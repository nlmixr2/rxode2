test_that("test the matrices of the linear compartment solutions .solComp2", {

  v <- list(L = c(4.07546291005291, 0.0245370899470903),
            C1 = structure(c(0.759200006770939,-0.740571447916969,
                             0.240799993229061, 0.740571447916969),
                           dim = c(2L, 2L)),
            C2 = structure(c(-0.246857149305656, 0.240799993229061,
                             0.246857149305656, 0.759200006770939),
                           dim = c(2L, 2L)))

  expect_equal(.solComp2(k10=0.1, k12=3, k21=1, cpp=FALSE), v)

  expect_equal(.solComp2(k10=0.1, k12=3, k21=1, cpp=TRUE), v)

  .Call(`_rxode2_solComp2cpp`, 0.1, 3, 1)

  v <- list(L = c(5.8977832399092, 0.0122878774411843, 0.689928882649618),
            C1 = structure(c(0.86252789433926, -0.528317313419071, -0.319585969277925,
                             0.120784508040635, 0.366861472939276, 0.495310665672737,
                             0.016687597620105, 0.161455840479795, -0.175724696394812),
                           dim = c(3L, 3L)),
            C2 = structure(c(-0.17610577113969, 0.107868659665074, 0.0652511460029109,
                             0.122287157646425, 0.371425504011093, 0.501472700759773,
                             0.053818613493265, 0.520705836323833, -0.566723846762684),
                           dim = c(3L, 3L)),
            C3 = structure(c(-0.0798964923194813, 0.0489383595021832, 0.0296034459956658,
                             0.123827666418184, 0.37610452556983, 0.507789987948271,
                             -0.043931174098703, -0.425042885072013, 0.462606566056063),
                           dim = c(3L,  3L)))

  expect_equal(.solComp3(k10=0.1, k12=3, k21=1, k13=2, k31=0.5, cpp=FALSE), v)

  expect_equal(.solComp3(k10=0.1, k12=3, k21=1, k13=2, k31=0.5, cpp=TRUE), v)

})
