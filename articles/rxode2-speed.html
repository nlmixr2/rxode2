<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Speeding up rxode2 • rxode2</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Speeding up rxode2">
<meta name="google-site-verification" content="fp9A3qPrCar1DKeVQg4Mfrf6-An5keP9OwhIxUkntbU">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rxode2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-book"></span> Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Getting started</h6></li>
    <li><a class="dropdown-item" href="../articles/rxode2-syntax.html">rxode2 mini language syntax</a></li>
    <li><a class="dropdown-item" href="../articles/Modifying-Models.html">rxode2 model modification %&gt;%</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-pipeline.html">rxode2 pipeline ie %&gt;%</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-speed.html">Speeding up rxode2 ODE solving</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-data-frame.html">Adaptive Data Frames with rxode2</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-plot.html">Plotting with rxode2</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced Features, Model Types, Technical Details</h6></li>
    <li><a class="dropdown-item" href="../articles/rxode2-model-types.html">rxode2 model types</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-cmt.html">Chainging rxode2 compartment numbers</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-transit-compartments.html">rxode2 transit compartment models</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-shiny.html">Using Shiny with rxode2</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-covariates.html">rxode2 covariates</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-stiff.html">Stiff Systems and Jacobian specification</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-rxUse.html">Adding compiled rxode2 models to your package</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-dosing-events" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-stethoscope"></span> Dosing/Events</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-dosing-events">
<li><a class="dropdown-item" href="../articles/rxode2-datasets.html">nlmixr/rxode2 dataset overview</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-event-types.html">Supported Event Types</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-event-table.html">Easy rxode2 Event Tables</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-events-classic.html">Classic rxode2 events explained</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-simulations" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-desktop"></span> Simulations</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-simulations">
<li><a class="dropdown-item" href="../articles/rxode2-single-subject.html">Single Subject ODE solving</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-sim-var.html">Multiple Subject rxode2 Simulation</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-prior-data.html">Using Prior Data for ODE solving</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-help" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-life-ring"></span> Help</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-help">
<li><a class="dropdown-item" href="../articles/rxode2-tutorials.html">Running the interactive tutorials</a></li>
    <li><a class="external-link dropdown-item" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4728294/pdf/PSP4-5-03.pdf">2015 CPT tutorial</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/rxode2-covariates.html">Adding Circadian Rythmn (time-varying covariates)</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-wt.html">Weight Based Dosing</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-nesting.html">Simulating Multiple levels of nesting (iov, between study etc)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changes/News</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="https://nlmixr2.github.io/rxode2/reference/index.html"><span class="fa fa-file-code-o"></span> Functions</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-archive"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-">
<li><a class="dropdown-item" href="https://nlmixr2.github.io/rxode2-manual/">rxode2 User Guide</a></li>
    <li><a class="external-link dropdown-item" href="https://nlmixr2.org/">nlmixr2</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nlmixr2/rxode2"><span class="fa fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nlmixr2/rxode2/releases"><span class="fa fa-download"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Speeding up rxode2</h1>
                        <h4 data-toc-skip class="author">Matthew
Fidler</h4>
            
            <h4 data-toc-skip class="date">2025-07-23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nlmixr2/rxode2/blob/main/vignettes/rxode2-speed.Rmd" class="external-link"><code>vignettes/rxode2-speed.Rmd</code></a></small>
      <div class="d-none name"><code>rxode2-speed.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="a-note-about-the-speed-of-the-functional-form-for-rxode2">A note about the speed of the functional form for rxode2<a class="anchor" aria-label="anchor" href="#a-note-about-the-speed-of-the-functional-form-for-rxode2"></a>
</h2>
<p>The functional form has the benefit that it is what is supported by
nlmixr2 and therefore there is only one interface between solving and
estimating, and it takes some computation time to get to the underlying
“classic” simulation code.</p>
<p>These models are in the form of:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlmixr2.github.io/rxode2/">rxode2</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; rxode2 4.0.2 using 2 threads (see ?getRxThreads)</span></span>
<span><span class="co">#&gt;   no cache: create with `rxCreateCache()`</span></span>
<span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/ini.html">ini</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">KA</span>   <span class="op">&lt;-</span> <span class="fl">0.3</span></span>
<span>    <span class="va">CL</span>   <span class="op">&lt;-</span> <span class="fl">7</span></span>
<span>    <span class="va">V2</span>   <span class="op">&lt;-</span> <span class="fl">40</span></span>
<span>    <span class="va">Q</span>    <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span>    <span class="va">V3</span>   <span class="op">&lt;-</span> <span class="fl">300</span></span>
<span>    <span class="va">Kin</span>  <span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span>    <span class="va">Kout</span> <span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span>    <span class="va">EC50</span> <span class="op">&lt;-</span> <span class="fl">8</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/model.html">model</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">C2</span> <span class="op">=</span> <span class="va">centr</span><span class="op">/</span><span class="va">V2</span></span>
<span>    <span class="va">C3</span> <span class="op">=</span> <span class="va">peri</span><span class="op">/</span><span class="va">V3</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">depot</span><span class="op">)</span> <span class="op">=</span> <span class="op">-</span><span class="va">KA</span><span class="op">*</span><span class="va">depot</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">centr</span><span class="op">)</span> <span class="op">=</span> <span class="va">KA</span><span class="op">*</span><span class="va">depot</span> <span class="op">-</span> <span class="va">CL</span><span class="op">*</span><span class="va">C2</span> <span class="op">-</span> <span class="va">Q</span><span class="op">*</span><span class="va">C2</span> <span class="op">+</span> <span class="va">Q</span><span class="op">*</span><span class="va">C3</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">peri</span><span class="op">)</span> <span class="op">=</span> <span class="va">Q</span><span class="op">*</span><span class="va">C2</span> <span class="op">-</span> <span class="va">Q</span><span class="op">*</span><span class="va">C3</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">eff</span><span class="op">)</span> <span class="op">=</span> <span class="va">Kin</span> <span class="op">-</span> <span class="va">Kout</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">C2</span><span class="op">/</span><span class="op">(</span><span class="va">EC50</span><span class="op">+</span><span class="va">C2</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="va">eff</span></span>
<span>    <span class="fu">eff</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span> <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Or you can also specify the end-points for simulation/estimation just
like <code>nlmixr2</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod2f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/ini.html">ini</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">TKA</span>   <span class="op">&lt;-</span> <span class="fl">0.3</span></span>
<span>    <span class="va">TCL</span>   <span class="op">&lt;-</span> <span class="fl">7</span></span>
<span>    <span class="va">TV2</span>   <span class="op">&lt;-</span> <span class="fl">40</span></span>
<span>    <span class="va">TQ</span>    <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span>    <span class="va">TV3</span>   <span class="op">&lt;-</span> <span class="fl">300</span></span>
<span>    <span class="va">TKin</span>  <span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span>    <span class="va">TKout</span> <span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span>    <span class="va">TEC50</span> <span class="op">&lt;-</span> <span class="fl">8</span></span>
<span>    <span class="va">eta.cl</span> <span class="op">+</span> <span class="va">eta.v</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.09</span>,</span>
<span>                       <span class="fl">0.08</span>, <span class="fl">0.25</span><span class="op">)</span></span>
<span>    <span class="va">c2.prop.sd</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span>    <span class="va">eff.add.sd</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/model.html">model</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">KA</span> <span class="op">&lt;-</span> <span class="va">TKA</span></span>
<span>    <span class="va">CL</span> <span class="op">&lt;-</span> <span class="va">TCL</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">eta.cl</span><span class="op">)</span></span>
<span>    <span class="va">V2</span>  <span class="op">&lt;-</span> <span class="va">TV2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">eta.v</span><span class="op">)</span></span>
<span>    <span class="va">Q</span>   <span class="op">&lt;-</span> <span class="va">TQ</span></span>
<span>    <span class="va">V3</span>  <span class="op">&lt;-</span> <span class="va">TV3</span></span>
<span>    <span class="va">Kin</span>  <span class="op">&lt;-</span> <span class="va">TKin</span></span>
<span>    <span class="va">Kout</span> <span class="op">&lt;-</span> <span class="va">TKout</span></span>
<span>    <span class="va">EC50</span> <span class="op">&lt;-</span> <span class="va">TEC50</span></span>
<span>    <span class="va">C2</span> <span class="op">=</span> <span class="va">centr</span><span class="op">/</span><span class="va">V2</span></span>
<span>    <span class="va">C3</span> <span class="op">=</span> <span class="va">peri</span><span class="op">/</span><span class="va">V3</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">depot</span><span class="op">)</span> <span class="op">=</span> <span class="op">-</span><span class="va">KA</span><span class="op">*</span><span class="va">depot</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">centr</span><span class="op">)</span> <span class="op">=</span> <span class="va">KA</span><span class="op">*</span><span class="va">depot</span> <span class="op">-</span> <span class="va">CL</span><span class="op">*</span><span class="va">C2</span> <span class="op">-</span> <span class="va">Q</span><span class="op">*</span><span class="va">C2</span> <span class="op">+</span> <span class="va">Q</span><span class="op">*</span><span class="va">C3</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">peri</span><span class="op">)</span> <span class="op">=</span> <span class="va">Q</span><span class="op">*</span><span class="va">C2</span> <span class="op">-</span> <span class="va">Q</span><span class="op">*</span><span class="va">C3</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">eff</span><span class="op">)</span> <span class="op">=</span> <span class="va">Kin</span> <span class="op">-</span> <span class="va">Kout</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">C2</span><span class="op">/</span><span class="op">(</span><span class="va">EC50</span><span class="op">+</span><span class="va">C2</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="va">eff</span></span>
<span>    <span class="fu">eff</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span> <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="va">C2</span> <span class="op">~</span> <span class="fu">prop</span><span class="op">(</span><span class="va">c2.prop.sd</span><span class="op">)</span></span>
<span>    <span class="va">eff</span> <span class="op">~</span> <span class="fu">add</span><span class="op">(</span><span class="va">eff.add.sd</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>For every solve, there is a compile (or a cached compile) of the
underlying model. If you wish to speed this process up you can use the
two underlying <code>rxode2</code> classic models. This takes two
steps:</p>
<ul>
<li><p>Parsing/evaluating the model</p></li>
<li><p>Creating the simulation model</p></li>
</ul>
<p>The first step can be done by <code>rxode2(mod1)</code> or
<code>mod1()</code> (or for the second model too).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu">mod1</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">mod2f</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rxode2.html">rxode2</a></span><span class="op">(</span><span class="va">mod2f</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> parameter labels from comments are typically ignored in non-interactive mode</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Need to run with the source intact to parse comments</span></span></code></pre></div>
<p>The second step is to create the underlying “classic”
<code>rxode2</code> model, which can be done with two different
methods:<code>$simulationModel</code> and
<code>$simulationIniModel</code>. The <code>$simulationModel</code> will
provide the simulation code without the initial conditions pre-pended,
the <code>$simulationIniModel</code> will pre-pend the values. When the
endpoints are specified, the simulation code for each endpoint is also
output. You can see the differences below:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">$</span><span class="va">simulationModel</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">rxode2 </span>4.0.2 model named <span style="color: #BBBB00; font-weight: bold;">rx_7a16d7dfede75ed83a3210281ca68330</span> model (<span style="color: #00BB00;">✔</span> <span style="color: #00BB00; font-weight: bold;">ready</span>). </span></span>
<span><span class="co">#&gt; DLL: /tmp/RtmpgzfWbr/rxode2/rx_7a16d7dfede75ed83a3210281ca68330__.rxd/rx_7a16d7dfede75ed83a3210281ca68330_.so</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Calculated Variables:</span></span>
<span><span class="co">#&gt; [1] "C2" "C3"</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── rxode2 Model Syntax ──</span></span></span>
<span><span class="co">#&gt; rxode2({</span></span>
<span><span class="co">#&gt;     param(KA, CL, V2, Q, V3, Kin, Kout, EC50)</span></span>
<span><span class="co">#&gt;     C2 = centr/V2</span></span>
<span><span class="co">#&gt;     C3 = peri/V3</span></span>
<span><span class="co">#&gt;     d/dt(depot) = -KA * depot</span></span>
<span><span class="co">#&gt;     d/dt(centr) = KA * depot - CL * C2 - Q * C2 + Q * C3</span></span>
<span><span class="co">#&gt;     d/dt(peri) = Q * C2 - Q * C3</span></span>
<span><span class="co">#&gt;     d/dt(eff) = Kin - Kout * (1 - C2/(EC50 + C2)) * eff</span></span>
<span><span class="co">#&gt;     eff(0) = 1</span></span>
<span><span class="co">#&gt; })</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">$</span><span class="va">simulationIniModel</span><span class="op">)</span></span>
<span><span class="co">#&gt; C model:</span></span>
<span><span class="co">#&gt; // Define translation state order for 4 states</span></span>
<span><span class="co">#&gt; #define __DDT0__ 0 // depot</span></span>
<span><span class="co">#&gt; #define _DEPOT_ 0 // depot</span></span>
<span><span class="co">#&gt; #define __DDT1__ 1 // centr</span></span>
<span><span class="co">#&gt; #define __DDT2__ 2 // peri</span></span>
<span><span class="co">#&gt; #define __DDT3__ 3 // eff</span></span>
<span><span class="co">#&gt; // Define 2 LHS values</span></span>
<span><span class="co">#&gt; #define _LHS_0_ 0 // C2</span></span>
<span><span class="co">#&gt; #define _LHS_1_ 1 // C3</span></span>
<span><span class="co">#&gt; #define _getRxSolve_ _rxb4c229157277fd6b4e6d330f251ccdc00__getRxSolve__5pb9</span></span>
<span><span class="co">#&gt; #define _evalUdf _rxb4c229157277fd6b4e6d330f251ccdc01__evalUdf_0SUH</span></span>
<span><span class="co">#&gt; #define _solveData _rxb4c229157277fd6b4e6d330f251ccdc02__solveData_jlsA</span></span>
<span><span class="co">#&gt; #define _assign_ptr _rxb4c229157277fd6b4e6d330f251ccdc03__assign_ptr_2JOC</span></span>
<span><span class="co">#&gt; #define _rxRmModelLib _rxb4c229157277fd6b4e6d330f251ccdc04__rxRmModelLib_P3Oy</span></span>
<span><span class="co">#&gt; #define _rxGetModelLib _rxb4c229157277fd6b4e6d330f251ccdc05__rxGetModelLib_HgjC</span></span>
<span><span class="co">#&gt; #define _old_c _rxb4c229157277fd6b4e6d330f251ccdc06__old_c_yj3W</span></span>
<span><span class="co">#&gt; #define _ptrid _rxb4c229157277fd6b4e6d330f251ccdc07__ptrid_hg1D</span></span>
<span><span class="co">#&gt; #define _rxIsCurrentC _rxb4c229157277fd6b4e6d330f251ccdc08__rxIsCurrentC_IdTQ</span></span>
<span><span class="co">#&gt; #define _sumPS _rxb4c229157277fd6b4e6d330f251ccdc09__sumPS_hwBD</span></span>
<span><span class="co">#&gt; #define _prodPS _rxb4c229157277fd6b4e6d330f251ccdc010__prodPS_gUde</span></span>
<span><span class="co">#&gt; #define _prodType _rxb4c229157277fd6b4e6d330f251ccdc011__prodType_5llz</span></span>
<span><span class="co">#&gt; #define _sumType _rxb4c229157277fd6b4e6d330f251ccdc012__sumType_yOSJ</span></span>
<span><span class="co">#&gt; #define _update_par_ptr _rxb4c229157277fd6b4e6d330f251ccdc013__update_par_ptr_AWUm</span></span>
<span><span class="co">#&gt; #define _getParCov _rxb4c229157277fd6b4e6d330f251ccdc014__getParCov_Ci4L</span></span>
<span><span class="co">#&gt; #define _rxode2_rxAssignPtr _rxb4c229157277fd6b4e6d330f251ccdc015__rxode2_rxAssignPtr_pGZK</span></span>
<span><span class="co">#&gt; #define _rxQr _rxb4c229157277fd6b4e6d330f251ccdc016__rxQr_aBwX</span></span>
<span><span class="co">#&gt; #define _compareFactorVal _rxb4c229157277fd6b4e6d330f251ccdc017__compareFactorVal_XHRN</span></span>
<span><span class="co">#&gt; #define _sum _rxb4c229157277fd6b4e6d330f251ccdc018__sum_1SO1</span></span>
<span><span class="co">#&gt; #define _udf _rxb4c229157277fd6b4e6d330f251ccdc019__udf_NYrN</span></span>
<span><span class="co">#&gt; #define _sign _rxb4c229157277fd6b4e6d330f251ccdc020__sign_WbGH</span></span>
<span><span class="co">#&gt; #define _prod _rxb4c229157277fd6b4e6d330f251ccdc021__prod_TvOD</span></span>
<span><span class="co">#&gt; #define _max _rxb4c229157277fd6b4e6d330f251ccdc022__max_f3z9</span></span>
<span><span class="co">#&gt; #define _min _rxb4c229157277fd6b4e6d330f251ccdc023__min_WqiE</span></span>
<span><span class="co">#&gt; #define _transit4P _rxb4c229157277fd6b4e6d330f251ccdc024__transit4P_Xp1T</span></span>
<span><span class="co">#&gt; #define _transit3P _rxb4c229157277fd6b4e6d330f251ccdc025__transit3P_noPD</span></span>
<span><span class="co">#&gt; #define _assignFuns0 _rxb4c229157277fd6b4e6d330f251ccdc026__assignFuns0_PfVe</span></span>
<span><span class="co">#&gt; #define _assignFuns _rxb4c229157277fd6b4e6d330f251ccdc027__assignFuns_Vphs</span></span>
<span><span class="co">#&gt; #define _rxord _rxb4c229157277fd6b4e6d330f251ccdc028__rxord_0tzV</span></span>
<span><span class="co">#&gt; #define __assignFuns2 _rxb4c229157277fd6b4e6d330f251ccdc029___assignFuns2_Mmad</span></span>
<span><span class="co">#&gt; #define _llikCauchyDscale _rxb4c229157277fd6b4e6d330f251ccdc030__llikCauchyDscale_rZFu</span></span>
<span><span class="co">#&gt; #define _llikCauchyDlocation _rxb4c229157277fd6b4e6d330f251ccdc031__llikCauchyDlocation_rFOl</span></span>
<span><span class="co">#&gt; #define _llikCauchy _rxb4c229157277fd6b4e6d330f251ccdc032__llikCauchy_7CAf</span></span>
<span><span class="co">#&gt; #define _llikGammaDrate _rxb4c229157277fd6b4e6d330f251ccdc033__llikGammaDrate_rvYZ</span></span>
<span><span class="co">#&gt; #define _llikGammaDshape _rxb4c229157277fd6b4e6d330f251ccdc034__llikGammaDshape_gF2u</span></span>
<span><span class="co">#&gt; #define _llikGamma _rxb4c229157277fd6b4e6d330f251ccdc035__llikGamma_4zbA</span></span>
<span><span class="co">#&gt; #define _llikWeibullDscale _rxb4c229157277fd6b4e6d330f251ccdc036__llikWeibullDscale_u2aE</span></span>
<span><span class="co">#&gt; #define _llikWeibullDshape _rxb4c229157277fd6b4e6d330f251ccdc037__llikWeibullDshape_uohD</span></span>
<span><span class="co">#&gt; #define _llikWeibull _rxb4c229157277fd6b4e6d330f251ccdc038__llikWeibull_jDSK</span></span>
<span><span class="co">#&gt; #define _llikUnifDbeta _rxb4c229157277fd6b4e6d330f251ccdc039__llikUnifDbeta_ZFSu</span></span>
<span><span class="co">#&gt; #define _llikUnifDalpha _rxb4c229157277fd6b4e6d330f251ccdc040__llikUnifDalpha_yota</span></span>
<span><span class="co">#&gt; #define _llikUnif _rxb4c229157277fd6b4e6d330f251ccdc041__llikUnif_lziD</span></span>
<span><span class="co">#&gt; #define _llikGeomDp _rxb4c229157277fd6b4e6d330f251ccdc042__llikGeomDp_IirE</span></span>
<span><span class="co">#&gt; #define _llikGeom _rxb4c229157277fd6b4e6d330f251ccdc043__llikGeom_0wRk</span></span>
<span><span class="co">#&gt; #define _llikFDdf2 _rxb4c229157277fd6b4e6d330f251ccdc044__llikFDdf2_fPLj</span></span>
<span><span class="co">#&gt; #define _llikFDdf1 _rxb4c229157277fd6b4e6d330f251ccdc045__llikFDdf1_f5r4</span></span>
<span><span class="co">#&gt; #define _llikF _rxb4c229157277fd6b4e6d330f251ccdc046__llikF_q6UF</span></span>
<span><span class="co">#&gt; #define _llikExpDrate _rxb4c229157277fd6b4e6d330f251ccdc047__llikExpDrate_gAxJ</span></span>
<span><span class="co">#&gt; #define _llikExp _rxb4c229157277fd6b4e6d330f251ccdc048__llikExp_Mtp6</span></span>
<span><span class="co">#&gt; #define _llikChisqDdf _rxb4c229157277fd6b4e6d330f251ccdc049__llikChisqDdf_ulNz</span></span>
<span><span class="co">#&gt; #define _llikChisq _rxb4c229157277fd6b4e6d330f251ccdc050__llikChisq_LwD1</span></span>
<span><span class="co">#&gt; #define _llikTDsd _rxb4c229157277fd6b4e6d330f251ccdc051__llikTDsd_9qDD</span></span>
<span><span class="co">#&gt; #define _llikTDmean _rxb4c229157277fd6b4e6d330f251ccdc052__llikTDmean_2wFm</span></span>
<span><span class="co">#&gt; #define _llikTDdf _rxb4c229157277fd6b4e6d330f251ccdc053__llikTDdf_HsIy</span></span>
<span><span class="co">#&gt; #define _llikT _rxb4c229157277fd6b4e6d330f251ccdc054__llikT_alpl</span></span>
<span><span class="co">#&gt; #define _llikBetaDshape2 _rxb4c229157277fd6b4e6d330f251ccdc055__llikBetaDshape2_P85e</span></span>
<span><span class="co">#&gt; #define _llikBetaDshape1 _rxb4c229157277fd6b4e6d330f251ccdc056__llikBetaDshape1_beKy</span></span>
<span><span class="co">#&gt; #define _llikBeta _rxb4c229157277fd6b4e6d330f251ccdc057__llikBeta_isyD</span></span>
<span><span class="co">#&gt; #define _llikNbinomMuDmu _rxb4c229157277fd6b4e6d330f251ccdc058__llikNbinomMuDmu_fO2c</span></span>
<span><span class="co">#&gt; #define _llikNbinomMu _rxb4c229157277fd6b4e6d330f251ccdc059__llikNbinomMu_bPrW</span></span>
<span><span class="co">#&gt; #define _llikNbinomDprob _rxb4c229157277fd6b4e6d330f251ccdc060__llikNbinomDprob_y1fN</span></span>
<span><span class="co">#&gt; #define _llikNbinom _rxb4c229157277fd6b4e6d330f251ccdc061__llikNbinom_ugfk</span></span>
<span><span class="co">#&gt; #define _llikBinomDprob _rxb4c229157277fd6b4e6d330f251ccdc062__llikBinomDprob_XEVP</span></span>
<span><span class="co">#&gt; #define _llikBinom _rxb4c229157277fd6b4e6d330f251ccdc063__llikBinom_jdOx</span></span>
<span><span class="co">#&gt; #define _llikPoisDlambda _rxb4c229157277fd6b4e6d330f251ccdc064__llikPoisDlambda_I3ZD</span></span>
<span><span class="co">#&gt; #define _llikPois _rxb4c229157277fd6b4e6d330f251ccdc065__llikPois_7wnk</span></span>
<span><span class="co">#&gt; #define _llikNormDsd _rxb4c229157277fd6b4e6d330f251ccdc066__llikNormDsd_XX5O</span></span>
<span><span class="co">#&gt; #define _llikNormDmean _rxb4c229157277fd6b4e6d330f251ccdc067__llikNormDmean_Agfw</span></span>
<span><span class="co">#&gt; #define _llikNorm _rxb4c229157277fd6b4e6d330f251ccdc068__llikNorm_CyNe</span></span>
<span><span class="co">#&gt; #define simeps _rxb4c229157277fd6b4e6d330f251ccdc069_simeps_o4Wl</span></span>
<span><span class="co">#&gt; #define simeta _rxb4c229157277fd6b4e6d330f251ccdc070_simeta_QYC1</span></span>
<span><span class="co">#&gt; #define expit _rxb4c229157277fd6b4e6d330f251ccdc071_expit_yBms</span></span>
<span><span class="co">#&gt; #define logit _rxb4c229157277fd6b4e6d330f251ccdc072_logit_pbu2</span></span>
<span><span class="co">#&gt; #define gammapDer _rxb4c229157277fd6b4e6d330f251ccdc073_gammapDer_85hP</span></span>
<span><span class="co">#&gt; #define lowergamma _rxb4c229157277fd6b4e6d330f251ccdc074_lowergamma_47wD</span></span>
<span><span class="co">#&gt; #define uppergamma _rxb4c229157277fd6b4e6d330f251ccdc075_uppergamma_fCYp</span></span>
<span><span class="co">#&gt; #define gammaqInva _rxb4c229157277fd6b4e6d330f251ccdc076_gammaqInva_7GH0</span></span>
<span><span class="co">#&gt; #define gammaqInv _rxb4c229157277fd6b4e6d330f251ccdc077_gammaqInv_qPki</span></span>
<span><span class="co">#&gt; #define gammapInva _rxb4c229157277fd6b4e6d330f251ccdc078_gammapInva_VyMA</span></span>
<span><span class="co">#&gt; #define gammapInv _rxb4c229157277fd6b4e6d330f251ccdc079_gammapInv_m1mA</span></span>
<span><span class="co">#&gt; #define gammaq _rxb4c229157277fd6b4e6d330f251ccdc080_gammaq_1mpx</span></span>
<span><span class="co">#&gt; #define gammap _rxb4c229157277fd6b4e6d330f251ccdc081_gammap_NAbn</span></span>
<span><span class="co">#&gt; #define phi _rxb4c229157277fd6b4e6d330f251ccdc082_phi_2jD0</span></span>
<span><span class="co">#&gt; #define d2ELUa _rxb4c229157277fd6b4e6d330f251ccdc083_d2ELUa_7gdK</span></span>
<span><span class="co">#&gt; #define dELUa _rxb4c229157277fd6b4e6d330f251ccdc084_dELUa_Ohhv</span></span>
<span><span class="co">#&gt; #define d2aELU _rxb4c229157277fd6b4e6d330f251ccdc085_d2aELU_SaAZ</span></span>
<span><span class="co">#&gt; #define d2ELU _rxb4c229157277fd6b4e6d330f251ccdc086_d2ELU_tapa</span></span>
<span><span class="co">#&gt; #define dELU _rxb4c229157277fd6b4e6d330f251ccdc087_dELU_mOqj</span></span>
<span><span class="co">#&gt; #define ELU _rxb4c229157277fd6b4e6d330f251ccdc088_ELU_J66n</span></span>
<span><span class="co">#&gt; #define dPReLUa1 _rxb4c229157277fd6b4e6d330f251ccdc089_dPReLUa1_N3zb</span></span>
<span><span class="co">#&gt; #define dPReLUa _rxb4c229157277fd6b4e6d330f251ccdc090_dPReLUa_9X7x</span></span>
<span><span class="co">#&gt; #define dPReLU _rxb4c229157277fd6b4e6d330f251ccdc091_dPReLU_2Awy</span></span>
<span><span class="co">#&gt; #define PReLU _rxb4c229157277fd6b4e6d330f251ccdc092_PReLU_isy2</span></span>
<span><span class="co">#&gt; #define dSwish _rxb4c229157277fd6b4e6d330f251ccdc093_dSwish_RdzJ</span></span>
<span><span class="co">#&gt; #define Swish _rxb4c229157277fd6b4e6d330f251ccdc094_Swish_rXsV</span></span>
<span><span class="co">#&gt; #define dlReLU _rxb4c229157277fd6b4e6d330f251ccdc095_dlReLU_rrL0</span></span>
<span><span class="co">#&gt; #define lReLU _rxb4c229157277fd6b4e6d330f251ccdc096_lReLU_CwHs</span></span>
<span><span class="co">#&gt; #define dSELU _rxb4c229157277fd6b4e6d330f251ccdc097_dSELU_x0YD</span></span>
<span><span class="co">#&gt; #define SELU _rxb4c229157277fd6b4e6d330f251ccdc098_SELU_ejsN</span></span>
<span><span class="co">#&gt; #define d4softplus _rxb4c229157277fd6b4e6d330f251ccdc099_d4softplus_tqj2</span></span>
<span><span class="co">#&gt; #define d3softplus _rxb4c229157277fd6b4e6d330f251ccdc0100_d3softplus_KkuC</span></span>
<span><span class="co">#&gt; #define d2softplus _rxb4c229157277fd6b4e6d330f251ccdc0101_d2softplus_TNOD</span></span>
<span><span class="co">#&gt; #define dsoftplus _rxb4c229157277fd6b4e6d330f251ccdc0102_dsoftplus_0MWq</span></span>
<span><span class="co">#&gt; #define softplus _rxb4c229157277fd6b4e6d330f251ccdc0103_softplus_8NGU</span></span>
<span><span class="co">#&gt; #define d4GELU _rxb4c229157277fd6b4e6d330f251ccdc0104_d4GELU_15zw</span></span>
<span><span class="co">#&gt; #define d3GELU _rxb4c229157277fd6b4e6d330f251ccdc0105_d3GELU_77MT</span></span>
<span><span class="co">#&gt; #define d2GELU _rxb4c229157277fd6b4e6d330f251ccdc0106_d2GELU_mU6w</span></span>
<span><span class="co">#&gt; #define dGELU _rxb4c229157277fd6b4e6d330f251ccdc0107_dGELU_hVWG</span></span>
<span><span class="co">#&gt; #define GELU _rxb4c229157277fd6b4e6d330f251ccdc0108_GELU_iyen</span></span>
<span><span class="co">#&gt; #define dReLU _rxb4c229157277fd6b4e6d330f251ccdc0109_dReLU_4spi</span></span>
<span><span class="co">#&gt; #define ReLU _rxb4c229157277fd6b4e6d330f251ccdc0110_ReLU_MWT6</span></span>
<span><span class="co">#&gt; #define riweibull _rxb4c229157277fd6b4e6d330f251ccdc0111_riweibull_VRYe</span></span>
<span><span class="co">#&gt; #define riunif _rxb4c229157277fd6b4e6d330f251ccdc0112_riunif_9Ita</span></span>
<span><span class="co">#&gt; #define rit_ _rxb4c229157277fd6b4e6d330f251ccdc0113_rit__dGJL</span></span>
<span><span class="co">#&gt; #define ripois _rxb4c229157277fd6b4e6d330f251ccdc0114_ripois_l03G</span></span>
<span><span class="co">#&gt; #define ribeta _rxb4c229157277fd6b4e6d330f251ccdc0115_ribeta_aI5l</span></span>
<span><span class="co">#&gt; #define rigamma _rxb4c229157277fd6b4e6d330f251ccdc0116_rigamma_lO3k</span></span>
<span><span class="co">#&gt; #define rigeom _rxb4c229157277fd6b4e6d330f251ccdc0117_rigeom_WHGX</span></span>
<span><span class="co">#&gt; #define rif _rxb4c229157277fd6b4e6d330f251ccdc0118_rif_CdkG</span></span>
<span><span class="co">#&gt; #define riexp _rxb4c229157277fd6b4e6d330f251ccdc0119_riexp_sq2N</span></span>
<span><span class="co">#&gt; #define richisq _rxb4c229157277fd6b4e6d330f251ccdc0120_richisq_BvuB</span></span>
<span><span class="co">#&gt; #define ricauchy _rxb4c229157277fd6b4e6d330f251ccdc0121_ricauchy_r0sO</span></span>
<span><span class="co">#&gt; #define rinbinomMu _rxb4c229157277fd6b4e6d330f251ccdc0122_rinbinomMu_4eup</span></span>
<span><span class="co">#&gt; #define rinbinom _rxb4c229157277fd6b4e6d330f251ccdc0123_rinbinom_VbTs</span></span>
<span><span class="co">#&gt; #define ribinom _rxb4c229157277fd6b4e6d330f251ccdc0124_ribinom_fOYF</span></span>
<span><span class="co">#&gt; #define rinorm _rxb4c229157277fd6b4e6d330f251ccdc0125_rinorm_C4Jz</span></span>
<span><span class="co">#&gt; #define rxweibull _rxb4c229157277fd6b4e6d330f251ccdc0126_rxweibull_7iE8</span></span>
<span><span class="co">#&gt; #define rxunif _rxb4c229157277fd6b4e6d330f251ccdc0127_rxunif_vtCF</span></span>
<span><span class="co">#&gt; #define rxt_ _rxb4c229157277fd6b4e6d330f251ccdc0128_rxt__cRJ6</span></span>
<span><span class="co">#&gt; #define rxpois _rxb4c229157277fd6b4e6d330f251ccdc0129_rxpois_Gev1</span></span>
<span><span class="co">#&gt; #define rxbeta _rxb4c229157277fd6b4e6d330f251ccdc0130_rxbeta_Yq4C</span></span>
<span><span class="co">#&gt; #define rxgamma _rxb4c229157277fd6b4e6d330f251ccdc0131_rxgamma_UGPR</span></span>
<span><span class="co">#&gt; #define rxgeom _rxb4c229157277fd6b4e6d330f251ccdc0132_rxgeom_B41j</span></span>
<span><span class="co">#&gt; #define rxf _rxb4c229157277fd6b4e6d330f251ccdc0133_rxf_yXA3</span></span>
<span><span class="co">#&gt; #define rxexp _rxb4c229157277fd6b4e6d330f251ccdc0134_rxexp_Scak</span></span>
<span><span class="co">#&gt; #define rxchisq _rxb4c229157277fd6b4e6d330f251ccdc0135_rxchisq_WU0x</span></span>
<span><span class="co">#&gt; #define rxcauchy _rxb4c229157277fd6b4e6d330f251ccdc0136_rxcauchy_SyXM</span></span>
<span><span class="co">#&gt; #define rxnbinomMu _rxb4c229157277fd6b4e6d330f251ccdc0137_rxnbinomMu_V4ye</span></span>
<span><span class="co">#&gt; #define rxnbinom _rxb4c229157277fd6b4e6d330f251ccdc0138_rxnbinom_zXlY</span></span>
<span><span class="co">#&gt; #define rxbinom _rxb4c229157277fd6b4e6d330f251ccdc0139_rxbinom_mdNM</span></span>
<span><span class="co">#&gt; #define rxnorm _rxb4c229157277fd6b4e6d330f251ccdc0140_rxnorm_qSBx</span></span>
<span><span class="co">#&gt; #define linCmtB _rxb4c229157277fd6b4e6d330f251ccdc0141_linCmtB_i1cp</span></span>
<span><span class="co">#&gt; #define linCmtA _rxb4c229157277fd6b4e6d330f251ccdc0142_linCmtA_dhrH</span></span>
<span><span class="co">#&gt; #include &lt;rxode2_model_shared.h&gt;</span></span>
<span><span class="co">#&gt; #define __MAX_PROD__ 0</span></span>
<span><span class="co">#&gt; #define _CMT CMT</span></span>
<span><span class="co">#&gt; #define _SYNC_simeps_ for (int _svari=_solveData-&gt;neps; _svari--;){  if (_solveData-&gt;svar[_svari] == 0) {KA = _PP[0];};   if (_solveData-&gt;svar[_svari] == 1) {CL = _PP[1];};   if (_solveData-&gt;svar[_svari] == 2) {V2 = _PP[2];};   if (_solveData-&gt;svar[_svari] == 3) {Q = _PP[3];};   if (_solveData-&gt;svar[_svari] == 4) {V3 = _PP[4];};   if (_solveData-&gt;svar[_svari] == 5) {Kin = _PP[5];};   if (_solveData-&gt;svar[_svari] == 6) {Kout = _PP[6];};   if (_solveData-&gt;svar[_svari] == 7) {EC50 = _PP[7];}; }</span></span>
<span><span class="co">#&gt; #define _SYNC_simeta_ for (int _ovari=_solveData-&gt;neta; _ovari--;){  if (_solveData-&gt;ovar[_ovari] == 0) {KA = _PP[0];};   if (_solveData-&gt;ovar[_ovari] == 1) {CL = _PP[1];};   if (_solveData-&gt;ovar[_ovari] == 2) {V2 = _PP[2];};   if (_solveData-&gt;ovar[_ovari] == 3) {Q = _PP[3];};   if (_solveData-&gt;ovar[_ovari] == 4) {V3 = _PP[4];};   if (_solveData-&gt;ovar[_ovari] == 5) {Kin = _PP[5];};   if (_solveData-&gt;ovar[_ovari] == 6) {Kout = _PP[6];};   if (_solveData-&gt;ovar[_ovari] == 7) {EC50 = _PP[7];}; }</span></span>
<span><span class="co">#&gt; _getRxSolve_t _getRxSolve_;</span></span>
<span><span class="co">#&gt; _simfun simeps;</span></span>
<span><span class="co">#&gt; _simfun simeta;</span></span>
<span><span class="co">#&gt; _udf_type _evalUdf=NULL;</span></span>
<span><span class="co">#&gt; rx_solve *_solveData=NULL;</span></span>
<span><span class="co">#&gt; rxode2_assign_ptr _assign_ptr=NULL;</span></span>
<span><span class="co">#&gt; _rxRmModelLibType _rxRmModelLib=NULL;</span></span>
<span><span class="co">#&gt; _rxGetModelLibType _rxGetModelLib=NULL;</span></span>
<span><span class="co">#&gt; rxode2_ode_solver_old_c _old_c=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _ptrid=NULL;</span></span>
<span><span class="co">#&gt; _rxIsCurrentC_type _rxIsCurrentC=NULL;</span></span>
<span><span class="co">#&gt; _rxSumType _sumPS=NULL;</span></span>
<span><span class="co">#&gt; _rxProdType _prodPS=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _prodType=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _sumType=NULL;</span></span>
<span><span class="co">#&gt; _update_par_ptr_p _update_par_ptr=NULL;</span></span>
<span><span class="co">#&gt; _getParCov_p _getParCov=NULL;</span></span>
<span><span class="co">#&gt; linCmtA_p linCmtA;</span></span>
<span><span class="co">#&gt; linCmtB_p linCmtB;</span></span>
<span><span class="co">#&gt; _rx_asgn _rxode2_rxAssignPtr=NULL;</span></span>
<span><span class="co">#&gt; _rx_asgn _rxQr=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn phi;</span></span>
<span><span class="co">#&gt; rxode2_fn ReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn dReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn dGELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d2GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d3GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d4GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn dsoftplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d2softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d3softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d4softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn SELU;</span></span>
<span><span class="co">#&gt; rxode2_fn dSELU;</span></span>
<span><span class="co">#&gt; rxode2_fn lReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn dlReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn Swish;</span></span>
<span><span class="co">#&gt; rxode2_fn dSwish;</span></span>
<span><span class="co">#&gt; rxode2_fn2 PReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLUa;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLUa1;</span></span>
<span><span class="co">#&gt; rxode2_fn2 ELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2ELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2aELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dELUa;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2ELUa;</span></span>
<span><span class="co">#&gt; rxode2_fn3 logit;</span></span>
<span><span class="co">#&gt; rxode2_fn3 expit;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammap;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaq;</span></span>
<span><span class="co">#&gt; rxode2_fn2 lowergamma;</span></span>
<span><span class="co">#&gt; rxode2_fn2 uppergamma;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapInv;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapDer;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapInva;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaqInv;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaqInva;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxnorm;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxbinom;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxnbinom;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxnbinomMu;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxcauchy;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxchisq;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxexp;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxf;</span></span>
<span><span class="co">#&gt; rxode2i_ifn rxgeom;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxgamma;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxbeta;</span></span>
<span><span class="co">#&gt; rxode2i_ifn rxpois;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxt_;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxunif;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxweibull;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rinorm;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom ribinom;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom rinbinom;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom rinbinomMu;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 ricauchy;</span></span>
<span><span class="co">#&gt; rxode2i2_fn richisq;</span></span>
<span><span class="co">#&gt; rxode2i2_fn riexp;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rif;</span></span>
<span><span class="co">#&gt; rxode2i2_ifn rigeom;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rigamma;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 ribeta;</span></span>
<span><span class="co">#&gt; rxode2i2_ifn ripois;</span></span>
<span><span class="co">#&gt; rxode2i2_fn rit_;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 riunif;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 riweibull;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNorm;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNormDmean;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNormDsd;</span></span>
<span><span class="co">#&gt; rxode2_llikPoisFun _llikPois;</span></span>
<span><span class="co">#&gt; rxode2_llikPoisFun _llikPoisDlambda;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikBinom;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikBinomDprob;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinom;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomDprob;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomMu;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomMuDmu;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBeta;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBetaDshape1;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBetaDshape2;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikT;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDdf;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDmean;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDsd;</span></span>
<span><span class="co">#&gt; rxode2_llikChisqFun _llikChisq;</span></span>
<span><span class="co">#&gt; rxode2_llikChisqFun _llikChisqDdf;</span></span>
<span><span class="co">#&gt; rxode2_llikExpFun _llikExp;</span></span>
<span><span class="co">#&gt; rxode2_llikExpFun _llikExpDrate;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikF;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikFDdf1;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikFDdf2;</span></span>
<span><span class="co">#&gt; rxode2_llikGeomFun _llikGeom;</span></span>
<span><span class="co">#&gt; rxode2_llikGeomFun _llikGeomDp;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnif;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnifDalpha;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnifDbeta;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibull;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibullDshape;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibullDscale;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGamma;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGammaDshape;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGammaDrate;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchy;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchyDlocation;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchyDscale;</span></span>
<span><span class="co">#&gt; rxode2_compareFactorVal_fn _compareFactorVal;</span></span>
<span><span class="co">#&gt; #include "extraC.h"</span></span>
<span><span class="co">#&gt; double _prod(double *input, double *p, int type, int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return _prodPS(input, p, n, type);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _udf(const char *funName, double *input, int n, ...) {</span></span>
<span><span class="co">#&gt;   if (n == -42) Rf_error("%s", "this has a ui user function that cannot be called directly");</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return _evalUdf(funName, n, input);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _sum(double *input, double *pld, int m, int type, int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   double ret = _sumPS(input, n, pld, m, type);</span></span>
<span><span class="co">#&gt;   if (type == 2 &amp;&amp; m &lt; 0){</span></span>
<span><span class="co">#&gt;     for (int i = -m; i--;){</span></span>
<span><span class="co">#&gt;       pld[i] = 0.0;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return ret;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _sign(unsigned int n, ...) {</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double s = 1;</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;     s = sign(va_arg(valist, double))*s;</span></span>
<span><span class="co">#&gt;     if (s == 0){</span></span>
<span><span class="co">#&gt;       break;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return s;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _rxord(int _cSub, unsigned int n,  ...) {</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind* ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   if (!ind-&gt;inLhs) {</span></span>
<span><span class="co">#&gt;     return 1.0;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double ret = 1.0;</span></span>
<span><span class="co">#&gt;   double p = 0.0;</span></span>
<span><span class="co">#&gt;   double u = rxunif(ind, 0.0, 1.0);</span></span>
<span><span class="co">#&gt;   int found = 0;</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;     p += va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     if (!found) {</span></span>
<span><span class="co">#&gt;       if (u &lt; p) {</span></span>
<span><span class="co">#&gt;         ret = (double)(i+1);</span></span>
<span><span class="co">#&gt;         found = 1;</span></span>
<span><span class="co">#&gt;       }</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   if (!found) ret =(double)(n+1);</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return ret;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _max(unsigned int n, ...) {</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double mx = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tmp = 0;</span></span>
<span><span class="co">#&gt;   if (n &gt;= 1){</span></span>
<span><span class="co">#&gt;     mx = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     for (unsigned int i = 1; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;       tmp = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;       if (tmp&gt;mx) mx=tmp;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     va_end(valist);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return mx;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _min(unsigned int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double mn = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tmp = 0;</span></span>
<span><span class="co">#&gt;   if (n &gt;= 1){</span></span>
<span><span class="co">#&gt;     mn = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     for (unsigned int i = 1; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;       tmp = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;       if (tmp&lt;mn) mn=tmp;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     va_end(valist);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return mn;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _transit4P(int cmt, double t, unsigned int id, double n, double mtt, double bio){</span></span>
<span><span class="co">#&gt;   double nd = (double) n;</span></span>
<span><span class="co">#&gt;   double ktr = (nd+1)/mtt;</span></span>
<span><span class="co">#&gt;   double lktr = _safe_log(nd+1)-_safe_log(mtt);</span></span>
<span><span class="co">#&gt;   double tlast = _solveData-&gt;subjects[id].tlastS[cmt];</span></span>
<span><span class="co">#&gt;   double dose = _solveData-&gt;subjects[id].curDoseS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(dose)) dose = 0.0;</span></span>
<span><span class="co">#&gt;   if (ISNA(tlast)) tlast = 0.0;</span></span>
<span><span class="co">#&gt;   double tad = (t-tlast);</span></span>
<span><span class="co">#&gt;   return exp(_safe_log(bio*dose)+lktr+n*(lktr+_safe_log(tad))-ktr*(tad)-lgamma1p(nd));</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _transit3P(int cmt, double t, unsigned int id, double n, double mtt){</span></span>
<span><span class="co">#&gt;   double nd = (double) n;</span></span>
<span><span class="co">#&gt;   double ktr = (nd+1)/mtt;</span></span>
<span><span class="co">#&gt;   double lktr = _safe_log(nd+1)-_safe_log(mtt);</span></span>
<span><span class="co">#&gt;   double tlast = _solveData-&gt;subjects[id].tlastS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(tlast)) tlast = 0.0;</span></span>
<span><span class="co">#&gt;   double tad = t-tlast;</span></span>
<span><span class="co">#&gt;   double podo = _solveData-&gt;subjects[id].curDoseS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(podo)) podo = 0.0;</span></span>
<span><span class="co">#&gt;   return exp(_safe_log(podo)+lktr+n*(lktr+_safe_log(tad))-ktr*(tad)-lgamma1p(nd));</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void _assignFuns0(void) {</span></span>
<span><span class="co">#&gt;   _evalUdf = (_udf_type) R_GetCCallable("rxode2", "_rxode2_evalUdf");</span></span>
<span><span class="co">#&gt;   _getRxSolve_ = (_getRxSolve_t) R_GetCCallable("rxode2","getRxSolve_");</span></span>
<span><span class="co">#&gt;   _assign_ptr=(rxode2_assign_ptr) R_GetCCallable("rxode2","rxode2_assign_fn_pointers");</span></span>
<span><span class="co">#&gt;   _rxRmModelLib=(_rxRmModelLibType) R_GetCCallable("rxode2","rxRmModelLib");</span></span>
<span><span class="co">#&gt;   _rxGetModelLib=(_rxGetModelLibType) R_GetCCallable("rxode2","rxGetModelLib");</span></span>
<span><span class="co">#&gt;   _rxode2_rxAssignPtr=(_rx_asgn)R_GetCCallable("rxode2","_rxode2_rxAssignPtr");</span></span>
<span><span class="co">#&gt;   _rxQr=(_rx_asgn)R_GetCCallable("rxode2","_rxode2_rxQr");</span></span>
<span><span class="co">#&gt;   _rxIsCurrentC = (_rxIsCurrentC_type)R_GetCCallable("rxode2","rxIsCurrentC");</span></span>
<span><span class="co">#&gt;   _sumPS  = (_rxSumType) R_GetCCallable("PreciseSums","PreciseSums_sum_r");</span></span>
<span><span class="co">#&gt;   _prodPS = (_rxProdType) R_GetCCallable("PreciseSums","PreciseSums_prod_r");</span></span>
<span><span class="co">#&gt;   _prodType=(rxode2_fn0i)R_GetCCallable("PreciseSums", "PreciseSums_prod_get");</span></span>
<span><span class="co">#&gt;   _sumType=(rxode2_fn0i)R_GetCCallable("PreciseSums", "PreciseSums_sum_get");</span></span>
<span><span class="co">#&gt;   _ptrid=(rxode2_fn0i)R_GetCCallable("rxode2", "rxode2_current_fn_pointer_id");</span></span>
<span><span class="co">#&gt;   _compareFactorVal=(rxode2_compareFactorVal_fn) R_GetCCallable("rxode2", "compareFactorVal");</span></span>
<span><span class="co">#&gt;   _update_par_ptr = (_update_par_ptr_p) R_GetCCallable("rxode2","_update_par_ptr");</span></span>
<span><span class="co">#&gt;   _getParCov = (_getParCov_p) R_GetCCallable("rxode2","_getParCov");</span></span>
<span><span class="co">#&gt;   // dynamic start</span></span>
<span><span class="co">#&gt;   _llikCauchyDscale = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchyDscale");</span></span>
<span><span class="co">#&gt;   _llikCauchyDlocation = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchyDlocation");</span></span>
<span><span class="co">#&gt;   _llikCauchy = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchy");</span></span>
<span><span class="co">#&gt;   _llikGammaDrate = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGammaDrate");</span></span>
<span><span class="co">#&gt;   _llikGammaDshape = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGammaDshape");</span></span>
<span><span class="co">#&gt;   _llikGamma = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGamma");</span></span>
<span><span class="co">#&gt;   _llikWeibullDscale = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibullDscale");</span></span>
<span><span class="co">#&gt;   _llikWeibullDshape = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibullDshape");</span></span>
<span><span class="co">#&gt;   _llikWeibull = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibull");</span></span>
<span><span class="co">#&gt;   _llikUnifDbeta = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnifDbeta");</span></span>
<span><span class="co">#&gt;   _llikUnifDalpha = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnifDalpha");</span></span>
<span><span class="co">#&gt;   _llikUnif = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnif");</span></span>
<span><span class="co">#&gt;   _llikGeomDp = (rxode2_llikGeomFun) R_GetCCallable("rxode2ll", "rxLlikGeomDp");</span></span>
<span><span class="co">#&gt;   _llikGeom = (rxode2_llikGeomFun) R_GetCCallable("rxode2ll", "rxLlikGeom");</span></span>
<span><span class="co">#&gt;   _llikFDdf2 = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikFDdf2");</span></span>
<span><span class="co">#&gt;   _llikFDdf1 = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikFDdf1");</span></span>
<span><span class="co">#&gt;   _llikF = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikF");</span></span>
<span><span class="co">#&gt;   _llikExpDrate = (rxode2_llikExpFun) R_GetCCallable("rxode2ll", "rxLlikExpDrate");</span></span>
<span><span class="co">#&gt;   _llikExp = (rxode2_llikExpFun) R_GetCCallable("rxode2ll", "rxLlikExp");</span></span>
<span><span class="co">#&gt;   _llikChisqDdf = (rxode2_llikChisqFun) R_GetCCallable("rxode2ll", "rxLlikChisqDdf");</span></span>
<span><span class="co">#&gt;   _llikChisq = (rxode2_llikChisqFun) R_GetCCallable("rxode2ll", "rxLlikChisq");</span></span>
<span><span class="co">#&gt;   _llikTDsd = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDsd");</span></span>
<span><span class="co">#&gt;   _llikTDmean = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDmean");</span></span>
<span><span class="co">#&gt;   _llikTDdf = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDdf");</span></span>
<span><span class="co">#&gt;   _llikT = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikT");</span></span>
<span><span class="co">#&gt;   _llikBetaDshape2 = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBetaDshape2");</span></span>
<span><span class="co">#&gt;   _llikBetaDshape1 = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBetaDshape1");</span></span>
<span><span class="co">#&gt;   _llikBeta = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBeta");</span></span>
<span><span class="co">#&gt;   _llikNbinomMuDmu = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomMuDmu");</span></span>
<span><span class="co">#&gt;   _llikNbinomMu = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomMu");</span></span>
<span><span class="co">#&gt;   _llikNbinomDprob = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomDprob");</span></span>
<span><span class="co">#&gt;   _llikNbinom = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinom");</span></span>
<span><span class="co">#&gt;   _llikBinomDprob = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikBinomDprob");</span></span>
<span><span class="co">#&gt;   _llikBinom = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikBinom");</span></span>
<span><span class="co">#&gt;   _llikPoisDlambda = (rxode2_llikPoisFun) R_GetCCallable("rxode2ll", "rxLlikPoisDlambda");</span></span>
<span><span class="co">#&gt;   _llikPois = (rxode2_llikPoisFun) R_GetCCallable("rxode2ll", "rxLlikPois");</span></span>
<span><span class="co">#&gt;   _llikNormDsd = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNormDsd");</span></span>
<span><span class="co">#&gt;   _llikNormDmean = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNormDmean");</span></span>
<span><span class="co">#&gt;   _llikNorm = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNorm");</span></span>
<span><span class="co">#&gt;   simeps = (_simfun) R_GetCCallable("rxode2", "simeps");</span></span>
<span><span class="co">#&gt;   simeta = (_simfun) R_GetCCallable("rxode2", "simeta");</span></span>
<span><span class="co">#&gt;   expit = (rxode2_fn3) R_GetCCallable("rxode2", "expit");</span></span>
<span><span class="co">#&gt;   logit = (rxode2_fn3) R_GetCCallable("rxode2", "logit");</span></span>
<span><span class="co">#&gt;   gammapDer = (rxode2_fn2) R_GetCCallable("rxode2", "gammapDer");</span></span>
<span><span class="co">#&gt;   lowergamma = (rxode2_fn2) R_GetCCallable("rxode2", "lowergamma");</span></span>
<span><span class="co">#&gt;   uppergamma = (rxode2_fn2) R_GetCCallable("rxode2", "uppergamma");</span></span>
<span><span class="co">#&gt;   gammaqInva = (rxode2_fn2) R_GetCCallable("rxode2", "gammaqInva");</span></span>
<span><span class="co">#&gt;   gammaqInv = (rxode2_fn2) R_GetCCallable("rxode2", "gammaqInv");</span></span>
<span><span class="co">#&gt;   gammapInva = (rxode2_fn2) R_GetCCallable("rxode2", "gammapInva");</span></span>
<span><span class="co">#&gt;   gammapInv = (rxode2_fn2) R_GetCCallable("rxode2", "gammapInv");</span></span>
<span><span class="co">#&gt;   gammaq = (rxode2_fn2) R_GetCCallable("rxode2", "gammaq");</span></span>
<span><span class="co">#&gt;   gammap = (rxode2_fn2) R_GetCCallable("rxode2", "gammap");</span></span>
<span><span class="co">#&gt;   phi = (rxode2_fn) R_GetCCallable("rxode2", "phi");</span></span>
<span><span class="co">#&gt;   d2ELUa = (rxode2_fn2) R_GetCCallable("rxode2", "d2ELUa");</span></span>
<span><span class="co">#&gt;   dELUa = (rxode2_fn2) R_GetCCallable("rxode2", "dELUa");</span></span>
<span><span class="co">#&gt;   d2aELU = (rxode2_fn2) R_GetCCallable("rxode2", "d2aELU");</span></span>
<span><span class="co">#&gt;   d2ELU = (rxode2_fn2) R_GetCCallable("rxode2", "d2ELU");</span></span>
<span><span class="co">#&gt;   dELU = (rxode2_fn2) R_GetCCallable("rxode2", "dELU");</span></span>
<span><span class="co">#&gt;   ELU = (rxode2_fn2) R_GetCCallable("rxode2", "ELU");</span></span>
<span><span class="co">#&gt;   dPReLUa1 = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLUa1");</span></span>
<span><span class="co">#&gt;   dPReLUa = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLUa");</span></span>
<span><span class="co">#&gt;   dPReLU = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLU");</span></span>
<span><span class="co">#&gt;   PReLU = (rxode2_fn2) R_GetCCallable("rxode2", "PReLU");</span></span>
<span><span class="co">#&gt;   dSwish = (rxode2_fn) R_GetCCallable("rxode2", "dSwish");</span></span>
<span><span class="co">#&gt;   Swish = (rxode2_fn) R_GetCCallable("rxode2", "Swish");</span></span>
<span><span class="co">#&gt;   dlReLU = (rxode2_fn) R_GetCCallable("rxode2", "dlReLU");</span></span>
<span><span class="co">#&gt;   lReLU = (rxode2_fn) R_GetCCallable("rxode2", "lReLU");</span></span>
<span><span class="co">#&gt;   dSELU = (rxode2_fn) R_GetCCallable("rxode2", "dSELU");</span></span>
<span><span class="co">#&gt;   SELU = (rxode2_fn) R_GetCCallable("rxode2", "SELU");</span></span>
<span><span class="co">#&gt;   d4softplus = (rxode2_fn) R_GetCCallable("rxode2", "d4softplus");</span></span>
<span><span class="co">#&gt;   d3softplus = (rxode2_fn) R_GetCCallable("rxode2", "d3softplus");</span></span>
<span><span class="co">#&gt;   d2softplus = (rxode2_fn) R_GetCCallable("rxode2", "d2softplus");</span></span>
<span><span class="co">#&gt;   dsoftplus = (rxode2_fn) R_GetCCallable("rxode2", "dsoftplus");</span></span>
<span><span class="co">#&gt;   softplus = (rxode2_fn) R_GetCCallable("rxode2", "softplus");</span></span>
<span><span class="co">#&gt;   d4GELU = (rxode2_fn) R_GetCCallable("rxode2", "d4GELU");</span></span>
<span><span class="co">#&gt;   d3GELU = (rxode2_fn) R_GetCCallable("rxode2", "d3GELU");</span></span>
<span><span class="co">#&gt;   d2GELU = (rxode2_fn) R_GetCCallable("rxode2", "d2GELU");</span></span>
<span><span class="co">#&gt;   dGELU = (rxode2_fn) R_GetCCallable("rxode2", "dGELU");</span></span>
<span><span class="co">#&gt;   GELU = (rxode2_fn) R_GetCCallable("rxode2", "GELU");</span></span>
<span><span class="co">#&gt;   dReLU = (rxode2_fn) R_GetCCallable("rxode2", "dReLU");</span></span>
<span><span class="co">#&gt;   ReLU = (rxode2_fn) R_GetCCallable("rxode2", "ReLU");</span></span>
<span><span class="co">#&gt;   riweibull = (rxode2i2_fn2) R_GetCCallable("rxode2", "riweibull");</span></span>
<span><span class="co">#&gt;   riunif = (rxode2i2_fn2) R_GetCCallable("rxode2", "riunif");</span></span>
<span><span class="co">#&gt;   rit_ = (rxode2i2_fn) R_GetCCallable("rxode2", "rit_");</span></span>
<span><span class="co">#&gt;   ripois = (rxode2i2_ifn) R_GetCCallable("rxode2", "ripois");</span></span>
<span><span class="co">#&gt;   ribeta = (rxode2i2_fn2) R_GetCCallable("rxode2", "ribeta");</span></span>
<span><span class="co">#&gt;   rigamma = (rxode2i2_fn2) R_GetCCallable("rxode2", "rigamma");</span></span>
<span><span class="co">#&gt;   rigeom = (rxode2i2_ifn) R_GetCCallable("rxode2", "rigeom");</span></span>
<span><span class="co">#&gt;   rif = (rxode2i2_fn2) R_GetCCallable("rxode2", "rif");</span></span>
<span><span class="co">#&gt;   riexp = (rxode2i2_fn) R_GetCCallable("rxode2", "riexp");</span></span>
<span><span class="co">#&gt;   richisq = (rxode2i2_fn) R_GetCCallable("rxode2", "richisq");</span></span>
<span><span class="co">#&gt;   ricauchy = (rxode2i2_fn2) R_GetCCallable("rxode2", "ricauchy");</span></span>
<span><span class="co">#&gt;   rinbinomMu = (rxode2i2_ribinom) R_GetCCallable("rxode2", "rinbinomMu");</span></span>
<span><span class="co">#&gt;   rinbinom = (rxode2i2_ribinom) R_GetCCallable("rxode2", "rinbinom");</span></span>
<span><span class="co">#&gt;   ribinom = (rxode2i2_ribinom) R_GetCCallable("rxode2", "ribinom");</span></span>
<span><span class="co">#&gt;   rinorm = (rxode2i2_fn2) R_GetCCallable("rxode2", "rinorm");</span></span>
<span><span class="co">#&gt;   rxweibull = (rxode2i_fn2) R_GetCCallable("rxode2", "rxweibull");</span></span>
<span><span class="co">#&gt;   rxunif = (rxode2i_fn2) R_GetCCallable("rxode2", "rxunif");</span></span>
<span><span class="co">#&gt;   rxt_ = (rxode2i_fn) R_GetCCallable("rxode2", "rxt_");</span></span>
<span><span class="co">#&gt;   rxpois = (rxode2i_ifn) R_GetCCallable("rxode2", "rxpois");</span></span>
<span><span class="co">#&gt;   rxbeta = (rxode2i_fn2) R_GetCCallable("rxode2", "rxbeta");</span></span>
<span><span class="co">#&gt;   rxgamma = (rxode2i_fn2) R_GetCCallable("rxode2", "rxgamma");</span></span>
<span><span class="co">#&gt;   rxgeom = (rxode2i_ifn) R_GetCCallable("rxode2", "rxgeom");</span></span>
<span><span class="co">#&gt;   rxf = (rxode2i_fn2) R_GetCCallable("rxode2", "rxf");</span></span>
<span><span class="co">#&gt;   rxexp = (rxode2i_fn) R_GetCCallable("rxode2", "rxexp");</span></span>
<span><span class="co">#&gt;   rxchisq = (rxode2i_fn) R_GetCCallable("rxode2", "rxchisq");</span></span>
<span><span class="co">#&gt;   rxcauchy = (rxode2i_fn2) R_GetCCallable("rxode2", "rxcauchy");</span></span>
<span><span class="co">#&gt;   rxnbinomMu = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxnbinomMu");</span></span>
<span><span class="co">#&gt;   rxnbinom = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxnbinom");</span></span>
<span><span class="co">#&gt;   rxbinom = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxbinom");</span></span>
<span><span class="co">#&gt;   rxnorm = (rxode2i_fn2) R_GetCCallable("rxode2", "rxnorm");</span></span>
<span><span class="co">#&gt;   linCmtB = (linCmtB_p) R_GetCCallable("rxode2", "linCmtB");</span></span>
<span><span class="co">#&gt;   linCmtA = (linCmtA_p) R_GetCCallable("rxode2", "linCmtA");</span></span>
<span><span class="co">#&gt;   // dynamic stop</span></span>
<span><span class="co">#&gt;   _solveData = _getRxSolve_();</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void _assignFuns(void) {</span></span>
<span><span class="co">#&gt;   if (_assign_ptr == NULL){</span></span>
<span><span class="co">#&gt;     _assignFuns0();</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void __assignFuns2(rx_solve rx,</span></span>
<span><span class="co">#&gt;                    rx_solving_options op,</span></span>
<span><span class="co">#&gt;                    t_F f,</span></span>
<span><span class="co">#&gt;                    t_LAG lag,</span></span>
<span><span class="co">#&gt;                    t_RATE rate,</span></span>
<span><span class="co">#&gt;                    t_DUR dur,</span></span>
<span><span class="co">#&gt;                    t_calc_mtime mtime,</span></span>
<span><span class="co">#&gt;                    t_ME me,</span></span>
<span><span class="co">#&gt;                    t_IndF indf,</span></span>
<span><span class="co">#&gt;                    t_getTime gettime,</span></span>
<span><span class="co">#&gt;                    t_locateTimeIndex timeindex,</span></span>
<span><span class="co">#&gt;                    t_handle_evidL handleEvid,</span></span>
<span><span class="co">#&gt;                    t_getDur getdur) {</span></span>
<span><span class="co">#&gt;   // assign start</span></span>
<span><span class="co">#&gt;     static rxode2_assignFuns2_t rxode2_assignFuns2 = NULL;</span></span>
<span><span class="co">#&gt;     if (rxode2_assignFuns2 == NULL) rxode2_assignFuns2 = (rxode2_assignFuns2_t)(R_GetCCallable("rxode2", "_rxode2_assignFuns2"));</span></span>
<span><span class="co">#&gt;     rxode2_assignFuns2(rx, op, f, lag, rate, dur, mtime, me, indf, gettime, timeindex, handleEvid, getdur);</span></span>
<span><span class="co">#&gt;   // assign stop</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void  rx_7611bb7c6ec3e29b5c3f55496eef0e30__ode_solver_solvedata (rx_solve *solve){</span></span>
<span><span class="co">#&gt;   _solveData = solve;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern rx_solve *rx_7611bb7c6ec3e29b5c3f55496eef0e30__ode_solver_get_solvedata(void){</span></span>
<span><span class="co">#&gt;   return _solveData;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; SEXP rx_7611bb7c6ec3e29b5c3f55496eef0e30__model_vars(void);</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; // prj-specific differential eqns</span></span>
<span><span class="co">#&gt; void rx_7611bb7c6ec3e29b5c3f55496eef0e30__dydt(int *_neq, double __t, double *__zzStateVar__, double *__DDtStateVar__)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   int _cSub = _neq[1];</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_neq[1]].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=1;</span></span>
<span><span class="co">#&gt;   double KA = NA_REAL;</span></span>
<span><span class="co">#&gt;   double CL = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Q = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kin = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kout = NA_REAL;</span></span>
<span><span class="co">#&gt;   double EC50 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double centr = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double peri = NA_REAL;</span></span>
<span><span class="co">#&gt;   double depot = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eff = NA_REAL;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   (void)KA;</span></span>
<span><span class="co">#&gt;   (void)CL;</span></span>
<span><span class="co">#&gt;   (void)V2;</span></span>
<span><span class="co">#&gt;   (void)Q;</span></span>
<span><span class="co">#&gt;   (void)V3;</span></span>
<span><span class="co">#&gt;   (void)Kin;</span></span>
<span><span class="co">#&gt;   (void)Kout;</span></span>
<span><span class="co">#&gt;   (void)EC50;</span></span>
<span><span class="co">#&gt;   (void)C2;</span></span>
<span><span class="co">#&gt;   (void)centr;</span></span>
<span><span class="co">#&gt;   (void)C3;</span></span>
<span><span class="co">#&gt;   (void)peri;</span></span>
<span><span class="co">#&gt;   (void)depot;</span></span>
<span><span class="co">#&gt;   (void)eff;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   C2 = _PL[0];</span></span>
<span><span class="co">#&gt;   C3 = _PL[1];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _update_par_ptr(__t, _cSub, _solveData, _idx);</span></span>
<span><span class="co">#&gt;   KA = _PP[0];</span></span>
<span><span class="co">#&gt;   CL = _PP[1];</span></span>
<span><span class="co">#&gt;   V2 = _PP[2];</span></span>
<span><span class="co">#&gt;   Q = _PP[3];</span></span>
<span><span class="co">#&gt;   V3 = _PP[4];</span></span>
<span><span class="co">#&gt;   Kin = _PP[5];</span></span>
<span><span class="co">#&gt;   Kout = _PP[6];</span></span>
<span><span class="co">#&gt;   EC50 = _PP[7];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   depot = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">#&gt;   centr = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">#&gt;   peri = __zzStateVar__[__DDT2__]*((double)(_ON[__DDT2__]));</span></span>
<span><span class="co">#&gt;   eff = __zzStateVar__[__DDT3__]*((double)(_ON[__DDT3__]));</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   C2=centr/_div0(V2);</span></span>
<span><span class="co">#&gt;   C3=peri/_div0(V3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT0__] = ((double)(_ON[__DDT0__]))*(_IR[__DDT0__] -KA*depot);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT1__] = ((double)(_ON[__DDT1__]))*(_IR[__DDT1__] + KA*depot-CL*C2-Q*C2+Q*C3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT2__] = ((double)(_ON[__DDT2__]))*(_IR[__DDT2__] + Q*C2-Q*C3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT3__] = ((double)(_ON[__DDT3__]))*(_IR[__DDT3__] + Kin-Kout*(1-C2/_div0((EC50+C2)))*eff);</span></span>
<span><span class="co">#&gt;   (&amp;_solveData-&gt;subjects[_cSub])-&gt;dadt_counter[0]++;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; // Jacobian derived vars</span></span>
<span><span class="co">#&gt; void rx_7611bb7c6ec3e29b5c3f55496eef0e30__calc_jac(int *_neq, double __t, double *__zzStateVar__, double *__PDStateVar__, unsigned int __NROWPD__) {</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;     int _cSub=_neq[1];</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_neq[1]].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=2;</span></span>
<span><span class="co">#&gt;   (&amp;_solveData-&gt;subjects[_cSub])-&gt;jac_counter[0]++;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Functional based initial conditions.</span></span>
<span><span class="co">#&gt; void rx_7611bb7c6ec3e29b5c3f55496eef0e30__inis(int _cSub, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;  _ind-&gt;_rxFlag=3;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // prj-specific derived vars</span></span>
<span><span class="co">#&gt; void rx_7611bb7c6ec3e29b5c3f55496eef0e30__calc_lhs(int _cSub, double __t, double *__zzStateVar__, double *_lhs) {</span></span>
<span><span class="co">#&gt;     int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=11;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_0__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_1__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_2__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_3__;</span></span>
<span><span class="co">#&gt;   double KA = NA_REAL;</span></span>
<span><span class="co">#&gt;   double CL = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Q = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kin = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kout = NA_REAL;</span></span>
<span><span class="co">#&gt;   double EC50 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double centr = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double peri = NA_REAL;</span></span>
<span><span class="co">#&gt;   double depot = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eff = NA_REAL;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_0__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_1__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_2__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_3__;</span></span>
<span><span class="co">#&gt;   (void)KA;</span></span>
<span><span class="co">#&gt;   (void)CL;</span></span>
<span><span class="co">#&gt;   (void)V2;</span></span>
<span><span class="co">#&gt;   (void)Q;</span></span>
<span><span class="co">#&gt;   (void)V3;</span></span>
<span><span class="co">#&gt;   (void)Kin;</span></span>
<span><span class="co">#&gt;   (void)Kout;</span></span>
<span><span class="co">#&gt;   (void)EC50;</span></span>
<span><span class="co">#&gt;   (void)C2;</span></span>
<span><span class="co">#&gt;   (void)centr;</span></span>
<span><span class="co">#&gt;   (void)C3;</span></span>
<span><span class="co">#&gt;   (void)peri;</span></span>
<span><span class="co">#&gt;   (void)depot;</span></span>
<span><span class="co">#&gt;   (void)eff;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   C2 = _PL[0];</span></span>
<span><span class="co">#&gt;   C3 = _PL[1];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _update_par_ptr(__t, _cSub, _solveData, _idx);</span></span>
<span><span class="co">#&gt;   KA = _PP[0];</span></span>
<span><span class="co">#&gt;   CL = _PP[1];</span></span>
<span><span class="co">#&gt;   V2 = _PP[2];</span></span>
<span><span class="co">#&gt;   Q = _PP[3];</span></span>
<span><span class="co">#&gt;   V3 = _PP[4];</span></span>
<span><span class="co">#&gt;   Kin = _PP[5];</span></span>
<span><span class="co">#&gt;   Kout = _PP[6];</span></span>
<span><span class="co">#&gt;   EC50 = _PP[7];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   depot = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">#&gt;   centr = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">#&gt;   peri = __zzStateVar__[__DDT2__]*((double)(_ON[__DDT2__]));</span></span>
<span><span class="co">#&gt;   eff = __zzStateVar__[__DDT3__]*((double)(_ON[__DDT3__]));</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   C2=centr/_div0(V2);</span></span>
<span><span class="co">#&gt;   C3=peri/_div0(V3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_0__ = ((double)(_ON[__DDT0__]))*(_IR[__DDT0__] -KA*depot);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_1__ = ((double)(_ON[__DDT1__]))*(_IR[__DDT1__] + KA*depot-CL*C2-Q*C2+Q*C3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_2__ = ((double)(_ON[__DDT2__]))*(_IR[__DDT2__] + Q*C2-Q*C3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_3__ = ((double)(_ON[__DDT3__]))*(_IR[__DDT3__] + Kin-Kout*(1-C2/_div0((EC50+C2)))*eff);</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _lhs[_LHS_0_]=C2;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_1_]=C3;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Functional based bioavailability</span></span>
<span><span class="co">#&gt; double rx_7611bb7c6ec3e29b5c3f55496eef0e30__F(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return _amt;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; // Functional based absorption lag</span></span>
<span><span class="co">#&gt; double rx_7611bb7c6ec3e29b5c3f55496eef0e30__Lag(int _cSub,  int _cmt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return __t;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Modeled zero-order rate</span></span>
<span><span class="co">#&gt; double rx_7611bb7c6ec3e29b5c3f55496eef0e30__Rate(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return 0.0;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Modeled zero-order duration</span></span>
<span><span class="co">#&gt; double rx_7611bb7c6ec3e29b5c3f55496eef0e30__Dur(int _cSub,  int _cmt, double _amt, double __t){</span></span>
<span><span class="co">#&gt;  return 0.0;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Model Times</span></span>
<span><span class="co">#&gt; void rx_7611bb7c6ec3e29b5c3f55496eef0e30__mtime(int _cSub, double *_mtime){</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Matrix Exponential (0)</span></span>
<span><span class="co">#&gt; void rx_7611bb7c6ec3e29b5c3f55496eef0e30__ME(int _cSub, double _t, double __t, double *_mat, const double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=9;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Inductive linearization Matf</span></span>
<span><span class="co">#&gt; void rx_7611bb7c6ec3e29b5c3f55496eef0e30__IndF(int _cSub, double _t, double __t, double *_matf){</span></span>
<span><span class="co">#&gt;  int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=10;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern SEXP rx_7611bb7c6ec3e29b5c3f55496eef0e30__model_vars(void){</span></span>
<span><span class="co">#&gt;   int pro=0;</span></span>
<span><span class="co">#&gt;   SEXP _mv = PROTECT(_rxGetModelLib("rx_7611bb7c6ec3e29b5c3f55496eef0e30__model_vars"));pro++;</span></span>
<span><span class="co">#&gt;   if (!_rxIsCurrentC(_mv)){</span></span>
<span><span class="co">#&gt;     SEXP hash    = PROTECT(Rf_allocVector(STRSXP, 1));pro++;</span></span>
<span><span class="co">#&gt; #define __doBuf__  snprintf(buf, __doBufN__, "un]\"BAAA@QRtHACAAAAAAABt*AAAv7#aT)M00URAT7y\?j\"\?*6tuJ&lt;yOJL5#;(JSC&lt;8j~B&lt;d\?YXJysz1J`cENbgWwf,1Q!wn\?)V*tHDh4X5\"~Cp!^XQ@n_#nV~q&amp;[y+y_KAuA\"B[t0P)n]05}`c#aZerM@Jq4m{VJWMb[Ac\?pprZx[6fLus!c/(t\?2~QWl#\?&lt;\"~YQ&lt;XPgo:O5XNIF6l.&lt;Oj|YUn0yZ`E10Qn|4gsH1dMl^uq$[h%%c%%g5%%u.25bw@${.6~h:%%YL.(ekDJ2w99TI3,Lv1&lt;TAzGQ]Iv%%lWH&gt;Oz{=k(4]dYmrkXTchDoGpb^QZem7S+;*Fb7t~[B*hZrF++OVNf&gt;utufq6C0NJtJl0SW=*Z#s+S#*Jo/:tXp7miXl]!z}f&amp;z}1S;GUY5,\"eiNxe:*`r~^^eXlg$@a=t#U^1g$!(^VO=OV&lt;r@!lrC9pp$grpLP=G3,mDf`&lt;_e`[PKWM^5@B@Ws;WeV31hKeV|1=GX,Y[*C8@Q#o}Z\?5@m5N56VBpscNX!Ba`eZEv\?Iu%%hYaO:C,+UC(Ms9bGnNOYH/RJY7MMm,$]^*|@\?Hc|!$Df5E%%~@VE=crv&amp;_M4o6gWb=*z_6C,^F$[;.&gt;2y=j*sO^R*!aqo.M@\"b&gt;_051=4_z6S,*|ZD3H*F5~R3~wcNf1kamhQ=5#8CI.aWR9wZldfD*aLhJToDd6&gt;Dp&lt;,_~hGfcmpD2&lt;a_J#6F^:]MMR~pwg^Q]Uo,jcGz`va${to5u}jRE\?!4GoSFja1`CFxy}HDc:q.`,kDgfRtvXwP2c@DGfV5ZLN\?_EDIQC,XT|;Bs#Rihi;E&amp;G2=f4A|:&gt;}RLx*.lwl(`i(;oSuZ67&gt;VuorgM.g1i~;#o!_z`[\?NXS&amp;kIs~aY}i34zvOEh\"wAI:$+ofE99Av~_MI56Y~Mq&amp;.^_(q|xPu+`^O86SN{|(rrY;nV$$iC23g#.3`#uX&lt;EF+z3EZ30fiD74&gt;cW&lt;KC3/@ABAD,gu.+DamO&gt;lNd_w}j6lnm0;u&lt;86oVs&amp;aP$D\?|7S0S_joEgj)a&gt;kgzt*uW7FVdS52MNcQ{IUEHnRa)yBPvHH*M$W*dl7FH:BnegBsM6s\"~8E;9aQ(5xIJVia=FzM*MY)m%%pO&lt;W0s)~i.\"r0Oql_LRK+(&amp;$(!=4f\?y,B&amp;R9vJ$]Ow8CFubPw6|8NO*W)Oi0*L|6@4pRq8vn,t[JU(q_~4g[*ho.dL}Wke@h`R5`0^XJq5tRn0RwY5Ci$ZbO:hk]ZXN00&amp;Q//G@;E%%KsrNiOz\"Fh%%#T*dH3fab7(K*9H{Br76^r@}Y}YFN&amp;;9I[U0|hd&gt;}V*a|3YBR{\?iM1s(Yi.Ak1x\"7}Y/MTT9UHh}+#CC//OO{uJVOVQSbVxa}r|aqquBE&gt;sq*KXKmqd74e!oQGYB(7c&lt;xfw%%~+^Hd\"#\"Uy}6@E&amp;NYA");</span></span>
<span><span class="co">#&gt;     char buf[1413];</span></span>
<span><span class="co">#&gt; #define __doBufN__ 1413</span></span>
<span><span class="co">#&gt;     __doBuf__</span></span>
<span><span class="co">#&gt; #undef __doBuf__</span></span>
<span><span class="co">#&gt; #undef __doBufN__</span></span>
<span><span class="co">#&gt;     SET_STRING_ELT(hash, 0, Rf_mkChar(buf));</span></span>
<span><span class="co">#&gt;     SEXP lst      = PROTECT(_rxQr(hash));pro++;</span></span>
<span><span class="co">#&gt;     _assign_ptr(lst);</span></span>
<span><span class="co">#&gt;     UNPROTECT(pro);</span></span>
<span><span class="co">#&gt;     return lst;</span></span>
<span><span class="co">#&gt;   } else {</span></span>
<span><span class="co">#&gt;     UNPROTECT(pro);</span></span>
<span><span class="co">#&gt;     return _mv;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void rx_7611bb7c6ec3e29b5c3f55496eef0e30__dydt_lsoda(int *neq, double *t, double *A, double *DADT)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   rx_7611bb7c6ec3e29b5c3f55496eef0e30__dydt(neq, *t, A, DADT);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern int rx_7611bb7c6ec3e29b5c3f55496eef0e30__dydt_liblsoda(double __t, double *y, double *ydot, void *data)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   int *neq = (int*)(data);</span></span>
<span><span class="co">#&gt;   rx_7611bb7c6ec3e29b5c3f55496eef0e30__dydt(neq, __t, y, ydot);</span></span>
<span><span class="co">#&gt;   return(0);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void rx_7611bb7c6ec3e29b5c3f55496eef0e30__calc_jac_lsoda(int *neq, double *t, double *A,int *ml, int *mu, double *JAC, int *nrowpd){</span></span>
<span><span class="co">#&gt;   // Update all covariate parameters</span></span>
<span><span class="co">#&gt;   rx_7611bb7c6ec3e29b5c3f55496eef0e30__calc_jac(neq, *t, A, JAC, *nrowpd);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; //Create function to call from R's main thread that assigns the required functions. Sometimes they don't get assigned.</span></span>
<span><span class="co">#&gt; extern void rx_7611bb7c6ec3e29b5c3f55496eef0e30__assignFuns(void){</span></span>
<span><span class="co">#&gt;   _assignFuns();</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; //Initialize the dll to match rxode2's calls</span></span>
<span><span class="co">#&gt; void R_init0_rx_7611bb7c6ec3e29b5c3f55496eef0e30_(void){</span></span>
<span><span class="co">#&gt;   // Get C callables on load; Otherwise it isn't thread safe</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_7611bb7c6ec3e29b5c3f55496eef0e30_","rx_7611bb7c6ec3e29b5c3f55496eef0e30__assignFuns2", (DL_FUNC) __assignFuns2);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_7611bb7c6ec3e29b5c3f55496eef0e30_","rx_7611bb7c6ec3e29b5c3f55496eef0e30__assignFuns", (DL_FUNC) rx_7611bb7c6ec3e29b5c3f55496eef0e30__assignFuns);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_7611bb7c6ec3e29b5c3f55496eef0e30_","rx_7611bb7c6ec3e29b5c3f55496eef0e30__inis",(DL_FUNC) rx_7611bb7c6ec3e29b5c3f55496eef0e30__inis);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_7611bb7c6ec3e29b5c3f55496eef0e30_","rx_7611bb7c6ec3e29b5c3f55496eef0e30__dydt",(DL_FUNC) rx_7611bb7c6ec3e29b5c3f55496eef0e30__dydt);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_7611bb7c6ec3e29b5c3f55496eef0e30_","rx_7611bb7c6ec3e29b5c3f55496eef0e30__calc_lhs",(DL_FUNC) rx_7611bb7c6ec3e29b5c3f55496eef0e30__calc_lhs);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_7611bb7c6ec3e29b5c3f55496eef0e30_","rx_7611bb7c6ec3e29b5c3f55496eef0e30__calc_jac",(DL_FUNC) rx_7611bb7c6ec3e29b5c3f55496eef0e30__calc_jac);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_7611bb7c6ec3e29b5c3f55496eef0e30_","rx_7611bb7c6ec3e29b5c3f55496eef0e30__dydt_lsoda", (DL_FUNC) rx_7611bb7c6ec3e29b5c3f55496eef0e30__dydt_lsoda);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_7611bb7c6ec3e29b5c3f55496eef0e30_","rx_7611bb7c6ec3e29b5c3f55496eef0e30__calc_jac_lsoda", (DL_FUNC) rx_7611bb7c6ec3e29b5c3f55496eef0e30__calc_jac_lsoda);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_7611bb7c6ec3e29b5c3f55496eef0e30_","rx_7611bb7c6ec3e29b5c3f55496eef0e30__ode_solver_solvedata", (DL_FUNC) rx_7611bb7c6ec3e29b5c3f55496eef0e30__ode_solver_solvedata);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_7611bb7c6ec3e29b5c3f55496eef0e30_","rx_7611bb7c6ec3e29b5c3f55496eef0e30__ode_solver_get_solvedata", (DL_FUNC) rx_7611bb7c6ec3e29b5c3f55496eef0e30__ode_solver_get_solvedata);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_7611bb7c6ec3e29b5c3f55496eef0e30_","rx_7611bb7c6ec3e29b5c3f55496eef0e30__F", (DL_FUNC) rx_7611bb7c6ec3e29b5c3f55496eef0e30__F);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_7611bb7c6ec3e29b5c3f55496eef0e30_","rx_7611bb7c6ec3e29b5c3f55496eef0e30__Lag", (DL_FUNC) rx_7611bb7c6ec3e29b5c3f55496eef0e30__Lag);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_7611bb7c6ec3e29b5c3f55496eef0e30_","rx_7611bb7c6ec3e29b5c3f55496eef0e30__Rate", (DL_FUNC) rx_7611bb7c6ec3e29b5c3f55496eef0e30__Rate);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_7611bb7c6ec3e29b5c3f55496eef0e30_","rx_7611bb7c6ec3e29b5c3f55496eef0e30__Dur", (DL_FUNC) rx_7611bb7c6ec3e29b5c3f55496eef0e30__Dur);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_7611bb7c6ec3e29b5c3f55496eef0e30_","rx_7611bb7c6ec3e29b5c3f55496eef0e30__mtime", (DL_FUNC) rx_7611bb7c6ec3e29b5c3f55496eef0e30__mtime);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_7611bb7c6ec3e29b5c3f55496eef0e30_","rx_7611bb7c6ec3e29b5c3f55496eef0e30__ME", (DL_FUNC) rx_7611bb7c6ec3e29b5c3f55496eef0e30__ME);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_7611bb7c6ec3e29b5c3f55496eef0e30_","rx_7611bb7c6ec3e29b5c3f55496eef0e30__IndF", (DL_FUNC) rx_7611bb7c6ec3e29b5c3f55496eef0e30__IndF);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_7611bb7c6ec3e29b5c3f55496eef0e30_","rx_7611bb7c6ec3e29b5c3f55496eef0e30__dydt_liblsoda", (DL_FUNC) rx_7611bb7c6ec3e29b5c3f55496eef0e30__dydt_liblsoda);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; //Initialize the dll to match rxode2's calls</span></span>
<span><span class="co">#&gt; void R_init_rx_7611bb7c6ec3e29b5c3f55496eef0e30_(DllInfo *info){</span></span>
<span><span class="co">#&gt;   // Get C callables on load; Otherwise it isn't thread safe</span></span>
<span><span class="co">#&gt;   R_init0_rx_7611bb7c6ec3e29b5c3f55496eef0e30_();</span></span>
<span><span class="co">#&gt;   static const R_CallMethodDef callMethods[]  = {</span></span>
<span><span class="co">#&gt;     {"rx_7611bb7c6ec3e29b5c3f55496eef0e30__model_vars", (DL_FUNC) &amp;rx_7611bb7c6ec3e29b5c3f55496eef0e30__model_vars, 0},</span></span>
<span><span class="co">#&gt;     {NULL, NULL, 0}</span></span>
<span><span class="co">#&gt;   };</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   R_registerRoutines(info, NULL, callMethods, NULL, NULL);</span></span>
<span><span class="co">#&gt;   R_useDynamicSymbols(info,FALSE);</span></span>
<span><span class="co">#&gt;   _assignFuns0();</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; void R_unload_rx_7611bb7c6ec3e29b5c3f55496eef0e30_ (DllInfo *info){</span></span>
<span><span class="co">#&gt;   // Free resources required for single subject solve.</span></span>
<span><span class="co">#&gt;   SEXP _mv = PROTECT(_rxGetModelLib("rx_7611bb7c6ec3e29b5c3f55496eef0e30__model_vars"));</span></span>
<span><span class="co">#&gt;   if (!Rf_isNull(_mv)){</span></span>
<span><span class="co">#&gt;     _rxRmModelLib("rx_7611bb7c6ec3e29b5c3f55496eef0e30__model_vars");</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   UNPROTECT(1);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">rxode2 </span>4.0.2 model named <span style="color: #BBBB00; font-weight: bold;">rx_7611bb7c6ec3e29b5c3f55496eef0e30</span> model (<span style="color: #00BB00;">✔</span> <span style="color: #00BB00; font-weight: bold;">ready</span>). </span></span>
<span><span class="co">#&gt; DLL: /tmp/RtmpgzfWbr/rxode2/rx_7611bb7c6ec3e29b5c3f55496eef0e30__.rxd/rx_7611bb7c6ec3e29b5c3f55496eef0e30_.so</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Calculated Variables:</span></span>
<span><span class="co">#&gt; [1] "C2" "C3"</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── rxode2 Model Syntax ──</span></span></span>
<span><span class="co">#&gt; rxode2({</span></span>
<span><span class="co">#&gt;     param(KA, CL, V2, Q, V3, Kin, Kout, EC50)</span></span>
<span><span class="co">#&gt;     KA = 0.3</span></span>
<span><span class="co">#&gt;     CL = 7</span></span>
<span><span class="co">#&gt;     V2 = 40</span></span>
<span><span class="co">#&gt;     Q = 10</span></span>
<span><span class="co">#&gt;     V3 = 300</span></span>
<span><span class="co">#&gt;     Kin = 0.2</span></span>
<span><span class="co">#&gt;     Kout = 0.2</span></span>
<span><span class="co">#&gt;     EC50 = 8</span></span>
<span><span class="co">#&gt;     C2 = centr/V2</span></span>
<span><span class="co">#&gt;     C3 = peri/V3</span></span>
<span><span class="co">#&gt;     d/dt(depot) = -KA * depot</span></span>
<span><span class="co">#&gt;     d/dt(centr) = KA * depot - CL * C2 - Q * C2 + Q * C3</span></span>
<span><span class="co">#&gt;     d/dt(peri) = Q * C2 - Q * C3</span></span>
<span><span class="co">#&gt;     d/dt(eff) = Kin - Kout * (1 - C2/(EC50 + C2)) * eff</span></span>
<span><span class="co">#&gt;     eff(0) = 1</span></span>
<span><span class="co">#&gt; })</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod2f</span><span class="op">$</span><span class="va">simulationModel</span><span class="op">)</span></span>
<span><span class="co">#&gt; C model:</span></span>
<span><span class="co">#&gt; // Define translation state order for 5 states</span></span>
<span><span class="co">#&gt; #define __DDT0__ 0 // depot</span></span>
<span><span class="co">#&gt; #define _DEPOT_ 0 // depot</span></span>
<span><span class="co">#&gt; #define __DDT1__ 1 // centr</span></span>
<span><span class="co">#&gt; #define __DDT2__ 2 // peri</span></span>
<span><span class="co">#&gt; #define __DDT3__ 3 // eff</span></span>
<span><span class="co">#&gt; #define __DDT4__ 4 // NA</span></span>
<span><span class="co">#&gt; // Define 12 LHS values</span></span>
<span><span class="co">#&gt; #define _LHS_0_ 0 // KA</span></span>
<span><span class="co">#&gt; #define _LHS_1_ 1 // CL</span></span>
<span><span class="co">#&gt; #define _LHS_2_ 2 // V2</span></span>
<span><span class="co">#&gt; #define _LHS_3_ 3 // Q</span></span>
<span><span class="co">#&gt; #define _LHS_4_ 4 // V3</span></span>
<span><span class="co">#&gt; #define _LHS_5_ 5 // Kin</span></span>
<span><span class="co">#&gt; #define _LHS_6_ 6 // Kout</span></span>
<span><span class="co">#&gt; #define _LHS_7_ 7 // EC50</span></span>
<span><span class="co">#&gt; #define _LHS_8_ 8 // C2</span></span>
<span><span class="co">#&gt; #define _LHS_9_ 9 // C3</span></span>
<span><span class="co">#&gt; #define _LHS_10_ 10 // ipredSim</span></span>
<span><span class="co">#&gt; #define _LHS_11_ 11 // sim</span></span>
<span><span class="co">#&gt; #define _getRxSolve_ _rxa29af0735fbab1e0509ebc06b6ff3c48143__getRxSolve__5pb9</span></span>
<span><span class="co">#&gt; #define _evalUdf _rxa29af0735fbab1e0509ebc06b6ff3c48144__evalUdf_0SUH</span></span>
<span><span class="co">#&gt; #define _solveData _rxa29af0735fbab1e0509ebc06b6ff3c48145__solveData_jlsA</span></span>
<span><span class="co">#&gt; #define _assign_ptr _rxa29af0735fbab1e0509ebc06b6ff3c48146__assign_ptr_2JOC</span></span>
<span><span class="co">#&gt; #define _rxRmModelLib _rxa29af0735fbab1e0509ebc06b6ff3c48147__rxRmModelLib_P3Oy</span></span>
<span><span class="co">#&gt; #define _rxGetModelLib _rxa29af0735fbab1e0509ebc06b6ff3c48148__rxGetModelLib_HgjC</span></span>
<span><span class="co">#&gt; #define _old_c _rxa29af0735fbab1e0509ebc06b6ff3c48149__old_c_yj3W</span></span>
<span><span class="co">#&gt; #define _ptrid _rxa29af0735fbab1e0509ebc06b6ff3c48150__ptrid_hg1D</span></span>
<span><span class="co">#&gt; #define _rxIsCurrentC _rxa29af0735fbab1e0509ebc06b6ff3c48151__rxIsCurrentC_IdTQ</span></span>
<span><span class="co">#&gt; #define _sumPS _rxa29af0735fbab1e0509ebc06b6ff3c48152__sumPS_hwBD</span></span>
<span><span class="co">#&gt; #define _prodPS _rxa29af0735fbab1e0509ebc06b6ff3c48153__prodPS_gUde</span></span>
<span><span class="co">#&gt; #define _prodType _rxa29af0735fbab1e0509ebc06b6ff3c48154__prodType_5llz</span></span>
<span><span class="co">#&gt; #define _sumType _rxa29af0735fbab1e0509ebc06b6ff3c48155__sumType_yOSJ</span></span>
<span><span class="co">#&gt; #define _update_par_ptr _rxa29af0735fbab1e0509ebc06b6ff3c48156__update_par_ptr_AWUm</span></span>
<span><span class="co">#&gt; #define _getParCov _rxa29af0735fbab1e0509ebc06b6ff3c48157__getParCov_Ci4L</span></span>
<span><span class="co">#&gt; #define _rxode2_rxAssignPtr _rxa29af0735fbab1e0509ebc06b6ff3c48158__rxode2_rxAssignPtr_pGZK</span></span>
<span><span class="co">#&gt; #define _rxQr _rxa29af0735fbab1e0509ebc06b6ff3c48159__rxQr_aBwX</span></span>
<span><span class="co">#&gt; #define _compareFactorVal _rxa29af0735fbab1e0509ebc06b6ff3c48160__compareFactorVal_XHRN</span></span>
<span><span class="co">#&gt; #define _sum _rxa29af0735fbab1e0509ebc06b6ff3c48161__sum_1SO1</span></span>
<span><span class="co">#&gt; #define _udf _rxa29af0735fbab1e0509ebc06b6ff3c48162__udf_NYrN</span></span>
<span><span class="co">#&gt; #define _sign _rxa29af0735fbab1e0509ebc06b6ff3c48163__sign_WbGH</span></span>
<span><span class="co">#&gt; #define _prod _rxa29af0735fbab1e0509ebc06b6ff3c48164__prod_TvOD</span></span>
<span><span class="co">#&gt; #define _max _rxa29af0735fbab1e0509ebc06b6ff3c48165__max_f3z9</span></span>
<span><span class="co">#&gt; #define _min _rxa29af0735fbab1e0509ebc06b6ff3c48166__min_WqiE</span></span>
<span><span class="co">#&gt; #define _transit4P _rxa29af0735fbab1e0509ebc06b6ff3c48167__transit4P_Xp1T</span></span>
<span><span class="co">#&gt; #define _transit3P _rxa29af0735fbab1e0509ebc06b6ff3c48168__transit3P_noPD</span></span>
<span><span class="co">#&gt; #define _assignFuns0 _rxa29af0735fbab1e0509ebc06b6ff3c48169__assignFuns0_PfVe</span></span>
<span><span class="co">#&gt; #define _assignFuns _rxa29af0735fbab1e0509ebc06b6ff3c48170__assignFuns_Vphs</span></span>
<span><span class="co">#&gt; #define _rxord _rxa29af0735fbab1e0509ebc06b6ff3c48171__rxord_0tzV</span></span>
<span><span class="co">#&gt; #define __assignFuns2 _rxa29af0735fbab1e0509ebc06b6ff3c48172___assignFuns2_Mmad</span></span>
<span><span class="co">#&gt; #define _llikCauchyDscale _rxa29af0735fbab1e0509ebc06b6ff3c48173__llikCauchyDscale_rZFu</span></span>
<span><span class="co">#&gt; #define _llikCauchyDlocation _rxa29af0735fbab1e0509ebc06b6ff3c48174__llikCauchyDlocation_rFOl</span></span>
<span><span class="co">#&gt; #define _llikCauchy _rxa29af0735fbab1e0509ebc06b6ff3c48175__llikCauchy_7CAf</span></span>
<span><span class="co">#&gt; #define _llikGammaDrate _rxa29af0735fbab1e0509ebc06b6ff3c48176__llikGammaDrate_rvYZ</span></span>
<span><span class="co">#&gt; #define _llikGammaDshape _rxa29af0735fbab1e0509ebc06b6ff3c48177__llikGammaDshape_gF2u</span></span>
<span><span class="co">#&gt; #define _llikGamma _rxa29af0735fbab1e0509ebc06b6ff3c48178__llikGamma_4zbA</span></span>
<span><span class="co">#&gt; #define _llikWeibullDscale _rxa29af0735fbab1e0509ebc06b6ff3c48179__llikWeibullDscale_u2aE</span></span>
<span><span class="co">#&gt; #define _llikWeibullDshape _rxa29af0735fbab1e0509ebc06b6ff3c48180__llikWeibullDshape_uohD</span></span>
<span><span class="co">#&gt; #define _llikWeibull _rxa29af0735fbab1e0509ebc06b6ff3c48181__llikWeibull_jDSK</span></span>
<span><span class="co">#&gt; #define _llikUnifDbeta _rxa29af0735fbab1e0509ebc06b6ff3c48182__llikUnifDbeta_ZFSu</span></span>
<span><span class="co">#&gt; #define _llikUnifDalpha _rxa29af0735fbab1e0509ebc06b6ff3c48183__llikUnifDalpha_yota</span></span>
<span><span class="co">#&gt; #define _llikUnif _rxa29af0735fbab1e0509ebc06b6ff3c48184__llikUnif_lziD</span></span>
<span><span class="co">#&gt; #define _llikGeomDp _rxa29af0735fbab1e0509ebc06b6ff3c48185__llikGeomDp_IirE</span></span>
<span><span class="co">#&gt; #define _llikGeom _rxa29af0735fbab1e0509ebc06b6ff3c48186__llikGeom_0wRk</span></span>
<span><span class="co">#&gt; #define _llikFDdf2 _rxa29af0735fbab1e0509ebc06b6ff3c48187__llikFDdf2_fPLj</span></span>
<span><span class="co">#&gt; #define _llikFDdf1 _rxa29af0735fbab1e0509ebc06b6ff3c48188__llikFDdf1_f5r4</span></span>
<span><span class="co">#&gt; #define _llikF _rxa29af0735fbab1e0509ebc06b6ff3c48189__llikF_q6UF</span></span>
<span><span class="co">#&gt; #define _llikExpDrate _rxa29af0735fbab1e0509ebc06b6ff3c48190__llikExpDrate_gAxJ</span></span>
<span><span class="co">#&gt; #define _llikExp _rxa29af0735fbab1e0509ebc06b6ff3c48191__llikExp_Mtp6</span></span>
<span><span class="co">#&gt; #define _llikChisqDdf _rxa29af0735fbab1e0509ebc06b6ff3c48192__llikChisqDdf_ulNz</span></span>
<span><span class="co">#&gt; #define _llikChisq _rxa29af0735fbab1e0509ebc06b6ff3c48193__llikChisq_LwD1</span></span>
<span><span class="co">#&gt; #define _llikTDsd _rxa29af0735fbab1e0509ebc06b6ff3c48194__llikTDsd_9qDD</span></span>
<span><span class="co">#&gt; #define _llikTDmean _rxa29af0735fbab1e0509ebc06b6ff3c48195__llikTDmean_2wFm</span></span>
<span><span class="co">#&gt; #define _llikTDdf _rxa29af0735fbab1e0509ebc06b6ff3c48196__llikTDdf_HsIy</span></span>
<span><span class="co">#&gt; #define _llikT _rxa29af0735fbab1e0509ebc06b6ff3c48197__llikT_alpl</span></span>
<span><span class="co">#&gt; #define _llikBetaDshape2 _rxa29af0735fbab1e0509ebc06b6ff3c48198__llikBetaDshape2_P85e</span></span>
<span><span class="co">#&gt; #define _llikBetaDshape1 _rxa29af0735fbab1e0509ebc06b6ff3c48199__llikBetaDshape1_beKy</span></span>
<span><span class="co">#&gt; #define _llikBeta _rxa29af0735fbab1e0509ebc06b6ff3c48200__llikBeta_isyD</span></span>
<span><span class="co">#&gt; #define _llikNbinomMuDmu _rxa29af0735fbab1e0509ebc06b6ff3c48201__llikNbinomMuDmu_fO2c</span></span>
<span><span class="co">#&gt; #define _llikNbinomMu _rxa29af0735fbab1e0509ebc06b6ff3c48202__llikNbinomMu_bPrW</span></span>
<span><span class="co">#&gt; #define _llikNbinomDprob _rxa29af0735fbab1e0509ebc06b6ff3c48203__llikNbinomDprob_y1fN</span></span>
<span><span class="co">#&gt; #define _llikNbinom _rxa29af0735fbab1e0509ebc06b6ff3c48204__llikNbinom_ugfk</span></span>
<span><span class="co">#&gt; #define _llikBinomDprob _rxa29af0735fbab1e0509ebc06b6ff3c48205__llikBinomDprob_XEVP</span></span>
<span><span class="co">#&gt; #define _llikBinom _rxa29af0735fbab1e0509ebc06b6ff3c48206__llikBinom_jdOx</span></span>
<span><span class="co">#&gt; #define _llikPoisDlambda _rxa29af0735fbab1e0509ebc06b6ff3c48207__llikPoisDlambda_I3ZD</span></span>
<span><span class="co">#&gt; #define _llikPois _rxa29af0735fbab1e0509ebc06b6ff3c48208__llikPois_7wnk</span></span>
<span><span class="co">#&gt; #define _llikNormDsd _rxa29af0735fbab1e0509ebc06b6ff3c48209__llikNormDsd_XX5O</span></span>
<span><span class="co">#&gt; #define _llikNormDmean _rxa29af0735fbab1e0509ebc06b6ff3c48210__llikNormDmean_Agfw</span></span>
<span><span class="co">#&gt; #define _llikNorm _rxa29af0735fbab1e0509ebc06b6ff3c48211__llikNorm_CyNe</span></span>
<span><span class="co">#&gt; #define simeps _rxa29af0735fbab1e0509ebc06b6ff3c48212_simeps_o4Wl</span></span>
<span><span class="co">#&gt; #define simeta _rxa29af0735fbab1e0509ebc06b6ff3c48213_simeta_QYC1</span></span>
<span><span class="co">#&gt; #define expit _rxa29af0735fbab1e0509ebc06b6ff3c48214_expit_yBms</span></span>
<span><span class="co">#&gt; #define logit _rxa29af0735fbab1e0509ebc06b6ff3c48215_logit_pbu2</span></span>
<span><span class="co">#&gt; #define gammapDer _rxa29af0735fbab1e0509ebc06b6ff3c48216_gammapDer_85hP</span></span>
<span><span class="co">#&gt; #define lowergamma _rxa29af0735fbab1e0509ebc06b6ff3c48217_lowergamma_47wD</span></span>
<span><span class="co">#&gt; #define uppergamma _rxa29af0735fbab1e0509ebc06b6ff3c48218_uppergamma_fCYp</span></span>
<span><span class="co">#&gt; #define gammaqInva _rxa29af0735fbab1e0509ebc06b6ff3c48219_gammaqInva_7GH0</span></span>
<span><span class="co">#&gt; #define gammaqInv _rxa29af0735fbab1e0509ebc06b6ff3c48220_gammaqInv_qPki</span></span>
<span><span class="co">#&gt; #define gammapInva _rxa29af0735fbab1e0509ebc06b6ff3c48221_gammapInva_VyMA</span></span>
<span><span class="co">#&gt; #define gammapInv _rxa29af0735fbab1e0509ebc06b6ff3c48222_gammapInv_m1mA</span></span>
<span><span class="co">#&gt; #define gammaq _rxa29af0735fbab1e0509ebc06b6ff3c48223_gammaq_1mpx</span></span>
<span><span class="co">#&gt; #define gammap _rxa29af0735fbab1e0509ebc06b6ff3c48224_gammap_NAbn</span></span>
<span><span class="co">#&gt; #define phi _rxa29af0735fbab1e0509ebc06b6ff3c48225_phi_2jD0</span></span>
<span><span class="co">#&gt; #define d2ELUa _rxa29af0735fbab1e0509ebc06b6ff3c48226_d2ELUa_7gdK</span></span>
<span><span class="co">#&gt; #define dELUa _rxa29af0735fbab1e0509ebc06b6ff3c48227_dELUa_Ohhv</span></span>
<span><span class="co">#&gt; #define d2aELU _rxa29af0735fbab1e0509ebc06b6ff3c48228_d2aELU_SaAZ</span></span>
<span><span class="co">#&gt; #define d2ELU _rxa29af0735fbab1e0509ebc06b6ff3c48229_d2ELU_tapa</span></span>
<span><span class="co">#&gt; #define dELU _rxa29af0735fbab1e0509ebc06b6ff3c48230_dELU_mOqj</span></span>
<span><span class="co">#&gt; #define ELU _rxa29af0735fbab1e0509ebc06b6ff3c48231_ELU_J66n</span></span>
<span><span class="co">#&gt; #define dPReLUa1 _rxa29af0735fbab1e0509ebc06b6ff3c48232_dPReLUa1_N3zb</span></span>
<span><span class="co">#&gt; #define dPReLUa _rxa29af0735fbab1e0509ebc06b6ff3c48233_dPReLUa_9X7x</span></span>
<span><span class="co">#&gt; #define dPReLU _rxa29af0735fbab1e0509ebc06b6ff3c48234_dPReLU_2Awy</span></span>
<span><span class="co">#&gt; #define PReLU _rxa29af0735fbab1e0509ebc06b6ff3c48235_PReLU_isy2</span></span>
<span><span class="co">#&gt; #define dSwish _rxa29af0735fbab1e0509ebc06b6ff3c48236_dSwish_RdzJ</span></span>
<span><span class="co">#&gt; #define Swish _rxa29af0735fbab1e0509ebc06b6ff3c48237_Swish_rXsV</span></span>
<span><span class="co">#&gt; #define dlReLU _rxa29af0735fbab1e0509ebc06b6ff3c48238_dlReLU_rrL0</span></span>
<span><span class="co">#&gt; #define lReLU _rxa29af0735fbab1e0509ebc06b6ff3c48239_lReLU_CwHs</span></span>
<span><span class="co">#&gt; #define dSELU _rxa29af0735fbab1e0509ebc06b6ff3c48240_dSELU_x0YD</span></span>
<span><span class="co">#&gt; #define SELU _rxa29af0735fbab1e0509ebc06b6ff3c48241_SELU_ejsN</span></span>
<span><span class="co">#&gt; #define d4softplus _rxa29af0735fbab1e0509ebc06b6ff3c48242_d4softplus_tqj2</span></span>
<span><span class="co">#&gt; #define d3softplus _rxa29af0735fbab1e0509ebc06b6ff3c48243_d3softplus_KkuC</span></span>
<span><span class="co">#&gt; #define d2softplus _rxa29af0735fbab1e0509ebc06b6ff3c48244_d2softplus_TNOD</span></span>
<span><span class="co">#&gt; #define dsoftplus _rxa29af0735fbab1e0509ebc06b6ff3c48245_dsoftplus_0MWq</span></span>
<span><span class="co">#&gt; #define softplus _rxa29af0735fbab1e0509ebc06b6ff3c48246_softplus_8NGU</span></span>
<span><span class="co">#&gt; #define d4GELU _rxa29af0735fbab1e0509ebc06b6ff3c48247_d4GELU_15zw</span></span>
<span><span class="co">#&gt; #define d3GELU _rxa29af0735fbab1e0509ebc06b6ff3c48248_d3GELU_77MT</span></span>
<span><span class="co">#&gt; #define d2GELU _rxa29af0735fbab1e0509ebc06b6ff3c48249_d2GELU_mU6w</span></span>
<span><span class="co">#&gt; #define dGELU _rxa29af0735fbab1e0509ebc06b6ff3c48250_dGELU_hVWG</span></span>
<span><span class="co">#&gt; #define GELU _rxa29af0735fbab1e0509ebc06b6ff3c48251_GELU_iyen</span></span>
<span><span class="co">#&gt; #define dReLU _rxa29af0735fbab1e0509ebc06b6ff3c48252_dReLU_4spi</span></span>
<span><span class="co">#&gt; #define ReLU _rxa29af0735fbab1e0509ebc06b6ff3c48253_ReLU_MWT6</span></span>
<span><span class="co">#&gt; #define riweibull _rxa29af0735fbab1e0509ebc06b6ff3c48254_riweibull_VRYe</span></span>
<span><span class="co">#&gt; #define riunif _rxa29af0735fbab1e0509ebc06b6ff3c48255_riunif_9Ita</span></span>
<span><span class="co">#&gt; #define rit_ _rxa29af0735fbab1e0509ebc06b6ff3c48256_rit__dGJL</span></span>
<span><span class="co">#&gt; #define ripois _rxa29af0735fbab1e0509ebc06b6ff3c48257_ripois_l03G</span></span>
<span><span class="co">#&gt; #define ribeta _rxa29af0735fbab1e0509ebc06b6ff3c48258_ribeta_aI5l</span></span>
<span><span class="co">#&gt; #define rigamma _rxa29af0735fbab1e0509ebc06b6ff3c48259_rigamma_lO3k</span></span>
<span><span class="co">#&gt; #define rigeom _rxa29af0735fbab1e0509ebc06b6ff3c48260_rigeom_WHGX</span></span>
<span><span class="co">#&gt; #define rif _rxa29af0735fbab1e0509ebc06b6ff3c48261_rif_CdkG</span></span>
<span><span class="co">#&gt; #define riexp _rxa29af0735fbab1e0509ebc06b6ff3c48262_riexp_sq2N</span></span>
<span><span class="co">#&gt; #define richisq _rxa29af0735fbab1e0509ebc06b6ff3c48263_richisq_BvuB</span></span>
<span><span class="co">#&gt; #define ricauchy _rxa29af0735fbab1e0509ebc06b6ff3c48264_ricauchy_r0sO</span></span>
<span><span class="co">#&gt; #define rinbinomMu _rxa29af0735fbab1e0509ebc06b6ff3c48265_rinbinomMu_4eup</span></span>
<span><span class="co">#&gt; #define rinbinom _rxa29af0735fbab1e0509ebc06b6ff3c48266_rinbinom_VbTs</span></span>
<span><span class="co">#&gt; #define ribinom _rxa29af0735fbab1e0509ebc06b6ff3c48267_ribinom_fOYF</span></span>
<span><span class="co">#&gt; #define rinorm _rxa29af0735fbab1e0509ebc06b6ff3c48268_rinorm_C4Jz</span></span>
<span><span class="co">#&gt; #define rxweibull _rxa29af0735fbab1e0509ebc06b6ff3c48269_rxweibull_7iE8</span></span>
<span><span class="co">#&gt; #define rxunif _rxa29af0735fbab1e0509ebc06b6ff3c48270_rxunif_vtCF</span></span>
<span><span class="co">#&gt; #define rxt_ _rxa29af0735fbab1e0509ebc06b6ff3c48271_rxt__cRJ6</span></span>
<span><span class="co">#&gt; #define rxpois _rxa29af0735fbab1e0509ebc06b6ff3c48272_rxpois_Gev1</span></span>
<span><span class="co">#&gt; #define rxbeta _rxa29af0735fbab1e0509ebc06b6ff3c48273_rxbeta_Yq4C</span></span>
<span><span class="co">#&gt; #define rxgamma _rxa29af0735fbab1e0509ebc06b6ff3c48274_rxgamma_UGPR</span></span>
<span><span class="co">#&gt; #define rxgeom _rxa29af0735fbab1e0509ebc06b6ff3c48275_rxgeom_B41j</span></span>
<span><span class="co">#&gt; #define rxf _rxa29af0735fbab1e0509ebc06b6ff3c48276_rxf_yXA3</span></span>
<span><span class="co">#&gt; #define rxexp _rxa29af0735fbab1e0509ebc06b6ff3c48277_rxexp_Scak</span></span>
<span><span class="co">#&gt; #define rxchisq _rxa29af0735fbab1e0509ebc06b6ff3c48278_rxchisq_WU0x</span></span>
<span><span class="co">#&gt; #define rxcauchy _rxa29af0735fbab1e0509ebc06b6ff3c48279_rxcauchy_SyXM</span></span>
<span><span class="co">#&gt; #define rxnbinomMu _rxa29af0735fbab1e0509ebc06b6ff3c48280_rxnbinomMu_V4ye</span></span>
<span><span class="co">#&gt; #define rxnbinom _rxa29af0735fbab1e0509ebc06b6ff3c48281_rxnbinom_zXlY</span></span>
<span><span class="co">#&gt; #define rxbinom _rxa29af0735fbab1e0509ebc06b6ff3c48282_rxbinom_mdNM</span></span>
<span><span class="co">#&gt; #define rxnorm _rxa29af0735fbab1e0509ebc06b6ff3c48283_rxnorm_qSBx</span></span>
<span><span class="co">#&gt; #define linCmtB _rxa29af0735fbab1e0509ebc06b6ff3c48284_linCmtB_i1cp</span></span>
<span><span class="co">#&gt; #define linCmtA _rxa29af0735fbab1e0509ebc06b6ff3c48285_linCmtA_dhrH</span></span>
<span><span class="co">#&gt; #include &lt;rxode2_model_shared.h&gt;</span></span>
<span><span class="co">#&gt; #define __MAX_PROD__ 0</span></span>
<span><span class="co">#&gt; #define _CMT CMT</span></span>
<span><span class="co">#&gt; #define _SYNC_simeps_ for (int _svari=_solveData-&gt;neps; _svari--;){  if (_solveData-&gt;svar[_svari] == 0) {TKA = _PP[0];};   if (_solveData-&gt;svar[_svari] == 1) {TCL = _PP[1];};   if (_solveData-&gt;svar[_svari] == 2) {TV2 = _PP[2];};   if (_solveData-&gt;svar[_svari] == 3) {TQ = _PP[3];};   if (_solveData-&gt;svar[_svari] == 4) {TV3 = _PP[4];};   if (_solveData-&gt;svar[_svari] == 5) {TKin = _PP[5];};   if (_solveData-&gt;svar[_svari] == 6) {TKout = _PP[6];};   if (_solveData-&gt;svar[_svari] == 7) {TEC50 = _PP[7];};   if (_solveData-&gt;svar[_svari] == 8) {c2_DoT_prop_DoT_sd = _PP[8];};   if (_solveData-&gt;svar[_svari] == 9) {eff_DoT_add_DoT_sd = _PP[9];};   if (_solveData-&gt;svar[_svari] == 10) {eta_DoT_cl = _PP[10];};   if (_solveData-&gt;svar[_svari] == 11) {eta_DoT_v = _PP[11];};   if (_solveData-&gt;svar[_svari] == 12) {CMT = _PP[12];};   if (_solveData-&gt;svar[_svari] == 13) {rxerr_DoT_C2 = _PP[13];};   if (_solveData-&gt;svar[_svari] == 14) {rxerr_DoT_eff = _PP[14];}; }</span></span>
<span><span class="co">#&gt; #define _SYNC_simeta_ for (int _ovari=_solveData-&gt;neta; _ovari--;){  if (_solveData-&gt;ovar[_ovari] == 0) {TKA = _PP[0];};   if (_solveData-&gt;ovar[_ovari] == 1) {TCL = _PP[1];};   if (_solveData-&gt;ovar[_ovari] == 2) {TV2 = _PP[2];};   if (_solveData-&gt;ovar[_ovari] == 3) {TQ = _PP[3];};   if (_solveData-&gt;ovar[_ovari] == 4) {TV3 = _PP[4];};   if (_solveData-&gt;ovar[_ovari] == 5) {TKin = _PP[5];};   if (_solveData-&gt;ovar[_ovari] == 6) {TKout = _PP[6];};   if (_solveData-&gt;ovar[_ovari] == 7) {TEC50 = _PP[7];};   if (_solveData-&gt;ovar[_ovari] == 8) {c2_DoT_prop_DoT_sd = _PP[8];};   if (_solveData-&gt;ovar[_ovari] == 9) {eff_DoT_add_DoT_sd = _PP[9];};   if (_solveData-&gt;ovar[_ovari] == 10) {eta_DoT_cl = _PP[10];};   if (_solveData-&gt;ovar[_ovari] == 11) {eta_DoT_v = _PP[11];};   if (_solveData-&gt;ovar[_ovari] == 12) {CMT = _PP[12];};   if (_solveData-&gt;ovar[_ovari] == 13) {rxerr_DoT_C2 = _PP[13];};   if (_solveData-&gt;ovar[_ovari] == 14) {rxerr_DoT_eff = _PP[14];}; }</span></span>
<span><span class="co">#&gt; _getRxSolve_t _getRxSolve_;</span></span>
<span><span class="co">#&gt; _simfun simeps;</span></span>
<span><span class="co">#&gt; _simfun simeta;</span></span>
<span><span class="co">#&gt; _udf_type _evalUdf=NULL;</span></span>
<span><span class="co">#&gt; rx_solve *_solveData=NULL;</span></span>
<span><span class="co">#&gt; rxode2_assign_ptr _assign_ptr=NULL;</span></span>
<span><span class="co">#&gt; _rxRmModelLibType _rxRmModelLib=NULL;</span></span>
<span><span class="co">#&gt; _rxGetModelLibType _rxGetModelLib=NULL;</span></span>
<span><span class="co">#&gt; rxode2_ode_solver_old_c _old_c=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _ptrid=NULL;</span></span>
<span><span class="co">#&gt; _rxIsCurrentC_type _rxIsCurrentC=NULL;</span></span>
<span><span class="co">#&gt; _rxSumType _sumPS=NULL;</span></span>
<span><span class="co">#&gt; _rxProdType _prodPS=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _prodType=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _sumType=NULL;</span></span>
<span><span class="co">#&gt; _update_par_ptr_p _update_par_ptr=NULL;</span></span>
<span><span class="co">#&gt; _getParCov_p _getParCov=NULL;</span></span>
<span><span class="co">#&gt; linCmtA_p linCmtA;</span></span>
<span><span class="co">#&gt; linCmtB_p linCmtB;</span></span>
<span><span class="co">#&gt; _rx_asgn _rxode2_rxAssignPtr=NULL;</span></span>
<span><span class="co">#&gt; _rx_asgn _rxQr=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn phi;</span></span>
<span><span class="co">#&gt; rxode2_fn ReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn dReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn dGELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d2GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d3GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d4GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn dsoftplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d2softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d3softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d4softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn SELU;</span></span>
<span><span class="co">#&gt; rxode2_fn dSELU;</span></span>
<span><span class="co">#&gt; rxode2_fn lReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn dlReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn Swish;</span></span>
<span><span class="co">#&gt; rxode2_fn dSwish;</span></span>
<span><span class="co">#&gt; rxode2_fn2 PReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLUa;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLUa1;</span></span>
<span><span class="co">#&gt; rxode2_fn2 ELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2ELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2aELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dELUa;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2ELUa;</span></span>
<span><span class="co">#&gt; rxode2_fn3 logit;</span></span>
<span><span class="co">#&gt; rxode2_fn3 expit;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammap;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaq;</span></span>
<span><span class="co">#&gt; rxode2_fn2 lowergamma;</span></span>
<span><span class="co">#&gt; rxode2_fn2 uppergamma;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapInv;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapDer;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapInva;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaqInv;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaqInva;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxnorm;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxbinom;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxnbinom;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxnbinomMu;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxcauchy;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxchisq;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxexp;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxf;</span></span>
<span><span class="co">#&gt; rxode2i_ifn rxgeom;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxgamma;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxbeta;</span></span>
<span><span class="co">#&gt; rxode2i_ifn rxpois;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxt_;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxunif;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxweibull;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rinorm;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom ribinom;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom rinbinom;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom rinbinomMu;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 ricauchy;</span></span>
<span><span class="co">#&gt; rxode2i2_fn richisq;</span></span>
<span><span class="co">#&gt; rxode2i2_fn riexp;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rif;</span></span>
<span><span class="co">#&gt; rxode2i2_ifn rigeom;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rigamma;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 ribeta;</span></span>
<span><span class="co">#&gt; rxode2i2_ifn ripois;</span></span>
<span><span class="co">#&gt; rxode2i2_fn rit_;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 riunif;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 riweibull;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNorm;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNormDmean;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNormDsd;</span></span>
<span><span class="co">#&gt; rxode2_llikPoisFun _llikPois;</span></span>
<span><span class="co">#&gt; rxode2_llikPoisFun _llikPoisDlambda;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikBinom;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikBinomDprob;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinom;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomDprob;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomMu;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomMuDmu;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBeta;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBetaDshape1;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBetaDshape2;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikT;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDdf;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDmean;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDsd;</span></span>
<span><span class="co">#&gt; rxode2_llikChisqFun _llikChisq;</span></span>
<span><span class="co">#&gt; rxode2_llikChisqFun _llikChisqDdf;</span></span>
<span><span class="co">#&gt; rxode2_llikExpFun _llikExp;</span></span>
<span><span class="co">#&gt; rxode2_llikExpFun _llikExpDrate;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikF;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikFDdf1;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikFDdf2;</span></span>
<span><span class="co">#&gt; rxode2_llikGeomFun _llikGeom;</span></span>
<span><span class="co">#&gt; rxode2_llikGeomFun _llikGeomDp;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnif;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnifDalpha;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnifDbeta;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibull;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibullDshape;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibullDscale;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGamma;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGammaDshape;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGammaDrate;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchy;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchyDlocation;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchyDscale;</span></span>
<span><span class="co">#&gt; rxode2_compareFactorVal_fn _compareFactorVal;</span></span>
<span><span class="co">#&gt; #include "extraC.h"</span></span>
<span><span class="co">#&gt; double _prod(double *input, double *p, int type, int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return _prodPS(input, p, n, type);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _udf(const char *funName, double *input, int n, ...) {</span></span>
<span><span class="co">#&gt;   if (n == -42) Rf_error("%s", "this has a ui user function that cannot be called directly");</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return _evalUdf(funName, n, input);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _sum(double *input, double *pld, int m, int type, int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   double ret = _sumPS(input, n, pld, m, type);</span></span>
<span><span class="co">#&gt;   if (type == 2 &amp;&amp; m &lt; 0){</span></span>
<span><span class="co">#&gt;     for (int i = -m; i--;){</span></span>
<span><span class="co">#&gt;       pld[i] = 0.0;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return ret;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _sign(unsigned int n, ...) {</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double s = 1;</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;     s = sign(va_arg(valist, double))*s;</span></span>
<span><span class="co">#&gt;     if (s == 0){</span></span>
<span><span class="co">#&gt;       break;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return s;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _rxord(int _cSub, unsigned int n,  ...) {</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind* ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   if (!ind-&gt;inLhs) {</span></span>
<span><span class="co">#&gt;     return 1.0;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double ret = 1.0;</span></span>
<span><span class="co">#&gt;   double p = 0.0;</span></span>
<span><span class="co">#&gt;   double u = rxunif(ind, 0.0, 1.0);</span></span>
<span><span class="co">#&gt;   int found = 0;</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;     p += va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     if (!found) {</span></span>
<span><span class="co">#&gt;       if (u &lt; p) {</span></span>
<span><span class="co">#&gt;         ret = (double)(i+1);</span></span>
<span><span class="co">#&gt;         found = 1;</span></span>
<span><span class="co">#&gt;       }</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   if (!found) ret =(double)(n+1);</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return ret;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _max(unsigned int n, ...) {</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double mx = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tmp = 0;</span></span>
<span><span class="co">#&gt;   if (n &gt;= 1){</span></span>
<span><span class="co">#&gt;     mx = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     for (unsigned int i = 1; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;       tmp = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;       if (tmp&gt;mx) mx=tmp;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     va_end(valist);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return mx;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _min(unsigned int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double mn = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tmp = 0;</span></span>
<span><span class="co">#&gt;   if (n &gt;= 1){</span></span>
<span><span class="co">#&gt;     mn = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     for (unsigned int i = 1; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;       tmp = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;       if (tmp&lt;mn) mn=tmp;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     va_end(valist);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return mn;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _transit4P(int cmt, double t, unsigned int id, double n, double mtt, double bio){</span></span>
<span><span class="co">#&gt;   double nd = (double) n;</span></span>
<span><span class="co">#&gt;   double ktr = (nd+1)/mtt;</span></span>
<span><span class="co">#&gt;   double lktr = _safe_log(nd+1)-_safe_log(mtt);</span></span>
<span><span class="co">#&gt;   double tlast = _solveData-&gt;subjects[id].tlastS[cmt];</span></span>
<span><span class="co">#&gt;   double dose = _solveData-&gt;subjects[id].curDoseS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(dose)) dose = 0.0;</span></span>
<span><span class="co">#&gt;   if (ISNA(tlast)) tlast = 0.0;</span></span>
<span><span class="co">#&gt;   double tad = (t-tlast);</span></span>
<span><span class="co">#&gt;   return exp(_safe_log(bio*dose)+lktr+n*(lktr+_safe_log(tad))-ktr*(tad)-lgamma1p(nd));</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _transit3P(int cmt, double t, unsigned int id, double n, double mtt){</span></span>
<span><span class="co">#&gt;   double nd = (double) n;</span></span>
<span><span class="co">#&gt;   double ktr = (nd+1)/mtt;</span></span>
<span><span class="co">#&gt;   double lktr = _safe_log(nd+1)-_safe_log(mtt);</span></span>
<span><span class="co">#&gt;   double tlast = _solveData-&gt;subjects[id].tlastS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(tlast)) tlast = 0.0;</span></span>
<span><span class="co">#&gt;   double tad = t-tlast;</span></span>
<span><span class="co">#&gt;   double podo = _solveData-&gt;subjects[id].curDoseS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(podo)) podo = 0.0;</span></span>
<span><span class="co">#&gt;   return exp(_safe_log(podo)+lktr+n*(lktr+_safe_log(tad))-ktr*(tad)-lgamma1p(nd));</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void _assignFuns0(void) {</span></span>
<span><span class="co">#&gt;   _evalUdf = (_udf_type) R_GetCCallable("rxode2", "_rxode2_evalUdf");</span></span>
<span><span class="co">#&gt;   _getRxSolve_ = (_getRxSolve_t) R_GetCCallable("rxode2","getRxSolve_");</span></span>
<span><span class="co">#&gt;   _assign_ptr=(rxode2_assign_ptr) R_GetCCallable("rxode2","rxode2_assign_fn_pointers");</span></span>
<span><span class="co">#&gt;   _rxRmModelLib=(_rxRmModelLibType) R_GetCCallable("rxode2","rxRmModelLib");</span></span>
<span><span class="co">#&gt;   _rxGetModelLib=(_rxGetModelLibType) R_GetCCallable("rxode2","rxGetModelLib");</span></span>
<span><span class="co">#&gt;   _rxode2_rxAssignPtr=(_rx_asgn)R_GetCCallable("rxode2","_rxode2_rxAssignPtr");</span></span>
<span><span class="co">#&gt;   _rxQr=(_rx_asgn)R_GetCCallable("rxode2","_rxode2_rxQr");</span></span>
<span><span class="co">#&gt;   _rxIsCurrentC = (_rxIsCurrentC_type)R_GetCCallable("rxode2","rxIsCurrentC");</span></span>
<span><span class="co">#&gt;   _sumPS  = (_rxSumType) R_GetCCallable("PreciseSums","PreciseSums_sum_r");</span></span>
<span><span class="co">#&gt;   _prodPS = (_rxProdType) R_GetCCallable("PreciseSums","PreciseSums_prod_r");</span></span>
<span><span class="co">#&gt;   _prodType=(rxode2_fn0i)R_GetCCallable("PreciseSums", "PreciseSums_prod_get");</span></span>
<span><span class="co">#&gt;   _sumType=(rxode2_fn0i)R_GetCCallable("PreciseSums", "PreciseSums_sum_get");</span></span>
<span><span class="co">#&gt;   _ptrid=(rxode2_fn0i)R_GetCCallable("rxode2", "rxode2_current_fn_pointer_id");</span></span>
<span><span class="co">#&gt;   _compareFactorVal=(rxode2_compareFactorVal_fn) R_GetCCallable("rxode2", "compareFactorVal");</span></span>
<span><span class="co">#&gt;   _update_par_ptr = (_update_par_ptr_p) R_GetCCallable("rxode2","_update_par_ptr");</span></span>
<span><span class="co">#&gt;   _getParCov = (_getParCov_p) R_GetCCallable("rxode2","_getParCov");</span></span>
<span><span class="co">#&gt;   // dynamic start</span></span>
<span><span class="co">#&gt;   _llikCauchyDscale = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchyDscale");</span></span>
<span><span class="co">#&gt;   _llikCauchyDlocation = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchyDlocation");</span></span>
<span><span class="co">#&gt;   _llikCauchy = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchy");</span></span>
<span><span class="co">#&gt;   _llikGammaDrate = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGammaDrate");</span></span>
<span><span class="co">#&gt;   _llikGammaDshape = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGammaDshape");</span></span>
<span><span class="co">#&gt;   _llikGamma = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGamma");</span></span>
<span><span class="co">#&gt;   _llikWeibullDscale = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibullDscale");</span></span>
<span><span class="co">#&gt;   _llikWeibullDshape = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibullDshape");</span></span>
<span><span class="co">#&gt;   _llikWeibull = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibull");</span></span>
<span><span class="co">#&gt;   _llikUnifDbeta = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnifDbeta");</span></span>
<span><span class="co">#&gt;   _llikUnifDalpha = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnifDalpha");</span></span>
<span><span class="co">#&gt;   _llikUnif = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnif");</span></span>
<span><span class="co">#&gt;   _llikGeomDp = (rxode2_llikGeomFun) R_GetCCallable("rxode2ll", "rxLlikGeomDp");</span></span>
<span><span class="co">#&gt;   _llikGeom = (rxode2_llikGeomFun) R_GetCCallable("rxode2ll", "rxLlikGeom");</span></span>
<span><span class="co">#&gt;   _llikFDdf2 = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikFDdf2");</span></span>
<span><span class="co">#&gt;   _llikFDdf1 = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikFDdf1");</span></span>
<span><span class="co">#&gt;   _llikF = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikF");</span></span>
<span><span class="co">#&gt;   _llikExpDrate = (rxode2_llikExpFun) R_GetCCallable("rxode2ll", "rxLlikExpDrate");</span></span>
<span><span class="co">#&gt;   _llikExp = (rxode2_llikExpFun) R_GetCCallable("rxode2ll", "rxLlikExp");</span></span>
<span><span class="co">#&gt;   _llikChisqDdf = (rxode2_llikChisqFun) R_GetCCallable("rxode2ll", "rxLlikChisqDdf");</span></span>
<span><span class="co">#&gt;   _llikChisq = (rxode2_llikChisqFun) R_GetCCallable("rxode2ll", "rxLlikChisq");</span></span>
<span><span class="co">#&gt;   _llikTDsd = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDsd");</span></span>
<span><span class="co">#&gt;   _llikTDmean = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDmean");</span></span>
<span><span class="co">#&gt;   _llikTDdf = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDdf");</span></span>
<span><span class="co">#&gt;   _llikT = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikT");</span></span>
<span><span class="co">#&gt;   _llikBetaDshape2 = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBetaDshape2");</span></span>
<span><span class="co">#&gt;   _llikBetaDshape1 = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBetaDshape1");</span></span>
<span><span class="co">#&gt;   _llikBeta = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBeta");</span></span>
<span><span class="co">#&gt;   _llikNbinomMuDmu = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomMuDmu");</span></span>
<span><span class="co">#&gt;   _llikNbinomMu = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomMu");</span></span>
<span><span class="co">#&gt;   _llikNbinomDprob = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomDprob");</span></span>
<span><span class="co">#&gt;   _llikNbinom = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinom");</span></span>
<span><span class="co">#&gt;   _llikBinomDprob = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikBinomDprob");</span></span>
<span><span class="co">#&gt;   _llikBinom = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikBinom");</span></span>
<span><span class="co">#&gt;   _llikPoisDlambda = (rxode2_llikPoisFun) R_GetCCallable("rxode2ll", "rxLlikPoisDlambda");</span></span>
<span><span class="co">#&gt;   _llikPois = (rxode2_llikPoisFun) R_GetCCallable("rxode2ll", "rxLlikPois");</span></span>
<span><span class="co">#&gt;   _llikNormDsd = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNormDsd");</span></span>
<span><span class="co">#&gt;   _llikNormDmean = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNormDmean");</span></span>
<span><span class="co">#&gt;   _llikNorm = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNorm");</span></span>
<span><span class="co">#&gt;   simeps = (_simfun) R_GetCCallable("rxode2", "simeps");</span></span>
<span><span class="co">#&gt;   simeta = (_simfun) R_GetCCallable("rxode2", "simeta");</span></span>
<span><span class="co">#&gt;   expit = (rxode2_fn3) R_GetCCallable("rxode2", "expit");</span></span>
<span><span class="co">#&gt;   logit = (rxode2_fn3) R_GetCCallable("rxode2", "logit");</span></span>
<span><span class="co">#&gt;   gammapDer = (rxode2_fn2) R_GetCCallable("rxode2", "gammapDer");</span></span>
<span><span class="co">#&gt;   lowergamma = (rxode2_fn2) R_GetCCallable("rxode2", "lowergamma");</span></span>
<span><span class="co">#&gt;   uppergamma = (rxode2_fn2) R_GetCCallable("rxode2", "uppergamma");</span></span>
<span><span class="co">#&gt;   gammaqInva = (rxode2_fn2) R_GetCCallable("rxode2", "gammaqInva");</span></span>
<span><span class="co">#&gt;   gammaqInv = (rxode2_fn2) R_GetCCallable("rxode2", "gammaqInv");</span></span>
<span><span class="co">#&gt;   gammapInva = (rxode2_fn2) R_GetCCallable("rxode2", "gammapInva");</span></span>
<span><span class="co">#&gt;   gammapInv = (rxode2_fn2) R_GetCCallable("rxode2", "gammapInv");</span></span>
<span><span class="co">#&gt;   gammaq = (rxode2_fn2) R_GetCCallable("rxode2", "gammaq");</span></span>
<span><span class="co">#&gt;   gammap = (rxode2_fn2) R_GetCCallable("rxode2", "gammap");</span></span>
<span><span class="co">#&gt;   phi = (rxode2_fn) R_GetCCallable("rxode2", "phi");</span></span>
<span><span class="co">#&gt;   d2ELUa = (rxode2_fn2) R_GetCCallable("rxode2", "d2ELUa");</span></span>
<span><span class="co">#&gt;   dELUa = (rxode2_fn2) R_GetCCallable("rxode2", "dELUa");</span></span>
<span><span class="co">#&gt;   d2aELU = (rxode2_fn2) R_GetCCallable("rxode2", "d2aELU");</span></span>
<span><span class="co">#&gt;   d2ELU = (rxode2_fn2) R_GetCCallable("rxode2", "d2ELU");</span></span>
<span><span class="co">#&gt;   dELU = (rxode2_fn2) R_GetCCallable("rxode2", "dELU");</span></span>
<span><span class="co">#&gt;   ELU = (rxode2_fn2) R_GetCCallable("rxode2", "ELU");</span></span>
<span><span class="co">#&gt;   dPReLUa1 = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLUa1");</span></span>
<span><span class="co">#&gt;   dPReLUa = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLUa");</span></span>
<span><span class="co">#&gt;   dPReLU = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLU");</span></span>
<span><span class="co">#&gt;   PReLU = (rxode2_fn2) R_GetCCallable("rxode2", "PReLU");</span></span>
<span><span class="co">#&gt;   dSwish = (rxode2_fn) R_GetCCallable("rxode2", "dSwish");</span></span>
<span><span class="co">#&gt;   Swish = (rxode2_fn) R_GetCCallable("rxode2", "Swish");</span></span>
<span><span class="co">#&gt;   dlReLU = (rxode2_fn) R_GetCCallable("rxode2", "dlReLU");</span></span>
<span><span class="co">#&gt;   lReLU = (rxode2_fn) R_GetCCallable("rxode2", "lReLU");</span></span>
<span><span class="co">#&gt;   dSELU = (rxode2_fn) R_GetCCallable("rxode2", "dSELU");</span></span>
<span><span class="co">#&gt;   SELU = (rxode2_fn) R_GetCCallable("rxode2", "SELU");</span></span>
<span><span class="co">#&gt;   d4softplus = (rxode2_fn) R_GetCCallable("rxode2", "d4softplus");</span></span>
<span><span class="co">#&gt;   d3softplus = (rxode2_fn) R_GetCCallable("rxode2", "d3softplus");</span></span>
<span><span class="co">#&gt;   d2softplus = (rxode2_fn) R_GetCCallable("rxode2", "d2softplus");</span></span>
<span><span class="co">#&gt;   dsoftplus = (rxode2_fn) R_GetCCallable("rxode2", "dsoftplus");</span></span>
<span><span class="co">#&gt;   softplus = (rxode2_fn) R_GetCCallable("rxode2", "softplus");</span></span>
<span><span class="co">#&gt;   d4GELU = (rxode2_fn) R_GetCCallable("rxode2", "d4GELU");</span></span>
<span><span class="co">#&gt;   d3GELU = (rxode2_fn) R_GetCCallable("rxode2", "d3GELU");</span></span>
<span><span class="co">#&gt;   d2GELU = (rxode2_fn) R_GetCCallable("rxode2", "d2GELU");</span></span>
<span><span class="co">#&gt;   dGELU = (rxode2_fn) R_GetCCallable("rxode2", "dGELU");</span></span>
<span><span class="co">#&gt;   GELU = (rxode2_fn) R_GetCCallable("rxode2", "GELU");</span></span>
<span><span class="co">#&gt;   dReLU = (rxode2_fn) R_GetCCallable("rxode2", "dReLU");</span></span>
<span><span class="co">#&gt;   ReLU = (rxode2_fn) R_GetCCallable("rxode2", "ReLU");</span></span>
<span><span class="co">#&gt;   riweibull = (rxode2i2_fn2) R_GetCCallable("rxode2", "riweibull");</span></span>
<span><span class="co">#&gt;   riunif = (rxode2i2_fn2) R_GetCCallable("rxode2", "riunif");</span></span>
<span><span class="co">#&gt;   rit_ = (rxode2i2_fn) R_GetCCallable("rxode2", "rit_");</span></span>
<span><span class="co">#&gt;   ripois = (rxode2i2_ifn) R_GetCCallable("rxode2", "ripois");</span></span>
<span><span class="co">#&gt;   ribeta = (rxode2i2_fn2) R_GetCCallable("rxode2", "ribeta");</span></span>
<span><span class="co">#&gt;   rigamma = (rxode2i2_fn2) R_GetCCallable("rxode2", "rigamma");</span></span>
<span><span class="co">#&gt;   rigeom = (rxode2i2_ifn) R_GetCCallable("rxode2", "rigeom");</span></span>
<span><span class="co">#&gt;   rif = (rxode2i2_fn2) R_GetCCallable("rxode2", "rif");</span></span>
<span><span class="co">#&gt;   riexp = (rxode2i2_fn) R_GetCCallable("rxode2", "riexp");</span></span>
<span><span class="co">#&gt;   richisq = (rxode2i2_fn) R_GetCCallable("rxode2", "richisq");</span></span>
<span><span class="co">#&gt;   ricauchy = (rxode2i2_fn2) R_GetCCallable("rxode2", "ricauchy");</span></span>
<span><span class="co">#&gt;   rinbinomMu = (rxode2i2_ribinom) R_GetCCallable("rxode2", "rinbinomMu");</span></span>
<span><span class="co">#&gt;   rinbinom = (rxode2i2_ribinom) R_GetCCallable("rxode2", "rinbinom");</span></span>
<span><span class="co">#&gt;   ribinom = (rxode2i2_ribinom) R_GetCCallable("rxode2", "ribinom");</span></span>
<span><span class="co">#&gt;   rinorm = (rxode2i2_fn2) R_GetCCallable("rxode2", "rinorm");</span></span>
<span><span class="co">#&gt;   rxweibull = (rxode2i_fn2) R_GetCCallable("rxode2", "rxweibull");</span></span>
<span><span class="co">#&gt;   rxunif = (rxode2i_fn2) R_GetCCallable("rxode2", "rxunif");</span></span>
<span><span class="co">#&gt;   rxt_ = (rxode2i_fn) R_GetCCallable("rxode2", "rxt_");</span></span>
<span><span class="co">#&gt;   rxpois = (rxode2i_ifn) R_GetCCallable("rxode2", "rxpois");</span></span>
<span><span class="co">#&gt;   rxbeta = (rxode2i_fn2) R_GetCCallable("rxode2", "rxbeta");</span></span>
<span><span class="co">#&gt;   rxgamma = (rxode2i_fn2) R_GetCCallable("rxode2", "rxgamma");</span></span>
<span><span class="co">#&gt;   rxgeom = (rxode2i_ifn) R_GetCCallable("rxode2", "rxgeom");</span></span>
<span><span class="co">#&gt;   rxf = (rxode2i_fn2) R_GetCCallable("rxode2", "rxf");</span></span>
<span><span class="co">#&gt;   rxexp = (rxode2i_fn) R_GetCCallable("rxode2", "rxexp");</span></span>
<span><span class="co">#&gt;   rxchisq = (rxode2i_fn) R_GetCCallable("rxode2", "rxchisq");</span></span>
<span><span class="co">#&gt;   rxcauchy = (rxode2i_fn2) R_GetCCallable("rxode2", "rxcauchy");</span></span>
<span><span class="co">#&gt;   rxnbinomMu = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxnbinomMu");</span></span>
<span><span class="co">#&gt;   rxnbinom = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxnbinom");</span></span>
<span><span class="co">#&gt;   rxbinom = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxbinom");</span></span>
<span><span class="co">#&gt;   rxnorm = (rxode2i_fn2) R_GetCCallable("rxode2", "rxnorm");</span></span>
<span><span class="co">#&gt;   linCmtB = (linCmtB_p) R_GetCCallable("rxode2", "linCmtB");</span></span>
<span><span class="co">#&gt;   linCmtA = (linCmtA_p) R_GetCCallable("rxode2", "linCmtA");</span></span>
<span><span class="co">#&gt;   // dynamic stop</span></span>
<span><span class="co">#&gt;   _solveData = _getRxSolve_();</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void _assignFuns(void) {</span></span>
<span><span class="co">#&gt;   if (_assign_ptr == NULL){</span></span>
<span><span class="co">#&gt;     _assignFuns0();</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void __assignFuns2(rx_solve rx,</span></span>
<span><span class="co">#&gt;                    rx_solving_options op,</span></span>
<span><span class="co">#&gt;                    t_F f,</span></span>
<span><span class="co">#&gt;                    t_LAG lag,</span></span>
<span><span class="co">#&gt;                    t_RATE rate,</span></span>
<span><span class="co">#&gt;                    t_DUR dur,</span></span>
<span><span class="co">#&gt;                    t_calc_mtime mtime,</span></span>
<span><span class="co">#&gt;                    t_ME me,</span></span>
<span><span class="co">#&gt;                    t_IndF indf,</span></span>
<span><span class="co">#&gt;                    t_getTime gettime,</span></span>
<span><span class="co">#&gt;                    t_locateTimeIndex timeindex,</span></span>
<span><span class="co">#&gt;                    t_handle_evidL handleEvid,</span></span>
<span><span class="co">#&gt;                    t_getDur getdur) {</span></span>
<span><span class="co">#&gt;   // assign start</span></span>
<span><span class="co">#&gt;     static rxode2_assignFuns2_t rxode2_assignFuns2 = NULL;</span></span>
<span><span class="co">#&gt;     if (rxode2_assignFuns2 == NULL) rxode2_assignFuns2 = (rxode2_assignFuns2_t)(R_GetCCallable("rxode2", "_rxode2_assignFuns2"));</span></span>
<span><span class="co">#&gt;     rxode2_assignFuns2(rx, op, f, lag, rate, dur, mtime, me, indf, gettime, timeindex, handleEvid, getdur);</span></span>
<span><span class="co">#&gt;   // assign stop</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void  rx_8b7709189bf3267613a5559c5fec8f37__ode_solver_solvedata (rx_solve *solve){</span></span>
<span><span class="co">#&gt;   _solveData = solve;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern rx_solve *rx_8b7709189bf3267613a5559c5fec8f37__ode_solver_get_solvedata(void){</span></span>
<span><span class="co">#&gt;   return _solveData;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; SEXP rx_8b7709189bf3267613a5559c5fec8f37__model_vars(void);</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; // prj-specific differential eqns</span></span>
<span><span class="co">#&gt; void rx_8b7709189bf3267613a5559c5fec8f37__dydt(int *_neq, double __t, double *__zzStateVar__, double *__DDtStateVar__)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   int _cSub = _neq[1];</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_neq[1]].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=1;</span></span>
<span><span class="co">#&gt;   double TKA = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TCL = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TV2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TQ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TV3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TKin = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TKout = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TEC50 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double c2_DoT_prop_DoT_sd = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eff_DoT_add_DoT_sd = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_cl = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_v = NA_REAL;</span></span>
<span><span class="co">#&gt;   double KA = NA_REAL;</span></span>
<span><span class="co">#&gt;   double CL = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Q = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kin = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kout = NA_REAL;</span></span>
<span><span class="co">#&gt;   double EC50 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double centr = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double peri = NA_REAL;</span></span>
<span><span class="co">#&gt;   double depot = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eff = NA_REAL;</span></span>
<span><span class="co">#&gt;   double CMT = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_yj___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_lambda___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_low___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_hi___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_f_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_r_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double ipredSim = NA_REAL;</span></span>
<span><span class="co">#&gt;   double sim = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rxerr_DoT_C2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rxerr_DoT_eff = NA_REAL;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   (void)TKA;</span></span>
<span><span class="co">#&gt;   (void)TCL;</span></span>
<span><span class="co">#&gt;   (void)TV2;</span></span>
<span><span class="co">#&gt;   (void)TQ;</span></span>
<span><span class="co">#&gt;   (void)TV3;</span></span>
<span><span class="co">#&gt;   (void)TKin;</span></span>
<span><span class="co">#&gt;   (void)TKout;</span></span>
<span><span class="co">#&gt;   (void)TEC50;</span></span>
<span><span class="co">#&gt;   (void)c2_DoT_prop_DoT_sd;</span></span>
<span><span class="co">#&gt;   (void)eff_DoT_add_DoT_sd;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_cl;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_v;</span></span>
<span><span class="co">#&gt;   (void)KA;</span></span>
<span><span class="co">#&gt;   (void)CL;</span></span>
<span><span class="co">#&gt;   (void)V2;</span></span>
<span><span class="co">#&gt;   (void)Q;</span></span>
<span><span class="co">#&gt;   (void)V3;</span></span>
<span><span class="co">#&gt;   (void)Kin;</span></span>
<span><span class="co">#&gt;   (void)Kout;</span></span>
<span><span class="co">#&gt;   (void)EC50;</span></span>
<span><span class="co">#&gt;   (void)C2;</span></span>
<span><span class="co">#&gt;   (void)centr;</span></span>
<span><span class="co">#&gt;   (void)C3;</span></span>
<span><span class="co">#&gt;   (void)peri;</span></span>
<span><span class="co">#&gt;   (void)depot;</span></span>
<span><span class="co">#&gt;   (void)eff;</span></span>
<span><span class="co">#&gt;   (void)CMT;</span></span>
<span><span class="co">#&gt;   (void)rx_yj___;</span></span>
<span><span class="co">#&gt;   (void)rx_lambda___;</span></span>
<span><span class="co">#&gt;   (void)rx_low___;</span></span>
<span><span class="co">#&gt;   (void)rx_hi___;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_f_;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_;</span></span>
<span><span class="co">#&gt;   (void)rx_r_;</span></span>
<span><span class="co">#&gt;   (void)ipredSim;</span></span>
<span><span class="co">#&gt;   (void)sim;</span></span>
<span><span class="co">#&gt;   (void)rxerr_DoT_C2;</span></span>
<span><span class="co">#&gt;   (void)rxerr_DoT_eff;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   KA = _PL[0];</span></span>
<span><span class="co">#&gt;   CL = _PL[1];</span></span>
<span><span class="co">#&gt;   V2 = _PL[2];</span></span>
<span><span class="co">#&gt;   Q = _PL[3];</span></span>
<span><span class="co">#&gt;   V3 = _PL[4];</span></span>
<span><span class="co">#&gt;   Kin = _PL[5];</span></span>
<span><span class="co">#&gt;   Kout = _PL[6];</span></span>
<span><span class="co">#&gt;   EC50 = _PL[7];</span></span>
<span><span class="co">#&gt;   C2 = _PL[8];</span></span>
<span><span class="co">#&gt;   C3 = _PL[9];</span></span>
<span><span class="co">#&gt;   ipredSim = _PL[10];</span></span>
<span><span class="co">#&gt;   sim = _PL[11];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _update_par_ptr(__t, _cSub, _solveData, _idx);</span></span>
<span><span class="co">#&gt;   TKA = _PP[0];</span></span>
<span><span class="co">#&gt;   TCL = _PP[1];</span></span>
<span><span class="co">#&gt;   TV2 = _PP[2];</span></span>
<span><span class="co">#&gt;   TQ = _PP[3];</span></span>
<span><span class="co">#&gt;   TV3 = _PP[4];</span></span>
<span><span class="co">#&gt;   TKin = _PP[5];</span></span>
<span><span class="co">#&gt;   TKout = _PP[6];</span></span>
<span><span class="co">#&gt;   TEC50 = _PP[7];</span></span>
<span><span class="co">#&gt;   c2_DoT_prop_DoT_sd = _PP[8];</span></span>
<span><span class="co">#&gt;   eff_DoT_add_DoT_sd = _PP[9];</span></span>
<span><span class="co">#&gt;   eta_DoT_cl = _PP[10];</span></span>
<span><span class="co">#&gt;   eta_DoT_v = _PP[11];</span></span>
<span><span class="co">#&gt;   CMT = _PP[12];</span></span>
<span><span class="co">#&gt;   rxerr_DoT_C2 = _PP[13];</span></span>
<span><span class="co">#&gt;   rxerr_DoT_eff = _PP[14];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   depot = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">#&gt;   centr = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">#&gt;   peri = __zzStateVar__[__DDT2__]*((double)(_ON[__DDT2__]));</span></span>
<span><span class="co">#&gt;   eff = __zzStateVar__[__DDT3__]*((double)(_ON[__DDT3__]));</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   KA =TKA;</span></span>
<span><span class="co">#&gt;   CL =TCL*exp(eta_DoT_cl);</span></span>
<span><span class="co">#&gt;   V2 =TV2*exp(eta_DoT_v);</span></span>
<span><span class="co">#&gt;   Q =TQ;</span></span>
<span><span class="co">#&gt;   V3 =TV3;</span></span>
<span><span class="co">#&gt;   Kin =TKin;</span></span>
<span><span class="co">#&gt;   Kout =TKout;</span></span>
<span><span class="co">#&gt;   EC50 =TEC50;</span></span>
<span><span class="co">#&gt;   C2=centr/_div0(V2);</span></span>
<span><span class="co">#&gt;   C3=peri/_div0(V3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT0__] = ((double)(_ON[__DDT0__]))*(_IR[__DDT0__] -KA*depot);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT1__] = ((double)(_ON[__DDT1__]))*(_IR[__DDT1__] + KA*depot-CL*C2-Q*C2+Q*C3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT2__] = ((double)(_ON[__DDT2__]))*(_IR[__DDT2__] + Q*C2-Q*C3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT3__] = ((double)(_ON[__DDT3__]))*(_IR[__DDT3__] + Kin-Kout*(1-C2/_div0((EC50+C2)))*eff);</span></span>
<span><span class="co">#&gt;   if (_CMT==5){</span></span>
<span><span class="co">#&gt;   rx_yj_ =2;</span></span>
<span><span class="co">#&gt;   rx_lambda_ =1;</span></span>
<span><span class="co">#&gt;   rx_low_ =0;</span></span>
<span><span class="co">#&gt;   rx_hi_ =1;</span></span>
<span><span class="co">#&gt;   rx_pred_f_ =C2;</span></span>
<span><span class="co">#&gt;   rx_pred_ =rx_pred_f_;</span></span>
<span><span class="co">#&gt;   rx_r_ =Rx_pow((rx_pred_f_*c2_DoT_prop_DoT_sd),2);</span></span>
<span><span class="co">#&gt;   ipredSim =rxTBSi(rx_pred_,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   sim =rxTBSi(rx_pred_+sqrt(rx_r_)*rxerr_DoT_C2,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   if (_CMT==4){</span></span>
<span><span class="co">#&gt;   rx_yj_ =2;</span></span>
<span><span class="co">#&gt;   rx_lambda_ =1;</span></span>
<span><span class="co">#&gt;   rx_low_ =0;</span></span>
<span><span class="co">#&gt;   rx_hi_ =1;</span></span>
<span><span class="co">#&gt;   rx_pred_f_ =eff;</span></span>
<span><span class="co">#&gt;   rx_pred_ =rx_pred_f_;</span></span>
<span><span class="co">#&gt;   rx_r_ =Rx_pow((eff_DoT_add_DoT_sd),2);</span></span>
<span><span class="co">#&gt;   ipredSim =rxTBSi(rx_pred_,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   sim =rxTBSi(rx_pred_+sqrt(rx_r_)*rxerr_DoT_eff,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   (&amp;_solveData-&gt;subjects[_cSub])-&gt;dadt_counter[0]++;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; // Jacobian derived vars</span></span>
<span><span class="co">#&gt; void rx_8b7709189bf3267613a5559c5fec8f37__calc_jac(int *_neq, double __t, double *__zzStateVar__, double *__PDStateVar__, unsigned int __NROWPD__) {</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;     int _cSub=_neq[1];</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_neq[1]].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=2;</span></span>
<span><span class="co">#&gt;   (&amp;_solveData-&gt;subjects[_cSub])-&gt;jac_counter[0]++;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Functional based initial conditions.</span></span>
<span><span class="co">#&gt; void rx_8b7709189bf3267613a5559c5fec8f37__inis(int _cSub, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;  _ind-&gt;_rxFlag=3;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // prj-specific derived vars</span></span>
<span><span class="co">#&gt; void rx_8b7709189bf3267613a5559c5fec8f37__calc_lhs(int _cSub, double __t, double *__zzStateVar__, double *_lhs) {</span></span>
<span><span class="co">#&gt;     int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=11;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_0__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_1__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_2__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_3__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_4__;</span></span>
<span><span class="co">#&gt;   double TKA = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TCL = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TV2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TQ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TV3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TKin = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TKout = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TEC50 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double c2_DoT_prop_DoT_sd = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eff_DoT_add_DoT_sd = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_cl = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_v = NA_REAL;</span></span>
<span><span class="co">#&gt;   double KA = NA_REAL;</span></span>
<span><span class="co">#&gt;   double CL = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Q = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kin = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kout = NA_REAL;</span></span>
<span><span class="co">#&gt;   double EC50 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double centr = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double peri = NA_REAL;</span></span>
<span><span class="co">#&gt;   double depot = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eff = NA_REAL;</span></span>
<span><span class="co">#&gt;   double CMT = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_yj___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_lambda___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_low___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_hi___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_f_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_r_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double ipredSim = NA_REAL;</span></span>
<span><span class="co">#&gt;   double sim = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rxerr_DoT_C2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rxerr_DoT_eff = NA_REAL;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_0__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_1__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_2__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_3__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_4__;</span></span>
<span><span class="co">#&gt;   (void)TKA;</span></span>
<span><span class="co">#&gt;   (void)TCL;</span></span>
<span><span class="co">#&gt;   (void)TV2;</span></span>
<span><span class="co">#&gt;   (void)TQ;</span></span>
<span><span class="co">#&gt;   (void)TV3;</span></span>
<span><span class="co">#&gt;   (void)TKin;</span></span>
<span><span class="co">#&gt;   (void)TKout;</span></span>
<span><span class="co">#&gt;   (void)TEC50;</span></span>
<span><span class="co">#&gt;   (void)c2_DoT_prop_DoT_sd;</span></span>
<span><span class="co">#&gt;   (void)eff_DoT_add_DoT_sd;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_cl;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_v;</span></span>
<span><span class="co">#&gt;   (void)KA;</span></span>
<span><span class="co">#&gt;   (void)CL;</span></span>
<span><span class="co">#&gt;   (void)V2;</span></span>
<span><span class="co">#&gt;   (void)Q;</span></span>
<span><span class="co">#&gt;   (void)V3;</span></span>
<span><span class="co">#&gt;   (void)Kin;</span></span>
<span><span class="co">#&gt;   (void)Kout;</span></span>
<span><span class="co">#&gt;   (void)EC50;</span></span>
<span><span class="co">#&gt;   (void)C2;</span></span>
<span><span class="co">#&gt;   (void)centr;</span></span>
<span><span class="co">#&gt;   (void)C3;</span></span>
<span><span class="co">#&gt;   (void)peri;</span></span>
<span><span class="co">#&gt;   (void)depot;</span></span>
<span><span class="co">#&gt;   (void)eff;</span></span>
<span><span class="co">#&gt;   (void)CMT;</span></span>
<span><span class="co">#&gt;   (void)rx_yj___;</span></span>
<span><span class="co">#&gt;   (void)rx_lambda___;</span></span>
<span><span class="co">#&gt;   (void)rx_low___;</span></span>
<span><span class="co">#&gt;   (void)rx_hi___;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_f_;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_;</span></span>
<span><span class="co">#&gt;   (void)rx_r_;</span></span>
<span><span class="co">#&gt;   (void)ipredSim;</span></span>
<span><span class="co">#&gt;   (void)sim;</span></span>
<span><span class="co">#&gt;   (void)rxerr_DoT_C2;</span></span>
<span><span class="co">#&gt;   (void)rxerr_DoT_eff;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   KA = _PL[0];</span></span>
<span><span class="co">#&gt;   CL = _PL[1];</span></span>
<span><span class="co">#&gt;   V2 = _PL[2];</span></span>
<span><span class="co">#&gt;   Q = _PL[3];</span></span>
<span><span class="co">#&gt;   V3 = _PL[4];</span></span>
<span><span class="co">#&gt;   Kin = _PL[5];</span></span>
<span><span class="co">#&gt;   Kout = _PL[6];</span></span>
<span><span class="co">#&gt;   EC50 = _PL[7];</span></span>
<span><span class="co">#&gt;   C2 = _PL[8];</span></span>
<span><span class="co">#&gt;   C3 = _PL[9];</span></span>
<span><span class="co">#&gt;   ipredSim = _PL[10];</span></span>
<span><span class="co">#&gt;   sim = _PL[11];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _update_par_ptr(__t, _cSub, _solveData, _idx);</span></span>
<span><span class="co">#&gt;   TKA = _PP[0];</span></span>
<span><span class="co">#&gt;   TCL = _PP[1];</span></span>
<span><span class="co">#&gt;   TV2 = _PP[2];</span></span>
<span><span class="co">#&gt;   TQ = _PP[3];</span></span>
<span><span class="co">#&gt;   TV3 = _PP[4];</span></span>
<span><span class="co">#&gt;   TKin = _PP[5];</span></span>
<span><span class="co">#&gt;   TKout = _PP[6];</span></span>
<span><span class="co">#&gt;   TEC50 = _PP[7];</span></span>
<span><span class="co">#&gt;   c2_DoT_prop_DoT_sd = _PP[8];</span></span>
<span><span class="co">#&gt;   eff_DoT_add_DoT_sd = _PP[9];</span></span>
<span><span class="co">#&gt;   eta_DoT_cl = _PP[10];</span></span>
<span><span class="co">#&gt;   eta_DoT_v = _PP[11];</span></span>
<span><span class="co">#&gt;   CMT = _PP[12];</span></span>
<span><span class="co">#&gt;   rxerr_DoT_C2 = _PP[13];</span></span>
<span><span class="co">#&gt;   rxerr_DoT_eff = _PP[14];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   depot = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">#&gt;   centr = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">#&gt;   peri = __zzStateVar__[__DDT2__]*((double)(_ON[__DDT2__]));</span></span>
<span><span class="co">#&gt;   eff = __zzStateVar__[__DDT3__]*((double)(_ON[__DDT3__]));</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   KA =TKA;</span></span>
<span><span class="co">#&gt;   CL =TCL*exp(eta_DoT_cl);</span></span>
<span><span class="co">#&gt;   V2 =TV2*exp(eta_DoT_v);</span></span>
<span><span class="co">#&gt;   Q =TQ;</span></span>
<span><span class="co">#&gt;   V3 =TV3;</span></span>
<span><span class="co">#&gt;   Kin =TKin;</span></span>
<span><span class="co">#&gt;   Kout =TKout;</span></span>
<span><span class="co">#&gt;   EC50 =TEC50;</span></span>
<span><span class="co">#&gt;   C2=centr/_div0(V2);</span></span>
<span><span class="co">#&gt;   C3=peri/_div0(V3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_0__ = ((double)(_ON[__DDT0__]))*(_IR[__DDT0__] -KA*depot);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_1__ = ((double)(_ON[__DDT1__]))*(_IR[__DDT1__] + KA*depot-CL*C2-Q*C2+Q*C3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_2__ = ((double)(_ON[__DDT2__]))*(_IR[__DDT2__] + Q*C2-Q*C3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_3__ = ((double)(_ON[__DDT3__]))*(_IR[__DDT3__] + Kin-Kout*(1-C2/_div0((EC50+C2)))*eff);</span></span>
<span><span class="co">#&gt;   if (_CMT==5){</span></span>
<span><span class="co">#&gt;   rx_yj_ =2;</span></span>
<span><span class="co">#&gt;   rx_lambda_ =1;</span></span>
<span><span class="co">#&gt;   rx_low_ =0;</span></span>
<span><span class="co">#&gt;   rx_hi_ =1;</span></span>
<span><span class="co">#&gt;   rx_pred_f_ =C2;</span></span>
<span><span class="co">#&gt;   rx_pred_ =rx_pred_f_;</span></span>
<span><span class="co">#&gt;   rx_r_ =Rx_pow((rx_pred_f_*c2_DoT_prop_DoT_sd),2);</span></span>
<span><span class="co">#&gt;   ipredSim =rxTBSi(rx_pred_,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   sim =rxTBSi(rx_pred_+sqrt(rx_r_)*rxerr_DoT_C2,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   if (_CMT==4){</span></span>
<span><span class="co">#&gt;   rx_yj_ =2;</span></span>
<span><span class="co">#&gt;   rx_lambda_ =1;</span></span>
<span><span class="co">#&gt;   rx_low_ =0;</span></span>
<span><span class="co">#&gt;   rx_hi_ =1;</span></span>
<span><span class="co">#&gt;   rx_pred_f_ =eff;</span></span>
<span><span class="co">#&gt;   rx_pred_ =rx_pred_f_;</span></span>
<span><span class="co">#&gt;   rx_r_ =Rx_pow((eff_DoT_add_DoT_sd),2);</span></span>
<span><span class="co">#&gt;   ipredSim =rxTBSi(rx_pred_,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   sim =rxTBSi(rx_pred_+sqrt(rx_r_)*rxerr_DoT_eff,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _lhs[_LHS_0_]=KA;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_1_]=CL;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_2_]=V2;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_3_]=Q;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_4_]=V3;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_5_]=Kin;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_6_]=Kout;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_7_]=EC50;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_8_]=C2;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_9_]=C3;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_10_]=ipredSim;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_11_]=sim;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Functional based bioavailability</span></span>
<span><span class="co">#&gt; double rx_8b7709189bf3267613a5559c5fec8f37__F(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return _amt;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; // Functional based absorption lag</span></span>
<span><span class="co">#&gt; double rx_8b7709189bf3267613a5559c5fec8f37__Lag(int _cSub,  int _cmt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return __t;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Modeled zero-order rate</span></span>
<span><span class="co">#&gt; double rx_8b7709189bf3267613a5559c5fec8f37__Rate(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return 0.0;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Modeled zero-order duration</span></span>
<span><span class="co">#&gt; double rx_8b7709189bf3267613a5559c5fec8f37__Dur(int _cSub,  int _cmt, double _amt, double __t){</span></span>
<span><span class="co">#&gt;  return 0.0;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Model Times</span></span>
<span><span class="co">#&gt; void rx_8b7709189bf3267613a5559c5fec8f37__mtime(int _cSub, double *_mtime){</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Matrix Exponential (0)</span></span>
<span><span class="co">#&gt; void rx_8b7709189bf3267613a5559c5fec8f37__ME(int _cSub, double _t, double __t, double *_mat, const double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=9;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Inductive linearization Matf</span></span>
<span><span class="co">#&gt; void rx_8b7709189bf3267613a5559c5fec8f37__IndF(int _cSub, double _t, double __t, double *_matf){</span></span>
<span><span class="co">#&gt;  int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=10;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern SEXP rx_8b7709189bf3267613a5559c5fec8f37__model_vars(void){</span></span>
<span><span class="co">#&gt;   int pro=0;</span></span>
<span><span class="co">#&gt;   SEXP _mv = PROTECT(_rxGetModelLib("rx_8b7709189bf3267613a5559c5fec8f37__model_vars"));pro++;</span></span>
<span><span class="co">#&gt;   if (!_rxIsCurrentC(_mv)){</span></span>
<span><span class="co">#&gt;     SEXP hash    = PROTECT(Rf_allocVector(STRSXP, 1));pro++;</span></span>
<span><span class="co">#&gt; #define __doBuf__  snprintf(buf, __doBufN__, "un]\"BAAA@QRtHACAAAAAAAY4{AAAv7#aT)b/[tVAei8Y[Cj6,]Lv5tv;^tsi)E@iY6zpG*1/`fbbQY\?/(Z3w1Y|Xzr]yf(n\?RK|zyTSgv\?ANis&lt;JnHcN5p&lt;\?2!~0amFic\"RB9JWe;VIKrzY9f2O@9W3{h&gt;5PwmPx\?;**ijWbPQyol}EXt2q&gt;lY&amp;m`l&amp;8R`emRTAM3m`cB~fEF2x/A{n{XF\?ip=Z1MXWkq+BRCi1VlS&gt;4b]fy8n3zp$+xDKaY%%0HHz@&gt;a{pX#,~*1i{$3\?;Cw&gt;&lt;~OIX[n+7(q^G!U\"d;]TO&amp;3tU4WL2hd0/GSZwxx$/b9Gj1U6_n0CwcbN#y|o{A_*@MS(pi%%HkC,wz!UllaXZWsog/5;%%ueViXd3&gt;G[b4wgJE::G2ULCIGIwfr;0u}VK5IWEaYudVjZt0)$dUIQrukq1/)MSM{o,%%l|9!ke*)a/uOn\?jGJ^AJeg3Z/{8yDE;#7VtzSMTVtP!fgK9/`&lt;6%%:&amp;D(fDs&amp;6`&gt;tF7;CboViX(3Z:!b~9d]^CJrCsP!PM%%xgJS@7b5S%%u6SCb`!O=0mb$&amp;`l=pD(cj)A39nHk&lt;FEl6^b\"QA_)~d@Vz/a{CK|70!ocqcvDXQ3#&gt;0fF^*awOScWOz=L_$Ir2Xby+fx,M1SX@V,L&amp;`ZVmWg&gt;+\?K}W^FUd~|et4bUz;u*14~]m3klUx%%\"&gt;\?y^Q^(8TrX}R8BC7GC1X^:HC1kJ:]g,q)T(&amp;+_1}w.yDzEM`c{oj\"pI(]{KhRYNu`(^`$o^x!}Q(th[b&amp;r#W:ylCKN]d\?qq3Ou*s:Tvr5FCyXb*56y&amp;!&lt;]/kTR6[Z#J*\"s{r0=HQ4WL/BYORy0*`vi9Zq&amp;C;hRwiMW./@[;K,=zMBGxuh5,aEi8NoDs=kz{qzGJc58fc!Rqv_9_C(J57[*,`h66&gt;/44aKK{4bHTY!&lt;5GY\?HIX`YJhJl\?&gt;M9E5zx*CpK^9Hk1uJ~|)e#Ilp(8pG@g9#@_Fvyd$eVJ=g`b&lt;bmv]!{he4~Z)GW/9CnS@&lt;ijxb$!n`+&lt;/bTJyoP&lt;$5$H[e0=.l}Cv!^3$PXf0(0KINqsd^@ZHx$,**LB@\?/z.&amp;I&amp;/DKLSSRT!i5+1`_(/G=T7Iv9Fkt2A;CKGwUFBzWfz/cXxa\"lBC\"+a&gt;/`JP`9/!;&gt;.;gvJX2Se\"k)eFI6vGS3*HD_x+t.93`u#@;Zq_%%)fvZ8e]\"{)$azYGUwheAWI&lt;L90572x/t&gt;MozpR*h&lt;C^:Aw0LYLtH,WV//F@W4Lqu)MtZYw4kF0;TO5.r&amp;M3nHOV\?@dnI1~s5uWEo0WqLU@&gt;jPbc2qlwZ+JV)O9BaA7u{uM+Z3LE6hy)hQ0AD`,f\"S&amp;TB1#7ny`t^q[OU40&gt;qgXD*gH(@TU$`{I+oUfl|\"ITIa{Jk.wz|=Yit,O+[1H$T_a/QnBI/lH{f;8dKAi:jg#Jun^;]aQJ0SYKS}eE6^@*Wd9(S0_6S:\"{CQTYifEBlSKe]r*[jdDrX+Xzo8&lt;HY6]z+n5uJs):/nEP+=WEw~/&amp;9Ur8ETO+H)B\"rFy&gt;c+.E1$]wf,ukrm1leKnGE([t;VY8Z)rm&lt;H)bZXe\?|k[wA/9q&gt;t}G9xC|h5_=C}PWicv+B$B8oAvTx,3~p^c;x*Ja*2TL^}O[Zle&lt;#`G~J&amp;EJLy}7ygY|*hC5MK/XiY=G|}4k|sCdX4@uC,qc9v]xVR7m_x)*L@IxfZhGxU^i&amp;\"]3nlfh,%%+!W\?DXc7491yQwOLbAyFr:CtOU[;L;tg&gt;Ia&gt;%%E&gt;%%|zz!kjg;&gt;sG&lt;,C");</span></span>
<span><span class="co">#&gt;     char buf[1750];</span></span>
<span><span class="co">#&gt; #define __doBufN__ 1750</span></span>
<span><span class="co">#&gt;     __doBuf__</span></span>
<span><span class="co">#&gt; #undef __doBuf__</span></span>
<span><span class="co">#&gt; #undef __doBufN__</span></span>
<span><span class="co">#&gt;     SET_STRING_ELT(hash, 0, Rf_mkChar(buf));</span></span>
<span><span class="co">#&gt;     SEXP lst      = PROTECT(_rxQr(hash));pro++;</span></span>
<span><span class="co">#&gt;     _assign_ptr(lst);</span></span>
<span><span class="co">#&gt;     UNPROTECT(pro);</span></span>
<span><span class="co">#&gt;     return lst;</span></span>
<span><span class="co">#&gt;   } else {</span></span>
<span><span class="co">#&gt;     UNPROTECT(pro);</span></span>
<span><span class="co">#&gt;     return _mv;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void rx_8b7709189bf3267613a5559c5fec8f37__dydt_lsoda(int *neq, double *t, double *A, double *DADT)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   rx_8b7709189bf3267613a5559c5fec8f37__dydt(neq, *t, A, DADT);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern int rx_8b7709189bf3267613a5559c5fec8f37__dydt_liblsoda(double __t, double *y, double *ydot, void *data)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   int *neq = (int*)(data);</span></span>
<span><span class="co">#&gt;   rx_8b7709189bf3267613a5559c5fec8f37__dydt(neq, __t, y, ydot);</span></span>
<span><span class="co">#&gt;   return(0);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void rx_8b7709189bf3267613a5559c5fec8f37__calc_jac_lsoda(int *neq, double *t, double *A,int *ml, int *mu, double *JAC, int *nrowpd){</span></span>
<span><span class="co">#&gt;   // Update all covariate parameters</span></span>
<span><span class="co">#&gt;   rx_8b7709189bf3267613a5559c5fec8f37__calc_jac(neq, *t, A, JAC, *nrowpd);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; //Create function to call from R's main thread that assigns the required functions. Sometimes they don't get assigned.</span></span>
<span><span class="co">#&gt; extern void rx_8b7709189bf3267613a5559c5fec8f37__assignFuns(void){</span></span>
<span><span class="co">#&gt;   _assignFuns();</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; //Initialize the dll to match rxode2's calls</span></span>
<span><span class="co">#&gt; void R_init0_rx_8b7709189bf3267613a5559c5fec8f37_(void){</span></span>
<span><span class="co">#&gt;   // Get C callables on load; Otherwise it isn't thread safe</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_8b7709189bf3267613a5559c5fec8f37_","rx_8b7709189bf3267613a5559c5fec8f37__assignFuns2", (DL_FUNC) __assignFuns2);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_8b7709189bf3267613a5559c5fec8f37_","rx_8b7709189bf3267613a5559c5fec8f37__assignFuns", (DL_FUNC) rx_8b7709189bf3267613a5559c5fec8f37__assignFuns);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_8b7709189bf3267613a5559c5fec8f37_","rx_8b7709189bf3267613a5559c5fec8f37__inis",(DL_FUNC) rx_8b7709189bf3267613a5559c5fec8f37__inis);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_8b7709189bf3267613a5559c5fec8f37_","rx_8b7709189bf3267613a5559c5fec8f37__dydt",(DL_FUNC) rx_8b7709189bf3267613a5559c5fec8f37__dydt);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_8b7709189bf3267613a5559c5fec8f37_","rx_8b7709189bf3267613a5559c5fec8f37__calc_lhs",(DL_FUNC) rx_8b7709189bf3267613a5559c5fec8f37__calc_lhs);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_8b7709189bf3267613a5559c5fec8f37_","rx_8b7709189bf3267613a5559c5fec8f37__calc_jac",(DL_FUNC) rx_8b7709189bf3267613a5559c5fec8f37__calc_jac);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_8b7709189bf3267613a5559c5fec8f37_","rx_8b7709189bf3267613a5559c5fec8f37__dydt_lsoda", (DL_FUNC) rx_8b7709189bf3267613a5559c5fec8f37__dydt_lsoda);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_8b7709189bf3267613a5559c5fec8f37_","rx_8b7709189bf3267613a5559c5fec8f37__calc_jac_lsoda", (DL_FUNC) rx_8b7709189bf3267613a5559c5fec8f37__calc_jac_lsoda);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_8b7709189bf3267613a5559c5fec8f37_","rx_8b7709189bf3267613a5559c5fec8f37__ode_solver_solvedata", (DL_FUNC) rx_8b7709189bf3267613a5559c5fec8f37__ode_solver_solvedata);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_8b7709189bf3267613a5559c5fec8f37_","rx_8b7709189bf3267613a5559c5fec8f37__ode_solver_get_solvedata", (DL_FUNC) rx_8b7709189bf3267613a5559c5fec8f37__ode_solver_get_solvedata);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_8b7709189bf3267613a5559c5fec8f37_","rx_8b7709189bf3267613a5559c5fec8f37__F", (DL_FUNC) rx_8b7709189bf3267613a5559c5fec8f37__F);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_8b7709189bf3267613a5559c5fec8f37_","rx_8b7709189bf3267613a5559c5fec8f37__Lag", (DL_FUNC) rx_8b7709189bf3267613a5559c5fec8f37__Lag);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_8b7709189bf3267613a5559c5fec8f37_","rx_8b7709189bf3267613a5559c5fec8f37__Rate", (DL_FUNC) rx_8b7709189bf3267613a5559c5fec8f37__Rate);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_8b7709189bf3267613a5559c5fec8f37_","rx_8b7709189bf3267613a5559c5fec8f37__Dur", (DL_FUNC) rx_8b7709189bf3267613a5559c5fec8f37__Dur);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_8b7709189bf3267613a5559c5fec8f37_","rx_8b7709189bf3267613a5559c5fec8f37__mtime", (DL_FUNC) rx_8b7709189bf3267613a5559c5fec8f37__mtime);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_8b7709189bf3267613a5559c5fec8f37_","rx_8b7709189bf3267613a5559c5fec8f37__ME", (DL_FUNC) rx_8b7709189bf3267613a5559c5fec8f37__ME);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_8b7709189bf3267613a5559c5fec8f37_","rx_8b7709189bf3267613a5559c5fec8f37__IndF", (DL_FUNC) rx_8b7709189bf3267613a5559c5fec8f37__IndF);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_8b7709189bf3267613a5559c5fec8f37_","rx_8b7709189bf3267613a5559c5fec8f37__dydt_liblsoda", (DL_FUNC) rx_8b7709189bf3267613a5559c5fec8f37__dydt_liblsoda);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; //Initialize the dll to match rxode2's calls</span></span>
<span><span class="co">#&gt; void R_init_rx_8b7709189bf3267613a5559c5fec8f37_(DllInfo *info){</span></span>
<span><span class="co">#&gt;   // Get C callables on load; Otherwise it isn't thread safe</span></span>
<span><span class="co">#&gt;   R_init0_rx_8b7709189bf3267613a5559c5fec8f37_();</span></span>
<span><span class="co">#&gt;   static const R_CallMethodDef callMethods[]  = {</span></span>
<span><span class="co">#&gt;     {"rx_8b7709189bf3267613a5559c5fec8f37__model_vars", (DL_FUNC) &amp;rx_8b7709189bf3267613a5559c5fec8f37__model_vars, 0},</span></span>
<span><span class="co">#&gt;     {NULL, NULL, 0}</span></span>
<span><span class="co">#&gt;   };</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   R_registerRoutines(info, NULL, callMethods, NULL, NULL);</span></span>
<span><span class="co">#&gt;   R_useDynamicSymbols(info,FALSE);</span></span>
<span><span class="co">#&gt;   _assignFuns0();</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; void R_unload_rx_8b7709189bf3267613a5559c5fec8f37_ (DllInfo *info){</span></span>
<span><span class="co">#&gt;   // Free resources required for single subject solve.</span></span>
<span><span class="co">#&gt;   SEXP _mv = PROTECT(_rxGetModelLib("rx_8b7709189bf3267613a5559c5fec8f37__model_vars"));</span></span>
<span><span class="co">#&gt;   if (!Rf_isNull(_mv)){</span></span>
<span><span class="co">#&gt;     _rxRmModelLib("rx_8b7709189bf3267613a5559c5fec8f37__model_vars");</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   UNPROTECT(1);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">rxode2 </span>4.0.2 model named <span style="color: #BBBB00; font-weight: bold;">rx_8b7709189bf3267613a5559c5fec8f37</span> model (<span style="color: #00BB00;">✔</span> <span style="color: #00BB00; font-weight: bold;">ready</span>). </span></span>
<span><span class="co">#&gt; DLL: /tmp/RtmpgzfWbr/rxode2/rx_8b7709189bf3267613a5559c5fec8f37__.rxd/rx_8b7709189bf3267613a5559c5fec8f37_.so</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Calculated Variables:</span></span>
<span><span class="co">#&gt;  [1] "KA"       "CL"       "V2"       "Q"        "V3"       "Kin"     </span></span>
<span><span class="co">#&gt;  [7] "Kout"     "EC50"     "C2"       "C3"       "ipredSim" "sim"     </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── rxode2 Model Syntax ──</span></span></span>
<span><span class="co">#&gt; rxode2({</span></span>
<span><span class="co">#&gt;     param(TKA, TCL, TV2, TQ, TV3, TKin, TKout, TEC50, c2.prop.sd, </span></span>
<span><span class="co">#&gt;         eff.add.sd, eta.cl, eta.v)</span></span>
<span><span class="co">#&gt;     KA = TKA</span></span>
<span><span class="co">#&gt;     CL = TCL * exp(eta.cl)</span></span>
<span><span class="co">#&gt;     V2 = TV2 * exp(eta.v)</span></span>
<span><span class="co">#&gt;     Q = TQ</span></span>
<span><span class="co">#&gt;     V3 = TV3</span></span>
<span><span class="co">#&gt;     Kin = TKin</span></span>
<span><span class="co">#&gt;     Kout = TKout</span></span>
<span><span class="co">#&gt;     EC50 = TEC50</span></span>
<span><span class="co">#&gt;     C2 = centr/V2</span></span>
<span><span class="co">#&gt;     C3 = peri/V3</span></span>
<span><span class="co">#&gt;     d/dt(depot) = -KA * depot</span></span>
<span><span class="co">#&gt;     d/dt(centr) = KA * depot - CL * C2 - Q * C2 + Q * C3</span></span>
<span><span class="co">#&gt;     d/dt(peri) = Q * C2 - Q * C3</span></span>
<span><span class="co">#&gt;     d/dt(eff) = Kin - Kout * (1 - C2/(EC50 + C2)) * eff</span></span>
<span><span class="co">#&gt;     eff(0) = 1</span></span>
<span><span class="co">#&gt;     if (CMT == 5) {</span></span>
<span><span class="co">#&gt;         rx_yj_ ~ 2</span></span>
<span><span class="co">#&gt;         rx_lambda_ ~ 1</span></span>
<span><span class="co">#&gt;         rx_low_ ~ 0</span></span>
<span><span class="co">#&gt;         rx_hi_ ~ 1</span></span>
<span><span class="co">#&gt;         rx_pred_f_ ~ C2</span></span>
<span><span class="co">#&gt;         rx_pred_ ~ rx_pred_f_</span></span>
<span><span class="co">#&gt;         rx_r_ ~ (rx_pred_f_ * c2.prop.sd)^2</span></span>
<span><span class="co">#&gt;         ipredSim = rxTBSi(rx_pred_, rx_lambda_, rx_yj_, rx_low_, </span></span>
<span><span class="co">#&gt;             rx_hi_)</span></span>
<span><span class="co">#&gt;         sim = rxTBSi(rx_pred_ + sqrt(rx_r_) * rxerr.C2, rx_lambda_, </span></span>
<span><span class="co">#&gt;             rx_yj_, rx_low_, rx_hi_)</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     if (CMT == 4) {</span></span>
<span><span class="co">#&gt;         rx_yj_ ~ 2</span></span>
<span><span class="co">#&gt;         rx_lambda_ ~ 1</span></span>
<span><span class="co">#&gt;         rx_low_ ~ 0</span></span>
<span><span class="co">#&gt;         rx_hi_ ~ 1</span></span>
<span><span class="co">#&gt;         rx_pred_f_ ~ eff</span></span>
<span><span class="co">#&gt;         rx_pred_ ~ rx_pred_f_</span></span>
<span><span class="co">#&gt;         rx_r_ ~ (eff.add.sd)^2</span></span>
<span><span class="co">#&gt;         ipredSim = rxTBSi(rx_pred_, rx_lambda_, rx_yj_, rx_low_, </span></span>
<span><span class="co">#&gt;             rx_hi_)</span></span>
<span><span class="co">#&gt;         sim = rxTBSi(rx_pred_ + sqrt(rx_r_) * rxerr.eff, rx_lambda_, </span></span>
<span><span class="co">#&gt;             rx_yj_, rx_low_, rx_hi_)</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     cmt(C2)</span></span>
<span><span class="co">#&gt;     dvid(5, 4)</span></span>
<span><span class="co">#&gt; })</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod2f</span><span class="op">$</span><span class="va">simulationIniModel</span><span class="op">)</span></span>
<span><span class="co">#&gt; C model:</span></span>
<span><span class="co">#&gt; // Define translation state order for 5 states</span></span>
<span><span class="co">#&gt; #define __DDT0__ 0 // depot</span></span>
<span><span class="co">#&gt; #define _DEPOT_ 0 // depot</span></span>
<span><span class="co">#&gt; #define __DDT1__ 1 // centr</span></span>
<span><span class="co">#&gt; #define __DDT2__ 2 // peri</span></span>
<span><span class="co">#&gt; #define __DDT3__ 3 // eff</span></span>
<span><span class="co">#&gt; #define __DDT4__ 4 // NA</span></span>
<span><span class="co">#&gt; // Define 12 LHS values</span></span>
<span><span class="co">#&gt; #define _LHS_0_ 0 // KA</span></span>
<span><span class="co">#&gt; #define _LHS_1_ 1 // CL</span></span>
<span><span class="co">#&gt; #define _LHS_2_ 2 // V2</span></span>
<span><span class="co">#&gt; #define _LHS_3_ 3 // Q</span></span>
<span><span class="co">#&gt; #define _LHS_4_ 4 // V3</span></span>
<span><span class="co">#&gt; #define _LHS_5_ 5 // Kin</span></span>
<span><span class="co">#&gt; #define _LHS_6_ 6 // Kout</span></span>
<span><span class="co">#&gt; #define _LHS_7_ 7 // EC50</span></span>
<span><span class="co">#&gt; #define _LHS_8_ 8 // C2</span></span>
<span><span class="co">#&gt; #define _LHS_9_ 9 // C3</span></span>
<span><span class="co">#&gt; #define _LHS_10_ 10 // ipredSim</span></span>
<span><span class="co">#&gt; #define _LHS_11_ 11 // sim</span></span>
<span><span class="co">#&gt; #define _getRxSolve_ _rxf2338020723e51e42c81cc8e04ed9d58286__getRxSolve__5pb9</span></span>
<span><span class="co">#&gt; #define _evalUdf _rxf2338020723e51e42c81cc8e04ed9d58287__evalUdf_0SUH</span></span>
<span><span class="co">#&gt; #define _solveData _rxf2338020723e51e42c81cc8e04ed9d58288__solveData_jlsA</span></span>
<span><span class="co">#&gt; #define _assign_ptr _rxf2338020723e51e42c81cc8e04ed9d58289__assign_ptr_2JOC</span></span>
<span><span class="co">#&gt; #define _rxRmModelLib _rxf2338020723e51e42c81cc8e04ed9d58290__rxRmModelLib_P3Oy</span></span>
<span><span class="co">#&gt; #define _rxGetModelLib _rxf2338020723e51e42c81cc8e04ed9d58291__rxGetModelLib_HgjC</span></span>
<span><span class="co">#&gt; #define _old_c _rxf2338020723e51e42c81cc8e04ed9d58292__old_c_yj3W</span></span>
<span><span class="co">#&gt; #define _ptrid _rxf2338020723e51e42c81cc8e04ed9d58293__ptrid_hg1D</span></span>
<span><span class="co">#&gt; #define _rxIsCurrentC _rxf2338020723e51e42c81cc8e04ed9d58294__rxIsCurrentC_IdTQ</span></span>
<span><span class="co">#&gt; #define _sumPS _rxf2338020723e51e42c81cc8e04ed9d58295__sumPS_hwBD</span></span>
<span><span class="co">#&gt; #define _prodPS _rxf2338020723e51e42c81cc8e04ed9d58296__prodPS_gUde</span></span>
<span><span class="co">#&gt; #define _prodType _rxf2338020723e51e42c81cc8e04ed9d58297__prodType_5llz</span></span>
<span><span class="co">#&gt; #define _sumType _rxf2338020723e51e42c81cc8e04ed9d58298__sumType_yOSJ</span></span>
<span><span class="co">#&gt; #define _update_par_ptr _rxf2338020723e51e42c81cc8e04ed9d58299__update_par_ptr_AWUm</span></span>
<span><span class="co">#&gt; #define _getParCov _rxf2338020723e51e42c81cc8e04ed9d58300__getParCov_Ci4L</span></span>
<span><span class="co">#&gt; #define _rxode2_rxAssignPtr _rxf2338020723e51e42c81cc8e04ed9d58301__rxode2_rxAssignPtr_pGZK</span></span>
<span><span class="co">#&gt; #define _rxQr _rxf2338020723e51e42c81cc8e04ed9d58302__rxQr_aBwX</span></span>
<span><span class="co">#&gt; #define _compareFactorVal _rxf2338020723e51e42c81cc8e04ed9d58303__compareFactorVal_XHRN</span></span>
<span><span class="co">#&gt; #define _sum _rxf2338020723e51e42c81cc8e04ed9d58304__sum_1SO1</span></span>
<span><span class="co">#&gt; #define _udf _rxf2338020723e51e42c81cc8e04ed9d58305__udf_NYrN</span></span>
<span><span class="co">#&gt; #define _sign _rxf2338020723e51e42c81cc8e04ed9d58306__sign_WbGH</span></span>
<span><span class="co">#&gt; #define _prod _rxf2338020723e51e42c81cc8e04ed9d58307__prod_TvOD</span></span>
<span><span class="co">#&gt; #define _max _rxf2338020723e51e42c81cc8e04ed9d58308__max_f3z9</span></span>
<span><span class="co">#&gt; #define _min _rxf2338020723e51e42c81cc8e04ed9d58309__min_WqiE</span></span>
<span><span class="co">#&gt; #define _transit4P _rxf2338020723e51e42c81cc8e04ed9d58310__transit4P_Xp1T</span></span>
<span><span class="co">#&gt; #define _transit3P _rxf2338020723e51e42c81cc8e04ed9d58311__transit3P_noPD</span></span>
<span><span class="co">#&gt; #define _assignFuns0 _rxf2338020723e51e42c81cc8e04ed9d58312__assignFuns0_PfVe</span></span>
<span><span class="co">#&gt; #define _assignFuns _rxf2338020723e51e42c81cc8e04ed9d58313__assignFuns_Vphs</span></span>
<span><span class="co">#&gt; #define _rxord _rxf2338020723e51e42c81cc8e04ed9d58314__rxord_0tzV</span></span>
<span><span class="co">#&gt; #define __assignFuns2 _rxf2338020723e51e42c81cc8e04ed9d58315___assignFuns2_Mmad</span></span>
<span><span class="co">#&gt; #define _llikCauchyDscale _rxf2338020723e51e42c81cc8e04ed9d58316__llikCauchyDscale_rZFu</span></span>
<span><span class="co">#&gt; #define _llikCauchyDlocation _rxf2338020723e51e42c81cc8e04ed9d58317__llikCauchyDlocation_rFOl</span></span>
<span><span class="co">#&gt; #define _llikCauchy _rxf2338020723e51e42c81cc8e04ed9d58318__llikCauchy_7CAf</span></span>
<span><span class="co">#&gt; #define _llikGammaDrate _rxf2338020723e51e42c81cc8e04ed9d58319__llikGammaDrate_rvYZ</span></span>
<span><span class="co">#&gt; #define _llikGammaDshape _rxf2338020723e51e42c81cc8e04ed9d58320__llikGammaDshape_gF2u</span></span>
<span><span class="co">#&gt; #define _llikGamma _rxf2338020723e51e42c81cc8e04ed9d58321__llikGamma_4zbA</span></span>
<span><span class="co">#&gt; #define _llikWeibullDscale _rxf2338020723e51e42c81cc8e04ed9d58322__llikWeibullDscale_u2aE</span></span>
<span><span class="co">#&gt; #define _llikWeibullDshape _rxf2338020723e51e42c81cc8e04ed9d58323__llikWeibullDshape_uohD</span></span>
<span><span class="co">#&gt; #define _llikWeibull _rxf2338020723e51e42c81cc8e04ed9d58324__llikWeibull_jDSK</span></span>
<span><span class="co">#&gt; #define _llikUnifDbeta _rxf2338020723e51e42c81cc8e04ed9d58325__llikUnifDbeta_ZFSu</span></span>
<span><span class="co">#&gt; #define _llikUnifDalpha _rxf2338020723e51e42c81cc8e04ed9d58326__llikUnifDalpha_yota</span></span>
<span><span class="co">#&gt; #define _llikUnif _rxf2338020723e51e42c81cc8e04ed9d58327__llikUnif_lziD</span></span>
<span><span class="co">#&gt; #define _llikGeomDp _rxf2338020723e51e42c81cc8e04ed9d58328__llikGeomDp_IirE</span></span>
<span><span class="co">#&gt; #define _llikGeom _rxf2338020723e51e42c81cc8e04ed9d58329__llikGeom_0wRk</span></span>
<span><span class="co">#&gt; #define _llikFDdf2 _rxf2338020723e51e42c81cc8e04ed9d58330__llikFDdf2_fPLj</span></span>
<span><span class="co">#&gt; #define _llikFDdf1 _rxf2338020723e51e42c81cc8e04ed9d58331__llikFDdf1_f5r4</span></span>
<span><span class="co">#&gt; #define _llikF _rxf2338020723e51e42c81cc8e04ed9d58332__llikF_q6UF</span></span>
<span><span class="co">#&gt; #define _llikExpDrate _rxf2338020723e51e42c81cc8e04ed9d58333__llikExpDrate_gAxJ</span></span>
<span><span class="co">#&gt; #define _llikExp _rxf2338020723e51e42c81cc8e04ed9d58334__llikExp_Mtp6</span></span>
<span><span class="co">#&gt; #define _llikChisqDdf _rxf2338020723e51e42c81cc8e04ed9d58335__llikChisqDdf_ulNz</span></span>
<span><span class="co">#&gt; #define _llikChisq _rxf2338020723e51e42c81cc8e04ed9d58336__llikChisq_LwD1</span></span>
<span><span class="co">#&gt; #define _llikTDsd _rxf2338020723e51e42c81cc8e04ed9d58337__llikTDsd_9qDD</span></span>
<span><span class="co">#&gt; #define _llikTDmean _rxf2338020723e51e42c81cc8e04ed9d58338__llikTDmean_2wFm</span></span>
<span><span class="co">#&gt; #define _llikTDdf _rxf2338020723e51e42c81cc8e04ed9d58339__llikTDdf_HsIy</span></span>
<span><span class="co">#&gt; #define _llikT _rxf2338020723e51e42c81cc8e04ed9d58340__llikT_alpl</span></span>
<span><span class="co">#&gt; #define _llikBetaDshape2 _rxf2338020723e51e42c81cc8e04ed9d58341__llikBetaDshape2_P85e</span></span>
<span><span class="co">#&gt; #define _llikBetaDshape1 _rxf2338020723e51e42c81cc8e04ed9d58342__llikBetaDshape1_beKy</span></span>
<span><span class="co">#&gt; #define _llikBeta _rxf2338020723e51e42c81cc8e04ed9d58343__llikBeta_isyD</span></span>
<span><span class="co">#&gt; #define _llikNbinomMuDmu _rxf2338020723e51e42c81cc8e04ed9d58344__llikNbinomMuDmu_fO2c</span></span>
<span><span class="co">#&gt; #define _llikNbinomMu _rxf2338020723e51e42c81cc8e04ed9d58345__llikNbinomMu_bPrW</span></span>
<span><span class="co">#&gt; #define _llikNbinomDprob _rxf2338020723e51e42c81cc8e04ed9d58346__llikNbinomDprob_y1fN</span></span>
<span><span class="co">#&gt; #define _llikNbinom _rxf2338020723e51e42c81cc8e04ed9d58347__llikNbinom_ugfk</span></span>
<span><span class="co">#&gt; #define _llikBinomDprob _rxf2338020723e51e42c81cc8e04ed9d58348__llikBinomDprob_XEVP</span></span>
<span><span class="co">#&gt; #define _llikBinom _rxf2338020723e51e42c81cc8e04ed9d58349__llikBinom_jdOx</span></span>
<span><span class="co">#&gt; #define _llikPoisDlambda _rxf2338020723e51e42c81cc8e04ed9d58350__llikPoisDlambda_I3ZD</span></span>
<span><span class="co">#&gt; #define _llikPois _rxf2338020723e51e42c81cc8e04ed9d58351__llikPois_7wnk</span></span>
<span><span class="co">#&gt; #define _llikNormDsd _rxf2338020723e51e42c81cc8e04ed9d58352__llikNormDsd_XX5O</span></span>
<span><span class="co">#&gt; #define _llikNormDmean _rxf2338020723e51e42c81cc8e04ed9d58353__llikNormDmean_Agfw</span></span>
<span><span class="co">#&gt; #define _llikNorm _rxf2338020723e51e42c81cc8e04ed9d58354__llikNorm_CyNe</span></span>
<span><span class="co">#&gt; #define simeps _rxf2338020723e51e42c81cc8e04ed9d58355_simeps_o4Wl</span></span>
<span><span class="co">#&gt; #define simeta _rxf2338020723e51e42c81cc8e04ed9d58356_simeta_QYC1</span></span>
<span><span class="co">#&gt; #define expit _rxf2338020723e51e42c81cc8e04ed9d58357_expit_yBms</span></span>
<span><span class="co">#&gt; #define logit _rxf2338020723e51e42c81cc8e04ed9d58358_logit_pbu2</span></span>
<span><span class="co">#&gt; #define gammapDer _rxf2338020723e51e42c81cc8e04ed9d58359_gammapDer_85hP</span></span>
<span><span class="co">#&gt; #define lowergamma _rxf2338020723e51e42c81cc8e04ed9d58360_lowergamma_47wD</span></span>
<span><span class="co">#&gt; #define uppergamma _rxf2338020723e51e42c81cc8e04ed9d58361_uppergamma_fCYp</span></span>
<span><span class="co">#&gt; #define gammaqInva _rxf2338020723e51e42c81cc8e04ed9d58362_gammaqInva_7GH0</span></span>
<span><span class="co">#&gt; #define gammaqInv _rxf2338020723e51e42c81cc8e04ed9d58363_gammaqInv_qPki</span></span>
<span><span class="co">#&gt; #define gammapInva _rxf2338020723e51e42c81cc8e04ed9d58364_gammapInva_VyMA</span></span>
<span><span class="co">#&gt; #define gammapInv _rxf2338020723e51e42c81cc8e04ed9d58365_gammapInv_m1mA</span></span>
<span><span class="co">#&gt; #define gammaq _rxf2338020723e51e42c81cc8e04ed9d58366_gammaq_1mpx</span></span>
<span><span class="co">#&gt; #define gammap _rxf2338020723e51e42c81cc8e04ed9d58367_gammap_NAbn</span></span>
<span><span class="co">#&gt; #define phi _rxf2338020723e51e42c81cc8e04ed9d58368_phi_2jD0</span></span>
<span><span class="co">#&gt; #define d2ELUa _rxf2338020723e51e42c81cc8e04ed9d58369_d2ELUa_7gdK</span></span>
<span><span class="co">#&gt; #define dELUa _rxf2338020723e51e42c81cc8e04ed9d58370_dELUa_Ohhv</span></span>
<span><span class="co">#&gt; #define d2aELU _rxf2338020723e51e42c81cc8e04ed9d58371_d2aELU_SaAZ</span></span>
<span><span class="co">#&gt; #define d2ELU _rxf2338020723e51e42c81cc8e04ed9d58372_d2ELU_tapa</span></span>
<span><span class="co">#&gt; #define dELU _rxf2338020723e51e42c81cc8e04ed9d58373_dELU_mOqj</span></span>
<span><span class="co">#&gt; #define ELU _rxf2338020723e51e42c81cc8e04ed9d58374_ELU_J66n</span></span>
<span><span class="co">#&gt; #define dPReLUa1 _rxf2338020723e51e42c81cc8e04ed9d58375_dPReLUa1_N3zb</span></span>
<span><span class="co">#&gt; #define dPReLUa _rxf2338020723e51e42c81cc8e04ed9d58376_dPReLUa_9X7x</span></span>
<span><span class="co">#&gt; #define dPReLU _rxf2338020723e51e42c81cc8e04ed9d58377_dPReLU_2Awy</span></span>
<span><span class="co">#&gt; #define PReLU _rxf2338020723e51e42c81cc8e04ed9d58378_PReLU_isy2</span></span>
<span><span class="co">#&gt; #define dSwish _rxf2338020723e51e42c81cc8e04ed9d58379_dSwish_RdzJ</span></span>
<span><span class="co">#&gt; #define Swish _rxf2338020723e51e42c81cc8e04ed9d58380_Swish_rXsV</span></span>
<span><span class="co">#&gt; #define dlReLU _rxf2338020723e51e42c81cc8e04ed9d58381_dlReLU_rrL0</span></span>
<span><span class="co">#&gt; #define lReLU _rxf2338020723e51e42c81cc8e04ed9d58382_lReLU_CwHs</span></span>
<span><span class="co">#&gt; #define dSELU _rxf2338020723e51e42c81cc8e04ed9d58383_dSELU_x0YD</span></span>
<span><span class="co">#&gt; #define SELU _rxf2338020723e51e42c81cc8e04ed9d58384_SELU_ejsN</span></span>
<span><span class="co">#&gt; #define d4softplus _rxf2338020723e51e42c81cc8e04ed9d58385_d4softplus_tqj2</span></span>
<span><span class="co">#&gt; #define d3softplus _rxf2338020723e51e42c81cc8e04ed9d58386_d3softplus_KkuC</span></span>
<span><span class="co">#&gt; #define d2softplus _rxf2338020723e51e42c81cc8e04ed9d58387_d2softplus_TNOD</span></span>
<span><span class="co">#&gt; #define dsoftplus _rxf2338020723e51e42c81cc8e04ed9d58388_dsoftplus_0MWq</span></span>
<span><span class="co">#&gt; #define softplus _rxf2338020723e51e42c81cc8e04ed9d58389_softplus_8NGU</span></span>
<span><span class="co">#&gt; #define d4GELU _rxf2338020723e51e42c81cc8e04ed9d58390_d4GELU_15zw</span></span>
<span><span class="co">#&gt; #define d3GELU _rxf2338020723e51e42c81cc8e04ed9d58391_d3GELU_77MT</span></span>
<span><span class="co">#&gt; #define d2GELU _rxf2338020723e51e42c81cc8e04ed9d58392_d2GELU_mU6w</span></span>
<span><span class="co">#&gt; #define dGELU _rxf2338020723e51e42c81cc8e04ed9d58393_dGELU_hVWG</span></span>
<span><span class="co">#&gt; #define GELU _rxf2338020723e51e42c81cc8e04ed9d58394_GELU_iyen</span></span>
<span><span class="co">#&gt; #define dReLU _rxf2338020723e51e42c81cc8e04ed9d58395_dReLU_4spi</span></span>
<span><span class="co">#&gt; #define ReLU _rxf2338020723e51e42c81cc8e04ed9d58396_ReLU_MWT6</span></span>
<span><span class="co">#&gt; #define riweibull _rxf2338020723e51e42c81cc8e04ed9d58397_riweibull_VRYe</span></span>
<span><span class="co">#&gt; #define riunif _rxf2338020723e51e42c81cc8e04ed9d58398_riunif_9Ita</span></span>
<span><span class="co">#&gt; #define rit_ _rxf2338020723e51e42c81cc8e04ed9d58399_rit__dGJL</span></span>
<span><span class="co">#&gt; #define ripois _rxf2338020723e51e42c81cc8e04ed9d58400_ripois_l03G</span></span>
<span><span class="co">#&gt; #define ribeta _rxf2338020723e51e42c81cc8e04ed9d58401_ribeta_aI5l</span></span>
<span><span class="co">#&gt; #define rigamma _rxf2338020723e51e42c81cc8e04ed9d58402_rigamma_lO3k</span></span>
<span><span class="co">#&gt; #define rigeom _rxf2338020723e51e42c81cc8e04ed9d58403_rigeom_WHGX</span></span>
<span><span class="co">#&gt; #define rif _rxf2338020723e51e42c81cc8e04ed9d58404_rif_CdkG</span></span>
<span><span class="co">#&gt; #define riexp _rxf2338020723e51e42c81cc8e04ed9d58405_riexp_sq2N</span></span>
<span><span class="co">#&gt; #define richisq _rxf2338020723e51e42c81cc8e04ed9d58406_richisq_BvuB</span></span>
<span><span class="co">#&gt; #define ricauchy _rxf2338020723e51e42c81cc8e04ed9d58407_ricauchy_r0sO</span></span>
<span><span class="co">#&gt; #define rinbinomMu _rxf2338020723e51e42c81cc8e04ed9d58408_rinbinomMu_4eup</span></span>
<span><span class="co">#&gt; #define rinbinom _rxf2338020723e51e42c81cc8e04ed9d58409_rinbinom_VbTs</span></span>
<span><span class="co">#&gt; #define ribinom _rxf2338020723e51e42c81cc8e04ed9d58410_ribinom_fOYF</span></span>
<span><span class="co">#&gt; #define rinorm _rxf2338020723e51e42c81cc8e04ed9d58411_rinorm_C4Jz</span></span>
<span><span class="co">#&gt; #define rxweibull _rxf2338020723e51e42c81cc8e04ed9d58412_rxweibull_7iE8</span></span>
<span><span class="co">#&gt; #define rxunif _rxf2338020723e51e42c81cc8e04ed9d58413_rxunif_vtCF</span></span>
<span><span class="co">#&gt; #define rxt_ _rxf2338020723e51e42c81cc8e04ed9d58414_rxt__cRJ6</span></span>
<span><span class="co">#&gt; #define rxpois _rxf2338020723e51e42c81cc8e04ed9d58415_rxpois_Gev1</span></span>
<span><span class="co">#&gt; #define rxbeta _rxf2338020723e51e42c81cc8e04ed9d58416_rxbeta_Yq4C</span></span>
<span><span class="co">#&gt; #define rxgamma _rxf2338020723e51e42c81cc8e04ed9d58417_rxgamma_UGPR</span></span>
<span><span class="co">#&gt; #define rxgeom _rxf2338020723e51e42c81cc8e04ed9d58418_rxgeom_B41j</span></span>
<span><span class="co">#&gt; #define rxf _rxf2338020723e51e42c81cc8e04ed9d58419_rxf_yXA3</span></span>
<span><span class="co">#&gt; #define rxexp _rxf2338020723e51e42c81cc8e04ed9d58420_rxexp_Scak</span></span>
<span><span class="co">#&gt; #define rxchisq _rxf2338020723e51e42c81cc8e04ed9d58421_rxchisq_WU0x</span></span>
<span><span class="co">#&gt; #define rxcauchy _rxf2338020723e51e42c81cc8e04ed9d58422_rxcauchy_SyXM</span></span>
<span><span class="co">#&gt; #define rxnbinomMu _rxf2338020723e51e42c81cc8e04ed9d58423_rxnbinomMu_V4ye</span></span>
<span><span class="co">#&gt; #define rxnbinom _rxf2338020723e51e42c81cc8e04ed9d58424_rxnbinom_zXlY</span></span>
<span><span class="co">#&gt; #define rxbinom _rxf2338020723e51e42c81cc8e04ed9d58425_rxbinom_mdNM</span></span>
<span><span class="co">#&gt; #define rxnorm _rxf2338020723e51e42c81cc8e04ed9d58426_rxnorm_qSBx</span></span>
<span><span class="co">#&gt; #define linCmtB _rxf2338020723e51e42c81cc8e04ed9d58427_linCmtB_i1cp</span></span>
<span><span class="co">#&gt; #define linCmtA _rxf2338020723e51e42c81cc8e04ed9d58428_linCmtA_dhrH</span></span>
<span><span class="co">#&gt; #include &lt;rxode2_model_shared.h&gt;</span></span>
<span><span class="co">#&gt; #define __MAX_PROD__ 0</span></span>
<span><span class="co">#&gt; #define _CMT CMT</span></span>
<span><span class="co">#&gt; #define _SYNC_simeps_ for (int _svari=_solveData-&gt;neps; _svari--;){  if (_solveData-&gt;svar[_svari] == 0) {TKA = _PP[0];};   if (_solveData-&gt;svar[_svari] == 1) {TCL = _PP[1];};   if (_solveData-&gt;svar[_svari] == 2) {TV2 = _PP[2];};   if (_solveData-&gt;svar[_svari] == 3) {TQ = _PP[3];};   if (_solveData-&gt;svar[_svari] == 4) {TV3 = _PP[4];};   if (_solveData-&gt;svar[_svari] == 5) {TKin = _PP[5];};   if (_solveData-&gt;svar[_svari] == 6) {TKout = _PP[6];};   if (_solveData-&gt;svar[_svari] == 7) {TEC50 = _PP[7];};   if (_solveData-&gt;svar[_svari] == 8) {c2_DoT_prop_DoT_sd = _PP[8];};   if (_solveData-&gt;svar[_svari] == 9) {eff_DoT_add_DoT_sd = _PP[9];};   if (_solveData-&gt;svar[_svari] == 10) {eta_DoT_cl = _PP[10];};   if (_solveData-&gt;svar[_svari] == 11) {eta_DoT_v = _PP[11];};   if (_solveData-&gt;svar[_svari] == 12) {rxerr_DoT_C2 = _PP[12];};   if (_solveData-&gt;svar[_svari] == 13) {rxerr_DoT_eff = _PP[13];};   if (_solveData-&gt;svar[_svari] == 14) {CMT = _PP[14];}; }</span></span>
<span><span class="co">#&gt; #define _SYNC_simeta_ for (int _ovari=_solveData-&gt;neta; _ovari--;){  if (_solveData-&gt;ovar[_ovari] == 0) {TKA = _PP[0];};   if (_solveData-&gt;ovar[_ovari] == 1) {TCL = _PP[1];};   if (_solveData-&gt;ovar[_ovari] == 2) {TV2 = _PP[2];};   if (_solveData-&gt;ovar[_ovari] == 3) {TQ = _PP[3];};   if (_solveData-&gt;ovar[_ovari] == 4) {TV3 = _PP[4];};   if (_solveData-&gt;ovar[_ovari] == 5) {TKin = _PP[5];};   if (_solveData-&gt;ovar[_ovari] == 6) {TKout = _PP[6];};   if (_solveData-&gt;ovar[_ovari] == 7) {TEC50 = _PP[7];};   if (_solveData-&gt;ovar[_ovari] == 8) {c2_DoT_prop_DoT_sd = _PP[8];};   if (_solveData-&gt;ovar[_ovari] == 9) {eff_DoT_add_DoT_sd = _PP[9];};   if (_solveData-&gt;ovar[_ovari] == 10) {eta_DoT_cl = _PP[10];};   if (_solveData-&gt;ovar[_ovari] == 11) {eta_DoT_v = _PP[11];};   if (_solveData-&gt;ovar[_ovari] == 12) {rxerr_DoT_C2 = _PP[12];};   if (_solveData-&gt;ovar[_ovari] == 13) {rxerr_DoT_eff = _PP[13];};   if (_solveData-&gt;ovar[_ovari] == 14) {CMT = _PP[14];}; }</span></span>
<span><span class="co">#&gt; _getRxSolve_t _getRxSolve_;</span></span>
<span><span class="co">#&gt; _simfun simeps;</span></span>
<span><span class="co">#&gt; _simfun simeta;</span></span>
<span><span class="co">#&gt; _udf_type _evalUdf=NULL;</span></span>
<span><span class="co">#&gt; rx_solve *_solveData=NULL;</span></span>
<span><span class="co">#&gt; rxode2_assign_ptr _assign_ptr=NULL;</span></span>
<span><span class="co">#&gt; _rxRmModelLibType _rxRmModelLib=NULL;</span></span>
<span><span class="co">#&gt; _rxGetModelLibType _rxGetModelLib=NULL;</span></span>
<span><span class="co">#&gt; rxode2_ode_solver_old_c _old_c=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _ptrid=NULL;</span></span>
<span><span class="co">#&gt; _rxIsCurrentC_type _rxIsCurrentC=NULL;</span></span>
<span><span class="co">#&gt; _rxSumType _sumPS=NULL;</span></span>
<span><span class="co">#&gt; _rxProdType _prodPS=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _prodType=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _sumType=NULL;</span></span>
<span><span class="co">#&gt; _update_par_ptr_p _update_par_ptr=NULL;</span></span>
<span><span class="co">#&gt; _getParCov_p _getParCov=NULL;</span></span>
<span><span class="co">#&gt; linCmtA_p linCmtA;</span></span>
<span><span class="co">#&gt; linCmtB_p linCmtB;</span></span>
<span><span class="co">#&gt; _rx_asgn _rxode2_rxAssignPtr=NULL;</span></span>
<span><span class="co">#&gt; _rx_asgn _rxQr=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn phi;</span></span>
<span><span class="co">#&gt; rxode2_fn ReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn dReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn dGELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d2GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d3GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d4GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn dsoftplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d2softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d3softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d4softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn SELU;</span></span>
<span><span class="co">#&gt; rxode2_fn dSELU;</span></span>
<span><span class="co">#&gt; rxode2_fn lReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn dlReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn Swish;</span></span>
<span><span class="co">#&gt; rxode2_fn dSwish;</span></span>
<span><span class="co">#&gt; rxode2_fn2 PReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLUa;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLUa1;</span></span>
<span><span class="co">#&gt; rxode2_fn2 ELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2ELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2aELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dELUa;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2ELUa;</span></span>
<span><span class="co">#&gt; rxode2_fn3 logit;</span></span>
<span><span class="co">#&gt; rxode2_fn3 expit;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammap;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaq;</span></span>
<span><span class="co">#&gt; rxode2_fn2 lowergamma;</span></span>
<span><span class="co">#&gt; rxode2_fn2 uppergamma;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapInv;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapDer;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapInva;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaqInv;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaqInva;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxnorm;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxbinom;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxnbinom;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxnbinomMu;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxcauchy;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxchisq;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxexp;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxf;</span></span>
<span><span class="co">#&gt; rxode2i_ifn rxgeom;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxgamma;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxbeta;</span></span>
<span><span class="co">#&gt; rxode2i_ifn rxpois;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxt_;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxunif;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxweibull;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rinorm;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom ribinom;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom rinbinom;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom rinbinomMu;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 ricauchy;</span></span>
<span><span class="co">#&gt; rxode2i2_fn richisq;</span></span>
<span><span class="co">#&gt; rxode2i2_fn riexp;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rif;</span></span>
<span><span class="co">#&gt; rxode2i2_ifn rigeom;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rigamma;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 ribeta;</span></span>
<span><span class="co">#&gt; rxode2i2_ifn ripois;</span></span>
<span><span class="co">#&gt; rxode2i2_fn rit_;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 riunif;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 riweibull;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNorm;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNormDmean;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNormDsd;</span></span>
<span><span class="co">#&gt; rxode2_llikPoisFun _llikPois;</span></span>
<span><span class="co">#&gt; rxode2_llikPoisFun _llikPoisDlambda;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikBinom;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikBinomDprob;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinom;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomDprob;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomMu;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomMuDmu;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBeta;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBetaDshape1;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBetaDshape2;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikT;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDdf;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDmean;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDsd;</span></span>
<span><span class="co">#&gt; rxode2_llikChisqFun _llikChisq;</span></span>
<span><span class="co">#&gt; rxode2_llikChisqFun _llikChisqDdf;</span></span>
<span><span class="co">#&gt; rxode2_llikExpFun _llikExp;</span></span>
<span><span class="co">#&gt; rxode2_llikExpFun _llikExpDrate;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikF;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikFDdf1;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikFDdf2;</span></span>
<span><span class="co">#&gt; rxode2_llikGeomFun _llikGeom;</span></span>
<span><span class="co">#&gt; rxode2_llikGeomFun _llikGeomDp;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnif;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnifDalpha;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnifDbeta;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibull;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibullDshape;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibullDscale;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGamma;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGammaDshape;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGammaDrate;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchy;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchyDlocation;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchyDscale;</span></span>
<span><span class="co">#&gt; rxode2_compareFactorVal_fn _compareFactorVal;</span></span>
<span><span class="co">#&gt; #include "extraC.h"</span></span>
<span><span class="co">#&gt; double _prod(double *input, double *p, int type, int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return _prodPS(input, p, n, type);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _udf(const char *funName, double *input, int n, ...) {</span></span>
<span><span class="co">#&gt;   if (n == -42) Rf_error("%s", "this has a ui user function that cannot be called directly");</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return _evalUdf(funName, n, input);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _sum(double *input, double *pld, int m, int type, int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   double ret = _sumPS(input, n, pld, m, type);</span></span>
<span><span class="co">#&gt;   if (type == 2 &amp;&amp; m &lt; 0){</span></span>
<span><span class="co">#&gt;     for (int i = -m; i--;){</span></span>
<span><span class="co">#&gt;       pld[i] = 0.0;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return ret;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _sign(unsigned int n, ...) {</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double s = 1;</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;     s = sign(va_arg(valist, double))*s;</span></span>
<span><span class="co">#&gt;     if (s == 0){</span></span>
<span><span class="co">#&gt;       break;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return s;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _rxord(int _cSub, unsigned int n,  ...) {</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind* ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   if (!ind-&gt;inLhs) {</span></span>
<span><span class="co">#&gt;     return 1.0;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double ret = 1.0;</span></span>
<span><span class="co">#&gt;   double p = 0.0;</span></span>
<span><span class="co">#&gt;   double u = rxunif(ind, 0.0, 1.0);</span></span>
<span><span class="co">#&gt;   int found = 0;</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;     p += va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     if (!found) {</span></span>
<span><span class="co">#&gt;       if (u &lt; p) {</span></span>
<span><span class="co">#&gt;         ret = (double)(i+1);</span></span>
<span><span class="co">#&gt;         found = 1;</span></span>
<span><span class="co">#&gt;       }</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   if (!found) ret =(double)(n+1);</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return ret;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _max(unsigned int n, ...) {</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double mx = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tmp = 0;</span></span>
<span><span class="co">#&gt;   if (n &gt;= 1){</span></span>
<span><span class="co">#&gt;     mx = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     for (unsigned int i = 1; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;       tmp = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;       if (tmp&gt;mx) mx=tmp;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     va_end(valist);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return mx;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _min(unsigned int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double mn = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tmp = 0;</span></span>
<span><span class="co">#&gt;   if (n &gt;= 1){</span></span>
<span><span class="co">#&gt;     mn = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     for (unsigned int i = 1; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;       tmp = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;       if (tmp&lt;mn) mn=tmp;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     va_end(valist);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return mn;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _transit4P(int cmt, double t, unsigned int id, double n, double mtt, double bio){</span></span>
<span><span class="co">#&gt;   double nd = (double) n;</span></span>
<span><span class="co">#&gt;   double ktr = (nd+1)/mtt;</span></span>
<span><span class="co">#&gt;   double lktr = _safe_log(nd+1)-_safe_log(mtt);</span></span>
<span><span class="co">#&gt;   double tlast = _solveData-&gt;subjects[id].tlastS[cmt];</span></span>
<span><span class="co">#&gt;   double dose = _solveData-&gt;subjects[id].curDoseS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(dose)) dose = 0.0;</span></span>
<span><span class="co">#&gt;   if (ISNA(tlast)) tlast = 0.0;</span></span>
<span><span class="co">#&gt;   double tad = (t-tlast);</span></span>
<span><span class="co">#&gt;   return exp(_safe_log(bio*dose)+lktr+n*(lktr+_safe_log(tad))-ktr*(tad)-lgamma1p(nd));</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _transit3P(int cmt, double t, unsigned int id, double n, double mtt){</span></span>
<span><span class="co">#&gt;   double nd = (double) n;</span></span>
<span><span class="co">#&gt;   double ktr = (nd+1)/mtt;</span></span>
<span><span class="co">#&gt;   double lktr = _safe_log(nd+1)-_safe_log(mtt);</span></span>
<span><span class="co">#&gt;   double tlast = _solveData-&gt;subjects[id].tlastS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(tlast)) tlast = 0.0;</span></span>
<span><span class="co">#&gt;   double tad = t-tlast;</span></span>
<span><span class="co">#&gt;   double podo = _solveData-&gt;subjects[id].curDoseS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(podo)) podo = 0.0;</span></span>
<span><span class="co">#&gt;   return exp(_safe_log(podo)+lktr+n*(lktr+_safe_log(tad))-ktr*(tad)-lgamma1p(nd));</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void _assignFuns0(void) {</span></span>
<span><span class="co">#&gt;   _evalUdf = (_udf_type) R_GetCCallable("rxode2", "_rxode2_evalUdf");</span></span>
<span><span class="co">#&gt;   _getRxSolve_ = (_getRxSolve_t) R_GetCCallable("rxode2","getRxSolve_");</span></span>
<span><span class="co">#&gt;   _assign_ptr=(rxode2_assign_ptr) R_GetCCallable("rxode2","rxode2_assign_fn_pointers");</span></span>
<span><span class="co">#&gt;   _rxRmModelLib=(_rxRmModelLibType) R_GetCCallable("rxode2","rxRmModelLib");</span></span>
<span><span class="co">#&gt;   _rxGetModelLib=(_rxGetModelLibType) R_GetCCallable("rxode2","rxGetModelLib");</span></span>
<span><span class="co">#&gt;   _rxode2_rxAssignPtr=(_rx_asgn)R_GetCCallable("rxode2","_rxode2_rxAssignPtr");</span></span>
<span><span class="co">#&gt;   _rxQr=(_rx_asgn)R_GetCCallable("rxode2","_rxode2_rxQr");</span></span>
<span><span class="co">#&gt;   _rxIsCurrentC = (_rxIsCurrentC_type)R_GetCCallable("rxode2","rxIsCurrentC");</span></span>
<span><span class="co">#&gt;   _sumPS  = (_rxSumType) R_GetCCallable("PreciseSums","PreciseSums_sum_r");</span></span>
<span><span class="co">#&gt;   _prodPS = (_rxProdType) R_GetCCallable("PreciseSums","PreciseSums_prod_r");</span></span>
<span><span class="co">#&gt;   _prodType=(rxode2_fn0i)R_GetCCallable("PreciseSums", "PreciseSums_prod_get");</span></span>
<span><span class="co">#&gt;   _sumType=(rxode2_fn0i)R_GetCCallable("PreciseSums", "PreciseSums_sum_get");</span></span>
<span><span class="co">#&gt;   _ptrid=(rxode2_fn0i)R_GetCCallable("rxode2", "rxode2_current_fn_pointer_id");</span></span>
<span><span class="co">#&gt;   _compareFactorVal=(rxode2_compareFactorVal_fn) R_GetCCallable("rxode2", "compareFactorVal");</span></span>
<span><span class="co">#&gt;   _update_par_ptr = (_update_par_ptr_p) R_GetCCallable("rxode2","_update_par_ptr");</span></span>
<span><span class="co">#&gt;   _getParCov = (_getParCov_p) R_GetCCallable("rxode2","_getParCov");</span></span>
<span><span class="co">#&gt;   // dynamic start</span></span>
<span><span class="co">#&gt;   _llikCauchyDscale = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchyDscale");</span></span>
<span><span class="co">#&gt;   _llikCauchyDlocation = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchyDlocation");</span></span>
<span><span class="co">#&gt;   _llikCauchy = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchy");</span></span>
<span><span class="co">#&gt;   _llikGammaDrate = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGammaDrate");</span></span>
<span><span class="co">#&gt;   _llikGammaDshape = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGammaDshape");</span></span>
<span><span class="co">#&gt;   _llikGamma = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGamma");</span></span>
<span><span class="co">#&gt;   _llikWeibullDscale = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibullDscale");</span></span>
<span><span class="co">#&gt;   _llikWeibullDshape = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibullDshape");</span></span>
<span><span class="co">#&gt;   _llikWeibull = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibull");</span></span>
<span><span class="co">#&gt;   _llikUnifDbeta = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnifDbeta");</span></span>
<span><span class="co">#&gt;   _llikUnifDalpha = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnifDalpha");</span></span>
<span><span class="co">#&gt;   _llikUnif = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnif");</span></span>
<span><span class="co">#&gt;   _llikGeomDp = (rxode2_llikGeomFun) R_GetCCallable("rxode2ll", "rxLlikGeomDp");</span></span>
<span><span class="co">#&gt;   _llikGeom = (rxode2_llikGeomFun) R_GetCCallable("rxode2ll", "rxLlikGeom");</span></span>
<span><span class="co">#&gt;   _llikFDdf2 = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikFDdf2");</span></span>
<span><span class="co">#&gt;   _llikFDdf1 = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikFDdf1");</span></span>
<span><span class="co">#&gt;   _llikF = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikF");</span></span>
<span><span class="co">#&gt;   _llikExpDrate = (rxode2_llikExpFun) R_GetCCallable("rxode2ll", "rxLlikExpDrate");</span></span>
<span><span class="co">#&gt;   _llikExp = (rxode2_llikExpFun) R_GetCCallable("rxode2ll", "rxLlikExp");</span></span>
<span><span class="co">#&gt;   _llikChisqDdf = (rxode2_llikChisqFun) R_GetCCallable("rxode2ll", "rxLlikChisqDdf");</span></span>
<span><span class="co">#&gt;   _llikChisq = (rxode2_llikChisqFun) R_GetCCallable("rxode2ll", "rxLlikChisq");</span></span>
<span><span class="co">#&gt;   _llikTDsd = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDsd");</span></span>
<span><span class="co">#&gt;   _llikTDmean = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDmean");</span></span>
<span><span class="co">#&gt;   _llikTDdf = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDdf");</span></span>
<span><span class="co">#&gt;   _llikT = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikT");</span></span>
<span><span class="co">#&gt;   _llikBetaDshape2 = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBetaDshape2");</span></span>
<span><span class="co">#&gt;   _llikBetaDshape1 = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBetaDshape1");</span></span>
<span><span class="co">#&gt;   _llikBeta = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBeta");</span></span>
<span><span class="co">#&gt;   _llikNbinomMuDmu = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomMuDmu");</span></span>
<span><span class="co">#&gt;   _llikNbinomMu = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomMu");</span></span>
<span><span class="co">#&gt;   _llikNbinomDprob = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomDprob");</span></span>
<span><span class="co">#&gt;   _llikNbinom = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinom");</span></span>
<span><span class="co">#&gt;   _llikBinomDprob = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikBinomDprob");</span></span>
<span><span class="co">#&gt;   _llikBinom = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikBinom");</span></span>
<span><span class="co">#&gt;   _llikPoisDlambda = (rxode2_llikPoisFun) R_GetCCallable("rxode2ll", "rxLlikPoisDlambda");</span></span>
<span><span class="co">#&gt;   _llikPois = (rxode2_llikPoisFun) R_GetCCallable("rxode2ll", "rxLlikPois");</span></span>
<span><span class="co">#&gt;   _llikNormDsd = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNormDsd");</span></span>
<span><span class="co">#&gt;   _llikNormDmean = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNormDmean");</span></span>
<span><span class="co">#&gt;   _llikNorm = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNorm");</span></span>
<span><span class="co">#&gt;   simeps = (_simfun) R_GetCCallable("rxode2", "simeps");</span></span>
<span><span class="co">#&gt;   simeta = (_simfun) R_GetCCallable("rxode2", "simeta");</span></span>
<span><span class="co">#&gt;   expit = (rxode2_fn3) R_GetCCallable("rxode2", "expit");</span></span>
<span><span class="co">#&gt;   logit = (rxode2_fn3) R_GetCCallable("rxode2", "logit");</span></span>
<span><span class="co">#&gt;   gammapDer = (rxode2_fn2) R_GetCCallable("rxode2", "gammapDer");</span></span>
<span><span class="co">#&gt;   lowergamma = (rxode2_fn2) R_GetCCallable("rxode2", "lowergamma");</span></span>
<span><span class="co">#&gt;   uppergamma = (rxode2_fn2) R_GetCCallable("rxode2", "uppergamma");</span></span>
<span><span class="co">#&gt;   gammaqInva = (rxode2_fn2) R_GetCCallable("rxode2", "gammaqInva");</span></span>
<span><span class="co">#&gt;   gammaqInv = (rxode2_fn2) R_GetCCallable("rxode2", "gammaqInv");</span></span>
<span><span class="co">#&gt;   gammapInva = (rxode2_fn2) R_GetCCallable("rxode2", "gammapInva");</span></span>
<span><span class="co">#&gt;   gammapInv = (rxode2_fn2) R_GetCCallable("rxode2", "gammapInv");</span></span>
<span><span class="co">#&gt;   gammaq = (rxode2_fn2) R_GetCCallable("rxode2", "gammaq");</span></span>
<span><span class="co">#&gt;   gammap = (rxode2_fn2) R_GetCCallable("rxode2", "gammap");</span></span>
<span><span class="co">#&gt;   phi = (rxode2_fn) R_GetCCallable("rxode2", "phi");</span></span>
<span><span class="co">#&gt;   d2ELUa = (rxode2_fn2) R_GetCCallable("rxode2", "d2ELUa");</span></span>
<span><span class="co">#&gt;   dELUa = (rxode2_fn2) R_GetCCallable("rxode2", "dELUa");</span></span>
<span><span class="co">#&gt;   d2aELU = (rxode2_fn2) R_GetCCallable("rxode2", "d2aELU");</span></span>
<span><span class="co">#&gt;   d2ELU = (rxode2_fn2) R_GetCCallable("rxode2", "d2ELU");</span></span>
<span><span class="co">#&gt;   dELU = (rxode2_fn2) R_GetCCallable("rxode2", "dELU");</span></span>
<span><span class="co">#&gt;   ELU = (rxode2_fn2) R_GetCCallable("rxode2", "ELU");</span></span>
<span><span class="co">#&gt;   dPReLUa1 = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLUa1");</span></span>
<span><span class="co">#&gt;   dPReLUa = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLUa");</span></span>
<span><span class="co">#&gt;   dPReLU = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLU");</span></span>
<span><span class="co">#&gt;   PReLU = (rxode2_fn2) R_GetCCallable("rxode2", "PReLU");</span></span>
<span><span class="co">#&gt;   dSwish = (rxode2_fn) R_GetCCallable("rxode2", "dSwish");</span></span>
<span><span class="co">#&gt;   Swish = (rxode2_fn) R_GetCCallable("rxode2", "Swish");</span></span>
<span><span class="co">#&gt;   dlReLU = (rxode2_fn) R_GetCCallable("rxode2", "dlReLU");</span></span>
<span><span class="co">#&gt;   lReLU = (rxode2_fn) R_GetCCallable("rxode2", "lReLU");</span></span>
<span><span class="co">#&gt;   dSELU = (rxode2_fn) R_GetCCallable("rxode2", "dSELU");</span></span>
<span><span class="co">#&gt;   SELU = (rxode2_fn) R_GetCCallable("rxode2", "SELU");</span></span>
<span><span class="co">#&gt;   d4softplus = (rxode2_fn) R_GetCCallable("rxode2", "d4softplus");</span></span>
<span><span class="co">#&gt;   d3softplus = (rxode2_fn) R_GetCCallable("rxode2", "d3softplus");</span></span>
<span><span class="co">#&gt;   d2softplus = (rxode2_fn) R_GetCCallable("rxode2", "d2softplus");</span></span>
<span><span class="co">#&gt;   dsoftplus = (rxode2_fn) R_GetCCallable("rxode2", "dsoftplus");</span></span>
<span><span class="co">#&gt;   softplus = (rxode2_fn) R_GetCCallable("rxode2", "softplus");</span></span>
<span><span class="co">#&gt;   d4GELU = (rxode2_fn) R_GetCCallable("rxode2", "d4GELU");</span></span>
<span><span class="co">#&gt;   d3GELU = (rxode2_fn) R_GetCCallable("rxode2", "d3GELU");</span></span>
<span><span class="co">#&gt;   d2GELU = (rxode2_fn) R_GetCCallable("rxode2", "d2GELU");</span></span>
<span><span class="co">#&gt;   dGELU = (rxode2_fn) R_GetCCallable("rxode2", "dGELU");</span></span>
<span><span class="co">#&gt;   GELU = (rxode2_fn) R_GetCCallable("rxode2", "GELU");</span></span>
<span><span class="co">#&gt;   dReLU = (rxode2_fn) R_GetCCallable("rxode2", "dReLU");</span></span>
<span><span class="co">#&gt;   ReLU = (rxode2_fn) R_GetCCallable("rxode2", "ReLU");</span></span>
<span><span class="co">#&gt;   riweibull = (rxode2i2_fn2) R_GetCCallable("rxode2", "riweibull");</span></span>
<span><span class="co">#&gt;   riunif = (rxode2i2_fn2) R_GetCCallable("rxode2", "riunif");</span></span>
<span><span class="co">#&gt;   rit_ = (rxode2i2_fn) R_GetCCallable("rxode2", "rit_");</span></span>
<span><span class="co">#&gt;   ripois = (rxode2i2_ifn) R_GetCCallable("rxode2", "ripois");</span></span>
<span><span class="co">#&gt;   ribeta = (rxode2i2_fn2) R_GetCCallable("rxode2", "ribeta");</span></span>
<span><span class="co">#&gt;   rigamma = (rxode2i2_fn2) R_GetCCallable("rxode2", "rigamma");</span></span>
<span><span class="co">#&gt;   rigeom = (rxode2i2_ifn) R_GetCCallable("rxode2", "rigeom");</span></span>
<span><span class="co">#&gt;   rif = (rxode2i2_fn2) R_GetCCallable("rxode2", "rif");</span></span>
<span><span class="co">#&gt;   riexp = (rxode2i2_fn) R_GetCCallable("rxode2", "riexp");</span></span>
<span><span class="co">#&gt;   richisq = (rxode2i2_fn) R_GetCCallable("rxode2", "richisq");</span></span>
<span><span class="co">#&gt;   ricauchy = (rxode2i2_fn2) R_GetCCallable("rxode2", "ricauchy");</span></span>
<span><span class="co">#&gt;   rinbinomMu = (rxode2i2_ribinom) R_GetCCallable("rxode2", "rinbinomMu");</span></span>
<span><span class="co">#&gt;   rinbinom = (rxode2i2_ribinom) R_GetCCallable("rxode2", "rinbinom");</span></span>
<span><span class="co">#&gt;   ribinom = (rxode2i2_ribinom) R_GetCCallable("rxode2", "ribinom");</span></span>
<span><span class="co">#&gt;   rinorm = (rxode2i2_fn2) R_GetCCallable("rxode2", "rinorm");</span></span>
<span><span class="co">#&gt;   rxweibull = (rxode2i_fn2) R_GetCCallable("rxode2", "rxweibull");</span></span>
<span><span class="co">#&gt;   rxunif = (rxode2i_fn2) R_GetCCallable("rxode2", "rxunif");</span></span>
<span><span class="co">#&gt;   rxt_ = (rxode2i_fn) R_GetCCallable("rxode2", "rxt_");</span></span>
<span><span class="co">#&gt;   rxpois = (rxode2i_ifn) R_GetCCallable("rxode2", "rxpois");</span></span>
<span><span class="co">#&gt;   rxbeta = (rxode2i_fn2) R_GetCCallable("rxode2", "rxbeta");</span></span>
<span><span class="co">#&gt;   rxgamma = (rxode2i_fn2) R_GetCCallable("rxode2", "rxgamma");</span></span>
<span><span class="co">#&gt;   rxgeom = (rxode2i_ifn) R_GetCCallable("rxode2", "rxgeom");</span></span>
<span><span class="co">#&gt;   rxf = (rxode2i_fn2) R_GetCCallable("rxode2", "rxf");</span></span>
<span><span class="co">#&gt;   rxexp = (rxode2i_fn) R_GetCCallable("rxode2", "rxexp");</span></span>
<span><span class="co">#&gt;   rxchisq = (rxode2i_fn) R_GetCCallable("rxode2", "rxchisq");</span></span>
<span><span class="co">#&gt;   rxcauchy = (rxode2i_fn2) R_GetCCallable("rxode2", "rxcauchy");</span></span>
<span><span class="co">#&gt;   rxnbinomMu = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxnbinomMu");</span></span>
<span><span class="co">#&gt;   rxnbinom = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxnbinom");</span></span>
<span><span class="co">#&gt;   rxbinom = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxbinom");</span></span>
<span><span class="co">#&gt;   rxnorm = (rxode2i_fn2) R_GetCCallable("rxode2", "rxnorm");</span></span>
<span><span class="co">#&gt;   linCmtB = (linCmtB_p) R_GetCCallable("rxode2", "linCmtB");</span></span>
<span><span class="co">#&gt;   linCmtA = (linCmtA_p) R_GetCCallable("rxode2", "linCmtA");</span></span>
<span><span class="co">#&gt;   // dynamic stop</span></span>
<span><span class="co">#&gt;   _solveData = _getRxSolve_();</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void _assignFuns(void) {</span></span>
<span><span class="co">#&gt;   if (_assign_ptr == NULL){</span></span>
<span><span class="co">#&gt;     _assignFuns0();</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void __assignFuns2(rx_solve rx,</span></span>
<span><span class="co">#&gt;                    rx_solving_options op,</span></span>
<span><span class="co">#&gt;                    t_F f,</span></span>
<span><span class="co">#&gt;                    t_LAG lag,</span></span>
<span><span class="co">#&gt;                    t_RATE rate,</span></span>
<span><span class="co">#&gt;                    t_DUR dur,</span></span>
<span><span class="co">#&gt;                    t_calc_mtime mtime,</span></span>
<span><span class="co">#&gt;                    t_ME me,</span></span>
<span><span class="co">#&gt;                    t_IndF indf,</span></span>
<span><span class="co">#&gt;                    t_getTime gettime,</span></span>
<span><span class="co">#&gt;                    t_locateTimeIndex timeindex,</span></span>
<span><span class="co">#&gt;                    t_handle_evidL handleEvid,</span></span>
<span><span class="co">#&gt;                    t_getDur getdur) {</span></span>
<span><span class="co">#&gt;   // assign start</span></span>
<span><span class="co">#&gt;     static rxode2_assignFuns2_t rxode2_assignFuns2 = NULL;</span></span>
<span><span class="co">#&gt;     if (rxode2_assignFuns2 == NULL) rxode2_assignFuns2 = (rxode2_assignFuns2_t)(R_GetCCallable("rxode2", "_rxode2_assignFuns2"));</span></span>
<span><span class="co">#&gt;     rxode2_assignFuns2(rx, op, f, lag, rate, dur, mtime, me, indf, gettime, timeindex, handleEvid, getdur);</span></span>
<span><span class="co">#&gt;   // assign stop</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void  rx_00a71d2e93f00e17fd3643e392c6263d__ode_solver_solvedata (rx_solve *solve){</span></span>
<span><span class="co">#&gt;   _solveData = solve;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern rx_solve *rx_00a71d2e93f00e17fd3643e392c6263d__ode_solver_get_solvedata(void){</span></span>
<span><span class="co">#&gt;   return _solveData;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; SEXP rx_00a71d2e93f00e17fd3643e392c6263d__model_vars(void);</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; // prj-specific differential eqns</span></span>
<span><span class="co">#&gt; void rx_00a71d2e93f00e17fd3643e392c6263d__dydt(int *_neq, double __t, double *__zzStateVar__, double *__DDtStateVar__)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   int _cSub = _neq[1];</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_neq[1]].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=1;</span></span>
<span><span class="co">#&gt;   double TKA = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TCL = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TV2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TQ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TV3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TKin = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TKout = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TEC50 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double c2_DoT_prop_DoT_sd = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eff_DoT_add_DoT_sd = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_cl = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_v = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rxerr_DoT_C2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rxerr_DoT_eff = NA_REAL;</span></span>
<span><span class="co">#&gt;   double KA = NA_REAL;</span></span>
<span><span class="co">#&gt;   double CL = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Q = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kin = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kout = NA_REAL;</span></span>
<span><span class="co">#&gt;   double EC50 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double centr = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double peri = NA_REAL;</span></span>
<span><span class="co">#&gt;   double depot = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eff = NA_REAL;</span></span>
<span><span class="co">#&gt;   double CMT = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_yj___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_lambda___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_low___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_hi___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_f_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_r_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double ipredSim = NA_REAL;</span></span>
<span><span class="co">#&gt;   double sim = NA_REAL;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   (void)TKA;</span></span>
<span><span class="co">#&gt;   (void)TCL;</span></span>
<span><span class="co">#&gt;   (void)TV2;</span></span>
<span><span class="co">#&gt;   (void)TQ;</span></span>
<span><span class="co">#&gt;   (void)TV3;</span></span>
<span><span class="co">#&gt;   (void)TKin;</span></span>
<span><span class="co">#&gt;   (void)TKout;</span></span>
<span><span class="co">#&gt;   (void)TEC50;</span></span>
<span><span class="co">#&gt;   (void)c2_DoT_prop_DoT_sd;</span></span>
<span><span class="co">#&gt;   (void)eff_DoT_add_DoT_sd;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_cl;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_v;</span></span>
<span><span class="co">#&gt;   (void)rxerr_DoT_C2;</span></span>
<span><span class="co">#&gt;   (void)rxerr_DoT_eff;</span></span>
<span><span class="co">#&gt;   (void)KA;</span></span>
<span><span class="co">#&gt;   (void)CL;</span></span>
<span><span class="co">#&gt;   (void)V2;</span></span>
<span><span class="co">#&gt;   (void)Q;</span></span>
<span><span class="co">#&gt;   (void)V3;</span></span>
<span><span class="co">#&gt;   (void)Kin;</span></span>
<span><span class="co">#&gt;   (void)Kout;</span></span>
<span><span class="co">#&gt;   (void)EC50;</span></span>
<span><span class="co">#&gt;   (void)C2;</span></span>
<span><span class="co">#&gt;   (void)centr;</span></span>
<span><span class="co">#&gt;   (void)C3;</span></span>
<span><span class="co">#&gt;   (void)peri;</span></span>
<span><span class="co">#&gt;   (void)depot;</span></span>
<span><span class="co">#&gt;   (void)eff;</span></span>
<span><span class="co">#&gt;   (void)CMT;</span></span>
<span><span class="co">#&gt;   (void)rx_yj___;</span></span>
<span><span class="co">#&gt;   (void)rx_lambda___;</span></span>
<span><span class="co">#&gt;   (void)rx_low___;</span></span>
<span><span class="co">#&gt;   (void)rx_hi___;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_f_;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_;</span></span>
<span><span class="co">#&gt;   (void)rx_r_;</span></span>
<span><span class="co">#&gt;   (void)ipredSim;</span></span>
<span><span class="co">#&gt;   (void)sim;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   KA = _PL[0];</span></span>
<span><span class="co">#&gt;   CL = _PL[1];</span></span>
<span><span class="co">#&gt;   V2 = _PL[2];</span></span>
<span><span class="co">#&gt;   Q = _PL[3];</span></span>
<span><span class="co">#&gt;   V3 = _PL[4];</span></span>
<span><span class="co">#&gt;   Kin = _PL[5];</span></span>
<span><span class="co">#&gt;   Kout = _PL[6];</span></span>
<span><span class="co">#&gt;   EC50 = _PL[7];</span></span>
<span><span class="co">#&gt;   C2 = _PL[8];</span></span>
<span><span class="co">#&gt;   C3 = _PL[9];</span></span>
<span><span class="co">#&gt;   ipredSim = _PL[10];</span></span>
<span><span class="co">#&gt;   sim = _PL[11];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _update_par_ptr(__t, _cSub, _solveData, _idx);</span></span>
<span><span class="co">#&gt;   TKA = _PP[0];</span></span>
<span><span class="co">#&gt;   TCL = _PP[1];</span></span>
<span><span class="co">#&gt;   TV2 = _PP[2];</span></span>
<span><span class="co">#&gt;   TQ = _PP[3];</span></span>
<span><span class="co">#&gt;   TV3 = _PP[4];</span></span>
<span><span class="co">#&gt;   TKin = _PP[5];</span></span>
<span><span class="co">#&gt;   TKout = _PP[6];</span></span>
<span><span class="co">#&gt;   TEC50 = _PP[7];</span></span>
<span><span class="co">#&gt;   c2_DoT_prop_DoT_sd = _PP[8];</span></span>
<span><span class="co">#&gt;   eff_DoT_add_DoT_sd = _PP[9];</span></span>
<span><span class="co">#&gt;   eta_DoT_cl = _PP[10];</span></span>
<span><span class="co">#&gt;   eta_DoT_v = _PP[11];</span></span>
<span><span class="co">#&gt;   rxerr_DoT_C2 = _PP[12];</span></span>
<span><span class="co">#&gt;   rxerr_DoT_eff = _PP[13];</span></span>
<span><span class="co">#&gt;   CMT = _PP[14];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   depot = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">#&gt;   centr = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">#&gt;   peri = __zzStateVar__[__DDT2__]*((double)(_ON[__DDT2__]));</span></span>
<span><span class="co">#&gt;   eff = __zzStateVar__[__DDT3__]*((double)(_ON[__DDT3__]));</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   KA =TKA;</span></span>
<span><span class="co">#&gt;   CL =TCL*exp(eta_DoT_cl);</span></span>
<span><span class="co">#&gt;   V2 =TV2*exp(eta_DoT_v);</span></span>
<span><span class="co">#&gt;   Q =TQ;</span></span>
<span><span class="co">#&gt;   V3 =TV3;</span></span>
<span><span class="co">#&gt;   Kin =TKin;</span></span>
<span><span class="co">#&gt;   Kout =TKout;</span></span>
<span><span class="co">#&gt;   EC50 =TEC50;</span></span>
<span><span class="co">#&gt;   C2=centr/_div0(V2);</span></span>
<span><span class="co">#&gt;   C3=peri/_div0(V3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT0__] = ((double)(_ON[__DDT0__]))*(_IR[__DDT0__] -KA*depot);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT1__] = ((double)(_ON[__DDT1__]))*(_IR[__DDT1__] + KA*depot-CL*C2-Q*C2+Q*C3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT2__] = ((double)(_ON[__DDT2__]))*(_IR[__DDT2__] + Q*C2-Q*C3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT3__] = ((double)(_ON[__DDT3__]))*(_IR[__DDT3__] + Kin-Kout*(1-C2/_div0((EC50+C2)))*eff);</span></span>
<span><span class="co">#&gt;   if (_CMT==5){</span></span>
<span><span class="co">#&gt;   rx_yj_ =2;</span></span>
<span><span class="co">#&gt;   rx_lambda_ =1;</span></span>
<span><span class="co">#&gt;   rx_low_ =0;</span></span>
<span><span class="co">#&gt;   rx_hi_ =1;</span></span>
<span><span class="co">#&gt;   rx_pred_f_ =C2;</span></span>
<span><span class="co">#&gt;   rx_pred_ =rx_pred_f_;</span></span>
<span><span class="co">#&gt;   rx_r_ =Rx_pow((rx_pred_f_*c2_DoT_prop_DoT_sd),2);</span></span>
<span><span class="co">#&gt;   ipredSim =rxTBSi(rx_pred_,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   sim =rxTBSi(rx_pred_+sqrt(rx_r_)*rxerr_DoT_C2,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   if (_CMT==4){</span></span>
<span><span class="co">#&gt;   rx_yj_ =2;</span></span>
<span><span class="co">#&gt;   rx_lambda_ =1;</span></span>
<span><span class="co">#&gt;   rx_low_ =0;</span></span>
<span><span class="co">#&gt;   rx_hi_ =1;</span></span>
<span><span class="co">#&gt;   rx_pred_f_ =eff;</span></span>
<span><span class="co">#&gt;   rx_pred_ =rx_pred_f_;</span></span>
<span><span class="co">#&gt;   rx_r_ =Rx_pow((eff_DoT_add_DoT_sd),2);</span></span>
<span><span class="co">#&gt;   ipredSim =rxTBSi(rx_pred_,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   sim =rxTBSi(rx_pred_+sqrt(rx_r_)*rxerr_DoT_eff,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   (&amp;_solveData-&gt;subjects[_cSub])-&gt;dadt_counter[0]++;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; // Jacobian derived vars</span></span>
<span><span class="co">#&gt; void rx_00a71d2e93f00e17fd3643e392c6263d__calc_jac(int *_neq, double __t, double *__zzStateVar__, double *__PDStateVar__, unsigned int __NROWPD__) {</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;     int _cSub=_neq[1];</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_neq[1]].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=2;</span></span>
<span><span class="co">#&gt;   (&amp;_solveData-&gt;subjects[_cSub])-&gt;jac_counter[0]++;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Functional based initial conditions.</span></span>
<span><span class="co">#&gt; void rx_00a71d2e93f00e17fd3643e392c6263d__inis(int _cSub, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;  _ind-&gt;_rxFlag=3;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // prj-specific derived vars</span></span>
<span><span class="co">#&gt; void rx_00a71d2e93f00e17fd3643e392c6263d__calc_lhs(int _cSub, double __t, double *__zzStateVar__, double *_lhs) {</span></span>
<span><span class="co">#&gt;     int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=11;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_0__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_1__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_2__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_3__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_4__;</span></span>
<span><span class="co">#&gt;   double TKA = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TCL = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TV2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TQ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TV3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TKin = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TKout = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TEC50 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double c2_DoT_prop_DoT_sd = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eff_DoT_add_DoT_sd = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_cl = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_v = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rxerr_DoT_C2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rxerr_DoT_eff = NA_REAL;</span></span>
<span><span class="co">#&gt;   double KA = NA_REAL;</span></span>
<span><span class="co">#&gt;   double CL = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Q = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kin = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kout = NA_REAL;</span></span>
<span><span class="co">#&gt;   double EC50 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double centr = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double peri = NA_REAL;</span></span>
<span><span class="co">#&gt;   double depot = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eff = NA_REAL;</span></span>
<span><span class="co">#&gt;   double CMT = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_yj___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_lambda___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_low___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_hi___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_f_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_r_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double ipredSim = NA_REAL;</span></span>
<span><span class="co">#&gt;   double sim = NA_REAL;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_0__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_1__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_2__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_3__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_4__;</span></span>
<span><span class="co">#&gt;   (void)TKA;</span></span>
<span><span class="co">#&gt;   (void)TCL;</span></span>
<span><span class="co">#&gt;   (void)TV2;</span></span>
<span><span class="co">#&gt;   (void)TQ;</span></span>
<span><span class="co">#&gt;   (void)TV3;</span></span>
<span><span class="co">#&gt;   (void)TKin;</span></span>
<span><span class="co">#&gt;   (void)TKout;</span></span>
<span><span class="co">#&gt;   (void)TEC50;</span></span>
<span><span class="co">#&gt;   (void)c2_DoT_prop_DoT_sd;</span></span>
<span><span class="co">#&gt;   (void)eff_DoT_add_DoT_sd;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_cl;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_v;</span></span>
<span><span class="co">#&gt;   (void)rxerr_DoT_C2;</span></span>
<span><span class="co">#&gt;   (void)rxerr_DoT_eff;</span></span>
<span><span class="co">#&gt;   (void)KA;</span></span>
<span><span class="co">#&gt;   (void)CL;</span></span>
<span><span class="co">#&gt;   (void)V2;</span></span>
<span><span class="co">#&gt;   (void)Q;</span></span>
<span><span class="co">#&gt;   (void)V3;</span></span>
<span><span class="co">#&gt;   (void)Kin;</span></span>
<span><span class="co">#&gt;   (void)Kout;</span></span>
<span><span class="co">#&gt;   (void)EC50;</span></span>
<span><span class="co">#&gt;   (void)C2;</span></span>
<span><span class="co">#&gt;   (void)centr;</span></span>
<span><span class="co">#&gt;   (void)C3;</span></span>
<span><span class="co">#&gt;   (void)peri;</span></span>
<span><span class="co">#&gt;   (void)depot;</span></span>
<span><span class="co">#&gt;   (void)eff;</span></span>
<span><span class="co">#&gt;   (void)CMT;</span></span>
<span><span class="co">#&gt;   (void)rx_yj___;</span></span>
<span><span class="co">#&gt;   (void)rx_lambda___;</span></span>
<span><span class="co">#&gt;   (void)rx_low___;</span></span>
<span><span class="co">#&gt;   (void)rx_hi___;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_f_;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_;</span></span>
<span><span class="co">#&gt;   (void)rx_r_;</span></span>
<span><span class="co">#&gt;   (void)ipredSim;</span></span>
<span><span class="co">#&gt;   (void)sim;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   KA = _PL[0];</span></span>
<span><span class="co">#&gt;   CL = _PL[1];</span></span>
<span><span class="co">#&gt;   V2 = _PL[2];</span></span>
<span><span class="co">#&gt;   Q = _PL[3];</span></span>
<span><span class="co">#&gt;   V3 = _PL[4];</span></span>
<span><span class="co">#&gt;   Kin = _PL[5];</span></span>
<span><span class="co">#&gt;   Kout = _PL[6];</span></span>
<span><span class="co">#&gt;   EC50 = _PL[7];</span></span>
<span><span class="co">#&gt;   C2 = _PL[8];</span></span>
<span><span class="co">#&gt;   C3 = _PL[9];</span></span>
<span><span class="co">#&gt;   ipredSim = _PL[10];</span></span>
<span><span class="co">#&gt;   sim = _PL[11];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _update_par_ptr(__t, _cSub, _solveData, _idx);</span></span>
<span><span class="co">#&gt;   TKA = _PP[0];</span></span>
<span><span class="co">#&gt;   TCL = _PP[1];</span></span>
<span><span class="co">#&gt;   TV2 = _PP[2];</span></span>
<span><span class="co">#&gt;   TQ = _PP[3];</span></span>
<span><span class="co">#&gt;   TV3 = _PP[4];</span></span>
<span><span class="co">#&gt;   TKin = _PP[5];</span></span>
<span><span class="co">#&gt;   TKout = _PP[6];</span></span>
<span><span class="co">#&gt;   TEC50 = _PP[7];</span></span>
<span><span class="co">#&gt;   c2_DoT_prop_DoT_sd = _PP[8];</span></span>
<span><span class="co">#&gt;   eff_DoT_add_DoT_sd = _PP[9];</span></span>
<span><span class="co">#&gt;   eta_DoT_cl = _PP[10];</span></span>
<span><span class="co">#&gt;   eta_DoT_v = _PP[11];</span></span>
<span><span class="co">#&gt;   rxerr_DoT_C2 = _PP[12];</span></span>
<span><span class="co">#&gt;   rxerr_DoT_eff = _PP[13];</span></span>
<span><span class="co">#&gt;   CMT = _PP[14];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   depot = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">#&gt;   centr = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">#&gt;   peri = __zzStateVar__[__DDT2__]*((double)(_ON[__DDT2__]));</span></span>
<span><span class="co">#&gt;   eff = __zzStateVar__[__DDT3__]*((double)(_ON[__DDT3__]));</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   KA =TKA;</span></span>
<span><span class="co">#&gt;   CL =TCL*exp(eta_DoT_cl);</span></span>
<span><span class="co">#&gt;   V2 =TV2*exp(eta_DoT_v);</span></span>
<span><span class="co">#&gt;   Q =TQ;</span></span>
<span><span class="co">#&gt;   V3 =TV3;</span></span>
<span><span class="co">#&gt;   Kin =TKin;</span></span>
<span><span class="co">#&gt;   Kout =TKout;</span></span>
<span><span class="co">#&gt;   EC50 =TEC50;</span></span>
<span><span class="co">#&gt;   C2=centr/_div0(V2);</span></span>
<span><span class="co">#&gt;   C3=peri/_div0(V3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_0__ = ((double)(_ON[__DDT0__]))*(_IR[__DDT0__] -KA*depot);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_1__ = ((double)(_ON[__DDT1__]))*(_IR[__DDT1__] + KA*depot-CL*C2-Q*C2+Q*C3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_2__ = ((double)(_ON[__DDT2__]))*(_IR[__DDT2__] + Q*C2-Q*C3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_3__ = ((double)(_ON[__DDT3__]))*(_IR[__DDT3__] + Kin-Kout*(1-C2/_div0((EC50+C2)))*eff);</span></span>
<span><span class="co">#&gt;   if (_CMT==5){</span></span>
<span><span class="co">#&gt;   rx_yj_ =2;</span></span>
<span><span class="co">#&gt;   rx_lambda_ =1;</span></span>
<span><span class="co">#&gt;   rx_low_ =0;</span></span>
<span><span class="co">#&gt;   rx_hi_ =1;</span></span>
<span><span class="co">#&gt;   rx_pred_f_ =C2;</span></span>
<span><span class="co">#&gt;   rx_pred_ =rx_pred_f_;</span></span>
<span><span class="co">#&gt;   rx_r_ =Rx_pow((rx_pred_f_*c2_DoT_prop_DoT_sd),2);</span></span>
<span><span class="co">#&gt;   ipredSim =rxTBSi(rx_pred_,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   sim =rxTBSi(rx_pred_+sqrt(rx_r_)*rxerr_DoT_C2,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   if (_CMT==4){</span></span>
<span><span class="co">#&gt;   rx_yj_ =2;</span></span>
<span><span class="co">#&gt;   rx_lambda_ =1;</span></span>
<span><span class="co">#&gt;   rx_low_ =0;</span></span>
<span><span class="co">#&gt;   rx_hi_ =1;</span></span>
<span><span class="co">#&gt;   rx_pred_f_ =eff;</span></span>
<span><span class="co">#&gt;   rx_pred_ =rx_pred_f_;</span></span>
<span><span class="co">#&gt;   rx_r_ =Rx_pow((eff_DoT_add_DoT_sd),2);</span></span>
<span><span class="co">#&gt;   ipredSim =rxTBSi(rx_pred_,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   sim =rxTBSi(rx_pred_+sqrt(rx_r_)*rxerr_DoT_eff,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _lhs[_LHS_0_]=KA;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_1_]=CL;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_2_]=V2;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_3_]=Q;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_4_]=V3;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_5_]=Kin;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_6_]=Kout;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_7_]=EC50;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_8_]=C2;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_9_]=C3;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_10_]=ipredSim;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_11_]=sim;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Functional based bioavailability</span></span>
<span><span class="co">#&gt; double rx_00a71d2e93f00e17fd3643e392c6263d__F(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return _amt;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; // Functional based absorption lag</span></span>
<span><span class="co">#&gt; double rx_00a71d2e93f00e17fd3643e392c6263d__Lag(int _cSub,  int _cmt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return __t;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Modeled zero-order rate</span></span>
<span><span class="co">#&gt; double rx_00a71d2e93f00e17fd3643e392c6263d__Rate(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return 0.0;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Modeled zero-order duration</span></span>
<span><span class="co">#&gt; double rx_00a71d2e93f00e17fd3643e392c6263d__Dur(int _cSub,  int _cmt, double _amt, double __t){</span></span>
<span><span class="co">#&gt;  return 0.0;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Model Times</span></span>
<span><span class="co">#&gt; void rx_00a71d2e93f00e17fd3643e392c6263d__mtime(int _cSub, double *_mtime){</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Matrix Exponential (0)</span></span>
<span><span class="co">#&gt; void rx_00a71d2e93f00e17fd3643e392c6263d__ME(int _cSub, double _t, double __t, double *_mat, const double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=9;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Inductive linearization Matf</span></span>
<span><span class="co">#&gt; void rx_00a71d2e93f00e17fd3643e392c6263d__IndF(int _cSub, double _t, double __t, double *_matf){</span></span>
<span><span class="co">#&gt;  int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=10;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern SEXP rx_00a71d2e93f00e17fd3643e392c6263d__model_vars(void){</span></span>
<span><span class="co">#&gt;   int pro=0;</span></span>
<span><span class="co">#&gt;   SEXP _mv = PROTECT(_rxGetModelLib("rx_00a71d2e93f00e17fd3643e392c6263d__model_vars"));pro++;</span></span>
<span><span class="co">#&gt;   if (!_rxIsCurrentC(_mv)){</span></span>
<span><span class="co">#&gt;     SEXP hash    = PROTECT(Rf_allocVector(STRSXP, 1));pro++;</span></span>
<span><span class="co">#&gt; #define __doBuf__  snprintf(buf, __doBufN__, "un]\"BAAA@QRtHACAAAAAAAuWDBAABdk1ku@,^:uAVpC*3Ig+@[BAJ\"E8lBBtP{{%%\?}6h`B5FeSpVBQ86\"}}clLtWh&lt;~&amp;0&gt;^|2(TE!{C4/$$(ZSGQ9GTD7Hz*uW[,={a`:nb#b4eA!d{}=FtzJ|!Iy~g}CFf(6B9PIg&gt;FpMV}&gt;ZOPen^U&lt;+o]4\?f0J!8&amp;G~97_#b+C~y0v$aRA`9wTdi1CcpGo[#V27\?9ZQa,ie*o,&amp;S,PR&amp;X#dB3I3\?TfvO\?&lt;^SCoB+Xxnl..)nBK5w!wOV,s|[^5NJ~D@v&lt;ol&lt;&amp;[Y]:mIzVHxibag`/UaAu&lt;\?S4(4&lt;0^H)wu\"(f\?|&amp;iE6m+PUrol@d&gt;9cdg#!+`Q~_&lt;]~#9m1{n[]N2#pC(V#($QD,RpWC~|,m{INicd`R7W67dDB8P%%q)O,4d[,\"vK8#PktwnG81VpzI2mAydY+mkjGF`*d8jTgi.+$R$%%;$ykN1|_hM9!#kn0UIc6R^|L|Imp`r{I3mnIIx%%It#aeGROPraVN4GdwZYD+MM1i4@kcc7Xf7!MoCbT\?lL&amp;@%%Frap[bop[xGt5aRsF@k]`r|RaZWsM0~UESvxjRv*f@W+*2craK+%%FL:6IjB~q)ONSCkVN7`&gt;qnVUh0c5QG:uHD{|LCr`r.mmm[SGtMA|XyIAYG]g{FKw)!!$gcfFxhS(Unfshg&gt;.4OStT=U:ZKs}[NQOVflU#wg.C~FW/PL/lr#X)65J%%1;:cY&gt;^5wj\?mNLyjql8(0TGg*0}`C+4iPVR5jXhYP2iYKC9d)fU)2oWhQbqK:bRsXQcv{20)h2AJ8WFyvM8WXVr%%^#@iLohd7AJ)+do|eYEj&gt;UXJS[w4[.s5Vat2YEaEjbu(~Bv]r_0NDw^^!rw.r3yUgcU]557.@VH`4bF*cEQO&amp;4m0:kLy6t&amp;$\?D_&gt;JF;W,uEa]C&lt;na/8;SY!{H3{v1PE3M&gt;H=lQ_#Mol@wyG.UfnEBUQ~Xg2&gt;w$MoTpRIxzR**KPuZ7;/Nfotrw1sL`^j97=\"cR+LcT5ia_SMM}*^k=}CCbgrnn~s&gt;&amp;F9r:.VYdk~|f`&amp;,gg&lt;Cxi1#V=b^=GJ$yFL~kpWcqCD*{t:xg\?,Tsy;&amp;^NUB}o[v!{j$2kRe9!j#=^~f|3sH.y#%%qYPk!v$Tp7g1N1;Zgp0GTK338&lt;vFoG.I@D;UkK)6l2(X/Nim2y7~L0z0W&amp;\",\"aBSclBk&lt;KNQw6FQAH72OWa$XBLK}$UP]n5^YYd5PGbt!DxDcDJ4l2u}*_({fH};&lt;$EO&amp;}=C#OMqOGdw4vD;%%9bbw.8%%q*D,J33}fhh[;)&lt;g7vFskeC26tx:4Bw/t%%Z\?5EXgL`veY3vFtR1YB!ZXXtBruAwEMuZUw6eF0;T.y7`&lt;3jX/&gt;`uN9V;v}PM#XOKlzU\"DMi,7napwMp+eYM*$N~wU6NJMX@5azgQK*X1M#.X`I^n!L&lt;Ea:ggt$o8~x~]`H):^#Mw:M4+,#NJ3#myT;vGGE&gt;tq*\?.%%7L`eJA\?dG.Y\"xP&amp;EQ.DE)Q+]#g/EjO#4(5Kaj\?[fVr27w*R1_dtlawD%%G\?(8)nc7(^nF58k#M8F^;byr@;5w8auuZ*$3P,tYx$U%%4k%%^7YB#[+\"N4brfv6t43m&gt;Z/4}&lt;.=E0YRy*@!z2&amp;==R/6Js7|j=&gt;0OmQkFC${l=}p0w&gt;0ajPAXIej&gt;CjcIlJ=iOg[ux|YA\?sQ\"Et$0P#}icDu.$Lls^]6H}K5QcJ$7InEUe`0W\?NVr+VDc\"&gt;&amp;]MM&lt;r@E)}WF~Cx6cl{3jC!Fppcp&lt;:{K/WRutC8p(S{M2d{{bm*)&lt;_1FSW7nJGN~]}tZ`%%Z_nC~KdB$GcA0ujV$5^](&lt;eRvy_dH;{e.Kb9Z;44k*tTR|ZlGtpP`ubYOty9P7TKJ^qQ}&amp;usIXl+7tFKV\?W2jj\?$u=dCjs*y[T%%LBo\"h.Q\?ZB");</span></span>
<span><span class="co">#&gt;     char buf[1906];</span></span>
<span><span class="co">#&gt; #define __doBufN__ 1906</span></span>
<span><span class="co">#&gt;     __doBuf__</span></span>
<span><span class="co">#&gt; #undef __doBuf__</span></span>
<span><span class="co">#&gt; #undef __doBufN__</span></span>
<span><span class="co">#&gt;     SET_STRING_ELT(hash, 0, Rf_mkChar(buf));</span></span>
<span><span class="co">#&gt;     SEXP lst      = PROTECT(_rxQr(hash));pro++;</span></span>
<span><span class="co">#&gt;     _assign_ptr(lst);</span></span>
<span><span class="co">#&gt;     UNPROTECT(pro);</span></span>
<span><span class="co">#&gt;     return lst;</span></span>
<span><span class="co">#&gt;   } else {</span></span>
<span><span class="co">#&gt;     UNPROTECT(pro);</span></span>
<span><span class="co">#&gt;     return _mv;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void rx_00a71d2e93f00e17fd3643e392c6263d__dydt_lsoda(int *neq, double *t, double *A, double *DADT)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   rx_00a71d2e93f00e17fd3643e392c6263d__dydt(neq, *t, A, DADT);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern int rx_00a71d2e93f00e17fd3643e392c6263d__dydt_liblsoda(double __t, double *y, double *ydot, void *data)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   int *neq = (int*)(data);</span></span>
<span><span class="co">#&gt;   rx_00a71d2e93f00e17fd3643e392c6263d__dydt(neq, __t, y, ydot);</span></span>
<span><span class="co">#&gt;   return(0);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void rx_00a71d2e93f00e17fd3643e392c6263d__calc_jac_lsoda(int *neq, double *t, double *A,int *ml, int *mu, double *JAC, int *nrowpd){</span></span>
<span><span class="co">#&gt;   // Update all covariate parameters</span></span>
<span><span class="co">#&gt;   rx_00a71d2e93f00e17fd3643e392c6263d__calc_jac(neq, *t, A, JAC, *nrowpd);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; //Create function to call from R's main thread that assigns the required functions. Sometimes they don't get assigned.</span></span>
<span><span class="co">#&gt; extern void rx_00a71d2e93f00e17fd3643e392c6263d__assignFuns(void){</span></span>
<span><span class="co">#&gt;   _assignFuns();</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; //Initialize the dll to match rxode2's calls</span></span>
<span><span class="co">#&gt; void R_init0_rx_00a71d2e93f00e17fd3643e392c6263d_(void){</span></span>
<span><span class="co">#&gt;   // Get C callables on load; Otherwise it isn't thread safe</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_00a71d2e93f00e17fd3643e392c6263d_","rx_00a71d2e93f00e17fd3643e392c6263d__assignFuns2", (DL_FUNC) __assignFuns2);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_00a71d2e93f00e17fd3643e392c6263d_","rx_00a71d2e93f00e17fd3643e392c6263d__assignFuns", (DL_FUNC) rx_00a71d2e93f00e17fd3643e392c6263d__assignFuns);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_00a71d2e93f00e17fd3643e392c6263d_","rx_00a71d2e93f00e17fd3643e392c6263d__inis",(DL_FUNC) rx_00a71d2e93f00e17fd3643e392c6263d__inis);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_00a71d2e93f00e17fd3643e392c6263d_","rx_00a71d2e93f00e17fd3643e392c6263d__dydt",(DL_FUNC) rx_00a71d2e93f00e17fd3643e392c6263d__dydt);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_00a71d2e93f00e17fd3643e392c6263d_","rx_00a71d2e93f00e17fd3643e392c6263d__calc_lhs",(DL_FUNC) rx_00a71d2e93f00e17fd3643e392c6263d__calc_lhs);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_00a71d2e93f00e17fd3643e392c6263d_","rx_00a71d2e93f00e17fd3643e392c6263d__calc_jac",(DL_FUNC) rx_00a71d2e93f00e17fd3643e392c6263d__calc_jac);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_00a71d2e93f00e17fd3643e392c6263d_","rx_00a71d2e93f00e17fd3643e392c6263d__dydt_lsoda", (DL_FUNC) rx_00a71d2e93f00e17fd3643e392c6263d__dydt_lsoda);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_00a71d2e93f00e17fd3643e392c6263d_","rx_00a71d2e93f00e17fd3643e392c6263d__calc_jac_lsoda", (DL_FUNC) rx_00a71d2e93f00e17fd3643e392c6263d__calc_jac_lsoda);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_00a71d2e93f00e17fd3643e392c6263d_","rx_00a71d2e93f00e17fd3643e392c6263d__ode_solver_solvedata", (DL_FUNC) rx_00a71d2e93f00e17fd3643e392c6263d__ode_solver_solvedata);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_00a71d2e93f00e17fd3643e392c6263d_","rx_00a71d2e93f00e17fd3643e392c6263d__ode_solver_get_solvedata", (DL_FUNC) rx_00a71d2e93f00e17fd3643e392c6263d__ode_solver_get_solvedata);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_00a71d2e93f00e17fd3643e392c6263d_","rx_00a71d2e93f00e17fd3643e392c6263d__F", (DL_FUNC) rx_00a71d2e93f00e17fd3643e392c6263d__F);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_00a71d2e93f00e17fd3643e392c6263d_","rx_00a71d2e93f00e17fd3643e392c6263d__Lag", (DL_FUNC) rx_00a71d2e93f00e17fd3643e392c6263d__Lag);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_00a71d2e93f00e17fd3643e392c6263d_","rx_00a71d2e93f00e17fd3643e392c6263d__Rate", (DL_FUNC) rx_00a71d2e93f00e17fd3643e392c6263d__Rate);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_00a71d2e93f00e17fd3643e392c6263d_","rx_00a71d2e93f00e17fd3643e392c6263d__Dur", (DL_FUNC) rx_00a71d2e93f00e17fd3643e392c6263d__Dur);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_00a71d2e93f00e17fd3643e392c6263d_","rx_00a71d2e93f00e17fd3643e392c6263d__mtime", (DL_FUNC) rx_00a71d2e93f00e17fd3643e392c6263d__mtime);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_00a71d2e93f00e17fd3643e392c6263d_","rx_00a71d2e93f00e17fd3643e392c6263d__ME", (DL_FUNC) rx_00a71d2e93f00e17fd3643e392c6263d__ME);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_00a71d2e93f00e17fd3643e392c6263d_","rx_00a71d2e93f00e17fd3643e392c6263d__IndF", (DL_FUNC) rx_00a71d2e93f00e17fd3643e392c6263d__IndF);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_00a71d2e93f00e17fd3643e392c6263d_","rx_00a71d2e93f00e17fd3643e392c6263d__dydt_liblsoda", (DL_FUNC) rx_00a71d2e93f00e17fd3643e392c6263d__dydt_liblsoda);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; //Initialize the dll to match rxode2's calls</span></span>
<span><span class="co">#&gt; void R_init_rx_00a71d2e93f00e17fd3643e392c6263d_(DllInfo *info){</span></span>
<span><span class="co">#&gt;   // Get C callables on load; Otherwise it isn't thread safe</span></span>
<span><span class="co">#&gt;   R_init0_rx_00a71d2e93f00e17fd3643e392c6263d_();</span></span>
<span><span class="co">#&gt;   static const R_CallMethodDef callMethods[]  = {</span></span>
<span><span class="co">#&gt;     {"rx_00a71d2e93f00e17fd3643e392c6263d__model_vars", (DL_FUNC) &amp;rx_00a71d2e93f00e17fd3643e392c6263d__model_vars, 0},</span></span>
<span><span class="co">#&gt;     {NULL, NULL, 0}</span></span>
<span><span class="co">#&gt;   };</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   R_registerRoutines(info, NULL, callMethods, NULL, NULL);</span></span>
<span><span class="co">#&gt;   R_useDynamicSymbols(info,FALSE);</span></span>
<span><span class="co">#&gt;   _assignFuns0();</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; void R_unload_rx_00a71d2e93f00e17fd3643e392c6263d_ (DllInfo *info){</span></span>
<span><span class="co">#&gt;   // Free resources required for single subject solve.</span></span>
<span><span class="co">#&gt;   SEXP _mv = PROTECT(_rxGetModelLib("rx_00a71d2e93f00e17fd3643e392c6263d__model_vars"));</span></span>
<span><span class="co">#&gt;   if (!Rf_isNull(_mv)){</span></span>
<span><span class="co">#&gt;     _rxRmModelLib("rx_00a71d2e93f00e17fd3643e392c6263d__model_vars");</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   UNPROTECT(1);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">rxode2 </span>4.0.2 model named <span style="color: #BBBB00; font-weight: bold;">rx_00a71d2e93f00e17fd3643e392c6263d</span> model (<span style="color: #00BB00;">✔</span> <span style="color: #00BB00; font-weight: bold;">ready</span>). </span></span>
<span><span class="co">#&gt; DLL: /tmp/RtmpgzfWbr/rxode2/rx_00a71d2e93f00e17fd3643e392c6263d__.rxd/rx_00a71d2e93f00e17fd3643e392c6263d_.so</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Calculated Variables:</span></span>
<span><span class="co">#&gt;  [1] "KA"       "CL"       "V2"       "Q"        "V3"       "Kin"     </span></span>
<span><span class="co">#&gt;  [7] "Kout"     "EC50"     "C2"       "C3"       "ipredSim" "sim"     </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── rxode2 Model Syntax ──</span></span></span>
<span><span class="co">#&gt; rxode2({</span></span>
<span><span class="co">#&gt;     param(TKA, TCL, TV2, TQ, TV3, TKin, TKout, TEC50, c2.prop.sd, </span></span>
<span><span class="co">#&gt;         eff.add.sd, eta.cl, eta.v)</span></span>
<span><span class="co">#&gt;     rxerr.C2 = 1</span></span>
<span><span class="co">#&gt;     rxerr.eff = 1</span></span>
<span><span class="co">#&gt;     TKA = 0.3</span></span>
<span><span class="co">#&gt;     TCL = 7</span></span>
<span><span class="co">#&gt;     TV2 = 40</span></span>
<span><span class="co">#&gt;     TQ = 10</span></span>
<span><span class="co">#&gt;     TV3 = 300</span></span>
<span><span class="co">#&gt;     TKin = 0.2</span></span>
<span><span class="co">#&gt;     TKout = 0.2</span></span>
<span><span class="co">#&gt;     TEC50 = 8</span></span>
<span><span class="co">#&gt;     c2.prop.sd = 0.1</span></span>
<span><span class="co">#&gt;     eff.add.sd = 0.1</span></span>
<span><span class="co">#&gt;     eta.cl = 0</span></span>
<span><span class="co">#&gt;     eta.v = 0</span></span>
<span><span class="co">#&gt;     KA = TKA</span></span>
<span><span class="co">#&gt;     CL = TCL * exp(eta.cl)</span></span>
<span><span class="co">#&gt;     V2 = TV2 * exp(eta.v)</span></span>
<span><span class="co">#&gt;     Q = TQ</span></span>
<span><span class="co">#&gt;     V3 = TV3</span></span>
<span><span class="co">#&gt;     Kin = TKin</span></span>
<span><span class="co">#&gt;     Kout = TKout</span></span>
<span><span class="co">#&gt;     EC50 = TEC50</span></span>
<span><span class="co">#&gt;     C2 = centr/V2</span></span>
<span><span class="co">#&gt;     C3 = peri/V3</span></span>
<span><span class="co">#&gt;     d/dt(depot) = -KA * depot</span></span>
<span><span class="co">#&gt;     d/dt(centr) = KA * depot - CL * C2 - Q * C2 + Q * C3</span></span>
<span><span class="co">#&gt;     d/dt(peri) = Q * C2 - Q * C3</span></span>
<span><span class="co">#&gt;     d/dt(eff) = Kin - Kout * (1 - C2/(EC50 + C2)) * eff</span></span>
<span><span class="co">#&gt;     eff(0) = 1</span></span>
<span><span class="co">#&gt;     if (CMT == 5) {</span></span>
<span><span class="co">#&gt;         rx_yj_ ~ 2</span></span>
<span><span class="co">#&gt;         rx_lambda_ ~ 1</span></span>
<span><span class="co">#&gt;         rx_low_ ~ 0</span></span>
<span><span class="co">#&gt;         rx_hi_ ~ 1</span></span>
<span><span class="co">#&gt;         rx_pred_f_ ~ C2</span></span>
<span><span class="co">#&gt;         rx_pred_ ~ rx_pred_f_</span></span>
<span><span class="co">#&gt;         rx_r_ ~ (rx_pred_f_ * c2.prop.sd)^2</span></span>
<span><span class="co">#&gt;         ipredSim = rxTBSi(rx_pred_, rx_lambda_, rx_yj_, rx_low_, </span></span>
<span><span class="co">#&gt;             rx_hi_)</span></span>
<span><span class="co">#&gt;         sim = rxTBSi(rx_pred_ + sqrt(rx_r_) * rxerr.C2, rx_lambda_, </span></span>
<span><span class="co">#&gt;             rx_yj_, rx_low_, rx_hi_)</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     if (CMT == 4) {</span></span>
<span><span class="co">#&gt;         rx_yj_ ~ 2</span></span>
<span><span class="co">#&gt;         rx_lambda_ ~ 1</span></span>
<span><span class="co">#&gt;         rx_low_ ~ 0</span></span>
<span><span class="co">#&gt;         rx_hi_ ~ 1</span></span>
<span><span class="co">#&gt;         rx_pred_f_ ~ eff</span></span>
<span><span class="co">#&gt;         rx_pred_ ~ rx_pred_f_</span></span>
<span><span class="co">#&gt;         rx_r_ ~ (eff.add.sd)^2</span></span>
<span><span class="co">#&gt;         ipredSim = rxTBSi(rx_pred_, rx_lambda_, rx_yj_, rx_low_, </span></span>
<span><span class="co">#&gt;             rx_hi_)</span></span>
<span><span class="co">#&gt;         sim = rxTBSi(rx_pred_ + sqrt(rx_r_) * rxerr.eff, rx_lambda_, </span></span>
<span><span class="co">#&gt;             rx_yj_, rx_low_, rx_hi_)</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     cmt(C2)</span></span>
<span><span class="co">#&gt;     dvid(5, 4)</span></span>
<span><span class="co">#&gt; })</span></span></code></pre></div>
<p>If you wish to speed up multiple simualtions from the
<code>rxode2</code> functions, you need to pre-calculate care of the
steps above:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="va">mod1</span><span class="op">$</span><span class="va">simulationModel</span></span>
<span></span>
<span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="va">mod2f</span><span class="op">$</span><span class="va">simulationModel</span></span></code></pre></div>
<p>These functions then can act like a normal ui model to be solved. You
can convert them back to a UI <code><a href="../reference/as.rxUi.html">as.rxUi()</a></code> or a function
<code><a href="https://rdrr.io/r/base/as.function.html" class="external-link">as.function()</a></code> as needed.</p>
<p>To increase speed for multiple simulations from the same model you
should use the lower level simulation model (ie
<code>$simulationModel</code> or <code>$simulationIniModel</code>
depending on what you need)</p>
</div>
<div class="section level2">
<h2 id="increasing-rxode2-speed-by-multi-subject-parallel-solving">Increasing rxode2 speed by multi-subject parallel solving<a class="anchor" aria-label="anchor" href="#increasing-rxode2-speed-by-multi-subject-parallel-solving"></a>
</h2>
<p>Using the classic <code>rxode2</code> model specification (which we
can convert from a functional/ui model style) we will continue the
discussion on <code>rxode2</code> speed enhancements.</p>
<p><code>rxode2</code> originally developed as an ODE solver that
allowed an ODE solve for a single subject. This flexibility is still
supported.</p>
<p>The original code from the <code>rxode2</code> tutorial is below:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlmixr2.github.io/rxode2/">rxode2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joshuaulrich/microbenchmark/" class="external-link">microbenchmark</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rxode2.html">rxode2</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">C2</span> <span class="op">=</span> <span class="va">centr</span><span class="op">/</span><span class="va">V2</span></span>
<span>    <span class="va">C3</span> <span class="op">=</span> <span class="va">peri</span><span class="op">/</span><span class="va">V3</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">depot</span><span class="op">)</span> <span class="op">=</span> <span class="op">-</span><span class="va">KA</span><span class="op">*</span><span class="va">depot</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">centr</span><span class="op">)</span> <span class="op">=</span> <span class="va">KA</span><span class="op">*</span><span class="va">depot</span> <span class="op">-</span> <span class="va">CL</span><span class="op">*</span><span class="va">C2</span> <span class="op">-</span> <span class="va">Q</span><span class="op">*</span><span class="va">C2</span> <span class="op">+</span> <span class="va">Q</span><span class="op">*</span><span class="va">C3</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">peri</span><span class="op">)</span> <span class="op">=</span> <span class="va">Q</span><span class="op">*</span><span class="va">C2</span> <span class="op">-</span> <span class="va">Q</span><span class="op">*</span><span class="va">C3</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">eff</span><span class="op">)</span> <span class="op">=</span> <span class="va">Kin</span> <span class="op">-</span> <span class="va">Kout</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">C2</span><span class="op">/</span><span class="op">(</span><span class="va">EC50</span><span class="op">+</span><span class="va">C2</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="va">eff</span></span>
<span>    <span class="fu">eff</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span> <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; C model:</span></span>
<span><span class="co">#&gt; // Define translation state order for 4 states</span></span>
<span><span class="co">#&gt; #define __DDT0__ 0 // depot</span></span>
<span><span class="co">#&gt; #define _DEPOT_ 0 // depot</span></span>
<span><span class="co">#&gt; #define __DDT1__ 1 // centr</span></span>
<span><span class="co">#&gt; #define __DDT2__ 2 // peri</span></span>
<span><span class="co">#&gt; #define __DDT3__ 3 // eff</span></span>
<span><span class="co">#&gt; // Define 2 LHS values</span></span>
<span><span class="co">#&gt; #define _LHS_0_ 0 // C2</span></span>
<span><span class="co">#&gt; #define _LHS_1_ 1 // C3</span></span>
<span><span class="co">#&gt; #define _getRxSolve_ _rx74b3848e5895f7c7d5e753cb1dff835f429__getRxSolve__5pb9</span></span>
<span><span class="co">#&gt; #define _evalUdf _rx74b3848e5895f7c7d5e753cb1dff835f430__evalUdf_0SUH</span></span>
<span><span class="co">#&gt; #define _solveData _rx74b3848e5895f7c7d5e753cb1dff835f431__solveData_jlsA</span></span>
<span><span class="co">#&gt; #define _assign_ptr _rx74b3848e5895f7c7d5e753cb1dff835f432__assign_ptr_2JOC</span></span>
<span><span class="co">#&gt; #define _rxRmModelLib _rx74b3848e5895f7c7d5e753cb1dff835f433__rxRmModelLib_P3Oy</span></span>
<span><span class="co">#&gt; #define _rxGetModelLib _rx74b3848e5895f7c7d5e753cb1dff835f434__rxGetModelLib_HgjC</span></span>
<span><span class="co">#&gt; #define _old_c _rx74b3848e5895f7c7d5e753cb1dff835f435__old_c_yj3W</span></span>
<span><span class="co">#&gt; #define _ptrid _rx74b3848e5895f7c7d5e753cb1dff835f436__ptrid_hg1D</span></span>
<span><span class="co">#&gt; #define _rxIsCurrentC _rx74b3848e5895f7c7d5e753cb1dff835f437__rxIsCurrentC_IdTQ</span></span>
<span><span class="co">#&gt; #define _sumPS _rx74b3848e5895f7c7d5e753cb1dff835f438__sumPS_hwBD</span></span>
<span><span class="co">#&gt; #define _prodPS _rx74b3848e5895f7c7d5e753cb1dff835f439__prodPS_gUde</span></span>
<span><span class="co">#&gt; #define _prodType _rx74b3848e5895f7c7d5e753cb1dff835f440__prodType_5llz</span></span>
<span><span class="co">#&gt; #define _sumType _rx74b3848e5895f7c7d5e753cb1dff835f441__sumType_yOSJ</span></span>
<span><span class="co">#&gt; #define _update_par_ptr _rx74b3848e5895f7c7d5e753cb1dff835f442__update_par_ptr_AWUm</span></span>
<span><span class="co">#&gt; #define _getParCov _rx74b3848e5895f7c7d5e753cb1dff835f443__getParCov_Ci4L</span></span>
<span><span class="co">#&gt; #define _rxode2_rxAssignPtr _rx74b3848e5895f7c7d5e753cb1dff835f444__rxode2_rxAssignPtr_pGZK</span></span>
<span><span class="co">#&gt; #define _rxQr _rx74b3848e5895f7c7d5e753cb1dff835f445__rxQr_aBwX</span></span>
<span><span class="co">#&gt; #define _compareFactorVal _rx74b3848e5895f7c7d5e753cb1dff835f446__compareFactorVal_XHRN</span></span>
<span><span class="co">#&gt; #define _sum _rx74b3848e5895f7c7d5e753cb1dff835f447__sum_1SO1</span></span>
<span><span class="co">#&gt; #define _udf _rx74b3848e5895f7c7d5e753cb1dff835f448__udf_NYrN</span></span>
<span><span class="co">#&gt; #define _sign _rx74b3848e5895f7c7d5e753cb1dff835f449__sign_WbGH</span></span>
<span><span class="co">#&gt; #define _prod _rx74b3848e5895f7c7d5e753cb1dff835f450__prod_TvOD</span></span>
<span><span class="co">#&gt; #define _max _rx74b3848e5895f7c7d5e753cb1dff835f451__max_f3z9</span></span>
<span><span class="co">#&gt; #define _min _rx74b3848e5895f7c7d5e753cb1dff835f452__min_WqiE</span></span>
<span><span class="co">#&gt; #define _transit4P _rx74b3848e5895f7c7d5e753cb1dff835f453__transit4P_Xp1T</span></span>
<span><span class="co">#&gt; #define _transit3P _rx74b3848e5895f7c7d5e753cb1dff835f454__transit3P_noPD</span></span>
<span><span class="co">#&gt; #define _assignFuns0 _rx74b3848e5895f7c7d5e753cb1dff835f455__assignFuns0_PfVe</span></span>
<span><span class="co">#&gt; #define _assignFuns _rx74b3848e5895f7c7d5e753cb1dff835f456__assignFuns_Vphs</span></span>
<span><span class="co">#&gt; #define _rxord _rx74b3848e5895f7c7d5e753cb1dff835f457__rxord_0tzV</span></span>
<span><span class="co">#&gt; #define __assignFuns2 _rx74b3848e5895f7c7d5e753cb1dff835f458___assignFuns2_Mmad</span></span>
<span><span class="co">#&gt; #define _llikCauchyDscale _rx74b3848e5895f7c7d5e753cb1dff835f459__llikCauchyDscale_rZFu</span></span>
<span><span class="co">#&gt; #define _llikCauchyDlocation _rx74b3848e5895f7c7d5e753cb1dff835f460__llikCauchyDlocation_rFOl</span></span>
<span><span class="co">#&gt; #define _llikCauchy _rx74b3848e5895f7c7d5e753cb1dff835f461__llikCauchy_7CAf</span></span>
<span><span class="co">#&gt; #define _llikGammaDrate _rx74b3848e5895f7c7d5e753cb1dff835f462__llikGammaDrate_rvYZ</span></span>
<span><span class="co">#&gt; #define _llikGammaDshape _rx74b3848e5895f7c7d5e753cb1dff835f463__llikGammaDshape_gF2u</span></span>
<span><span class="co">#&gt; #define _llikGamma _rx74b3848e5895f7c7d5e753cb1dff835f464__llikGamma_4zbA</span></span>
<span><span class="co">#&gt; #define _llikWeibullDscale _rx74b3848e5895f7c7d5e753cb1dff835f465__llikWeibullDscale_u2aE</span></span>
<span><span class="co">#&gt; #define _llikWeibullDshape _rx74b3848e5895f7c7d5e753cb1dff835f466__llikWeibullDshape_uohD</span></span>
<span><span class="co">#&gt; #define _llikWeibull _rx74b3848e5895f7c7d5e753cb1dff835f467__llikWeibull_jDSK</span></span>
<span><span class="co">#&gt; #define _llikUnifDbeta _rx74b3848e5895f7c7d5e753cb1dff835f468__llikUnifDbeta_ZFSu</span></span>
<span><span class="co">#&gt; #define _llikUnifDalpha _rx74b3848e5895f7c7d5e753cb1dff835f469__llikUnifDalpha_yota</span></span>
<span><span class="co">#&gt; #define _llikUnif _rx74b3848e5895f7c7d5e753cb1dff835f470__llikUnif_lziD</span></span>
<span><span class="co">#&gt; #define _llikGeomDp _rx74b3848e5895f7c7d5e753cb1dff835f471__llikGeomDp_IirE</span></span>
<span><span class="co">#&gt; #define _llikGeom _rx74b3848e5895f7c7d5e753cb1dff835f472__llikGeom_0wRk</span></span>
<span><span class="co">#&gt; #define _llikFDdf2 _rx74b3848e5895f7c7d5e753cb1dff835f473__llikFDdf2_fPLj</span></span>
<span><span class="co">#&gt; #define _llikFDdf1 _rx74b3848e5895f7c7d5e753cb1dff835f474__llikFDdf1_f5r4</span></span>
<span><span class="co">#&gt; #define _llikF _rx74b3848e5895f7c7d5e753cb1dff835f475__llikF_q6UF</span></span>
<span><span class="co">#&gt; #define _llikExpDrate _rx74b3848e5895f7c7d5e753cb1dff835f476__llikExpDrate_gAxJ</span></span>
<span><span class="co">#&gt; #define _llikExp _rx74b3848e5895f7c7d5e753cb1dff835f477__llikExp_Mtp6</span></span>
<span><span class="co">#&gt; #define _llikChisqDdf _rx74b3848e5895f7c7d5e753cb1dff835f478__llikChisqDdf_ulNz</span></span>
<span><span class="co">#&gt; #define _llikChisq _rx74b3848e5895f7c7d5e753cb1dff835f479__llikChisq_LwD1</span></span>
<span><span class="co">#&gt; #define _llikTDsd _rx74b3848e5895f7c7d5e753cb1dff835f480__llikTDsd_9qDD</span></span>
<span><span class="co">#&gt; #define _llikTDmean _rx74b3848e5895f7c7d5e753cb1dff835f481__llikTDmean_2wFm</span></span>
<span><span class="co">#&gt; #define _llikTDdf _rx74b3848e5895f7c7d5e753cb1dff835f482__llikTDdf_HsIy</span></span>
<span><span class="co">#&gt; #define _llikT _rx74b3848e5895f7c7d5e753cb1dff835f483__llikT_alpl</span></span>
<span><span class="co">#&gt; #define _llikBetaDshape2 _rx74b3848e5895f7c7d5e753cb1dff835f484__llikBetaDshape2_P85e</span></span>
<span><span class="co">#&gt; #define _llikBetaDshape1 _rx74b3848e5895f7c7d5e753cb1dff835f485__llikBetaDshape1_beKy</span></span>
<span><span class="co">#&gt; #define _llikBeta _rx74b3848e5895f7c7d5e753cb1dff835f486__llikBeta_isyD</span></span>
<span><span class="co">#&gt; #define _llikNbinomMuDmu _rx74b3848e5895f7c7d5e753cb1dff835f487__llikNbinomMuDmu_fO2c</span></span>
<span><span class="co">#&gt; #define _llikNbinomMu _rx74b3848e5895f7c7d5e753cb1dff835f488__llikNbinomMu_bPrW</span></span>
<span><span class="co">#&gt; #define _llikNbinomDprob _rx74b3848e5895f7c7d5e753cb1dff835f489__llikNbinomDprob_y1fN</span></span>
<span><span class="co">#&gt; #define _llikNbinom _rx74b3848e5895f7c7d5e753cb1dff835f490__llikNbinom_ugfk</span></span>
<span><span class="co">#&gt; #define _llikBinomDprob _rx74b3848e5895f7c7d5e753cb1dff835f491__llikBinomDprob_XEVP</span></span>
<span><span class="co">#&gt; #define _llikBinom _rx74b3848e5895f7c7d5e753cb1dff835f492__llikBinom_jdOx</span></span>
<span><span class="co">#&gt; #define _llikPoisDlambda _rx74b3848e5895f7c7d5e753cb1dff835f493__llikPoisDlambda_I3ZD</span></span>
<span><span class="co">#&gt; #define _llikPois _rx74b3848e5895f7c7d5e753cb1dff835f494__llikPois_7wnk</span></span>
<span><span class="co">#&gt; #define _llikNormDsd _rx74b3848e5895f7c7d5e753cb1dff835f495__llikNormDsd_XX5O</span></span>
<span><span class="co">#&gt; #define _llikNormDmean _rx74b3848e5895f7c7d5e753cb1dff835f496__llikNormDmean_Agfw</span></span>
<span><span class="co">#&gt; #define _llikNorm _rx74b3848e5895f7c7d5e753cb1dff835f497__llikNorm_CyNe</span></span>
<span><span class="co">#&gt; #define simeps _rx74b3848e5895f7c7d5e753cb1dff835f498_simeps_o4Wl</span></span>
<span><span class="co">#&gt; #define simeta _rx74b3848e5895f7c7d5e753cb1dff835f499_simeta_QYC1</span></span>
<span><span class="co">#&gt; #define expit _rx74b3848e5895f7c7d5e753cb1dff835f500_expit_yBms</span></span>
<span><span class="co">#&gt; #define logit _rx74b3848e5895f7c7d5e753cb1dff835f501_logit_pbu2</span></span>
<span><span class="co">#&gt; #define gammapDer _rx74b3848e5895f7c7d5e753cb1dff835f502_gammapDer_85hP</span></span>
<span><span class="co">#&gt; #define lowergamma _rx74b3848e5895f7c7d5e753cb1dff835f503_lowergamma_47wD</span></span>
<span><span class="co">#&gt; #define uppergamma _rx74b3848e5895f7c7d5e753cb1dff835f504_uppergamma_fCYp</span></span>
<span><span class="co">#&gt; #define gammaqInva _rx74b3848e5895f7c7d5e753cb1dff835f505_gammaqInva_7GH0</span></span>
<span><span class="co">#&gt; #define gammaqInv _rx74b3848e5895f7c7d5e753cb1dff835f506_gammaqInv_qPki</span></span>
<span><span class="co">#&gt; #define gammapInva _rx74b3848e5895f7c7d5e753cb1dff835f507_gammapInva_VyMA</span></span>
<span><span class="co">#&gt; #define gammapInv _rx74b3848e5895f7c7d5e753cb1dff835f508_gammapInv_m1mA</span></span>
<span><span class="co">#&gt; #define gammaq _rx74b3848e5895f7c7d5e753cb1dff835f509_gammaq_1mpx</span></span>
<span><span class="co">#&gt; #define gammap _rx74b3848e5895f7c7d5e753cb1dff835f510_gammap_NAbn</span></span>
<span><span class="co">#&gt; #define phi _rx74b3848e5895f7c7d5e753cb1dff835f511_phi_2jD0</span></span>
<span><span class="co">#&gt; #define d2ELUa _rx74b3848e5895f7c7d5e753cb1dff835f512_d2ELUa_7gdK</span></span>
<span><span class="co">#&gt; #define dELUa _rx74b3848e5895f7c7d5e753cb1dff835f513_dELUa_Ohhv</span></span>
<span><span class="co">#&gt; #define d2aELU _rx74b3848e5895f7c7d5e753cb1dff835f514_d2aELU_SaAZ</span></span>
<span><span class="co">#&gt; #define d2ELU _rx74b3848e5895f7c7d5e753cb1dff835f515_d2ELU_tapa</span></span>
<span><span class="co">#&gt; #define dELU _rx74b3848e5895f7c7d5e753cb1dff835f516_dELU_mOqj</span></span>
<span><span class="co">#&gt; #define ELU _rx74b3848e5895f7c7d5e753cb1dff835f517_ELU_J66n</span></span>
<span><span class="co">#&gt; #define dPReLUa1 _rx74b3848e5895f7c7d5e753cb1dff835f518_dPReLUa1_N3zb</span></span>
<span><span class="co">#&gt; #define dPReLUa _rx74b3848e5895f7c7d5e753cb1dff835f519_dPReLUa_9X7x</span></span>
<span><span class="co">#&gt; #define dPReLU _rx74b3848e5895f7c7d5e753cb1dff835f520_dPReLU_2Awy</span></span>
<span><span class="co">#&gt; #define PReLU _rx74b3848e5895f7c7d5e753cb1dff835f521_PReLU_isy2</span></span>
<span><span class="co">#&gt; #define dSwish _rx74b3848e5895f7c7d5e753cb1dff835f522_dSwish_RdzJ</span></span>
<span><span class="co">#&gt; #define Swish _rx74b3848e5895f7c7d5e753cb1dff835f523_Swish_rXsV</span></span>
<span><span class="co">#&gt; #define dlReLU _rx74b3848e5895f7c7d5e753cb1dff835f524_dlReLU_rrL0</span></span>
<span><span class="co">#&gt; #define lReLU _rx74b3848e5895f7c7d5e753cb1dff835f525_lReLU_CwHs</span></span>
<span><span class="co">#&gt; #define dSELU _rx74b3848e5895f7c7d5e753cb1dff835f526_dSELU_x0YD</span></span>
<span><span class="co">#&gt; #define SELU _rx74b3848e5895f7c7d5e753cb1dff835f527_SELU_ejsN</span></span>
<span><span class="co">#&gt; #define d4softplus _rx74b3848e5895f7c7d5e753cb1dff835f528_d4softplus_tqj2</span></span>
<span><span class="co">#&gt; #define d3softplus _rx74b3848e5895f7c7d5e753cb1dff835f529_d3softplus_KkuC</span></span>
<span><span class="co">#&gt; #define d2softplus _rx74b3848e5895f7c7d5e753cb1dff835f530_d2softplus_TNOD</span></span>
<span><span class="co">#&gt; #define dsoftplus _rx74b3848e5895f7c7d5e753cb1dff835f531_dsoftplus_0MWq</span></span>
<span><span class="co">#&gt; #define softplus _rx74b3848e5895f7c7d5e753cb1dff835f532_softplus_8NGU</span></span>
<span><span class="co">#&gt; #define d4GELU _rx74b3848e5895f7c7d5e753cb1dff835f533_d4GELU_15zw</span></span>
<span><span class="co">#&gt; #define d3GELU _rx74b3848e5895f7c7d5e753cb1dff835f534_d3GELU_77MT</span></span>
<span><span class="co">#&gt; #define d2GELU _rx74b3848e5895f7c7d5e753cb1dff835f535_d2GELU_mU6w</span></span>
<span><span class="co">#&gt; #define dGELU _rx74b3848e5895f7c7d5e753cb1dff835f536_dGELU_hVWG</span></span>
<span><span class="co">#&gt; #define GELU _rx74b3848e5895f7c7d5e753cb1dff835f537_GELU_iyen</span></span>
<span><span class="co">#&gt; #define dReLU _rx74b3848e5895f7c7d5e753cb1dff835f538_dReLU_4spi</span></span>
<span><span class="co">#&gt; #define ReLU _rx74b3848e5895f7c7d5e753cb1dff835f539_ReLU_MWT6</span></span>
<span><span class="co">#&gt; #define riweibull _rx74b3848e5895f7c7d5e753cb1dff835f540_riweibull_VRYe</span></span>
<span><span class="co">#&gt; #define riunif _rx74b3848e5895f7c7d5e753cb1dff835f541_riunif_9Ita</span></span>
<span><span class="co">#&gt; #define rit_ _rx74b3848e5895f7c7d5e753cb1dff835f542_rit__dGJL</span></span>
<span><span class="co">#&gt; #define ripois _rx74b3848e5895f7c7d5e753cb1dff835f543_ripois_l03G</span></span>
<span><span class="co">#&gt; #define ribeta _rx74b3848e5895f7c7d5e753cb1dff835f544_ribeta_aI5l</span></span>
<span><span class="co">#&gt; #define rigamma _rx74b3848e5895f7c7d5e753cb1dff835f545_rigamma_lO3k</span></span>
<span><span class="co">#&gt; #define rigeom _rx74b3848e5895f7c7d5e753cb1dff835f546_rigeom_WHGX</span></span>
<span><span class="co">#&gt; #define rif _rx74b3848e5895f7c7d5e753cb1dff835f547_rif_CdkG</span></span>
<span><span class="co">#&gt; #define riexp _rx74b3848e5895f7c7d5e753cb1dff835f548_riexp_sq2N</span></span>
<span><span class="co">#&gt; #define richisq _rx74b3848e5895f7c7d5e753cb1dff835f549_richisq_BvuB</span></span>
<span><span class="co">#&gt; #define ricauchy _rx74b3848e5895f7c7d5e753cb1dff835f550_ricauchy_r0sO</span></span>
<span><span class="co">#&gt; #define rinbinomMu _rx74b3848e5895f7c7d5e753cb1dff835f551_rinbinomMu_4eup</span></span>
<span><span class="co">#&gt; #define rinbinom _rx74b3848e5895f7c7d5e753cb1dff835f552_rinbinom_VbTs</span></span>
<span><span class="co">#&gt; #define ribinom _rx74b3848e5895f7c7d5e753cb1dff835f553_ribinom_fOYF</span></span>
<span><span class="co">#&gt; #define rinorm _rx74b3848e5895f7c7d5e753cb1dff835f554_rinorm_C4Jz</span></span>
<span><span class="co">#&gt; #define rxweibull _rx74b3848e5895f7c7d5e753cb1dff835f555_rxweibull_7iE8</span></span>
<span><span class="co">#&gt; #define rxunif _rx74b3848e5895f7c7d5e753cb1dff835f556_rxunif_vtCF</span></span>
<span><span class="co">#&gt; #define rxt_ _rx74b3848e5895f7c7d5e753cb1dff835f557_rxt__cRJ6</span></span>
<span><span class="co">#&gt; #define rxpois _rx74b3848e5895f7c7d5e753cb1dff835f558_rxpois_Gev1</span></span>
<span><span class="co">#&gt; #define rxbeta _rx74b3848e5895f7c7d5e753cb1dff835f559_rxbeta_Yq4C</span></span>
<span><span class="co">#&gt; #define rxgamma _rx74b3848e5895f7c7d5e753cb1dff835f560_rxgamma_UGPR</span></span>
<span><span class="co">#&gt; #define rxgeom _rx74b3848e5895f7c7d5e753cb1dff835f561_rxgeom_B41j</span></span>
<span><span class="co">#&gt; #define rxf _rx74b3848e5895f7c7d5e753cb1dff835f562_rxf_yXA3</span></span>
<span><span class="co">#&gt; #define rxexp _rx74b3848e5895f7c7d5e753cb1dff835f563_rxexp_Scak</span></span>
<span><span class="co">#&gt; #define rxchisq _rx74b3848e5895f7c7d5e753cb1dff835f564_rxchisq_WU0x</span></span>
<span><span class="co">#&gt; #define rxcauchy _rx74b3848e5895f7c7d5e753cb1dff835f565_rxcauchy_SyXM</span></span>
<span><span class="co">#&gt; #define rxnbinomMu _rx74b3848e5895f7c7d5e753cb1dff835f566_rxnbinomMu_V4ye</span></span>
<span><span class="co">#&gt; #define rxnbinom _rx74b3848e5895f7c7d5e753cb1dff835f567_rxnbinom_zXlY</span></span>
<span><span class="co">#&gt; #define rxbinom _rx74b3848e5895f7c7d5e753cb1dff835f568_rxbinom_mdNM</span></span>
<span><span class="co">#&gt; #define rxnorm _rx74b3848e5895f7c7d5e753cb1dff835f569_rxnorm_qSBx</span></span>
<span><span class="co">#&gt; #define linCmtB _rx74b3848e5895f7c7d5e753cb1dff835f570_linCmtB_i1cp</span></span>
<span><span class="co">#&gt; #define linCmtA _rx74b3848e5895f7c7d5e753cb1dff835f571_linCmtA_dhrH</span></span>
<span><span class="co">#&gt; #include &lt;rxode2_model_shared.h&gt;</span></span>
<span><span class="co">#&gt; #define __MAX_PROD__ 0</span></span>
<span><span class="co">#&gt; #define _CMT CMT</span></span>
<span><span class="co">#&gt; #define _SYNC_simeps_ for (int _svari=_solveData-&gt;neps; _svari--;){  if (_solveData-&gt;svar[_svari] == 0) {V2 = _PP[0];};   if (_solveData-&gt;svar[_svari] == 1) {V3 = _PP[1];};   if (_solveData-&gt;svar[_svari] == 2) {KA = _PP[2];};   if (_solveData-&gt;svar[_svari] == 3) {CL = _PP[3];};   if (_solveData-&gt;svar[_svari] == 4) {Q = _PP[4];};   if (_solveData-&gt;svar[_svari] == 5) {Kin = _PP[5];};   if (_solveData-&gt;svar[_svari] == 6) {Kout = _PP[6];};   if (_solveData-&gt;svar[_svari] == 7) {EC50 = _PP[7];}; }</span></span>
<span><span class="co">#&gt; #define _SYNC_simeta_ for (int _ovari=_solveData-&gt;neta; _ovari--;){  if (_solveData-&gt;ovar[_ovari] == 0) {V2 = _PP[0];};   if (_solveData-&gt;ovar[_ovari] == 1) {V3 = _PP[1];};   if (_solveData-&gt;ovar[_ovari] == 2) {KA = _PP[2];};   if (_solveData-&gt;ovar[_ovari] == 3) {CL = _PP[3];};   if (_solveData-&gt;ovar[_ovari] == 4) {Q = _PP[4];};   if (_solveData-&gt;ovar[_ovari] == 5) {Kin = _PP[5];};   if (_solveData-&gt;ovar[_ovari] == 6) {Kout = _PP[6];};   if (_solveData-&gt;ovar[_ovari] == 7) {EC50 = _PP[7];}; }</span></span>
<span><span class="co">#&gt; _getRxSolve_t _getRxSolve_;</span></span>
<span><span class="co">#&gt; _simfun simeps;</span></span>
<span><span class="co">#&gt; _simfun simeta;</span></span>
<span><span class="co">#&gt; _udf_type _evalUdf=NULL;</span></span>
<span><span class="co">#&gt; rx_solve *_solveData=NULL;</span></span>
<span><span class="co">#&gt; rxode2_assign_ptr _assign_ptr=NULL;</span></span>
<span><span class="co">#&gt; _rxRmModelLibType _rxRmModelLib=NULL;</span></span>
<span><span class="co">#&gt; _rxGetModelLibType _rxGetModelLib=NULL;</span></span>
<span><span class="co">#&gt; rxode2_ode_solver_old_c _old_c=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _ptrid=NULL;</span></span>
<span><span class="co">#&gt; _rxIsCurrentC_type _rxIsCurrentC=NULL;</span></span>
<span><span class="co">#&gt; _rxSumType _sumPS=NULL;</span></span>
<span><span class="co">#&gt; _rxProdType _prodPS=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _prodType=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _sumType=NULL;</span></span>
<span><span class="co">#&gt; _update_par_ptr_p _update_par_ptr=NULL;</span></span>
<span><span class="co">#&gt; _getParCov_p _getParCov=NULL;</span></span>
<span><span class="co">#&gt; linCmtA_p linCmtA;</span></span>
<span><span class="co">#&gt; linCmtB_p linCmtB;</span></span>
<span><span class="co">#&gt; _rx_asgn _rxode2_rxAssignPtr=NULL;</span></span>
<span><span class="co">#&gt; _rx_asgn _rxQr=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn phi;</span></span>
<span><span class="co">#&gt; rxode2_fn ReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn dReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn dGELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d2GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d3GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d4GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn dsoftplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d2softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d3softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d4softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn SELU;</span></span>
<span><span class="co">#&gt; rxode2_fn dSELU;</span></span>
<span><span class="co">#&gt; rxode2_fn lReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn dlReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn Swish;</span></span>
<span><span class="co">#&gt; rxode2_fn dSwish;</span></span>
<span><span class="co">#&gt; rxode2_fn2 PReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLUa;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLUa1;</span></span>
<span><span class="co">#&gt; rxode2_fn2 ELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2ELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2aELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dELUa;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2ELUa;</span></span>
<span><span class="co">#&gt; rxode2_fn3 logit;</span></span>
<span><span class="co">#&gt; rxode2_fn3 expit;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammap;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaq;</span></span>
<span><span class="co">#&gt; rxode2_fn2 lowergamma;</span></span>
<span><span class="co">#&gt; rxode2_fn2 uppergamma;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapInv;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapDer;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapInva;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaqInv;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaqInva;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxnorm;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxbinom;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxnbinom;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxnbinomMu;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxcauchy;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxchisq;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxexp;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxf;</span></span>
<span><span class="co">#&gt; rxode2i_ifn rxgeom;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxgamma;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxbeta;</span></span>
<span><span class="co">#&gt; rxode2i_ifn rxpois;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxt_;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxunif;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxweibull;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rinorm;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom ribinom;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom rinbinom;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom rinbinomMu;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 ricauchy;</span></span>
<span><span class="co">#&gt; rxode2i2_fn richisq;</span></span>
<span><span class="co">#&gt; rxode2i2_fn riexp;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rif;</span></span>
<span><span class="co">#&gt; rxode2i2_ifn rigeom;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rigamma;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 ribeta;</span></span>
<span><span class="co">#&gt; rxode2i2_ifn ripois;</span></span>
<span><span class="co">#&gt; rxode2i2_fn rit_;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 riunif;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 riweibull;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNorm;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNormDmean;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNormDsd;</span></span>
<span><span class="co">#&gt; rxode2_llikPoisFun _llikPois;</span></span>
<span><span class="co">#&gt; rxode2_llikPoisFun _llikPoisDlambda;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikBinom;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikBinomDprob;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinom;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomDprob;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomMu;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomMuDmu;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBeta;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBetaDshape1;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBetaDshape2;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikT;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDdf;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDmean;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDsd;</span></span>
<span><span class="co">#&gt; rxode2_llikChisqFun _llikChisq;</span></span>
<span><span class="co">#&gt; rxode2_llikChisqFun _llikChisqDdf;</span></span>
<span><span class="co">#&gt; rxode2_llikExpFun _llikExp;</span></span>
<span><span class="co">#&gt; rxode2_llikExpFun _llikExpDrate;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikF;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikFDdf1;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikFDdf2;</span></span>
<span><span class="co">#&gt; rxode2_llikGeomFun _llikGeom;</span></span>
<span><span class="co">#&gt; rxode2_llikGeomFun _llikGeomDp;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnif;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnifDalpha;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnifDbeta;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibull;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibullDshape;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibullDscale;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGamma;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGammaDshape;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGammaDrate;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchy;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchyDlocation;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchyDscale;</span></span>
<span><span class="co">#&gt; rxode2_compareFactorVal_fn _compareFactorVal;</span></span>
<span><span class="co">#&gt; #include "extraC.h"</span></span>
<span><span class="co">#&gt; double _prod(double *input, double *p, int type, int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return _prodPS(input, p, n, type);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _udf(const char *funName, double *input, int n, ...) {</span></span>
<span><span class="co">#&gt;   if (n == -42) Rf_error("%s", "this has a ui user function that cannot be called directly");</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return _evalUdf(funName, n, input);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _sum(double *input, double *pld, int m, int type, int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   double ret = _sumPS(input, n, pld, m, type);</span></span>
<span><span class="co">#&gt;   if (type == 2 &amp;&amp; m &lt; 0){</span></span>
<span><span class="co">#&gt;     for (int i = -m; i--;){</span></span>
<span><span class="co">#&gt;       pld[i] = 0.0;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return ret;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _sign(unsigned int n, ...) {</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double s = 1;</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;     s = sign(va_arg(valist, double))*s;</span></span>
<span><span class="co">#&gt;     if (s == 0){</span></span>
<span><span class="co">#&gt;       break;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return s;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _rxord(int _cSub, unsigned int n,  ...) {</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind* ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   if (!ind-&gt;inLhs) {</span></span>
<span><span class="co">#&gt;     return 1.0;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double ret = 1.0;</span></span>
<span><span class="co">#&gt;   double p = 0.0;</span></span>
<span><span class="co">#&gt;   double u = rxunif(ind, 0.0, 1.0);</span></span>
<span><span class="co">#&gt;   int found = 0;</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;     p += va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     if (!found) {</span></span>
<span><span class="co">#&gt;       if (u &lt; p) {</span></span>
<span><span class="co">#&gt;         ret = (double)(i+1);</span></span>
<span><span class="co">#&gt;         found = 1;</span></span>
<span><span class="co">#&gt;       }</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   if (!found) ret =(double)(n+1);</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return ret;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _max(unsigned int n, ...) {</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double mx = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tmp = 0;</span></span>
<span><span class="co">#&gt;   if (n &gt;= 1){</span></span>
<span><span class="co">#&gt;     mx = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     for (unsigned int i = 1; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;       tmp = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;       if (tmp&gt;mx) mx=tmp;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     va_end(valist);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return mx;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _min(unsigned int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double mn = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tmp = 0;</span></span>
<span><span class="co">#&gt;   if (n &gt;= 1){</span></span>
<span><span class="co">#&gt;     mn = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     for (unsigned int i = 1; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;       tmp = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;       if (tmp&lt;mn) mn=tmp;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     va_end(valist);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return mn;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _transit4P(int cmt, double t, unsigned int id, double n, double mtt, double bio){</span></span>
<span><span class="co">#&gt;   double nd = (double) n;</span></span>
<span><span class="co">#&gt;   double ktr = (nd+1)/mtt;</span></span>
<span><span class="co">#&gt;   double lktr = _safe_log(nd+1)-_safe_log(mtt);</span></span>
<span><span class="co">#&gt;   double tlast = _solveData-&gt;subjects[id].tlastS[cmt];</span></span>
<span><span class="co">#&gt;   double dose = _solveData-&gt;subjects[id].curDoseS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(dose)) dose = 0.0;</span></span>
<span><span class="co">#&gt;   if (ISNA(tlast)) tlast = 0.0;</span></span>
<span><span class="co">#&gt;   double tad = (t-tlast);</span></span>
<span><span class="co">#&gt;   return exp(_safe_log(bio*dose)+lktr+n*(lktr+_safe_log(tad))-ktr*(tad)-lgamma1p(nd));</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _transit3P(int cmt, double t, unsigned int id, double n, double mtt){</span></span>
<span><span class="co">#&gt;   double nd = (double) n;</span></span>
<span><span class="co">#&gt;   double ktr = (nd+1)/mtt;</span></span>
<span><span class="co">#&gt;   double lktr = _safe_log(nd+1)-_safe_log(mtt);</span></span>
<span><span class="co">#&gt;   double tlast = _solveData-&gt;subjects[id].tlastS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(tlast)) tlast = 0.0;</span></span>
<span><span class="co">#&gt;   double tad = t-tlast;</span></span>
<span><span class="co">#&gt;   double podo = _solveData-&gt;subjects[id].curDoseS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(podo)) podo = 0.0;</span></span>
<span><span class="co">#&gt;   return exp(_safe_log(podo)+lktr+n*(lktr+_safe_log(tad))-ktr*(tad)-lgamma1p(nd));</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void _assignFuns0(void) {</span></span>
<span><span class="co">#&gt;   _evalUdf = (_udf_type) R_GetCCallable("rxode2", "_rxode2_evalUdf");</span></span>
<span><span class="co">#&gt;   _getRxSolve_ = (_getRxSolve_t) R_GetCCallable("rxode2","getRxSolve_");</span></span>
<span><span class="co">#&gt;   _assign_ptr=(rxode2_assign_ptr) R_GetCCallable("rxode2","rxode2_assign_fn_pointers");</span></span>
<span><span class="co">#&gt;   _rxRmModelLib=(_rxRmModelLibType) R_GetCCallable("rxode2","rxRmModelLib");</span></span>
<span><span class="co">#&gt;   _rxGetModelLib=(_rxGetModelLibType) R_GetCCallable("rxode2","rxGetModelLib");</span></span>
<span><span class="co">#&gt;   _rxode2_rxAssignPtr=(_rx_asgn)R_GetCCallable("rxode2","_rxode2_rxAssignPtr");</span></span>
<span><span class="co">#&gt;   _rxQr=(_rx_asgn)R_GetCCallable("rxode2","_rxode2_rxQr");</span></span>
<span><span class="co">#&gt;   _rxIsCurrentC = (_rxIsCurrentC_type)R_GetCCallable("rxode2","rxIsCurrentC");</span></span>
<span><span class="co">#&gt;   _sumPS  = (_rxSumType) R_GetCCallable("PreciseSums","PreciseSums_sum_r");</span></span>
<span><span class="co">#&gt;   _prodPS = (_rxProdType) R_GetCCallable("PreciseSums","PreciseSums_prod_r");</span></span>
<span><span class="co">#&gt;   _prodType=(rxode2_fn0i)R_GetCCallable("PreciseSums", "PreciseSums_prod_get");</span></span>
<span><span class="co">#&gt;   _sumType=(rxode2_fn0i)R_GetCCallable("PreciseSums", "PreciseSums_sum_get");</span></span>
<span><span class="co">#&gt;   _ptrid=(rxode2_fn0i)R_GetCCallable("rxode2", "rxode2_current_fn_pointer_id");</span></span>
<span><span class="co">#&gt;   _compareFactorVal=(rxode2_compareFactorVal_fn) R_GetCCallable("rxode2", "compareFactorVal");</span></span>
<span><span class="co">#&gt;   _update_par_ptr = (_update_par_ptr_p) R_GetCCallable("rxode2","_update_par_ptr");</span></span>
<span><span class="co">#&gt;   _getParCov = (_getParCov_p) R_GetCCallable("rxode2","_getParCov");</span></span>
<span><span class="co">#&gt;   // dynamic start</span></span>
<span><span class="co">#&gt;   _llikCauchyDscale = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchyDscale");</span></span>
<span><span class="co">#&gt;   _llikCauchyDlocation = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchyDlocation");</span></span>
<span><span class="co">#&gt;   _llikCauchy = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchy");</span></span>
<span><span class="co">#&gt;   _llikGammaDrate = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGammaDrate");</span></span>
<span><span class="co">#&gt;   _llikGammaDshape = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGammaDshape");</span></span>
<span><span class="co">#&gt;   _llikGamma = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGamma");</span></span>
<span><span class="co">#&gt;   _llikWeibullDscale = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibullDscale");</span></span>
<span><span class="co">#&gt;   _llikWeibullDshape = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibullDshape");</span></span>
<span><span class="co">#&gt;   _llikWeibull = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibull");</span></span>
<span><span class="co">#&gt;   _llikUnifDbeta = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnifDbeta");</span></span>
<span><span class="co">#&gt;   _llikUnifDalpha = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnifDalpha");</span></span>
<span><span class="co">#&gt;   _llikUnif = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnif");</span></span>
<span><span class="co">#&gt;   _llikGeomDp = (rxode2_llikGeomFun) R_GetCCallable("rxode2ll", "rxLlikGeomDp");</span></span>
<span><span class="co">#&gt;   _llikGeom = (rxode2_llikGeomFun) R_GetCCallable("rxode2ll", "rxLlikGeom");</span></span>
<span><span class="co">#&gt;   _llikFDdf2 = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikFDdf2");</span></span>
<span><span class="co">#&gt;   _llikFDdf1 = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikFDdf1");</span></span>
<span><span class="co">#&gt;   _llikF = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikF");</span></span>
<span><span class="co">#&gt;   _llikExpDrate = (rxode2_llikExpFun) R_GetCCallable("rxode2ll", "rxLlikExpDrate");</span></span>
<span><span class="co">#&gt;   _llikExp = (rxode2_llikExpFun) R_GetCCallable("rxode2ll", "rxLlikExp");</span></span>
<span><span class="co">#&gt;   _llikChisqDdf = (rxode2_llikChisqFun) R_GetCCallable("rxode2ll", "rxLlikChisqDdf");</span></span>
<span><span class="co">#&gt;   _llikChisq = (rxode2_llikChisqFun) R_GetCCallable("rxode2ll", "rxLlikChisq");</span></span>
<span><span class="co">#&gt;   _llikTDsd = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDsd");</span></span>
<span><span class="co">#&gt;   _llikTDmean = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDmean");</span></span>
<span><span class="co">#&gt;   _llikTDdf = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDdf");</span></span>
<span><span class="co">#&gt;   _llikT = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikT");</span></span>
<span><span class="co">#&gt;   _llikBetaDshape2 = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBetaDshape2");</span></span>
<span><span class="co">#&gt;   _llikBetaDshape1 = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBetaDshape1");</span></span>
<span><span class="co">#&gt;   _llikBeta = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBeta");</span></span>
<span><span class="co">#&gt;   _llikNbinomMuDmu = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomMuDmu");</span></span>
<span><span class="co">#&gt;   _llikNbinomMu = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomMu");</span></span>
<span><span class="co">#&gt;   _llikNbinomDprob = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomDprob");</span></span>
<span><span class="co">#&gt;   _llikNbinom = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinom");</span></span>
<span><span class="co">#&gt;   _llikBinomDprob = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikBinomDprob");</span></span>
<span><span class="co">#&gt;   _llikBinom = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikBinom");</span></span>
<span><span class="co">#&gt;   _llikPoisDlambda = (rxode2_llikPoisFun) R_GetCCallable("rxode2ll", "rxLlikPoisDlambda");</span></span>
<span><span class="co">#&gt;   _llikPois = (rxode2_llikPoisFun) R_GetCCallable("rxode2ll", "rxLlikPois");</span></span>
<span><span class="co">#&gt;   _llikNormDsd = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNormDsd");</span></span>
<span><span class="co">#&gt;   _llikNormDmean = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNormDmean");</span></span>
<span><span class="co">#&gt;   _llikNorm = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNorm");</span></span>
<span><span class="co">#&gt;   simeps = (_simfun) R_GetCCallable("rxode2", "simeps");</span></span>
<span><span class="co">#&gt;   simeta = (_simfun) R_GetCCallable("rxode2", "simeta");</span></span>
<span><span class="co">#&gt;   expit = (rxode2_fn3) R_GetCCallable("rxode2", "expit");</span></span>
<span><span class="co">#&gt;   logit = (rxode2_fn3) R_GetCCallable("rxode2", "logit");</span></span>
<span><span class="co">#&gt;   gammapDer = (rxode2_fn2) R_GetCCallable("rxode2", "gammapDer");</span></span>
<span><span class="co">#&gt;   lowergamma = (rxode2_fn2) R_GetCCallable("rxode2", "lowergamma");</span></span>
<span><span class="co">#&gt;   uppergamma = (rxode2_fn2) R_GetCCallable("rxode2", "uppergamma");</span></span>
<span><span class="co">#&gt;   gammaqInva = (rxode2_fn2) R_GetCCallable("rxode2", "gammaqInva");</span></span>
<span><span class="co">#&gt;   gammaqInv = (rxode2_fn2) R_GetCCallable("rxode2", "gammaqInv");</span></span>
<span><span class="co">#&gt;   gammapInva = (rxode2_fn2) R_GetCCallable("rxode2", "gammapInva");</span></span>
<span><span class="co">#&gt;   gammapInv = (rxode2_fn2) R_GetCCallable("rxode2", "gammapInv");</span></span>
<span><span class="co">#&gt;   gammaq = (rxode2_fn2) R_GetCCallable("rxode2", "gammaq");</span></span>
<span><span class="co">#&gt;   gammap = (rxode2_fn2) R_GetCCallable("rxode2", "gammap");</span></span>
<span><span class="co">#&gt;   phi = (rxode2_fn) R_GetCCallable("rxode2", "phi");</span></span>
<span><span class="co">#&gt;   d2ELUa = (rxode2_fn2) R_GetCCallable("rxode2", "d2ELUa");</span></span>
<span><span class="co">#&gt;   dELUa = (rxode2_fn2) R_GetCCallable("rxode2", "dELUa");</span></span>
<span><span class="co">#&gt;   d2aELU = (rxode2_fn2) R_GetCCallable("rxode2", "d2aELU");</span></span>
<span><span class="co">#&gt;   d2ELU = (rxode2_fn2) R_GetCCallable("rxode2", "d2ELU");</span></span>
<span><span class="co">#&gt;   dELU = (rxode2_fn2) R_GetCCallable("rxode2", "dELU");</span></span>
<span><span class="co">#&gt;   ELU = (rxode2_fn2) R_GetCCallable("rxode2", "ELU");</span></span>
<span><span class="co">#&gt;   dPReLUa1 = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLUa1");</span></span>
<span><span class="co">#&gt;   dPReLUa = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLUa");</span></span>
<span><span class="co">#&gt;   dPReLU = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLU");</span></span>
<span><span class="co">#&gt;   PReLU = (rxode2_fn2) R_GetCCallable("rxode2", "PReLU");</span></span>
<span><span class="co">#&gt;   dSwish = (rxode2_fn) R_GetCCallable("rxode2", "dSwish");</span></span>
<span><span class="co">#&gt;   Swish = (rxode2_fn) R_GetCCallable("rxode2", "Swish");</span></span>
<span><span class="co">#&gt;   dlReLU = (rxode2_fn) R_GetCCallable("rxode2", "dlReLU");</span></span>
<span><span class="co">#&gt;   lReLU = (rxode2_fn) R_GetCCallable("rxode2", "lReLU");</span></span>
<span><span class="co">#&gt;   dSELU = (rxode2_fn) R_GetCCallable("rxode2", "dSELU");</span></span>
<span><span class="co">#&gt;   SELU = (rxode2_fn) R_GetCCallable("rxode2", "SELU");</span></span>
<span><span class="co">#&gt;   d4softplus = (rxode2_fn) R_GetCCallable("rxode2", "d4softplus");</span></span>
<span><span class="co">#&gt;   d3softplus = (rxode2_fn) R_GetCCallable("rxode2", "d3softplus");</span></span>
<span><span class="co">#&gt;   d2softplus = (rxode2_fn) R_GetCCallable("rxode2", "d2softplus");</span></span>
<span><span class="co">#&gt;   dsoftplus = (rxode2_fn) R_GetCCallable("rxode2", "dsoftplus");</span></span>
<span><span class="co">#&gt;   softplus = (rxode2_fn) R_GetCCallable("rxode2", "softplus");</span></span>
<span><span class="co">#&gt;   d4GELU = (rxode2_fn) R_GetCCallable("rxode2", "d4GELU");</span></span>
<span><span class="co">#&gt;   d3GELU = (rxode2_fn) R_GetCCallable("rxode2", "d3GELU");</span></span>
<span><span class="co">#&gt;   d2GELU = (rxode2_fn) R_GetCCallable("rxode2", "d2GELU");</span></span>
<span><span class="co">#&gt;   dGELU = (rxode2_fn) R_GetCCallable("rxode2", "dGELU");</span></span>
<span><span class="co">#&gt;   GELU = (rxode2_fn) R_GetCCallable("rxode2", "GELU");</span></span>
<span><span class="co">#&gt;   dReLU = (rxode2_fn) R_GetCCallable("rxode2", "dReLU");</span></span>
<span><span class="co">#&gt;   ReLU = (rxode2_fn) R_GetCCallable("rxode2", "ReLU");</span></span>
<span><span class="co">#&gt;   riweibull = (rxode2i2_fn2) R_GetCCallable("rxode2", "riweibull");</span></span>
<span><span class="co">#&gt;   riunif = (rxode2i2_fn2) R_GetCCallable("rxode2", "riunif");</span></span>
<span><span class="co">#&gt;   rit_ = (rxode2i2_fn) R_GetCCallable("rxode2", "rit_");</span></span>
<span><span class="co">#&gt;   ripois = (rxode2i2_ifn) R_GetCCallable("rxode2", "ripois");</span></span>
<span><span class="co">#&gt;   ribeta = (rxode2i2_fn2) R_GetCCallable("rxode2", "ribeta");</span></span>
<span><span class="co">#&gt;   rigamma = (rxode2i2_fn2) R_GetCCallable("rxode2", "rigamma");</span></span>
<span><span class="co">#&gt;   rigeom = (rxode2i2_ifn) R_GetCCallable("rxode2", "rigeom");</span></span>
<span><span class="co">#&gt;   rif = (rxode2i2_fn2) R_GetCCallable("rxode2", "rif");</span></span>
<span><span class="co">#&gt;   riexp = (rxode2i2_fn) R_GetCCallable("rxode2", "riexp");</span></span>
<span><span class="co">#&gt;   richisq = (rxode2i2_fn) R_GetCCallable("rxode2", "richisq");</span></span>
<span><span class="co">#&gt;   ricauchy = (rxode2i2_fn2) R_GetCCallable("rxode2", "ricauchy");</span></span>
<span><span class="co">#&gt;   rinbinomMu = (rxode2i2_ribinom) R_GetCCallable("rxode2", "rinbinomMu");</span></span>
<span><span class="co">#&gt;   rinbinom = (rxode2i2_ribinom) R_GetCCallable("rxode2", "rinbinom");</span></span>
<span><span class="co">#&gt;   ribinom = (rxode2i2_ribinom) R_GetCCallable("rxode2", "ribinom");</span></span>
<span><span class="co">#&gt;   rinorm = (rxode2i2_fn2) R_GetCCallable("rxode2", "rinorm");</span></span>
<span><span class="co">#&gt;   rxweibull = (rxode2i_fn2) R_GetCCallable("rxode2", "rxweibull");</span></span>
<span><span class="co">#&gt;   rxunif = (rxode2i_fn2) R_GetCCallable("rxode2", "rxunif");</span></span>
<span><span class="co">#&gt;   rxt_ = (rxode2i_fn) R_GetCCallable("rxode2", "rxt_");</span></span>
<span><span class="co">#&gt;   rxpois = (rxode2i_ifn) R_GetCCallable("rxode2", "rxpois");</span></span>
<span><span class="co">#&gt;   rxbeta = (rxode2i_fn2) R_GetCCallable("rxode2", "rxbeta");</span></span>
<span><span class="co">#&gt;   rxgamma = (rxode2i_fn2) R_GetCCallable("rxode2", "rxgamma");</span></span>
<span><span class="co">#&gt;   rxgeom = (rxode2i_ifn) R_GetCCallable("rxode2", "rxgeom");</span></span>
<span><span class="co">#&gt;   rxf = (rxode2i_fn2) R_GetCCallable("rxode2", "rxf");</span></span>
<span><span class="co">#&gt;   rxexp = (rxode2i_fn) R_GetCCallable("rxode2", "rxexp");</span></span>
<span><span class="co">#&gt;   rxchisq = (rxode2i_fn) R_GetCCallable("rxode2", "rxchisq");</span></span>
<span><span class="co">#&gt;   rxcauchy = (rxode2i_fn2) R_GetCCallable("rxode2", "rxcauchy");</span></span>
<span><span class="co">#&gt;   rxnbinomMu = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxnbinomMu");</span></span>
<span><span class="co">#&gt;   rxnbinom = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxnbinom");</span></span>
<span><span class="co">#&gt;   rxbinom = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxbinom");</span></span>
<span><span class="co">#&gt;   rxnorm = (rxode2i_fn2) R_GetCCallable("rxode2", "rxnorm");</span></span>
<span><span class="co">#&gt;   linCmtB = (linCmtB_p) R_GetCCallable("rxode2", "linCmtB");</span></span>
<span><span class="co">#&gt;   linCmtA = (linCmtA_p) R_GetCCallable("rxode2", "linCmtA");</span></span>
<span><span class="co">#&gt;   // dynamic stop</span></span>
<span><span class="co">#&gt;   _solveData = _getRxSolve_();</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void _assignFuns(void) {</span></span>
<span><span class="co">#&gt;   if (_assign_ptr == NULL){</span></span>
<span><span class="co">#&gt;     _assignFuns0();</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void __assignFuns2(rx_solve rx,</span></span>
<span><span class="co">#&gt;                    rx_solving_options op,</span></span>
<span><span class="co">#&gt;                    t_F f,</span></span>
<span><span class="co">#&gt;                    t_LAG lag,</span></span>
<span><span class="co">#&gt;                    t_RATE rate,</span></span>
<span><span class="co">#&gt;                    t_DUR dur,</span></span>
<span><span class="co">#&gt;                    t_calc_mtime mtime,</span></span>
<span><span class="co">#&gt;                    t_ME me,</span></span>
<span><span class="co">#&gt;                    t_IndF indf,</span></span>
<span><span class="co">#&gt;                    t_getTime gettime,</span></span>
<span><span class="co">#&gt;                    t_locateTimeIndex timeindex,</span></span>
<span><span class="co">#&gt;                    t_handle_evidL handleEvid,</span></span>
<span><span class="co">#&gt;                    t_getDur getdur) {</span></span>
<span><span class="co">#&gt;   // assign start</span></span>
<span><span class="co">#&gt;     static rxode2_assignFuns2_t rxode2_assignFuns2 = NULL;</span></span>
<span><span class="co">#&gt;     if (rxode2_assignFuns2 == NULL) rxode2_assignFuns2 = (rxode2_assignFuns2_t)(R_GetCCallable("rxode2", "_rxode2_assignFuns2"));</span></span>
<span><span class="co">#&gt;     rxode2_assignFuns2(rx, op, f, lag, rate, dur, mtime, me, indf, gettime, timeindex, handleEvid, getdur);</span></span>
<span><span class="co">#&gt;   // assign stop</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void  rx_1e42fa879cc33e8f3e98b45613503f22__ode_solver_solvedata (rx_solve *solve){</span></span>
<span><span class="co">#&gt;   _solveData = solve;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern rx_solve *rx_1e42fa879cc33e8f3e98b45613503f22__ode_solver_get_solvedata(void){</span></span>
<span><span class="co">#&gt;   return _solveData;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; SEXP rx_1e42fa879cc33e8f3e98b45613503f22__model_vars(void);</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; // prj-specific differential eqns</span></span>
<span><span class="co">#&gt; void rx_1e42fa879cc33e8f3e98b45613503f22__dydt(int *_neq, double __t, double *__zzStateVar__, double *__DDtStateVar__)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   int _cSub = _neq[1];</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_neq[1]].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=1;</span></span>
<span><span class="co">#&gt;   double C2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double centr = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double peri = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double depot = NA_REAL;</span></span>
<span><span class="co">#&gt;   double KA = NA_REAL;</span></span>
<span><span class="co">#&gt;   double CL = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Q = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eff = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kin = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kout = NA_REAL;</span></span>
<span><span class="co">#&gt;   double EC50 = NA_REAL;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   (void)C2;</span></span>
<span><span class="co">#&gt;   (void)centr;</span></span>
<span><span class="co">#&gt;   (void)V2;</span></span>
<span><span class="co">#&gt;   (void)C3;</span></span>
<span><span class="co">#&gt;   (void)peri;</span></span>
<span><span class="co">#&gt;   (void)V3;</span></span>
<span><span class="co">#&gt;   (void)depot;</span></span>
<span><span class="co">#&gt;   (void)KA;</span></span>
<span><span class="co">#&gt;   (void)CL;</span></span>
<span><span class="co">#&gt;   (void)Q;</span></span>
<span><span class="co">#&gt;   (void)eff;</span></span>
<span><span class="co">#&gt;   (void)Kin;</span></span>
<span><span class="co">#&gt;   (void)Kout;</span></span>
<span><span class="co">#&gt;   (void)EC50;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   C2 = _PL[0];</span></span>
<span><span class="co">#&gt;   C3 = _PL[1];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _update_par_ptr(__t, _cSub, _solveData, _idx);</span></span>
<span><span class="co">#&gt;   V2 = _PP[0];</span></span>
<span><span class="co">#&gt;   V3 = _PP[1];</span></span>
<span><span class="co">#&gt;   KA = _PP[2];</span></span>
<span><span class="co">#&gt;   CL = _PP[3];</span></span>
<span><span class="co">#&gt;   Q = _PP[4];</span></span>
<span><span class="co">#&gt;   Kin = _PP[5];</span></span>
<span><span class="co">#&gt;   Kout = _PP[6];</span></span>
<span><span class="co">#&gt;   EC50 = _PP[7];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   depot = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">#&gt;   centr = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">#&gt;   peri = __zzStateVar__[__DDT2__]*((double)(_ON[__DDT2__]));</span></span>
<span><span class="co">#&gt;   eff = __zzStateVar__[__DDT3__]*((double)(_ON[__DDT3__]));</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   C2=centr/_div0(V2);</span></span>
<span><span class="co">#&gt;   C3=peri/_div0(V3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT0__] = ((double)(_ON[__DDT0__]))*(_IR[__DDT0__] -KA*depot);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT1__] = ((double)(_ON[__DDT1__]))*(_IR[__DDT1__] + KA*depot-CL*C2-Q*C2+Q*C3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT2__] = ((double)(_ON[__DDT2__]))*(_IR[__DDT2__] + Q*C2-Q*C3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT3__] = ((double)(_ON[__DDT3__]))*(_IR[__DDT3__] + Kin-Kout*(1-C2/_div0((EC50+C2)))*eff);</span></span>
<span><span class="co">#&gt;   (&amp;_solveData-&gt;subjects[_cSub])-&gt;dadt_counter[0]++;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; // Jacobian derived vars</span></span>
<span><span class="co">#&gt; void rx_1e42fa879cc33e8f3e98b45613503f22__calc_jac(int *_neq, double __t, double *__zzStateVar__, double *__PDStateVar__, unsigned int __NROWPD__) {</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;     int _cSub=_neq[1];</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_neq[1]].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=2;</span></span>
<span><span class="co">#&gt;   (&amp;_solveData-&gt;subjects[_cSub])-&gt;jac_counter[0]++;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Functional based initial conditions.</span></span>
<span><span class="co">#&gt; void rx_1e42fa879cc33e8f3e98b45613503f22__inis(int _cSub, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;  _ind-&gt;_rxFlag=3;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // prj-specific derived vars</span></span>
<span><span class="co">#&gt; void rx_1e42fa879cc33e8f3e98b45613503f22__calc_lhs(int _cSub, double __t, double *__zzStateVar__, double *_lhs) {</span></span>
<span><span class="co">#&gt;     int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=11;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_0__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_1__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_2__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_3__;</span></span>
<span><span class="co">#&gt;   double C2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double centr = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double peri = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double depot = NA_REAL;</span></span>
<span><span class="co">#&gt;   double KA = NA_REAL;</span></span>
<span><span class="co">#&gt;   double CL = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Q = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eff = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kin = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kout = NA_REAL;</span></span>
<span><span class="co">#&gt;   double EC50 = NA_REAL;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_0__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_1__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_2__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_3__;</span></span>
<span><span class="co">#&gt;   (void)C2;</span></span>
<span><span class="co">#&gt;   (void)centr;</span></span>
<span><span class="co">#&gt;   (void)V2;</span></span>
<span><span class="co">#&gt;   (void)C3;</span></span>
<span><span class="co">#&gt;   (void)peri;</span></span>
<span><span class="co">#&gt;   (void)V3;</span></span>
<span><span class="co">#&gt;   (void)depot;</span></span>
<span><span class="co">#&gt;   (void)KA;</span></span>
<span><span class="co">#&gt;   (void)CL;</span></span>
<span><span class="co">#&gt;   (void)Q;</span></span>
<span><span class="co">#&gt;   (void)eff;</span></span>
<span><span class="co">#&gt;   (void)Kin;</span></span>
<span><span class="co">#&gt;   (void)Kout;</span></span>
<span><span class="co">#&gt;   (void)EC50;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   C2 = _PL[0];</span></span>
<span><span class="co">#&gt;   C3 = _PL[1];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _update_par_ptr(__t, _cSub, _solveData, _idx);</span></span>
<span><span class="co">#&gt;   V2 = _PP[0];</span></span>
<span><span class="co">#&gt;   V3 = _PP[1];</span></span>
<span><span class="co">#&gt;   KA = _PP[2];</span></span>
<span><span class="co">#&gt;   CL = _PP[3];</span></span>
<span><span class="co">#&gt;   Q = _PP[4];</span></span>
<span><span class="co">#&gt;   Kin = _PP[5];</span></span>
<span><span class="co">#&gt;   Kout = _PP[6];</span></span>
<span><span class="co">#&gt;   EC50 = _PP[7];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   depot = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">#&gt;   centr = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">#&gt;   peri = __zzStateVar__[__DDT2__]*((double)(_ON[__DDT2__]));</span></span>
<span><span class="co">#&gt;   eff = __zzStateVar__[__DDT3__]*((double)(_ON[__DDT3__]));</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   C2=centr/_div0(V2);</span></span>
<span><span class="co">#&gt;   C3=peri/_div0(V3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_0__ = ((double)(_ON[__DDT0__]))*(_IR[__DDT0__] -KA*depot);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_1__ = ((double)(_ON[__DDT1__]))*(_IR[__DDT1__] + KA*depot-CL*C2-Q*C2+Q*C3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_2__ = ((double)(_ON[__DDT2__]))*(_IR[__DDT2__] + Q*C2-Q*C3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_3__ = ((double)(_ON[__DDT3__]))*(_IR[__DDT3__] + Kin-Kout*(1-C2/_div0((EC50+C2)))*eff);</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _lhs[_LHS_0_]=C2;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_1_]=C3;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Functional based bioavailability</span></span>
<span><span class="co">#&gt; double rx_1e42fa879cc33e8f3e98b45613503f22__F(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return _amt;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; // Functional based absorption lag</span></span>
<span><span class="co">#&gt; double rx_1e42fa879cc33e8f3e98b45613503f22__Lag(int _cSub,  int _cmt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return __t;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Modeled zero-order rate</span></span>
<span><span class="co">#&gt; double rx_1e42fa879cc33e8f3e98b45613503f22__Rate(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return 0.0;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Modeled zero-order duration</span></span>
<span><span class="co">#&gt; double rx_1e42fa879cc33e8f3e98b45613503f22__Dur(int _cSub,  int _cmt, double _amt, double __t){</span></span>
<span><span class="co">#&gt;  return 0.0;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Model Times</span></span>
<span><span class="co">#&gt; void rx_1e42fa879cc33e8f3e98b45613503f22__mtime(int _cSub, double *_mtime){</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Matrix Exponential (0)</span></span>
<span><span class="co">#&gt; void rx_1e42fa879cc33e8f3e98b45613503f22__ME(int _cSub, double _t, double __t, double *_mat, const double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=9;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Inductive linearization Matf</span></span>
<span><span class="co">#&gt; void rx_1e42fa879cc33e8f3e98b45613503f22__IndF(int _cSub, double _t, double __t, double *_matf){</span></span>
<span><span class="co">#&gt;  int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=10;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern SEXP rx_1e42fa879cc33e8f3e98b45613503f22__model_vars(void){</span></span>
<span><span class="co">#&gt;   int pro=0;</span></span>
<span><span class="co">#&gt;   SEXP _mv = PROTECT(_rxGetModelLib("rx_1e42fa879cc33e8f3e98b45613503f22__model_vars"));pro++;</span></span>
<span><span class="co">#&gt;   if (!_rxIsCurrentC(_mv)){</span></span>
<span><span class="co">#&gt;     SEXP hash    = PROTECT(Rf_allocVector(STRSXP, 1));pro++;</span></span>
<span><span class="co">#&gt; #define __doBuf__  snprintf(buf, __doBufN__, "un]\"BAAA@QRtHACAAAAAAAY4!AAAv7#aT)`v[tPAkY6;i\"\?*6tuJ&lt;yOJaE@=xgt/n5q3IBFDi%%]Zgm@c`Pf&gt;\?ZjTU~ZQ9vBq3wT|MfELgh){HSvZ%%fdbGEPtBeFgaSknKAmAQpf({8~s~{#K@(n}5rL/R&lt;%%@ul}~\?Ge=w`ijd]ssn=BxLJL={Oc{,CS#b3\"5P^av708EcaVu=54,0\?`rgwQvj*tgs^5d&lt;y7xJ#R=|1rv^6O[(cps8NkT=k=d^@eDZ0hY&lt;TD:&lt;5V(5d|*qf4v\"}7jBg]vPF+E;$[H&amp;{$4KHc{jzBwzU&gt;O9tRB~4mBLC/&gt;o4Lr@nkT[5*Ji=6hp0P/h^CRucc*xD|d^2Nbycy\"+T=nT9Gb1l&lt;\?xvU&lt;4Ko4Dv+,HxAWKOC]7)Jl~MEehpzg9j~&gt;jFvIC~.T9%%_If//j&amp;1&amp;]OshbM)IeSSrC{#SP&lt;FQ&lt;,7L#bu+uSc]J&gt;=})A3jfFB!88K\?W2:)~[/C*RJSOg7^16k7c{dH/dfY&gt;~FU&amp;hrPu(hY9I2gI*(&lt;M`\?nbA%%JHk;!,nE3O]ILd2~yME~,+5kBOO9HKwa&amp;#{W@%%%%8Mw)U7XkN*f:nvC({jgF}Nuy;pab8jp^I3\?@h]VUFSsm\?(lz&gt;:&lt;8f4|=@$h3h1Cc81@Q\"xh;aLu`K#nbXE@M{bvx.T&gt;bX\"Vn)N8qs&gt;MsLp&lt;ZRb14PtDMnm,TJ4`Olq|mwo#3P@}vcI/S6&lt;wIKc^k0TN2Quoig.u.D$@XCy4Leb&amp;qRa`\"\?\"wIy1|z;ClmeF:$=oe30[ZVMK(mVY1mI|9o34R@}[&amp;e!@\"IFg(5D1k^;+K~/@75;&gt;OM^D&amp;dn2;vS1JA(d^dfQR(UzY~$+Jb=BrbGO%%aJuU^_jT|1mTSzlc7J=$hCL.fF{,+n)N/F|hh=UtAA{2KwfY{+gc5:i:H3+Rjzy1[ZgzpRPD%%FIGMr1BgwG0%%B|v$IgT=vRwJYvZ*du@\"XClK;iAT0I&gt;0y~Fq\?Kr(nlv2GTu,C|v;v:OJv&lt;^@5|J`eaVU{!xAoG\"5)&amp;8rPM^9#{YCfQMo%%+gTw6nmX\?L8$:U8UjGr_a%%qsOK{EFzOp]&gt;ixMaz}b*q@6A}iLZzo*#iCluQF#s+6WQWy_+.%%o|&gt;0,[e5G%%H9^cQc6iaUc!6+tACa%%#tXiBb[O.Y@qY\?0e1WSQfEV+\?VBr~Z^PciY`\?P]bzio&lt;=ze;KRFwmuq2uTV1C^])uw6iU\?B|HWiE6Ci7O|TT5ohqN\?FzsDhtO=]W%%Zl8Ydc4*;O,iFaWujTALN#d0_BXys2JzC&lt;2rA");</span></span>
<span><span class="co">#&gt;     char buf[1282];</span></span>
<span><span class="co">#&gt; #define __doBufN__ 1282</span></span>
<span><span class="co">#&gt;     __doBuf__</span></span>
<span><span class="co">#&gt; #undef __doBuf__</span></span>
<span><span class="co">#&gt; #undef __doBufN__</span></span>
<span><span class="co">#&gt;     SET_STRING_ELT(hash, 0, Rf_mkChar(buf));</span></span>
<span><span class="co">#&gt;     SEXP lst      = PROTECT(_rxQr(hash));pro++;</span></span>
<span><span class="co">#&gt;     _assign_ptr(lst);</span></span>
<span><span class="co">#&gt;     UNPROTECT(pro);</span></span>
<span><span class="co">#&gt;     return lst;</span></span>
<span><span class="co">#&gt;   } else {</span></span>
<span><span class="co">#&gt;     UNPROTECT(pro);</span></span>
<span><span class="co">#&gt;     return _mv;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void rx_1e42fa879cc33e8f3e98b45613503f22__dydt_lsoda(int *neq, double *t, double *A, double *DADT)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   rx_1e42fa879cc33e8f3e98b45613503f22__dydt(neq, *t, A, DADT);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern int rx_1e42fa879cc33e8f3e98b45613503f22__dydt_liblsoda(double __t, double *y, double *ydot, void *data)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   int *neq = (int*)(data);</span></span>
<span><span class="co">#&gt;   rx_1e42fa879cc33e8f3e98b45613503f22__dydt(neq, __t, y, ydot);</span></span>
<span><span class="co">#&gt;   return(0);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void rx_1e42fa879cc33e8f3e98b45613503f22__calc_jac_lsoda(int *neq, double *t, double *A,int *ml, int *mu, double *JAC, int *nrowpd){</span></span>
<span><span class="co">#&gt;   // Update all covariate parameters</span></span>
<span><span class="co">#&gt;   rx_1e42fa879cc33e8f3e98b45613503f22__calc_jac(neq, *t, A, JAC, *nrowpd);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; //Create function to call from R's main thread that assigns the required functions. Sometimes they don't get assigned.</span></span>
<span><span class="co">#&gt; extern void rx_1e42fa879cc33e8f3e98b45613503f22__assignFuns(void){</span></span>
<span><span class="co">#&gt;   _assignFuns();</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; //Initialize the dll to match rxode2's calls</span></span>
<span><span class="co">#&gt; void R_init0_rx_1e42fa879cc33e8f3e98b45613503f22_(void){</span></span>
<span><span class="co">#&gt;   // Get C callables on load; Otherwise it isn't thread safe</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_1e42fa879cc33e8f3e98b45613503f22_","rx_1e42fa879cc33e8f3e98b45613503f22__assignFuns2", (DL_FUNC) __assignFuns2);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_1e42fa879cc33e8f3e98b45613503f22_","rx_1e42fa879cc33e8f3e98b45613503f22__assignFuns", (DL_FUNC) rx_1e42fa879cc33e8f3e98b45613503f22__assignFuns);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_1e42fa879cc33e8f3e98b45613503f22_","rx_1e42fa879cc33e8f3e98b45613503f22__inis",(DL_FUNC) rx_1e42fa879cc33e8f3e98b45613503f22__inis);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_1e42fa879cc33e8f3e98b45613503f22_","rx_1e42fa879cc33e8f3e98b45613503f22__dydt",(DL_FUNC) rx_1e42fa879cc33e8f3e98b45613503f22__dydt);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_1e42fa879cc33e8f3e98b45613503f22_","rx_1e42fa879cc33e8f3e98b45613503f22__calc_lhs",(DL_FUNC) rx_1e42fa879cc33e8f3e98b45613503f22__calc_lhs);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_1e42fa879cc33e8f3e98b45613503f22_","rx_1e42fa879cc33e8f3e98b45613503f22__calc_jac",(DL_FUNC) rx_1e42fa879cc33e8f3e98b45613503f22__calc_jac);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_1e42fa879cc33e8f3e98b45613503f22_","rx_1e42fa879cc33e8f3e98b45613503f22__dydt_lsoda", (DL_FUNC) rx_1e42fa879cc33e8f3e98b45613503f22__dydt_lsoda);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_1e42fa879cc33e8f3e98b45613503f22_","rx_1e42fa879cc33e8f3e98b45613503f22__calc_jac_lsoda", (DL_FUNC) rx_1e42fa879cc33e8f3e98b45613503f22__calc_jac_lsoda);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_1e42fa879cc33e8f3e98b45613503f22_","rx_1e42fa879cc33e8f3e98b45613503f22__ode_solver_solvedata", (DL_FUNC) rx_1e42fa879cc33e8f3e98b45613503f22__ode_solver_solvedata);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_1e42fa879cc33e8f3e98b45613503f22_","rx_1e42fa879cc33e8f3e98b45613503f22__ode_solver_get_solvedata", (DL_FUNC) rx_1e42fa879cc33e8f3e98b45613503f22__ode_solver_get_solvedata);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_1e42fa879cc33e8f3e98b45613503f22_","rx_1e42fa879cc33e8f3e98b45613503f22__F", (DL_FUNC) rx_1e42fa879cc33e8f3e98b45613503f22__F);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_1e42fa879cc33e8f3e98b45613503f22_","rx_1e42fa879cc33e8f3e98b45613503f22__Lag", (DL_FUNC) rx_1e42fa879cc33e8f3e98b45613503f22__Lag);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_1e42fa879cc33e8f3e98b45613503f22_","rx_1e42fa879cc33e8f3e98b45613503f22__Rate", (DL_FUNC) rx_1e42fa879cc33e8f3e98b45613503f22__Rate);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_1e42fa879cc33e8f3e98b45613503f22_","rx_1e42fa879cc33e8f3e98b45613503f22__Dur", (DL_FUNC) rx_1e42fa879cc33e8f3e98b45613503f22__Dur);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_1e42fa879cc33e8f3e98b45613503f22_","rx_1e42fa879cc33e8f3e98b45613503f22__mtime", (DL_FUNC) rx_1e42fa879cc33e8f3e98b45613503f22__mtime);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_1e42fa879cc33e8f3e98b45613503f22_","rx_1e42fa879cc33e8f3e98b45613503f22__ME", (DL_FUNC) rx_1e42fa879cc33e8f3e98b45613503f22__ME);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_1e42fa879cc33e8f3e98b45613503f22_","rx_1e42fa879cc33e8f3e98b45613503f22__IndF", (DL_FUNC) rx_1e42fa879cc33e8f3e98b45613503f22__IndF);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_1e42fa879cc33e8f3e98b45613503f22_","rx_1e42fa879cc33e8f3e98b45613503f22__dydt_liblsoda", (DL_FUNC) rx_1e42fa879cc33e8f3e98b45613503f22__dydt_liblsoda);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; //Initialize the dll to match rxode2's calls</span></span>
<span><span class="co">#&gt; void R_init_rx_1e42fa879cc33e8f3e98b45613503f22_(DllInfo *info){</span></span>
<span><span class="co">#&gt;   // Get C callables on load; Otherwise it isn't thread safe</span></span>
<span><span class="co">#&gt;   R_init0_rx_1e42fa879cc33e8f3e98b45613503f22_();</span></span>
<span><span class="co">#&gt;   static const R_CallMethodDef callMethods[]  = {</span></span>
<span><span class="co">#&gt;     {"rx_1e42fa879cc33e8f3e98b45613503f22__model_vars", (DL_FUNC) &amp;rx_1e42fa879cc33e8f3e98b45613503f22__model_vars, 0},</span></span>
<span><span class="co">#&gt;     {NULL, NULL, 0}</span></span>
<span><span class="co">#&gt;   };</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   R_registerRoutines(info, NULL, callMethods, NULL, NULL);</span></span>
<span><span class="co">#&gt;   R_useDynamicSymbols(info,FALSE);</span></span>
<span><span class="co">#&gt;   _assignFuns0();</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; void R_unload_rx_1e42fa879cc33e8f3e98b45613503f22_ (DllInfo *info){</span></span>
<span><span class="co">#&gt;   // Free resources required for single subject solve.</span></span>
<span><span class="co">#&gt;   SEXP _mv = PROTECT(_rxGetModelLib("rx_1e42fa879cc33e8f3e98b45613503f22__model_vars"));</span></span>
<span><span class="co">#&gt;   if (!Rf_isNull(_mv)){</span></span>
<span><span class="co">#&gt;     _rxRmModelLib("rx_1e42fa879cc33e8f3e98b45613503f22__model_vars");</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   UNPROTECT(1);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’</span></span>
<span></span>
<span><span class="co">## Create an event table</span></span>
<span></span>
<span><span class="va">ev</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>amt<span class="op">=</span><span class="fl">10000</span>, addl<span class="op">=</span><span class="fl">9</span>,ii<span class="op">=</span><span class="fl">12</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>time<span class="op">=</span><span class="fl">120</span>, amt<span class="op">=</span><span class="fl">20000</span>, addl<span class="op">=</span><span class="fl">4</span>, ii<span class="op">=</span><span class="fl">24</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">240</span><span class="op">)</span> <span class="co">## Add Sampling</span></span>
<span></span>
<span><span class="va">nsub</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="co"># 100 sub-problems</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.09</span>,<span class="fl">0.08</span>,<span class="fl">0.08</span>,<span class="fl">0.25</span><span class="op">)</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span> <span class="co"># IIV covariance matrix</span></span>
<span><span class="va">mv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rxRmvn.html">rxRmvn</a></span><span class="op">(</span>n<span class="op">=</span><span class="va">nsub</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span>, <span class="va">sigma</span><span class="op">)</span> <span class="co"># Sample from covariance matrix</span></span>
<span><span class="va">CL</span> <span class="op">&lt;-</span> <span class="fl">7</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">mv</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">V2</span> <span class="op">&lt;-</span> <span class="fl">40</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">mv</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">params.all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>KA<span class="op">=</span><span class="fl">0.3</span>, CL<span class="op">=</span><span class="va">CL</span>, V2<span class="op">=</span><span class="va">V2</span>, Q<span class="op">=</span><span class="fl">10</span>, V3<span class="op">=</span><span class="fl">300</span>,</span>
<span>                    Kin<span class="op">=</span><span class="fl">0.2</span>, Kout<span class="op">=</span><span class="fl">0.2</span>, EC50<span class="op">=</span><span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="for-loop">For Loop<a class="anchor" aria-label="anchor" href="#for-loop"></a>
</h3>
<p>The slowest way to code this is to use a <code>for</code> loop. In
this example we will enclose it in a function to compare timing.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">runFor</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">res</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nsub</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">params</span> <span class="op">&lt;-</span> <span class="va">params.all</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span></span>
<span>        <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">mod1</span><span class="op">$</span><span class="fu">solve</span><span class="op">(</span><span class="va">params</span>, <span class="va">ev</span><span class="op">)</span></span>
<span>        <span class="co">##Store results for effect compartment</span></span>
<span>        <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">res</span>, <span class="va">x</span><span class="op">[</span>, <span class="st">"eff"</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="running-with-apply">Running with apply<a class="anchor" aria-label="anchor" href="#running-with-apply"></a>
</h3>
<p>In general for R, the <code>apply</code> types of functions perform
better than a <code>for</code> loop, so the tutorial also suggests this
speed enhancement</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">runSapply</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">params.all</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">theta</span><span class="op">)</span></span>
<span>        <span class="va">mod1</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span><span class="va">theta</span>, <span class="va">ev</span><span class="op">)</span><span class="op">[</span>, <span class="st">"eff"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="run-using-a-single-threaded-solve">Run using a single-threaded solve<a class="anchor" aria-label="anchor" href="#run-using-a-single-threaded-solve"></a>
</h3>
<p>You can also have rxode2 solve all the subject simultaneously without
collecting the results in R, using a single threaded solve.</p>
<p>The data output is slightly different here, but still gives the same
information:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">runSingleThread</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/symengine/man/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">mod1</span>, <span class="va">params.all</span>, <span class="va">ev</span>, cores<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sim.id"</span>, <span class="st">"time"</span>, <span class="st">"eff"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="run-a-2-threaded-solve">Run a 2 threaded solve<a class="anchor" aria-label="anchor" href="#run-a-2-threaded-solve"></a>
</h3>
<p>rxode2 supports multi-threaded solves, so another option is to have
<code>2</code> threads (called <code>cores</code> in the solve options,
you can see the options in <code><a href="../reference/rxSolve.html">rxControl()</a></code> or
<code><a href="../reference/rxSolve.html">rxSolve()</a></code>).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">run2Thread</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/symengine/man/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">mod1</span>, <span class="va">params.all</span>, <span class="va">ev</span>, cores<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sim.id"</span>, <span class="st">"time"</span>, <span class="st">"eff"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="compare-the-times-between-all-the-methods">Compare the times between all the methods<a class="anchor" aria-label="anchor" href="#compare-the-times-between-all-the-methods"></a>
</h3>
<p>Now the moment of truth, the timings:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bench</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html" class="external-link">microbenchmark</a></span><span class="op">(</span><span class="fu">runFor</span><span class="op">(</span><span class="op">)</span>, <span class="fu">runSapply</span><span class="op">(</span><span class="op">)</span>, <span class="fu">runSingleThread</span><span class="op">(</span><span class="op">)</span>,<span class="fu">run2Thread</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bench</span><span class="op">)</span></span>
<span><span class="co">#&gt; Unit: milliseconds</span></span>
<span><span class="co">#&gt;               expr       min        lq      mean    median        uq       max</span></span>
<span><span class="co">#&gt;           runFor() 426.11539 433.48397 442.18685 437.10919 443.24195 572.48404</span></span>
<span><span class="co">#&gt;        runSapply() 430.62990 436.75827 446.45487 441.31605 445.69563 585.91698</span></span>
<span><span class="co">#&gt;  runSingleThread()  32.40220  32.76040  33.42362  32.91457  33.30872  39.96834</span></span>
<span><span class="co">#&gt;       run2Thread()  21.04444  21.39222  22.22500  21.71903  22.26973  27.13010</span></span>
<span><span class="co">#&gt;  neval</span></span>
<span><span class="co">#&gt;    100</span></span>
<span><span class="co">#&gt;    100</span></span>
<span><span class="co">#&gt;    100</span></span>
<span><span class="co">#&gt;    100</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">bench</span><span class="op">)</span></span></code></pre></div>
<p><img src="rxode2-speed_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>It is clear that the <strong>largest</strong> jump in performance
when using the <code>solve</code> method and providing <em>all</em> the
parameters to rxode2 to solve without looping over each subject with
either a <code>for</code> or a <code>sapply</code>. The number of
cores/threads applied to the solve also plays a role in the solving.</p>
<p>We can explore the number of threads further with the following
code:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">runThread</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/symengine/man/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">mod1</span>, <span class="va">params.all</span>, <span class="va">ev</span>, cores<span class="op">=</span><span class="va">n</span><span class="op">)</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sim.id"</span>, <span class="st">"time"</span>, <span class="st">"eff"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">bench</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eval.html" class="external-link">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/parse.html" class="external-link">parse</a></span><span class="op">(</span>text<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"microbenchmark(%s)"</span>,</span>
<span>                                     <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"runThread("</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="../reference/getRxThreads.html">rxCores</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,<span class="st">")"</span><span class="op">)</span>,</span>
<span>                                           collapse<span class="op">=</span><span class="st">","</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bench</span><span class="op">)</span></span>
<span><span class="co">#&gt; Unit: milliseconds</span></span>
<span><span class="co">#&gt;          expr      min       lq     mean   median       uq      max neval</span></span>
<span><span class="co">#&gt;  runThread(1) 32.53778 32.70976 33.47404 32.87194 33.18808 45.08973   100</span></span>
<span><span class="co">#&gt;  runThread(2) 21.25531 21.76628 23.39092 22.02238 22.57041 34.65198   100</span></span>
<span><span class="co">#&gt;  runThread(3) 22.72104 23.00887 24.11514 23.25499 25.88766 29.89816   100</span></span>
<span><span class="co">#&gt;  runThread(4) 22.17851 22.50783 23.04207 22.68364 22.99679 27.80266   100</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">bench</span><span class="op">)</span></span></code></pre></div>
<p><img src="rxode2-speed_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>There can be a suite spot in speed vs number or cores. The system
type (mac, linux, windows and/or processor), complexity of the ODE
solving and the number of subjects may affect this arbitrary number of
threads. 4 threads is a good number to use without any prior knowledge
because most systems these days have at least 4 threads (or 2 processors
with 4 threads).</p>
</div>
</div>
<div class="section level2">
<h2 id="increasing-speed-with-compiler-options">Increasing speed with compiler options<a class="anchor" aria-label="anchor" href="#increasing-speed-with-compiler-options"></a>
</h2>
<p>One of the way that allows faster ODE solving is to make some
approximations that make some math operators like <code><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp()</a></code>
faster but not technically accurate enough to follow the IEEE standard
for the math functions values (there are other implications that I will
not cover here).</p>
<p>While these are optimizations are <a href="https://github.com/JuliaLang/julia/blob/master/base/fastmath.jl" class="external-link">opt-in
for Julia</a> since they compile everything each session, CRAN has a
more conservative approach since individuals do not compile each R
function before running it.</p>
<p>Still, <code>rxode2</code> models can be compiled with this option
without disturbing CRAN policies. The key is to set an option. Here is
an example:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using the first example subset to PK</span></span>
<span><span class="va">mod2f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/ini.html">ini</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">TKA</span>   <span class="op">&lt;-</span> <span class="fl">0.3</span></span>
<span>    <span class="va">TCL</span>   <span class="op">&lt;-</span> <span class="fl">7</span></span>
<span>    <span class="va">TV2</span>   <span class="op">&lt;-</span> <span class="fl">40</span></span>
<span>    <span class="va">TQ</span>    <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span>    <span class="va">TV3</span>   <span class="op">&lt;-</span> <span class="fl">300</span></span>
<span>    <span class="va">TKin</span>  <span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span>    <span class="va">TKout</span> <span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span>    <span class="va">TEC50</span> <span class="op">&lt;-</span> <span class="fl">8</span></span>
<span>    <span class="va">eta.cl</span> <span class="op">+</span> <span class="va">eta.v</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.09</span>,</span>
<span>                       <span class="fl">0.08</span>, <span class="fl">0.25</span><span class="op">)</span></span>
<span>    <span class="va">c2.prop.sd</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/model.html">model</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">KA</span> <span class="op">&lt;-</span> <span class="va">TKA</span></span>
<span>    <span class="va">CL</span> <span class="op">&lt;-</span> <span class="va">TCL</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">eta.cl</span><span class="op">)</span></span>
<span>    <span class="va">V2</span>  <span class="op">&lt;-</span> <span class="va">TV2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">eta.v</span><span class="op">)</span></span>
<span>    <span class="va">Q</span>   <span class="op">&lt;-</span> <span class="va">TQ</span></span>
<span>    <span class="va">V3</span>  <span class="op">&lt;-</span> <span class="va">TV3</span></span>
<span>    <span class="va">Kin</span>  <span class="op">&lt;-</span> <span class="va">TKin</span></span>
<span>    <span class="va">Kout</span> <span class="op">&lt;-</span> <span class="va">TKout</span></span>
<span>    <span class="va">EC50</span> <span class="op">&lt;-</span> <span class="va">TEC50</span></span>
<span>    <span class="va">C2</span> <span class="op">=</span> <span class="va">centr</span><span class="op">/</span><span class="va">V2</span></span>
<span>    <span class="va">C3</span> <span class="op">=</span> <span class="va">peri</span><span class="op">/</span><span class="va">V3</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">depot</span><span class="op">)</span> <span class="op">=</span> <span class="op">-</span><span class="va">KA</span><span class="op">*</span><span class="va">depot</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">centr</span><span class="op">)</span> <span class="op">=</span> <span class="va">KA</span><span class="op">*</span><span class="va">depot</span> <span class="op">-</span> <span class="va">CL</span><span class="op">*</span><span class="va">C2</span> <span class="op">-</span> <span class="va">Q</span><span class="op">*</span><span class="va">C2</span> <span class="op">+</span> <span class="va">Q</span><span class="op">*</span><span class="va">C3</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">peri</span><span class="op">)</span> <span class="op">=</span> <span class="va">Q</span><span class="op">*</span><span class="va">C2</span> <span class="op">-</span> <span class="va">Q</span><span class="op">*</span><span class="va">C3</span></span>
<span>    <span class="va">C2</span> <span class="op">~</span> <span class="fu">prop</span><span class="op">(</span><span class="va">c2.prop.sd</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">mod2f</span> <span class="op">&lt;-</span> <span class="fu">mod2f</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod2s</span> <span class="op">&lt;-</span> <span class="va">mod2f</span><span class="op">$</span><span class="va">simulationIniModel</span></span>
<span><span class="co">#&gt; C model:</span></span>
<span><span class="co">#&gt; // Define translation state order for 4 states</span></span>
<span><span class="co">#&gt; #define __DDT0__ 0 // depot</span></span>
<span><span class="co">#&gt; #define _DEPOT_ 0 // depot</span></span>
<span><span class="co">#&gt; #define __DDT1__ 1 // centr</span></span>
<span><span class="co">#&gt; #define __DDT2__ 2 // peri</span></span>
<span><span class="co">#&gt; #define __DDT3__ 3 // NA</span></span>
<span><span class="co">#&gt; // Define 12 LHS values</span></span>
<span><span class="co">#&gt; #define _LHS_0_ 0 // KA</span></span>
<span><span class="co">#&gt; #define _LHS_1_ 1 // CL</span></span>
<span><span class="co">#&gt; #define _LHS_2_ 2 // V2</span></span>
<span><span class="co">#&gt; #define _LHS_3_ 3 // Q</span></span>
<span><span class="co">#&gt; #define _LHS_4_ 4 // V3</span></span>
<span><span class="co">#&gt; #define _LHS_5_ 5 // Kin</span></span>
<span><span class="co">#&gt; #define _LHS_6_ 6 // Kout</span></span>
<span><span class="co">#&gt; #define _LHS_7_ 7 // EC50</span></span>
<span><span class="co">#&gt; #define _LHS_8_ 8 // C2</span></span>
<span><span class="co">#&gt; #define _LHS_9_ 9 // C3</span></span>
<span><span class="co">#&gt; #define _LHS_10_ 10 // ipredSim</span></span>
<span><span class="co">#&gt; #define _LHS_11_ 11 // sim</span></span>
<span><span class="co">#&gt; #define _getRxSolve_ _rx7ecc92a2db6258ae79d04515021b2c0c572__getRxSolve__WvfT</span></span>
<span><span class="co">#&gt; #define _evalUdf _rx7ecc92a2db6258ae79d04515021b2c0c573__evalUdf_jtvt</span></span>
<span><span class="co">#&gt; #define _solveData _rx7ecc92a2db6258ae79d04515021b2c0c574__solveData_Aei3</span></span>
<span><span class="co">#&gt; #define _assign_ptr _rx7ecc92a2db6258ae79d04515021b2c0c575__assign_ptr_gW2L</span></span>
<span><span class="co">#&gt; #define _rxRmModelLib _rx7ecc92a2db6258ae79d04515021b2c0c576__rxRmModelLib_gOs5</span></span>
<span><span class="co">#&gt; #define _rxGetModelLib _rx7ecc92a2db6258ae79d04515021b2c0c577__rxGetModelLib_lhB2</span></span>
<span><span class="co">#&gt; #define _old_c _rx7ecc92a2db6258ae79d04515021b2c0c578__old_c_tCio</span></span>
<span><span class="co">#&gt; #define _ptrid _rx7ecc92a2db6258ae79d04515021b2c0c579__ptrid_kLfR</span></span>
<span><span class="co">#&gt; #define _rxIsCurrentC _rx7ecc92a2db6258ae79d04515021b2c0c580__rxIsCurrentC_7PBh</span></span>
<span><span class="co">#&gt; #define _sumPS _rx7ecc92a2db6258ae79d04515021b2c0c581__sumPS_QlMk</span></span>
<span><span class="co">#&gt; #define _prodPS _rx7ecc92a2db6258ae79d04515021b2c0c582__prodPS_6gVL</span></span>
<span><span class="co">#&gt; #define _prodType _rx7ecc92a2db6258ae79d04515021b2c0c583__prodType_L0GP</span></span>
<span><span class="co">#&gt; #define _sumType _rx7ecc92a2db6258ae79d04515021b2c0c584__sumType_ayby</span></span>
<span><span class="co">#&gt; #define _update_par_ptr _rx7ecc92a2db6258ae79d04515021b2c0c585__update_par_ptr_4NJb</span></span>
<span><span class="co">#&gt; #define _getParCov _rx7ecc92a2db6258ae79d04515021b2c0c586__getParCov_khyd</span></span>
<span><span class="co">#&gt; #define _rxode2_rxAssignPtr _rx7ecc92a2db6258ae79d04515021b2c0c587__rxode2_rxAssignPtr_WRt6</span></span>
<span><span class="co">#&gt; #define _rxQr _rx7ecc92a2db6258ae79d04515021b2c0c588__rxQr_h8tt</span></span>
<span><span class="co">#&gt; #define _compareFactorVal _rx7ecc92a2db6258ae79d04515021b2c0c589__compareFactorVal_oyqP</span></span>
<span><span class="co">#&gt; #define _sum _rx7ecc92a2db6258ae79d04515021b2c0c590__sum_leNq</span></span>
<span><span class="co">#&gt; #define _udf _rx7ecc92a2db6258ae79d04515021b2c0c591__udf_jGWm</span></span>
<span><span class="co">#&gt; #define _sign _rx7ecc92a2db6258ae79d04515021b2c0c592__sign_P49M</span></span>
<span><span class="co">#&gt; #define _prod _rx7ecc92a2db6258ae79d04515021b2c0c593__prod_fKZs</span></span>
<span><span class="co">#&gt; #define _max _rx7ecc92a2db6258ae79d04515021b2c0c594__max_FWDX</span></span>
<span><span class="co">#&gt; #define _min _rx7ecc92a2db6258ae79d04515021b2c0c595__min_RWGH</span></span>
<span><span class="co">#&gt; #define _transit4P _rx7ecc92a2db6258ae79d04515021b2c0c596__transit4P_y9lu</span></span>
<span><span class="co">#&gt; #define _transit3P _rx7ecc92a2db6258ae79d04515021b2c0c597__transit3P_0HWv</span></span>
<span><span class="co">#&gt; #define _assignFuns0 _rx7ecc92a2db6258ae79d04515021b2c0c598__assignFuns0_GXbn</span></span>
<span><span class="co">#&gt; #define _assignFuns _rx7ecc92a2db6258ae79d04515021b2c0c599__assignFuns_dbut</span></span>
<span><span class="co">#&gt; #define _rxord _rx7ecc92a2db6258ae79d04515021b2c0c600__rxord_uMqM</span></span>
<span><span class="co">#&gt; #define __assignFuns2 _rx7ecc92a2db6258ae79d04515021b2c0c601___assignFuns2_Ozry</span></span>
<span><span class="co">#&gt; #define _llikCauchyDscale _rx7ecc92a2db6258ae79d04515021b2c0c602__llikCauchyDscale_lFNT</span></span>
<span><span class="co">#&gt; #define _llikCauchyDlocation _rx7ecc92a2db6258ae79d04515021b2c0c603__llikCauchyDlocation_75G1</span></span>
<span><span class="co">#&gt; #define _llikCauchy _rx7ecc92a2db6258ae79d04515021b2c0c604__llikCauchy_JLXb</span></span>
<span><span class="co">#&gt; #define _llikGammaDrate _rx7ecc92a2db6258ae79d04515021b2c0c605__llikGammaDrate_Z7PK</span></span>
<span><span class="co">#&gt; #define _llikGammaDshape _rx7ecc92a2db6258ae79d04515021b2c0c606__llikGammaDshape_NZtB</span></span>
<span><span class="co">#&gt; #define _llikGamma _rx7ecc92a2db6258ae79d04515021b2c0c607__llikGamma_pygm</span></span>
<span><span class="co">#&gt; #define _llikWeibullDscale _rx7ecc92a2db6258ae79d04515021b2c0c608__llikWeibullDscale_B4T8</span></span>
<span><span class="co">#&gt; #define _llikWeibullDshape _rx7ecc92a2db6258ae79d04515021b2c0c609__llikWeibullDshape_Osos</span></span>
<span><span class="co">#&gt; #define _llikWeibull _rx7ecc92a2db6258ae79d04515021b2c0c610__llikWeibull_w8dc</span></span>
<span><span class="co">#&gt; #define _llikUnifDbeta _rx7ecc92a2db6258ae79d04515021b2c0c611__llikUnifDbeta_7Zby</span></span>
<span><span class="co">#&gt; #define _llikUnifDalpha _rx7ecc92a2db6258ae79d04515021b2c0c612__llikUnifDalpha_FKA8</span></span>
<span><span class="co">#&gt; #define _llikUnif _rx7ecc92a2db6258ae79d04515021b2c0c613__llikUnif_Awkm</span></span>
<span><span class="co">#&gt; #define _llikGeomDp _rx7ecc92a2db6258ae79d04515021b2c0c614__llikGeomDp_94JW</span></span>
<span><span class="co">#&gt; #define _llikGeom _rx7ecc92a2db6258ae79d04515021b2c0c615__llikGeom_vK6h</span></span>
<span><span class="co">#&gt; #define _llikFDdf2 _rx7ecc92a2db6258ae79d04515021b2c0c616__llikFDdf2_oalf</span></span>
<span><span class="co">#&gt; #define _llikFDdf1 _rx7ecc92a2db6258ae79d04515021b2c0c617__llikFDdf1_Qo6J</span></span>
<span><span class="co">#&gt; #define _llikF _rx7ecc92a2db6258ae79d04515021b2c0c618__llikF_h9i1</span></span>
<span><span class="co">#&gt; #define _llikExpDrate _rx7ecc92a2db6258ae79d04515021b2c0c619__llikExpDrate_K87P</span></span>
<span><span class="co">#&gt; #define _llikExp _rx7ecc92a2db6258ae79d04515021b2c0c620__llikExp_IzCX</span></span>
<span><span class="co">#&gt; #define _llikChisqDdf _rx7ecc92a2db6258ae79d04515021b2c0c621__llikChisqDdf_dVoO</span></span>
<span><span class="co">#&gt; #define _llikChisq _rx7ecc92a2db6258ae79d04515021b2c0c622__llikChisq_0kDC</span></span>
<span><span class="co">#&gt; #define _llikTDsd _rx7ecc92a2db6258ae79d04515021b2c0c623__llikTDsd_1F74</span></span>
<span><span class="co">#&gt; #define _llikTDmean _rx7ecc92a2db6258ae79d04515021b2c0c624__llikTDmean_igRq</span></span>
<span><span class="co">#&gt; #define _llikTDdf _rx7ecc92a2db6258ae79d04515021b2c0c625__llikTDdf_WjrN</span></span>
<span><span class="co">#&gt; #define _llikT _rx7ecc92a2db6258ae79d04515021b2c0c626__llikT_beKP</span></span>
<span><span class="co">#&gt; #define _llikBetaDshape2 _rx7ecc92a2db6258ae79d04515021b2c0c627__llikBetaDshape2_ICUc</span></span>
<span><span class="co">#&gt; #define _llikBetaDshape1 _rx7ecc92a2db6258ae79d04515021b2c0c628__llikBetaDshape1_M175</span></span>
<span><span class="co">#&gt; #define _llikBeta _rx7ecc92a2db6258ae79d04515021b2c0c629__llikBeta_hACo</span></span>
<span><span class="co">#&gt; #define _llikNbinomMuDmu _rx7ecc92a2db6258ae79d04515021b2c0c630__llikNbinomMuDmu_bmXg</span></span>
<span><span class="co">#&gt; #define _llikNbinomMu _rx7ecc92a2db6258ae79d04515021b2c0c631__llikNbinomMu_vTBm</span></span>
<span><span class="co">#&gt; #define _llikNbinomDprob _rx7ecc92a2db6258ae79d04515021b2c0c632__llikNbinomDprob_tLBh</span></span>
<span><span class="co">#&gt; #define _llikNbinom _rx7ecc92a2db6258ae79d04515021b2c0c633__llikNbinom_HmbB</span></span>
<span><span class="co">#&gt; #define _llikBinomDprob _rx7ecc92a2db6258ae79d04515021b2c0c634__llikBinomDprob_yQjU</span></span>
<span><span class="co">#&gt; #define _llikBinom _rx7ecc92a2db6258ae79d04515021b2c0c635__llikBinom_bIpJ</span></span>
<span><span class="co">#&gt; #define _llikPoisDlambda _rx7ecc92a2db6258ae79d04515021b2c0c636__llikPoisDlambda_xcm3</span></span>
<span><span class="co">#&gt; #define _llikPois _rx7ecc92a2db6258ae79d04515021b2c0c637__llikPois_5pW9</span></span>
<span><span class="co">#&gt; #define _llikNormDsd _rx7ecc92a2db6258ae79d04515021b2c0c638__llikNormDsd_d9i8</span></span>
<span><span class="co">#&gt; #define _llikNormDmean _rx7ecc92a2db6258ae79d04515021b2c0c639__llikNormDmean_aPwt</span></span>
<span><span class="co">#&gt; #define _llikNorm _rx7ecc92a2db6258ae79d04515021b2c0c640__llikNorm_DtHW</span></span>
<span><span class="co">#&gt; #define simeps _rx7ecc92a2db6258ae79d04515021b2c0c641_simeps_Ci4M</span></span>
<span><span class="co">#&gt; #define simeta _rx7ecc92a2db6258ae79d04515021b2c0c642_simeta_acC2</span></span>
<span><span class="co">#&gt; #define expit _rx7ecc92a2db6258ae79d04515021b2c0c643_expit_HFlL</span></span>
<span><span class="co">#&gt; #define logit _rx7ecc92a2db6258ae79d04515021b2c0c644_logit_d1Mn</span></span>
<span><span class="co">#&gt; #define gammapDer _rx7ecc92a2db6258ae79d04515021b2c0c645_gammapDer_HWBM</span></span>
<span><span class="co">#&gt; #define lowergamma _rx7ecc92a2db6258ae79d04515021b2c0c646_lowergamma_shty</span></span>
<span><span class="co">#&gt; #define uppergamma _rx7ecc92a2db6258ae79d04515021b2c0c647_uppergamma_Nad6</span></span>
<span><span class="co">#&gt; #define gammaqInva _rx7ecc92a2db6258ae79d04515021b2c0c648_gammaqInva_3qNS</span></span>
<span><span class="co">#&gt; #define gammaqInv _rx7ecc92a2db6258ae79d04515021b2c0c649_gammaqInv_3vj9</span></span>
<span><span class="co">#&gt; #define gammapInva _rx7ecc92a2db6258ae79d04515021b2c0c650_gammapInva_1MUL</span></span>
<span><span class="co">#&gt; #define gammapInv _rx7ecc92a2db6258ae79d04515021b2c0c651_gammapInv_uyNY</span></span>
<span><span class="co">#&gt; #define gammaq _rx7ecc92a2db6258ae79d04515021b2c0c652_gammaq_LQXJ</span></span>
<span><span class="co">#&gt; #define gammap _rx7ecc92a2db6258ae79d04515021b2c0c653_gammap_VBP4</span></span>
<span><span class="co">#&gt; #define phi _rx7ecc92a2db6258ae79d04515021b2c0c654_phi_yYqF</span></span>
<span><span class="co">#&gt; #define d2ELUa _rx7ecc92a2db6258ae79d04515021b2c0c655_d2ELUa_OlTf</span></span>
<span><span class="co">#&gt; #define dELUa _rx7ecc92a2db6258ae79d04515021b2c0c656_dELUa_9yUA</span></span>
<span><span class="co">#&gt; #define d2aELU _rx7ecc92a2db6258ae79d04515021b2c0c657_d2aELU_h07s</span></span>
<span><span class="co">#&gt; #define d2ELU _rx7ecc92a2db6258ae79d04515021b2c0c658_d2ELU_KMTe</span></span>
<span><span class="co">#&gt; #define dELU _rx7ecc92a2db6258ae79d04515021b2c0c659_dELU_xcRm</span></span>
<span><span class="co">#&gt; #define ELU _rx7ecc92a2db6258ae79d04515021b2c0c660_ELU_bTET</span></span>
<span><span class="co">#&gt; #define dPReLUa1 _rx7ecc92a2db6258ae79d04515021b2c0c661_dPReLUa1_PHqU</span></span>
<span><span class="co">#&gt; #define dPReLUa _rx7ecc92a2db6258ae79d04515021b2c0c662_dPReLUa_Eb8K</span></span>
<span><span class="co">#&gt; #define dPReLU _rx7ecc92a2db6258ae79d04515021b2c0c663_dPReLU_CdEa</span></span>
<span><span class="co">#&gt; #define PReLU _rx7ecc92a2db6258ae79d04515021b2c0c664_PReLU_G2vB</span></span>
<span><span class="co">#&gt; #define dSwish _rx7ecc92a2db6258ae79d04515021b2c0c665_dSwish_HlcS</span></span>
<span><span class="co">#&gt; #define Swish _rx7ecc92a2db6258ae79d04515021b2c0c666_Swish_pPK4</span></span>
<span><span class="co">#&gt; #define dlReLU _rx7ecc92a2db6258ae79d04515021b2c0c667_dlReLU_zcm4</span></span>
<span><span class="co">#&gt; #define lReLU _rx7ecc92a2db6258ae79d04515021b2c0c668_lReLU_pJ2s</span></span>
<span><span class="co">#&gt; #define dSELU _rx7ecc92a2db6258ae79d04515021b2c0c669_dSELU_RxYw</span></span>
<span><span class="co">#&gt; #define SELU _rx7ecc92a2db6258ae79d04515021b2c0c670_SELU_aRdQ</span></span>
<span><span class="co">#&gt; #define d4softplus _rx7ecc92a2db6258ae79d04515021b2c0c671_d4softplus_TCBr</span></span>
<span><span class="co">#&gt; #define d3softplus _rx7ecc92a2db6258ae79d04515021b2c0c672_d3softplus_Xm2T</span></span>
<span><span class="co">#&gt; #define d2softplus _rx7ecc92a2db6258ae79d04515021b2c0c673_d2softplus_LZx3</span></span>
<span><span class="co">#&gt; #define dsoftplus _rx7ecc92a2db6258ae79d04515021b2c0c674_dsoftplus_uLMu</span></span>
<span><span class="co">#&gt; #define softplus _rx7ecc92a2db6258ae79d04515021b2c0c675_softplus_TWhP</span></span>
<span><span class="co">#&gt; #define d4GELU _rx7ecc92a2db6258ae79d04515021b2c0c676_d4GELU_9C9a</span></span>
<span><span class="co">#&gt; #define d3GELU _rx7ecc92a2db6258ae79d04515021b2c0c677_d3GELU_xgq3</span></span>
<span><span class="co">#&gt; #define d2GELU _rx7ecc92a2db6258ae79d04515021b2c0c678_d2GELU_3wKK</span></span>
<span><span class="co">#&gt; #define dGELU _rx7ecc92a2db6258ae79d04515021b2c0c679_dGELU_pRCU</span></span>
<span><span class="co">#&gt; #define GELU _rx7ecc92a2db6258ae79d04515021b2c0c680_GELU_a2mQ</span></span>
<span><span class="co">#&gt; #define dReLU _rx7ecc92a2db6258ae79d04515021b2c0c681_dReLU_03YR</span></span>
<span><span class="co">#&gt; #define ReLU _rx7ecc92a2db6258ae79d04515021b2c0c682_ReLU_I3Bt</span></span>
<span><span class="co">#&gt; #define riweibull _rx7ecc92a2db6258ae79d04515021b2c0c683_riweibull_cx9A</span></span>
<span><span class="co">#&gt; #define riunif _rx7ecc92a2db6258ae79d04515021b2c0c684_riunif_bFQu</span></span>
<span><span class="co">#&gt; #define rit_ _rx7ecc92a2db6258ae79d04515021b2c0c685_rit__J8Dg</span></span>
<span><span class="co">#&gt; #define ripois _rx7ecc92a2db6258ae79d04515021b2c0c686_ripois_og4t</span></span>
<span><span class="co">#&gt; #define ribeta _rx7ecc92a2db6258ae79d04515021b2c0c687_ribeta_EvpE</span></span>
<span><span class="co">#&gt; #define rigamma _rx7ecc92a2db6258ae79d04515021b2c0c688_rigamma_HeR4</span></span>
<span><span class="co">#&gt; #define rigeom _rx7ecc92a2db6258ae79d04515021b2c0c689_rigeom_ood8</span></span>
<span><span class="co">#&gt; #define rif _rx7ecc92a2db6258ae79d04515021b2c0c690_rif_yJWa</span></span>
<span><span class="co">#&gt; #define riexp _rx7ecc92a2db6258ae79d04515021b2c0c691_riexp_FZpU</span></span>
<span><span class="co">#&gt; #define richisq _rx7ecc92a2db6258ae79d04515021b2c0c692_richisq_tcVn</span></span>
<span><span class="co">#&gt; #define ricauchy _rx7ecc92a2db6258ae79d04515021b2c0c693_ricauchy_VM0L</span></span>
<span><span class="co">#&gt; #define rinbinomMu _rx7ecc92a2db6258ae79d04515021b2c0c694_rinbinomMu_H9dq</span></span>
<span><span class="co">#&gt; #define rinbinom _rx7ecc92a2db6258ae79d04515021b2c0c695_rinbinom_nlm9</span></span>
<span><span class="co">#&gt; #define ribinom _rx7ecc92a2db6258ae79d04515021b2c0c696_ribinom_6D77</span></span>
<span><span class="co">#&gt; #define rinorm _rx7ecc92a2db6258ae79d04515021b2c0c697_rinorm_brEV</span></span>
<span><span class="co">#&gt; #define rxweibull _rx7ecc92a2db6258ae79d04515021b2c0c698_rxweibull_5DzG</span></span>
<span><span class="co">#&gt; #define rxunif _rx7ecc92a2db6258ae79d04515021b2c0c699_rxunif_VI3F</span></span>
<span><span class="co">#&gt; #define rxt_ _rx7ecc92a2db6258ae79d04515021b2c0c700_rxt__MnZd</span></span>
<span><span class="co">#&gt; #define rxpois _rx7ecc92a2db6258ae79d04515021b2c0c701_rxpois_u34t</span></span>
<span><span class="co">#&gt; #define rxbeta _rx7ecc92a2db6258ae79d04515021b2c0c702_rxbeta_XY2d</span></span>
<span><span class="co">#&gt; #define rxgamma _rx7ecc92a2db6258ae79d04515021b2c0c703_rxgamma_xSHM</span></span>
<span><span class="co">#&gt; #define rxgeom _rx7ecc92a2db6258ae79d04515021b2c0c704_rxgeom_vnQK</span></span>
<span><span class="co">#&gt; #define rxf _rx7ecc92a2db6258ae79d04515021b2c0c705_rxf_gMyd</span></span>
<span><span class="co">#&gt; #define rxexp _rx7ecc92a2db6258ae79d04515021b2c0c706_rxexp_bjOg</span></span>
<span><span class="co">#&gt; #define rxchisq _rx7ecc92a2db6258ae79d04515021b2c0c707_rxchisq_6f1A</span></span>
<span><span class="co">#&gt; #define rxcauchy _rx7ecc92a2db6258ae79d04515021b2c0c708_rxcauchy_1qoU</span></span>
<span><span class="co">#&gt; #define rxnbinomMu _rx7ecc92a2db6258ae79d04515021b2c0c709_rxnbinomMu_4jwq</span></span>
<span><span class="co">#&gt; #define rxnbinom _rx7ecc92a2db6258ae79d04515021b2c0c710_rxnbinom_voyA</span></span>
<span><span class="co">#&gt; #define rxbinom _rx7ecc92a2db6258ae79d04515021b2c0c711_rxbinom_mILe</span></span>
<span><span class="co">#&gt; #define rxnorm _rx7ecc92a2db6258ae79d04515021b2c0c712_rxnorm_8B1R</span></span>
<span><span class="co">#&gt; #define linCmtB _rx7ecc92a2db6258ae79d04515021b2c0c713_linCmtB_Wyj6</span></span>
<span><span class="co">#&gt; #define linCmtA _rx7ecc92a2db6258ae79d04515021b2c0c714_linCmtA_JrWJ</span></span>
<span><span class="co">#&gt; #include &lt;rxode2_model_shared.h&gt;</span></span>
<span><span class="co">#&gt; #define __MAX_PROD__ 0</span></span>
<span><span class="co">#&gt; #define _CMT CMT</span></span>
<span><span class="co">#&gt; #define _SYNC_simeps_ for (int _svari=_solveData-&gt;neps; _svari--;){  if (_solveData-&gt;svar[_svari] == 0) {TKA = _PP[0];};   if (_solveData-&gt;svar[_svari] == 1) {TCL = _PP[1];};   if (_solveData-&gt;svar[_svari] == 2) {TV2 = _PP[2];};   if (_solveData-&gt;svar[_svari] == 3) {TQ = _PP[3];};   if (_solveData-&gt;svar[_svari] == 4) {TV3 = _PP[4];};   if (_solveData-&gt;svar[_svari] == 5) {TKin = _PP[5];};   if (_solveData-&gt;svar[_svari] == 6) {TKout = _PP[6];};   if (_solveData-&gt;svar[_svari] == 7) {TEC50 = _PP[7];};   if (_solveData-&gt;svar[_svari] == 8) {c2_DoT_prop_DoT_sd = _PP[8];};   if (_solveData-&gt;svar[_svari] == 9) {eta_DoT_cl = _PP[9];};   if (_solveData-&gt;svar[_svari] == 10) {eta_DoT_v = _PP[10];};   if (_solveData-&gt;svar[_svari] == 11) {rxerr_DoT_C2 = _PP[11];}; }</span></span>
<span><span class="co">#&gt; #define _SYNC_simeta_ for (int _ovari=_solveData-&gt;neta; _ovari--;){  if (_solveData-&gt;ovar[_ovari] == 0) {TKA = _PP[0];};   if (_solveData-&gt;ovar[_ovari] == 1) {TCL = _PP[1];};   if (_solveData-&gt;ovar[_ovari] == 2) {TV2 = _PP[2];};   if (_solveData-&gt;ovar[_ovari] == 3) {TQ = _PP[3];};   if (_solveData-&gt;ovar[_ovari] == 4) {TV3 = _PP[4];};   if (_solveData-&gt;ovar[_ovari] == 5) {TKin = _PP[5];};   if (_solveData-&gt;ovar[_ovari] == 6) {TKout = _PP[6];};   if (_solveData-&gt;ovar[_ovari] == 7) {TEC50 = _PP[7];};   if (_solveData-&gt;ovar[_ovari] == 8) {c2_DoT_prop_DoT_sd = _PP[8];};   if (_solveData-&gt;ovar[_ovari] == 9) {eta_DoT_cl = _PP[9];};   if (_solveData-&gt;ovar[_ovari] == 10) {eta_DoT_v = _PP[10];};   if (_solveData-&gt;ovar[_ovari] == 11) {rxerr_DoT_C2 = _PP[11];}; }</span></span>
<span><span class="co">#&gt; _getRxSolve_t _getRxSolve_;</span></span>
<span><span class="co">#&gt; _simfun simeps;</span></span>
<span><span class="co">#&gt; _simfun simeta;</span></span>
<span><span class="co">#&gt; _udf_type _evalUdf=NULL;</span></span>
<span><span class="co">#&gt; rx_solve *_solveData=NULL;</span></span>
<span><span class="co">#&gt; rxode2_assign_ptr _assign_ptr=NULL;</span></span>
<span><span class="co">#&gt; _rxRmModelLibType _rxRmModelLib=NULL;</span></span>
<span><span class="co">#&gt; _rxGetModelLibType _rxGetModelLib=NULL;</span></span>
<span><span class="co">#&gt; rxode2_ode_solver_old_c _old_c=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _ptrid=NULL;</span></span>
<span><span class="co">#&gt; _rxIsCurrentC_type _rxIsCurrentC=NULL;</span></span>
<span><span class="co">#&gt; _rxSumType _sumPS=NULL;</span></span>
<span><span class="co">#&gt; _rxProdType _prodPS=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _prodType=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _sumType=NULL;</span></span>
<span><span class="co">#&gt; _update_par_ptr_p _update_par_ptr=NULL;</span></span>
<span><span class="co">#&gt; _getParCov_p _getParCov=NULL;</span></span>
<span><span class="co">#&gt; linCmtA_p linCmtA;</span></span>
<span><span class="co">#&gt; linCmtB_p linCmtB;</span></span>
<span><span class="co">#&gt; _rx_asgn _rxode2_rxAssignPtr=NULL;</span></span>
<span><span class="co">#&gt; _rx_asgn _rxQr=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn phi;</span></span>
<span><span class="co">#&gt; rxode2_fn ReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn dReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn dGELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d2GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d3GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d4GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn dsoftplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d2softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d3softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d4softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn SELU;</span></span>
<span><span class="co">#&gt; rxode2_fn dSELU;</span></span>
<span><span class="co">#&gt; rxode2_fn lReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn dlReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn Swish;</span></span>
<span><span class="co">#&gt; rxode2_fn dSwish;</span></span>
<span><span class="co">#&gt; rxode2_fn2 PReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLUa;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLUa1;</span></span>
<span><span class="co">#&gt; rxode2_fn2 ELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2ELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2aELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dELUa;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2ELUa;</span></span>
<span><span class="co">#&gt; rxode2_fn3 logit;</span></span>
<span><span class="co">#&gt; rxode2_fn3 expit;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammap;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaq;</span></span>
<span><span class="co">#&gt; rxode2_fn2 lowergamma;</span></span>
<span><span class="co">#&gt; rxode2_fn2 uppergamma;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapInv;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapDer;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapInva;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaqInv;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaqInva;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxnorm;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxbinom;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxnbinom;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxnbinomMu;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxcauchy;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxchisq;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxexp;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxf;</span></span>
<span><span class="co">#&gt; rxode2i_ifn rxgeom;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxgamma;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxbeta;</span></span>
<span><span class="co">#&gt; rxode2i_ifn rxpois;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxt_;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxunif;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxweibull;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rinorm;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom ribinom;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom rinbinom;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom rinbinomMu;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 ricauchy;</span></span>
<span><span class="co">#&gt; rxode2i2_fn richisq;</span></span>
<span><span class="co">#&gt; rxode2i2_fn riexp;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rif;</span></span>
<span><span class="co">#&gt; rxode2i2_ifn rigeom;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rigamma;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 ribeta;</span></span>
<span><span class="co">#&gt; rxode2i2_ifn ripois;</span></span>
<span><span class="co">#&gt; rxode2i2_fn rit_;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 riunif;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 riweibull;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNorm;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNormDmean;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNormDsd;</span></span>
<span><span class="co">#&gt; rxode2_llikPoisFun _llikPois;</span></span>
<span><span class="co">#&gt; rxode2_llikPoisFun _llikPoisDlambda;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikBinom;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikBinomDprob;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinom;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomDprob;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomMu;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomMuDmu;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBeta;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBetaDshape1;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBetaDshape2;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikT;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDdf;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDmean;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDsd;</span></span>
<span><span class="co">#&gt; rxode2_llikChisqFun _llikChisq;</span></span>
<span><span class="co">#&gt; rxode2_llikChisqFun _llikChisqDdf;</span></span>
<span><span class="co">#&gt; rxode2_llikExpFun _llikExp;</span></span>
<span><span class="co">#&gt; rxode2_llikExpFun _llikExpDrate;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikF;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikFDdf1;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikFDdf2;</span></span>
<span><span class="co">#&gt; rxode2_llikGeomFun _llikGeom;</span></span>
<span><span class="co">#&gt; rxode2_llikGeomFun _llikGeomDp;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnif;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnifDalpha;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnifDbeta;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibull;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibullDshape;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibullDscale;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGamma;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGammaDshape;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGammaDrate;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchy;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchyDlocation;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchyDscale;</span></span>
<span><span class="co">#&gt; rxode2_compareFactorVal_fn _compareFactorVal;</span></span>
<span><span class="co">#&gt; #include "extraC.h"</span></span>
<span><span class="co">#&gt; double _prod(double *input, double *p, int type, int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return _prodPS(input, p, n, type);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _udf(const char *funName, double *input, int n, ...) {</span></span>
<span><span class="co">#&gt;   if (n == -42) Rf_error("%s", "this has a ui user function that cannot be called directly");</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return _evalUdf(funName, n, input);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _sum(double *input, double *pld, int m, int type, int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   double ret = _sumPS(input, n, pld, m, type);</span></span>
<span><span class="co">#&gt;   if (type == 2 &amp;&amp; m &lt; 0){</span></span>
<span><span class="co">#&gt;     for (int i = -m; i--;){</span></span>
<span><span class="co">#&gt;       pld[i] = 0.0;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return ret;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _sign(unsigned int n, ...) {</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double s = 1;</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;     s = sign(va_arg(valist, double))*s;</span></span>
<span><span class="co">#&gt;     if (s == 0){</span></span>
<span><span class="co">#&gt;       break;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return s;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _rxord(int _cSub, unsigned int n,  ...) {</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind* ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   if (!ind-&gt;inLhs) {</span></span>
<span><span class="co">#&gt;     return 1.0;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double ret = 1.0;</span></span>
<span><span class="co">#&gt;   double p = 0.0;</span></span>
<span><span class="co">#&gt;   double u = rxunif(ind, 0.0, 1.0);</span></span>
<span><span class="co">#&gt;   int found = 0;</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;     p += va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     if (!found) {</span></span>
<span><span class="co">#&gt;       if (u &lt; p) {</span></span>
<span><span class="co">#&gt;         ret = (double)(i+1);</span></span>
<span><span class="co">#&gt;         found = 1;</span></span>
<span><span class="co">#&gt;       }</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   if (!found) ret =(double)(n+1);</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return ret;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _max(unsigned int n, ...) {</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double mx = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tmp = 0;</span></span>
<span><span class="co">#&gt;   if (n &gt;= 1){</span></span>
<span><span class="co">#&gt;     mx = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     for (unsigned int i = 1; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;       tmp = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;       if (tmp&gt;mx) mx=tmp;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     va_end(valist);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return mx;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _min(unsigned int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double mn = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tmp = 0;</span></span>
<span><span class="co">#&gt;   if (n &gt;= 1){</span></span>
<span><span class="co">#&gt;     mn = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     for (unsigned int i = 1; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;       tmp = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;       if (tmp&lt;mn) mn=tmp;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     va_end(valist);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return mn;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _transit4P(int cmt, double t, unsigned int id, double n, double mtt, double bio){</span></span>
<span><span class="co">#&gt;   double nd = (double) n;</span></span>
<span><span class="co">#&gt;   double ktr = (nd+1)/mtt;</span></span>
<span><span class="co">#&gt;   double lktr = _safe_log(nd+1)-_safe_log(mtt);</span></span>
<span><span class="co">#&gt;   double tlast = _solveData-&gt;subjects[id].tlastS[cmt];</span></span>
<span><span class="co">#&gt;   double dose = _solveData-&gt;subjects[id].curDoseS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(dose)) dose = 0.0;</span></span>
<span><span class="co">#&gt;   if (ISNA(tlast)) tlast = 0.0;</span></span>
<span><span class="co">#&gt;   double tad = (t-tlast);</span></span>
<span><span class="co">#&gt;   return exp(_safe_log(bio*dose)+lktr+n*(lktr+_safe_log(tad))-ktr*(tad)-lgamma1p(nd));</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _transit3P(int cmt, double t, unsigned int id, double n, double mtt){</span></span>
<span><span class="co">#&gt;   double nd = (double) n;</span></span>
<span><span class="co">#&gt;   double ktr = (nd+1)/mtt;</span></span>
<span><span class="co">#&gt;   double lktr = _safe_log(nd+1)-_safe_log(mtt);</span></span>
<span><span class="co">#&gt;   double tlast = _solveData-&gt;subjects[id].tlastS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(tlast)) tlast = 0.0;</span></span>
<span><span class="co">#&gt;   double tad = t-tlast;</span></span>
<span><span class="co">#&gt;   double podo = _solveData-&gt;subjects[id].curDoseS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(podo)) podo = 0.0;</span></span>
<span><span class="co">#&gt;   return exp(_safe_log(podo)+lktr+n*(lktr+_safe_log(tad))-ktr*(tad)-lgamma1p(nd));</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void _assignFuns0(void) {</span></span>
<span><span class="co">#&gt;   _evalUdf = (_udf_type) R_GetCCallable("rxode2", "_rxode2_evalUdf");</span></span>
<span><span class="co">#&gt;   _getRxSolve_ = (_getRxSolve_t) R_GetCCallable("rxode2","getRxSolve_");</span></span>
<span><span class="co">#&gt;   _assign_ptr=(rxode2_assign_ptr) R_GetCCallable("rxode2","rxode2_assign_fn_pointers");</span></span>
<span><span class="co">#&gt;   _rxRmModelLib=(_rxRmModelLibType) R_GetCCallable("rxode2","rxRmModelLib");</span></span>
<span><span class="co">#&gt;   _rxGetModelLib=(_rxGetModelLibType) R_GetCCallable("rxode2","rxGetModelLib");</span></span>
<span><span class="co">#&gt;   _rxode2_rxAssignPtr=(_rx_asgn)R_GetCCallable("rxode2","_rxode2_rxAssignPtr");</span></span>
<span><span class="co">#&gt;   _rxQr=(_rx_asgn)R_GetCCallable("rxode2","_rxode2_rxQr");</span></span>
<span><span class="co">#&gt;   _rxIsCurrentC = (_rxIsCurrentC_type)R_GetCCallable("rxode2","rxIsCurrentC");</span></span>
<span><span class="co">#&gt;   _sumPS  = (_rxSumType) R_GetCCallable("PreciseSums","PreciseSums_sum_r");</span></span>
<span><span class="co">#&gt;   _prodPS = (_rxProdType) R_GetCCallable("PreciseSums","PreciseSums_prod_r");</span></span>
<span><span class="co">#&gt;   _prodType=(rxode2_fn0i)R_GetCCallable("PreciseSums", "PreciseSums_prod_get");</span></span>
<span><span class="co">#&gt;   _sumType=(rxode2_fn0i)R_GetCCallable("PreciseSums", "PreciseSums_sum_get");</span></span>
<span><span class="co">#&gt;   _ptrid=(rxode2_fn0i)R_GetCCallable("rxode2", "rxode2_current_fn_pointer_id");</span></span>
<span><span class="co">#&gt;   _compareFactorVal=(rxode2_compareFactorVal_fn) R_GetCCallable("rxode2", "compareFactorVal");</span></span>
<span><span class="co">#&gt;   _update_par_ptr = (_update_par_ptr_p) R_GetCCallable("rxode2","_update_par_ptr");</span></span>
<span><span class="co">#&gt;   _getParCov = (_getParCov_p) R_GetCCallable("rxode2","_getParCov");</span></span>
<span><span class="co">#&gt;   // dynamic start</span></span>
<span><span class="co">#&gt;   _llikCauchyDscale = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchyDscale");</span></span>
<span><span class="co">#&gt;   _llikCauchyDlocation = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchyDlocation");</span></span>
<span><span class="co">#&gt;   _llikCauchy = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchy");</span></span>
<span><span class="co">#&gt;   _llikGammaDrate = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGammaDrate");</span></span>
<span><span class="co">#&gt;   _llikGammaDshape = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGammaDshape");</span></span>
<span><span class="co">#&gt;   _llikGamma = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGamma");</span></span>
<span><span class="co">#&gt;   _llikWeibullDscale = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibullDscale");</span></span>
<span><span class="co">#&gt;   _llikWeibullDshape = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibullDshape");</span></span>
<span><span class="co">#&gt;   _llikWeibull = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibull");</span></span>
<span><span class="co">#&gt;   _llikUnifDbeta = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnifDbeta");</span></span>
<span><span class="co">#&gt;   _llikUnifDalpha = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnifDalpha");</span></span>
<span><span class="co">#&gt;   _llikUnif = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnif");</span></span>
<span><span class="co">#&gt;   _llikGeomDp = (rxode2_llikGeomFun) R_GetCCallable("rxode2ll", "rxLlikGeomDp");</span></span>
<span><span class="co">#&gt;   _llikGeom = (rxode2_llikGeomFun) R_GetCCallable("rxode2ll", "rxLlikGeom");</span></span>
<span><span class="co">#&gt;   _llikFDdf2 = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikFDdf2");</span></span>
<span><span class="co">#&gt;   _llikFDdf1 = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikFDdf1");</span></span>
<span><span class="co">#&gt;   _llikF = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikF");</span></span>
<span><span class="co">#&gt;   _llikExpDrate = (rxode2_llikExpFun) R_GetCCallable("rxode2ll", "rxLlikExpDrate");</span></span>
<span><span class="co">#&gt;   _llikExp = (rxode2_llikExpFun) R_GetCCallable("rxode2ll", "rxLlikExp");</span></span>
<span><span class="co">#&gt;   _llikChisqDdf = (rxode2_llikChisqFun) R_GetCCallable("rxode2ll", "rxLlikChisqDdf");</span></span>
<span><span class="co">#&gt;   _llikChisq = (rxode2_llikChisqFun) R_GetCCallable("rxode2ll", "rxLlikChisq");</span></span>
<span><span class="co">#&gt;   _llikTDsd = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDsd");</span></span>
<span><span class="co">#&gt;   _llikTDmean = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDmean");</span></span>
<span><span class="co">#&gt;   _llikTDdf = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDdf");</span></span>
<span><span class="co">#&gt;   _llikT = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikT");</span></span>
<span><span class="co">#&gt;   _llikBetaDshape2 = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBetaDshape2");</span></span>
<span><span class="co">#&gt;   _llikBetaDshape1 = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBetaDshape1");</span></span>
<span><span class="co">#&gt;   _llikBeta = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBeta");</span></span>
<span><span class="co">#&gt;   _llikNbinomMuDmu = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomMuDmu");</span></span>
<span><span class="co">#&gt;   _llikNbinomMu = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomMu");</span></span>
<span><span class="co">#&gt;   _llikNbinomDprob = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomDprob");</span></span>
<span><span class="co">#&gt;   _llikNbinom = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinom");</span></span>
<span><span class="co">#&gt;   _llikBinomDprob = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikBinomDprob");</span></span>
<span><span class="co">#&gt;   _llikBinom = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikBinom");</span></span>
<span><span class="co">#&gt;   _llikPoisDlambda = (rxode2_llikPoisFun) R_GetCCallable("rxode2ll", "rxLlikPoisDlambda");</span></span>
<span><span class="co">#&gt;   _llikPois = (rxode2_llikPoisFun) R_GetCCallable("rxode2ll", "rxLlikPois");</span></span>
<span><span class="co">#&gt;   _llikNormDsd = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNormDsd");</span></span>
<span><span class="co">#&gt;   _llikNormDmean = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNormDmean");</span></span>
<span><span class="co">#&gt;   _llikNorm = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNorm");</span></span>
<span><span class="co">#&gt;   simeps = (_simfun) R_GetCCallable("rxode2", "simeps");</span></span>
<span><span class="co">#&gt;   simeta = (_simfun) R_GetCCallable("rxode2", "simeta");</span></span>
<span><span class="co">#&gt;   expit = (rxode2_fn3) R_GetCCallable("rxode2", "expit");</span></span>
<span><span class="co">#&gt;   logit = (rxode2_fn3) R_GetCCallable("rxode2", "logit");</span></span>
<span><span class="co">#&gt;   gammapDer = (rxode2_fn2) R_GetCCallable("rxode2", "gammapDer");</span></span>
<span><span class="co">#&gt;   lowergamma = (rxode2_fn2) R_GetCCallable("rxode2", "lowergamma");</span></span>
<span><span class="co">#&gt;   uppergamma = (rxode2_fn2) R_GetCCallable("rxode2", "uppergamma");</span></span>
<span><span class="co">#&gt;   gammaqInva = (rxode2_fn2) R_GetCCallable("rxode2", "gammaqInva");</span></span>
<span><span class="co">#&gt;   gammaqInv = (rxode2_fn2) R_GetCCallable("rxode2", "gammaqInv");</span></span>
<span><span class="co">#&gt;   gammapInva = (rxode2_fn2) R_GetCCallable("rxode2", "gammapInva");</span></span>
<span><span class="co">#&gt;   gammapInv = (rxode2_fn2) R_GetCCallable("rxode2", "gammapInv");</span></span>
<span><span class="co">#&gt;   gammaq = (rxode2_fn2) R_GetCCallable("rxode2", "gammaq");</span></span>
<span><span class="co">#&gt;   gammap = (rxode2_fn2) R_GetCCallable("rxode2", "gammap");</span></span>
<span><span class="co">#&gt;   phi = (rxode2_fn) R_GetCCallable("rxode2", "phi");</span></span>
<span><span class="co">#&gt;   d2ELUa = (rxode2_fn2) R_GetCCallable("rxode2", "d2ELUa");</span></span>
<span><span class="co">#&gt;   dELUa = (rxode2_fn2) R_GetCCallable("rxode2", "dELUa");</span></span>
<span><span class="co">#&gt;   d2aELU = (rxode2_fn2) R_GetCCallable("rxode2", "d2aELU");</span></span>
<span><span class="co">#&gt;   d2ELU = (rxode2_fn2) R_GetCCallable("rxode2", "d2ELU");</span></span>
<span><span class="co">#&gt;   dELU = (rxode2_fn2) R_GetCCallable("rxode2", "dELU");</span></span>
<span><span class="co">#&gt;   ELU = (rxode2_fn2) R_GetCCallable("rxode2", "ELU");</span></span>
<span><span class="co">#&gt;   dPReLUa1 = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLUa1");</span></span>
<span><span class="co">#&gt;   dPReLUa = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLUa");</span></span>
<span><span class="co">#&gt;   dPReLU = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLU");</span></span>
<span><span class="co">#&gt;   PReLU = (rxode2_fn2) R_GetCCallable("rxode2", "PReLU");</span></span>
<span><span class="co">#&gt;   dSwish = (rxode2_fn) R_GetCCallable("rxode2", "dSwish");</span></span>
<span><span class="co">#&gt;   Swish = (rxode2_fn) R_GetCCallable("rxode2", "Swish");</span></span>
<span><span class="co">#&gt;   dlReLU = (rxode2_fn) R_GetCCallable("rxode2", "dlReLU");</span></span>
<span><span class="co">#&gt;   lReLU = (rxode2_fn) R_GetCCallable("rxode2", "lReLU");</span></span>
<span><span class="co">#&gt;   dSELU = (rxode2_fn) R_GetCCallable("rxode2", "dSELU");</span></span>
<span><span class="co">#&gt;   SELU = (rxode2_fn) R_GetCCallable("rxode2", "SELU");</span></span>
<span><span class="co">#&gt;   d4softplus = (rxode2_fn) R_GetCCallable("rxode2", "d4softplus");</span></span>
<span><span class="co">#&gt;   d3softplus = (rxode2_fn) R_GetCCallable("rxode2", "d3softplus");</span></span>
<span><span class="co">#&gt;   d2softplus = (rxode2_fn) R_GetCCallable("rxode2", "d2softplus");</span></span>
<span><span class="co">#&gt;   dsoftplus = (rxode2_fn) R_GetCCallable("rxode2", "dsoftplus");</span></span>
<span><span class="co">#&gt;   softplus = (rxode2_fn) R_GetCCallable("rxode2", "softplus");</span></span>
<span><span class="co">#&gt;   d4GELU = (rxode2_fn) R_GetCCallable("rxode2", "d4GELU");</span></span>
<span><span class="co">#&gt;   d3GELU = (rxode2_fn) R_GetCCallable("rxode2", "d3GELU");</span></span>
<span><span class="co">#&gt;   d2GELU = (rxode2_fn) R_GetCCallable("rxode2", "d2GELU");</span></span>
<span><span class="co">#&gt;   dGELU = (rxode2_fn) R_GetCCallable("rxode2", "dGELU");</span></span>
<span><span class="co">#&gt;   GELU = (rxode2_fn) R_GetCCallable("rxode2", "GELU");</span></span>
<span><span class="co">#&gt;   dReLU = (rxode2_fn) R_GetCCallable("rxode2", "dReLU");</span></span>
<span><span class="co">#&gt;   ReLU = (rxode2_fn) R_GetCCallable("rxode2", "ReLU");</span></span>
<span><span class="co">#&gt;   riweibull = (rxode2i2_fn2) R_GetCCallable("rxode2", "riweibull");</span></span>
<span><span class="co">#&gt;   riunif = (rxode2i2_fn2) R_GetCCallable("rxode2", "riunif");</span></span>
<span><span class="co">#&gt;   rit_ = (rxode2i2_fn) R_GetCCallable("rxode2", "rit_");</span></span>
<span><span class="co">#&gt;   ripois = (rxode2i2_ifn) R_GetCCallable("rxode2", "ripois");</span></span>
<span><span class="co">#&gt;   ribeta = (rxode2i2_fn2) R_GetCCallable("rxode2", "ribeta");</span></span>
<span><span class="co">#&gt;   rigamma = (rxode2i2_fn2) R_GetCCallable("rxode2", "rigamma");</span></span>
<span><span class="co">#&gt;   rigeom = (rxode2i2_ifn) R_GetCCallable("rxode2", "rigeom");</span></span>
<span><span class="co">#&gt;   rif = (rxode2i2_fn2) R_GetCCallable("rxode2", "rif");</span></span>
<span><span class="co">#&gt;   riexp = (rxode2i2_fn) R_GetCCallable("rxode2", "riexp");</span></span>
<span><span class="co">#&gt;   richisq = (rxode2i2_fn) R_GetCCallable("rxode2", "richisq");</span></span>
<span><span class="co">#&gt;   ricauchy = (rxode2i2_fn2) R_GetCCallable("rxode2", "ricauchy");</span></span>
<span><span class="co">#&gt;   rinbinomMu = (rxode2i2_ribinom) R_GetCCallable("rxode2", "rinbinomMu");</span></span>
<span><span class="co">#&gt;   rinbinom = (rxode2i2_ribinom) R_GetCCallable("rxode2", "rinbinom");</span></span>
<span><span class="co">#&gt;   ribinom = (rxode2i2_ribinom) R_GetCCallable("rxode2", "ribinom");</span></span>
<span><span class="co">#&gt;   rinorm = (rxode2i2_fn2) R_GetCCallable("rxode2", "rinorm");</span></span>
<span><span class="co">#&gt;   rxweibull = (rxode2i_fn2) R_GetCCallable("rxode2", "rxweibull");</span></span>
<span><span class="co">#&gt;   rxunif = (rxode2i_fn2) R_GetCCallable("rxode2", "rxunif");</span></span>
<span><span class="co">#&gt;   rxt_ = (rxode2i_fn) R_GetCCallable("rxode2", "rxt_");</span></span>
<span><span class="co">#&gt;   rxpois = (rxode2i_ifn) R_GetCCallable("rxode2", "rxpois");</span></span>
<span><span class="co">#&gt;   rxbeta = (rxode2i_fn2) R_GetCCallable("rxode2", "rxbeta");</span></span>
<span><span class="co">#&gt;   rxgamma = (rxode2i_fn2) R_GetCCallable("rxode2", "rxgamma");</span></span>
<span><span class="co">#&gt;   rxgeom = (rxode2i_ifn) R_GetCCallable("rxode2", "rxgeom");</span></span>
<span><span class="co">#&gt;   rxf = (rxode2i_fn2) R_GetCCallable("rxode2", "rxf");</span></span>
<span><span class="co">#&gt;   rxexp = (rxode2i_fn) R_GetCCallable("rxode2", "rxexp");</span></span>
<span><span class="co">#&gt;   rxchisq = (rxode2i_fn) R_GetCCallable("rxode2", "rxchisq");</span></span>
<span><span class="co">#&gt;   rxcauchy = (rxode2i_fn2) R_GetCCallable("rxode2", "rxcauchy");</span></span>
<span><span class="co">#&gt;   rxnbinomMu = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxnbinomMu");</span></span>
<span><span class="co">#&gt;   rxnbinom = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxnbinom");</span></span>
<span><span class="co">#&gt;   rxbinom = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxbinom");</span></span>
<span><span class="co">#&gt;   rxnorm = (rxode2i_fn2) R_GetCCallable("rxode2", "rxnorm");</span></span>
<span><span class="co">#&gt;   linCmtB = (linCmtB_p) R_GetCCallable("rxode2", "linCmtB");</span></span>
<span><span class="co">#&gt;   linCmtA = (linCmtA_p) R_GetCCallable("rxode2", "linCmtA");</span></span>
<span><span class="co">#&gt;   // dynamic stop</span></span>
<span><span class="co">#&gt;   _solveData = _getRxSolve_();</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void _assignFuns(void) {</span></span>
<span><span class="co">#&gt;   if (_assign_ptr == NULL){</span></span>
<span><span class="co">#&gt;     _assignFuns0();</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void __assignFuns2(rx_solve rx,</span></span>
<span><span class="co">#&gt;                    rx_solving_options op,</span></span>
<span><span class="co">#&gt;                    t_F f,</span></span>
<span><span class="co">#&gt;                    t_LAG lag,</span></span>
<span><span class="co">#&gt;                    t_RATE rate,</span></span>
<span><span class="co">#&gt;                    t_DUR dur,</span></span>
<span><span class="co">#&gt;                    t_calc_mtime mtime,</span></span>
<span><span class="co">#&gt;                    t_ME me,</span></span>
<span><span class="co">#&gt;                    t_IndF indf,</span></span>
<span><span class="co">#&gt;                    t_getTime gettime,</span></span>
<span><span class="co">#&gt;                    t_locateTimeIndex timeindex,</span></span>
<span><span class="co">#&gt;                    t_handle_evidL handleEvid,</span></span>
<span><span class="co">#&gt;                    t_getDur getdur) {</span></span>
<span><span class="co">#&gt;   // assign start</span></span>
<span><span class="co">#&gt;     static rxode2_assignFuns2_t rxode2_assignFuns2 = NULL;</span></span>
<span><span class="co">#&gt;     if (rxode2_assignFuns2 == NULL) rxode2_assignFuns2 = (rxode2_assignFuns2_t)(R_GetCCallable("rxode2", "_rxode2_assignFuns2"));</span></span>
<span><span class="co">#&gt;     rxode2_assignFuns2(rx, op, f, lag, rate, dur, mtime, me, indf, gettime, timeindex, handleEvid, getdur);</span></span>
<span><span class="co">#&gt;   // assign stop</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void  rx_9a074c70b5926e5c95403ddefdfad9bb__ode_solver_solvedata (rx_solve *solve){</span></span>
<span><span class="co">#&gt;   _solveData = solve;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern rx_solve *rx_9a074c70b5926e5c95403ddefdfad9bb__ode_solver_get_solvedata(void){</span></span>
<span><span class="co">#&gt;   return _solveData;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; SEXP rx_9a074c70b5926e5c95403ddefdfad9bb__model_vars(void);</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; // prj-specific differential eqns</span></span>
<span><span class="co">#&gt; void rx_9a074c70b5926e5c95403ddefdfad9bb__dydt(int *_neq, double __t, double *__zzStateVar__, double *__DDtStateVar__)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   int _cSub = _neq[1];</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_neq[1]].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=1;</span></span>
<span><span class="co">#&gt;   double TKA = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TCL = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TV2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TQ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TV3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TKin = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TKout = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TEC50 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double c2_DoT_prop_DoT_sd = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_cl = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_v = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rxerr_DoT_C2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double KA = NA_REAL;</span></span>
<span><span class="co">#&gt;   double CL = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Q = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kin = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kout = NA_REAL;</span></span>
<span><span class="co">#&gt;   double EC50 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double centr = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double peri = NA_REAL;</span></span>
<span><span class="co">#&gt;   double depot = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_yj___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_lambda___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_low___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_hi___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_f_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_r_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double ipredSim = NA_REAL;</span></span>
<span><span class="co">#&gt;   double sim = NA_REAL;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   (void)TKA;</span></span>
<span><span class="co">#&gt;   (void)TCL;</span></span>
<span><span class="co">#&gt;   (void)TV2;</span></span>
<span><span class="co">#&gt;   (void)TQ;</span></span>
<span><span class="co">#&gt;   (void)TV3;</span></span>
<span><span class="co">#&gt;   (void)TKin;</span></span>
<span><span class="co">#&gt;   (void)TKout;</span></span>
<span><span class="co">#&gt;   (void)TEC50;</span></span>
<span><span class="co">#&gt;   (void)c2_DoT_prop_DoT_sd;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_cl;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_v;</span></span>
<span><span class="co">#&gt;   (void)rxerr_DoT_C2;</span></span>
<span><span class="co">#&gt;   (void)KA;</span></span>
<span><span class="co">#&gt;   (void)CL;</span></span>
<span><span class="co">#&gt;   (void)V2;</span></span>
<span><span class="co">#&gt;   (void)Q;</span></span>
<span><span class="co">#&gt;   (void)V3;</span></span>
<span><span class="co">#&gt;   (void)Kin;</span></span>
<span><span class="co">#&gt;   (void)Kout;</span></span>
<span><span class="co">#&gt;   (void)EC50;</span></span>
<span><span class="co">#&gt;   (void)C2;</span></span>
<span><span class="co">#&gt;   (void)centr;</span></span>
<span><span class="co">#&gt;   (void)C3;</span></span>
<span><span class="co">#&gt;   (void)peri;</span></span>
<span><span class="co">#&gt;   (void)depot;</span></span>
<span><span class="co">#&gt;   (void)rx_yj___;</span></span>
<span><span class="co">#&gt;   (void)rx_lambda___;</span></span>
<span><span class="co">#&gt;   (void)rx_low___;</span></span>
<span><span class="co">#&gt;   (void)rx_hi___;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_f_;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_;</span></span>
<span><span class="co">#&gt;   (void)rx_r_;</span></span>
<span><span class="co">#&gt;   (void)ipredSim;</span></span>
<span><span class="co">#&gt;   (void)sim;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   KA = _PL[0];</span></span>
<span><span class="co">#&gt;   CL = _PL[1];</span></span>
<span><span class="co">#&gt;   V2 = _PL[2];</span></span>
<span><span class="co">#&gt;   Q = _PL[3];</span></span>
<span><span class="co">#&gt;   V3 = _PL[4];</span></span>
<span><span class="co">#&gt;   Kin = _PL[5];</span></span>
<span><span class="co">#&gt;   Kout = _PL[6];</span></span>
<span><span class="co">#&gt;   EC50 = _PL[7];</span></span>
<span><span class="co">#&gt;   C2 = _PL[8];</span></span>
<span><span class="co">#&gt;   C3 = _PL[9];</span></span>
<span><span class="co">#&gt;   ipredSim = _PL[10];</span></span>
<span><span class="co">#&gt;   sim = _PL[11];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _update_par_ptr(__t, _cSub, _solveData, _idx);</span></span>
<span><span class="co">#&gt;   TKA = _PP[0];</span></span>
<span><span class="co">#&gt;   TCL = _PP[1];</span></span>
<span><span class="co">#&gt;   TV2 = _PP[2];</span></span>
<span><span class="co">#&gt;   TQ = _PP[3];</span></span>
<span><span class="co">#&gt;   TV3 = _PP[4];</span></span>
<span><span class="co">#&gt;   TKin = _PP[5];</span></span>
<span><span class="co">#&gt;   TKout = _PP[6];</span></span>
<span><span class="co">#&gt;   TEC50 = _PP[7];</span></span>
<span><span class="co">#&gt;   c2_DoT_prop_DoT_sd = _PP[8];</span></span>
<span><span class="co">#&gt;   eta_DoT_cl = _PP[9];</span></span>
<span><span class="co">#&gt;   eta_DoT_v = _PP[10];</span></span>
<span><span class="co">#&gt;   rxerr_DoT_C2 = _PP[11];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   depot = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">#&gt;   centr = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">#&gt;   peri = __zzStateVar__[__DDT2__]*((double)(_ON[__DDT2__]));</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   KA =TKA;</span></span>
<span><span class="co">#&gt;   CL =TCL*exp(eta_DoT_cl);</span></span>
<span><span class="co">#&gt;   V2 =TV2*exp(eta_DoT_v);</span></span>
<span><span class="co">#&gt;   Q =TQ;</span></span>
<span><span class="co">#&gt;   V3 =TV3;</span></span>
<span><span class="co">#&gt;   Kin =TKin;</span></span>
<span><span class="co">#&gt;   Kout =TKout;</span></span>
<span><span class="co">#&gt;   EC50 =TEC50;</span></span>
<span><span class="co">#&gt;   C2=centr/_div0(V2);</span></span>
<span><span class="co">#&gt;   C3=peri/_div0(V3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT0__] = ((double)(_ON[__DDT0__]))*(_IR[__DDT0__] -KA*depot);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT1__] = ((double)(_ON[__DDT1__]))*(_IR[__DDT1__] + KA*depot-CL*C2-Q*C2+Q*C3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT2__] = ((double)(_ON[__DDT2__]))*(_IR[__DDT2__] + Q*C2-Q*C3);</span></span>
<span><span class="co">#&gt;   rx_yj_ =2;</span></span>
<span><span class="co">#&gt;   rx_lambda_ =1;</span></span>
<span><span class="co">#&gt;   rx_low_ =0;</span></span>
<span><span class="co">#&gt;   rx_hi_ =1;</span></span>
<span><span class="co">#&gt;   rx_pred_f_ =C2;</span></span>
<span><span class="co">#&gt;   rx_pred_ =rx_pred_f_;</span></span>
<span><span class="co">#&gt;   rx_r_ =Rx_pow((rx_pred_f_*c2_DoT_prop_DoT_sd),2);</span></span>
<span><span class="co">#&gt;   ipredSim =rxTBSi(rx_pred_,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   sim =rxTBSi(rx_pred_+sqrt(rx_r_)*rxerr_DoT_C2,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   (&amp;_solveData-&gt;subjects[_cSub])-&gt;dadt_counter[0]++;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; // Jacobian derived vars</span></span>
<span><span class="co">#&gt; void rx_9a074c70b5926e5c95403ddefdfad9bb__calc_jac(int *_neq, double __t, double *__zzStateVar__, double *__PDStateVar__, unsigned int __NROWPD__) {</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;     int _cSub=_neq[1];</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_neq[1]].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=2;</span></span>
<span><span class="co">#&gt;   (&amp;_solveData-&gt;subjects[_cSub])-&gt;jac_counter[0]++;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Functional based initial conditions.</span></span>
<span><span class="co">#&gt; void rx_9a074c70b5926e5c95403ddefdfad9bb__inis(int _cSub, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;  _ind-&gt;_rxFlag=3;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // prj-specific derived vars</span></span>
<span><span class="co">#&gt; void rx_9a074c70b5926e5c95403ddefdfad9bb__calc_lhs(int _cSub, double __t, double *__zzStateVar__, double *_lhs) {</span></span>
<span><span class="co">#&gt;     int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=11;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_0__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_1__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_2__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_3__;</span></span>
<span><span class="co">#&gt;   double TKA = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TCL = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TV2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TQ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TV3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TKin = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TKout = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TEC50 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double c2_DoT_prop_DoT_sd = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_cl = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_v = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rxerr_DoT_C2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double KA = NA_REAL;</span></span>
<span><span class="co">#&gt;   double CL = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Q = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kin = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kout = NA_REAL;</span></span>
<span><span class="co">#&gt;   double EC50 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double centr = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double peri = NA_REAL;</span></span>
<span><span class="co">#&gt;   double depot = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_yj___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_lambda___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_low___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_hi___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_f_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_r_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double ipredSim = NA_REAL;</span></span>
<span><span class="co">#&gt;   double sim = NA_REAL;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_0__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_1__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_2__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_3__;</span></span>
<span><span class="co">#&gt;   (void)TKA;</span></span>
<span><span class="co">#&gt;   (void)TCL;</span></span>
<span><span class="co">#&gt;   (void)TV2;</span></span>
<span><span class="co">#&gt;   (void)TQ;</span></span>
<span><span class="co">#&gt;   (void)TV3;</span></span>
<span><span class="co">#&gt;   (void)TKin;</span></span>
<span><span class="co">#&gt;   (void)TKout;</span></span>
<span><span class="co">#&gt;   (void)TEC50;</span></span>
<span><span class="co">#&gt;   (void)c2_DoT_prop_DoT_sd;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_cl;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_v;</span></span>
<span><span class="co">#&gt;   (void)rxerr_DoT_C2;</span></span>
<span><span class="co">#&gt;   (void)KA;</span></span>
<span><span class="co">#&gt;   (void)CL;</span></span>
<span><span class="co">#&gt;   (void)V2;</span></span>
<span><span class="co">#&gt;   (void)Q;</span></span>
<span><span class="co">#&gt;   (void)V3;</span></span>
<span><span class="co">#&gt;   (void)Kin;</span></span>
<span><span class="co">#&gt;   (void)Kout;</span></span>
<span><span class="co">#&gt;   (void)EC50;</span></span>
<span><span class="co">#&gt;   (void)C2;</span></span>
<span><span class="co">#&gt;   (void)centr;</span></span>
<span><span class="co">#&gt;   (void)C3;</span></span>
<span><span class="co">#&gt;   (void)peri;</span></span>
<span><span class="co">#&gt;   (void)depot;</span></span>
<span><span class="co">#&gt;   (void)rx_yj___;</span></span>
<span><span class="co">#&gt;   (void)rx_lambda___;</span></span>
<span><span class="co">#&gt;   (void)rx_low___;</span></span>
<span><span class="co">#&gt;   (void)rx_hi___;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_f_;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_;</span></span>
<span><span class="co">#&gt;   (void)rx_r_;</span></span>
<span><span class="co">#&gt;   (void)ipredSim;</span></span>
<span><span class="co">#&gt;   (void)sim;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   KA = _PL[0];</span></span>
<span><span class="co">#&gt;   CL = _PL[1];</span></span>
<span><span class="co">#&gt;   V2 = _PL[2];</span></span>
<span><span class="co">#&gt;   Q = _PL[3];</span></span>
<span><span class="co">#&gt;   V3 = _PL[4];</span></span>
<span><span class="co">#&gt;   Kin = _PL[5];</span></span>
<span><span class="co">#&gt;   Kout = _PL[6];</span></span>
<span><span class="co">#&gt;   EC50 = _PL[7];</span></span>
<span><span class="co">#&gt;   C2 = _PL[8];</span></span>
<span><span class="co">#&gt;   C3 = _PL[9];</span></span>
<span><span class="co">#&gt;   ipredSim = _PL[10];</span></span>
<span><span class="co">#&gt;   sim = _PL[11];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _update_par_ptr(__t, _cSub, _solveData, _idx);</span></span>
<span><span class="co">#&gt;   TKA = _PP[0];</span></span>
<span><span class="co">#&gt;   TCL = _PP[1];</span></span>
<span><span class="co">#&gt;   TV2 = _PP[2];</span></span>
<span><span class="co">#&gt;   TQ = _PP[3];</span></span>
<span><span class="co">#&gt;   TV3 = _PP[4];</span></span>
<span><span class="co">#&gt;   TKin = _PP[5];</span></span>
<span><span class="co">#&gt;   TKout = _PP[6];</span></span>
<span><span class="co">#&gt;   TEC50 = _PP[7];</span></span>
<span><span class="co">#&gt;   c2_DoT_prop_DoT_sd = _PP[8];</span></span>
<span><span class="co">#&gt;   eta_DoT_cl = _PP[9];</span></span>
<span><span class="co">#&gt;   eta_DoT_v = _PP[10];</span></span>
<span><span class="co">#&gt;   rxerr_DoT_C2 = _PP[11];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   depot = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">#&gt;   centr = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">#&gt;   peri = __zzStateVar__[__DDT2__]*((double)(_ON[__DDT2__]));</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   KA =TKA;</span></span>
<span><span class="co">#&gt;   CL =TCL*exp(eta_DoT_cl);</span></span>
<span><span class="co">#&gt;   V2 =TV2*exp(eta_DoT_v);</span></span>
<span><span class="co">#&gt;   Q =TQ;</span></span>
<span><span class="co">#&gt;   V3 =TV3;</span></span>
<span><span class="co">#&gt;   Kin =TKin;</span></span>
<span><span class="co">#&gt;   Kout =TKout;</span></span>
<span><span class="co">#&gt;   EC50 =TEC50;</span></span>
<span><span class="co">#&gt;   C2=centr/_div0(V2);</span></span>
<span><span class="co">#&gt;   C3=peri/_div0(V3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_0__ = ((double)(_ON[__DDT0__]))*(_IR[__DDT0__] -KA*depot);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_1__ = ((double)(_ON[__DDT1__]))*(_IR[__DDT1__] + KA*depot-CL*C2-Q*C2+Q*C3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_2__ = ((double)(_ON[__DDT2__]))*(_IR[__DDT2__] + Q*C2-Q*C3);</span></span>
<span><span class="co">#&gt;   rx_yj_ =2;</span></span>
<span><span class="co">#&gt;   rx_lambda_ =1;</span></span>
<span><span class="co">#&gt;   rx_low_ =0;</span></span>
<span><span class="co">#&gt;   rx_hi_ =1;</span></span>
<span><span class="co">#&gt;   rx_pred_f_ =C2;</span></span>
<span><span class="co">#&gt;   rx_pred_ =rx_pred_f_;</span></span>
<span><span class="co">#&gt;   rx_r_ =Rx_pow((rx_pred_f_*c2_DoT_prop_DoT_sd),2);</span></span>
<span><span class="co">#&gt;   ipredSim =rxTBSi(rx_pred_,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   sim =rxTBSi(rx_pred_+sqrt(rx_r_)*rxerr_DoT_C2,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _lhs[_LHS_0_]=KA;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_1_]=CL;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_2_]=V2;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_3_]=Q;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_4_]=V3;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_5_]=Kin;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_6_]=Kout;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_7_]=EC50;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_8_]=C2;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_9_]=C3;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_10_]=ipredSim;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_11_]=sim;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Functional based bioavailability</span></span>
<span><span class="co">#&gt; double rx_9a074c70b5926e5c95403ddefdfad9bb__F(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return _amt;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; // Functional based absorption lag</span></span>
<span><span class="co">#&gt; double rx_9a074c70b5926e5c95403ddefdfad9bb__Lag(int _cSub,  int _cmt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return __t;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Modeled zero-order rate</span></span>
<span><span class="co">#&gt; double rx_9a074c70b5926e5c95403ddefdfad9bb__Rate(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return 0.0;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Modeled zero-order duration</span></span>
<span><span class="co">#&gt; double rx_9a074c70b5926e5c95403ddefdfad9bb__Dur(int _cSub,  int _cmt, double _amt, double __t){</span></span>
<span><span class="co">#&gt;  return 0.0;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Model Times</span></span>
<span><span class="co">#&gt; void rx_9a074c70b5926e5c95403ddefdfad9bb__mtime(int _cSub, double *_mtime){</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Matrix Exponential (0)</span></span>
<span><span class="co">#&gt; void rx_9a074c70b5926e5c95403ddefdfad9bb__ME(int _cSub, double _t, double __t, double *_mat, const double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=9;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Inductive linearization Matf</span></span>
<span><span class="co">#&gt; void rx_9a074c70b5926e5c95403ddefdfad9bb__IndF(int _cSub, double _t, double __t, double *_matf){</span></span>
<span><span class="co">#&gt;  int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=10;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern SEXP rx_9a074c70b5926e5c95403ddefdfad9bb__model_vars(void){</span></span>
<span><span class="co">#&gt;   int pro=0;</span></span>
<span><span class="co">#&gt;   SEXP _mv = PROTECT(_rxGetModelLib("rx_9a074c70b5926e5c95403ddefdfad9bb__model_vars"));pro++;</span></span>
<span><span class="co">#&gt;   if (!_rxIsCurrentC(_mv)){</span></span>
<span><span class="co">#&gt;     SEXP hash    = PROTECT(Rf_allocVector(STRSXP, 1));pro++;</span></span>
<span><span class="co">#&gt; #define __doBuf__  snprintf(buf, __doBufN__, "un]\"BAAA@QRtHACAAAAAAAjn|AAAv7#aT)5*Q$VAym4kbE[@2`KC+WXU[ZxDBS~vBbCeJs]N\?L}*GQ:[*zXB3m&amp;+.\?|ZwslOH*ZI!J]MqMD=s!~_Ko&lt;bZjH.u6N!^@&gt;M]:k_Ht4A`F3R3x83#Mf~#{9T~:Yl8[K`y3}.+N|M*,hm.`S\?s}]nIFZ8=jce+|+gD;Y16g8~``920}U7).xld,ey82YNN.{l}iY+`(86/;B/I|7[&lt;Yjy\?Izr`3%%I.`C)&gt;i%%zjiH)I@/)e6J&gt;v6b7p26i*=/eI~nk:;8%%[\?HMrlKP2Np.p88{+5.wPf{$$6XZE:~Aqz|x4wzJ&lt;a.wUr]Hpk%%gPkv}oRy&gt;De];l;R[dMVjq{=cEJ]nl.&amp;]HUw]/53zOPH*100210$rwY=Xi4:B&gt;Nd}C*X0pa#:}ZdE`PtOl!B]d$tO1iDdD(dc^$/)Wez;kv`$tMqMU$E#[Y^PZ+A\?e)LMS/!8f#oOTH3D/B6MSv8Z\?h[iSyJUh#qO;fMee&amp;tMiEXGqtYmRvYmL`&gt;c;Pn&amp;THiyHL{:#`Ko]x,QZZ4GQS_\"uQ&lt;PYz~;;y+n/B}]HvYm]c;PnOdJByB+p}Cy$UHUToC+@Tk:GSoan}&lt;DtJXL8YpXZX+pbu24g{/@yG\"tfqO:I#sm^[Ck+5E[%%H*q|c!`M_SO)o9,fwV[1h3T05b&lt;f}^7yR}CpJdm*k+7Z9t!@dj(dR\?mZ^yk\?m=,%%$e$~PZ`h2z;mZ.LS`=ZuUVv%%ZTtWP]AGxoby7zow*ul]3@/\"CZ&gt;w`U:nx6,T:oxsxQV0&lt;`fcWdj@UBhMSi&lt;488:h!ZMKp/e~7:U9WX(F7UaW|]~(g&gt;+#`\"gew2+,vi|&lt;MiB{Kh\"lBbLgt!Z6wC!@w.]EHt*tnJ*&gt;J%%Z2Ui]JF&gt;M{/v.ogZu^SVz_g8;~LGHn^mE2v2Oe2!1E7lT8jj_C\?.(`\"caQH1:71i:,n8c;rgNf]Ntj\"3MEg&amp;pW/oWSV\?xb:/&amp;[#(s(xW*[d$={l25h&gt;\?~A_c1\?ybWnqq(MUKD1{Re}&gt;E.gpk1:^9|s%%Y[U#+j5rCg6g8%%\?|:~g`c~n1s%%9q]OL#e(qTvn\?R/]ufnN+3(]q*&gt;)~ty*r.wMWr:ik\?B$WTV:;^%%*=F74]FpIMG0UFBzWFBj^vGEYAAg)RP/5e53I*oapc;DS[a2=Tl;=O}T&gt;%%=AJRu8}HFIn&lt;g8T{bjLZ~cT&lt;Z%%{8d&gt;ukKmvO*qds`&gt;HGqBtyY7W9wnOPJ2BpL&gt;MozOA&lt;\"#L_:jFU\"hQXDPRXX^vqi)MxZXDiG1.k63Oz@))JIrASE!37~z;mLoS0@__7umItJ8Pj@l=X!V`2Yk.MZqQfdrcz%%/i|kh|8,|Z3{,lO4zskFut}E^Nf\"O=.mlM}/.Jfvm[+w1NUDml2,s0mXpXm!&lt;+{9Z~&lt;B}rZ0]fQe+$lN!%%@d7#(%%pyeix&gt;o$_9,J37_&gt;mzP$N$&amp;satAZF)G*U1Hwks;nhWe],8UMYQOWW#$54[B{sLH*qX0&lt;@|tYHc=FbyNV)[R4+8uEqDdj&lt;dKgKBmQL&lt;ZC&amp;vG`Len1H5|+M\?.f,G\"pv{M6CFiCV[nsIdTpKKz/4BCX1b(Tv=wp\?hZv5ABPlF&amp;a5#8(D&gt;Gz{Ucu=`m`LAgB/8ErlTC:t1D^M[2xr13aoOhonXZ_{{:7D.M[[)v4Cyy;R[sUz;!%%a~q_K*`Jujywdx6_tXB@Npcf9}BvQ3@I[j{J+Ob%%OZcxVAm1q{f,a\"YIfcBGh/_g^##peC2Nx9To6FV2G6i\?}nsL58\?z)SZcn_a9|9B");</span></span>
<span><span class="co">#&gt;     char buf[1773];</span></span>
<span><span class="co">#&gt; #define __doBufN__ 1773</span></span>
<span><span class="co">#&gt;     __doBuf__</span></span>
<span><span class="co">#&gt; #undef __doBuf__</span></span>
<span><span class="co">#&gt; #undef __doBufN__</span></span>
<span><span class="co">#&gt;     SET_STRING_ELT(hash, 0, Rf_mkChar(buf));</span></span>
<span><span class="co">#&gt;     SEXP lst      = PROTECT(_rxQr(hash));pro++;</span></span>
<span><span class="co">#&gt;     _assign_ptr(lst);</span></span>
<span><span class="co">#&gt;     UNPROTECT(pro);</span></span>
<span><span class="co">#&gt;     return lst;</span></span>
<span><span class="co">#&gt;   } else {</span></span>
<span><span class="co">#&gt;     UNPROTECT(pro);</span></span>
<span><span class="co">#&gt;     return _mv;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void rx_9a074c70b5926e5c95403ddefdfad9bb__dydt_lsoda(int *neq, double *t, double *A, double *DADT)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   rx_9a074c70b5926e5c95403ddefdfad9bb__dydt(neq, *t, A, DADT);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern int rx_9a074c70b5926e5c95403ddefdfad9bb__dydt_liblsoda(double __t, double *y, double *ydot, void *data)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   int *neq = (int*)(data);</span></span>
<span><span class="co">#&gt;   rx_9a074c70b5926e5c95403ddefdfad9bb__dydt(neq, __t, y, ydot);</span></span>
<span><span class="co">#&gt;   return(0);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void rx_9a074c70b5926e5c95403ddefdfad9bb__calc_jac_lsoda(int *neq, double *t, double *A,int *ml, int *mu, double *JAC, int *nrowpd){</span></span>
<span><span class="co">#&gt;   // Update all covariate parameters</span></span>
<span><span class="co">#&gt;   rx_9a074c70b5926e5c95403ddefdfad9bb__calc_jac(neq, *t, A, JAC, *nrowpd);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; //Create function to call from R's main thread that assigns the required functions. Sometimes they don't get assigned.</span></span>
<span><span class="co">#&gt; extern void rx_9a074c70b5926e5c95403ddefdfad9bb__assignFuns(void){</span></span>
<span><span class="co">#&gt;   _assignFuns();</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; //Initialize the dll to match rxode2's calls</span></span>
<span><span class="co">#&gt; void R_init0_rx_9a074c70b5926e5c95403ddefdfad9bb_(void){</span></span>
<span><span class="co">#&gt;   // Get C callables on load; Otherwise it isn't thread safe</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_9a074c70b5926e5c95403ddefdfad9bb_","rx_9a074c70b5926e5c95403ddefdfad9bb__assignFuns2", (DL_FUNC) __assignFuns2);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_9a074c70b5926e5c95403ddefdfad9bb_","rx_9a074c70b5926e5c95403ddefdfad9bb__assignFuns", (DL_FUNC) rx_9a074c70b5926e5c95403ddefdfad9bb__assignFuns);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_9a074c70b5926e5c95403ddefdfad9bb_","rx_9a074c70b5926e5c95403ddefdfad9bb__inis",(DL_FUNC) rx_9a074c70b5926e5c95403ddefdfad9bb__inis);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_9a074c70b5926e5c95403ddefdfad9bb_","rx_9a074c70b5926e5c95403ddefdfad9bb__dydt",(DL_FUNC) rx_9a074c70b5926e5c95403ddefdfad9bb__dydt);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_9a074c70b5926e5c95403ddefdfad9bb_","rx_9a074c70b5926e5c95403ddefdfad9bb__calc_lhs",(DL_FUNC) rx_9a074c70b5926e5c95403ddefdfad9bb__calc_lhs);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_9a074c70b5926e5c95403ddefdfad9bb_","rx_9a074c70b5926e5c95403ddefdfad9bb__calc_jac",(DL_FUNC) rx_9a074c70b5926e5c95403ddefdfad9bb__calc_jac);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_9a074c70b5926e5c95403ddefdfad9bb_","rx_9a074c70b5926e5c95403ddefdfad9bb__dydt_lsoda", (DL_FUNC) rx_9a074c70b5926e5c95403ddefdfad9bb__dydt_lsoda);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_9a074c70b5926e5c95403ddefdfad9bb_","rx_9a074c70b5926e5c95403ddefdfad9bb__calc_jac_lsoda", (DL_FUNC) rx_9a074c70b5926e5c95403ddefdfad9bb__calc_jac_lsoda);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_9a074c70b5926e5c95403ddefdfad9bb_","rx_9a074c70b5926e5c95403ddefdfad9bb__ode_solver_solvedata", (DL_FUNC) rx_9a074c70b5926e5c95403ddefdfad9bb__ode_solver_solvedata);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_9a074c70b5926e5c95403ddefdfad9bb_","rx_9a074c70b5926e5c95403ddefdfad9bb__ode_solver_get_solvedata", (DL_FUNC) rx_9a074c70b5926e5c95403ddefdfad9bb__ode_solver_get_solvedata);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_9a074c70b5926e5c95403ddefdfad9bb_","rx_9a074c70b5926e5c95403ddefdfad9bb__F", (DL_FUNC) rx_9a074c70b5926e5c95403ddefdfad9bb__F);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_9a074c70b5926e5c95403ddefdfad9bb_","rx_9a074c70b5926e5c95403ddefdfad9bb__Lag", (DL_FUNC) rx_9a074c70b5926e5c95403ddefdfad9bb__Lag);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_9a074c70b5926e5c95403ddefdfad9bb_","rx_9a074c70b5926e5c95403ddefdfad9bb__Rate", (DL_FUNC) rx_9a074c70b5926e5c95403ddefdfad9bb__Rate);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_9a074c70b5926e5c95403ddefdfad9bb_","rx_9a074c70b5926e5c95403ddefdfad9bb__Dur", (DL_FUNC) rx_9a074c70b5926e5c95403ddefdfad9bb__Dur);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_9a074c70b5926e5c95403ddefdfad9bb_","rx_9a074c70b5926e5c95403ddefdfad9bb__mtime", (DL_FUNC) rx_9a074c70b5926e5c95403ddefdfad9bb__mtime);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_9a074c70b5926e5c95403ddefdfad9bb_","rx_9a074c70b5926e5c95403ddefdfad9bb__ME", (DL_FUNC) rx_9a074c70b5926e5c95403ddefdfad9bb__ME);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_9a074c70b5926e5c95403ddefdfad9bb_","rx_9a074c70b5926e5c95403ddefdfad9bb__IndF", (DL_FUNC) rx_9a074c70b5926e5c95403ddefdfad9bb__IndF);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_9a074c70b5926e5c95403ddefdfad9bb_","rx_9a074c70b5926e5c95403ddefdfad9bb__dydt_liblsoda", (DL_FUNC) rx_9a074c70b5926e5c95403ddefdfad9bb__dydt_liblsoda);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; //Initialize the dll to match rxode2's calls</span></span>
<span><span class="co">#&gt; void R_init_rx_9a074c70b5926e5c95403ddefdfad9bb_(DllInfo *info){</span></span>
<span><span class="co">#&gt;   // Get C callables on load; Otherwise it isn't thread safe</span></span>
<span><span class="co">#&gt;   R_init0_rx_9a074c70b5926e5c95403ddefdfad9bb_();</span></span>
<span><span class="co">#&gt;   static const R_CallMethodDef callMethods[]  = {</span></span>
<span><span class="co">#&gt;     {"rx_9a074c70b5926e5c95403ddefdfad9bb__model_vars", (DL_FUNC) &amp;rx_9a074c70b5926e5c95403ddefdfad9bb__model_vars, 0},</span></span>
<span><span class="co">#&gt;     {NULL, NULL, 0}</span></span>
<span><span class="co">#&gt;   };</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   R_registerRoutines(info, NULL, callMethods, NULL, NULL);</span></span>
<span><span class="co">#&gt;   R_useDynamicSymbols(info,FALSE);</span></span>
<span><span class="co">#&gt;   _assignFuns0();</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; void R_unload_rx_9a074c70b5926e5c95403ddefdfad9bb_ (DllInfo *info){</span></span>
<span><span class="co">#&gt;   // Free resources required for single subject solve.</span></span>
<span><span class="co">#&gt;   SEXP _mv = PROTECT(_rxGetModelLib("rx_9a074c70b5926e5c95403ddefdfad9bb__model_vars"));</span></span>
<span><span class="co">#&gt;   if (!Rf_isNull(_mv)){</span></span>
<span><span class="co">#&gt;     _rxRmModelLib("rx_9a074c70b5926e5c95403ddefdfad9bb__model_vars");</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   UNPROTECT(1);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’</span></span>
<span></span>
<span><span class="va">ev</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>amountUnits<span class="op">=</span><span class="st">"mg"</span>, timeUnits<span class="op">=</span><span class="st">"hours"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>amt<span class="op">=</span><span class="fl">10000</span>, addl<span class="op">=</span><span class="fl">9</span>,ii<span class="op">=</span><span class="fl">12</span>,cmt<span class="op">=</span><span class="st">"depot"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>time<span class="op">=</span><span class="fl">120</span>, amt<span class="op">=</span><span class="fl">2000</span>, addl<span class="op">=</span><span class="fl">4</span>, ii<span class="op">=</span><span class="fl">14</span>, cmt<span class="op">=</span><span class="st">"depot"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">240</span><span class="op">)</span> <span class="co"># Add sampling</span></span>
<span></span>
<span><span class="va">bench1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html" class="external-link">microbenchmark</a></span><span class="op">(</span>standardCompile<span class="op">=</span><span class="fu"><a href="../reference/rxSolve.html">rxSolve</a></span><span class="op">(</span><span class="va">mod2s</span>, <span class="va">ev</span>, nSub<span class="op">=</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Now clear the cache of models so we can change the compile options for the same model</span></span>
<span><span class="fu"><a href="../reference/rxClean.html">rxClean</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use withr to preserve the options</span></span>
<span><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_options.html" class="external-link">with_options</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rxode2.compile.O<span class="op">=</span><span class="st">"fast"</span><span class="op">)</span>, <span class="op">{</span></span>
<span>  <span class="va">mod2s</span> <span class="op">&lt;-</span> <span class="va">mod2f</span><span class="op">$</span><span class="va">simulationIniModel</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; C model:</span></span>
<span><span class="co">#&gt; // Define translation state order for 4 states</span></span>
<span><span class="co">#&gt; #define __DDT0__ 0 // depot</span></span>
<span><span class="co">#&gt; #define _DEPOT_ 0 // depot</span></span>
<span><span class="co">#&gt; #define __DDT1__ 1 // centr</span></span>
<span><span class="co">#&gt; #define __DDT2__ 2 // peri</span></span>
<span><span class="co">#&gt; #define __DDT3__ 3 // NA</span></span>
<span><span class="co">#&gt; // Define 12 LHS values</span></span>
<span><span class="co">#&gt; #define _LHS_0_ 0 // KA</span></span>
<span><span class="co">#&gt; #define _LHS_1_ 1 // CL</span></span>
<span><span class="co">#&gt; #define _LHS_2_ 2 // V2</span></span>
<span><span class="co">#&gt; #define _LHS_3_ 3 // Q</span></span>
<span><span class="co">#&gt; #define _LHS_4_ 4 // V3</span></span>
<span><span class="co">#&gt; #define _LHS_5_ 5 // Kin</span></span>
<span><span class="co">#&gt; #define _LHS_6_ 6 // Kout</span></span>
<span><span class="co">#&gt; #define _LHS_7_ 7 // EC50</span></span>
<span><span class="co">#&gt; #define _LHS_8_ 8 // C2</span></span>
<span><span class="co">#&gt; #define _LHS_9_ 9 // C3</span></span>
<span><span class="co">#&gt; #define _LHS_10_ 10 // ipredSim</span></span>
<span><span class="co">#&gt; #define _LHS_11_ 11 // sim</span></span>
<span><span class="co">#&gt; #define _getRxSolve_ _rx7ecc92a2db6258ae79d04515021b2c0c715__getRxSolve__C8ua</span></span>
<span><span class="co">#&gt; #define _evalUdf _rx7ecc92a2db6258ae79d04515021b2c0c716__evalUdf_dcJN</span></span>
<span><span class="co">#&gt; #define _solveData _rx7ecc92a2db6258ae79d04515021b2c0c717__solveData_GHFl</span></span>
<span><span class="co">#&gt; #define _assign_ptr _rx7ecc92a2db6258ae79d04515021b2c0c718__assign_ptr_Nprd</span></span>
<span><span class="co">#&gt; #define _rxRmModelLib _rx7ecc92a2db6258ae79d04515021b2c0c719__rxRmModelLib_Ftia</span></span>
<span><span class="co">#&gt; #define _rxGetModelLib _rx7ecc92a2db6258ae79d04515021b2c0c720__rxGetModelLib_PYP1</span></span>
<span><span class="co">#&gt; #define _old_c _rx7ecc92a2db6258ae79d04515021b2c0c721__old_c_hp9r</span></span>
<span><span class="co">#&gt; #define _ptrid _rx7ecc92a2db6258ae79d04515021b2c0c722__ptrid_FAjM</span></span>
<span><span class="co">#&gt; #define _rxIsCurrentC _rx7ecc92a2db6258ae79d04515021b2c0c723__rxIsCurrentC_bEVx</span></span>
<span><span class="co">#&gt; #define _sumPS _rx7ecc92a2db6258ae79d04515021b2c0c724__sumPS_nuSv</span></span>
<span><span class="co">#&gt; #define _prodPS _rx7ecc92a2db6258ae79d04515021b2c0c725__prodPS_wuRi</span></span>
<span><span class="co">#&gt; #define _prodType _rx7ecc92a2db6258ae79d04515021b2c0c726__prodType_5nMR</span></span>
<span><span class="co">#&gt; #define _sumType _rx7ecc92a2db6258ae79d04515021b2c0c727__sumType_ZWZY</span></span>
<span><span class="co">#&gt; #define _update_par_ptr _rx7ecc92a2db6258ae79d04515021b2c0c728__update_par_ptr_OFhP</span></span>
<span><span class="co">#&gt; #define _getParCov _rx7ecc92a2db6258ae79d04515021b2c0c729__getParCov_yRZG</span></span>
<span><span class="co">#&gt; #define _rxode2_rxAssignPtr _rx7ecc92a2db6258ae79d04515021b2c0c730__rxode2_rxAssignPtr_MlHg</span></span>
<span><span class="co">#&gt; #define _rxQr _rx7ecc92a2db6258ae79d04515021b2c0c731__rxQr_oq9r</span></span>
<span><span class="co">#&gt; #define _compareFactorVal _rx7ecc92a2db6258ae79d04515021b2c0c732__compareFactorVal_TKJn</span></span>
<span><span class="co">#&gt; #define _sum _rx7ecc92a2db6258ae79d04515021b2c0c733__sum_Mr9i</span></span>
<span><span class="co">#&gt; #define _udf _rx7ecc92a2db6258ae79d04515021b2c0c734__udf_PDTZ</span></span>
<span><span class="co">#&gt; #define _sign _rx7ecc92a2db6258ae79d04515021b2c0c735__sign_yJC9</span></span>
<span><span class="co">#&gt; #define _prod _rx7ecc92a2db6258ae79d04515021b2c0c736__prod_RBAV</span></span>
<span><span class="co">#&gt; #define _max _rx7ecc92a2db6258ae79d04515021b2c0c737__max_SG5Z</span></span>
<span><span class="co">#&gt; #define _min _rx7ecc92a2db6258ae79d04515021b2c0c738__min_CXpc</span></span>
<span><span class="co">#&gt; #define _transit4P _rx7ecc92a2db6258ae79d04515021b2c0c739__transit4P_L1Ye</span></span>
<span><span class="co">#&gt; #define _transit3P _rx7ecc92a2db6258ae79d04515021b2c0c740__transit3P_uYR3</span></span>
<span><span class="co">#&gt; #define _assignFuns0 _rx7ecc92a2db6258ae79d04515021b2c0c741__assignFuns0_6WbP</span></span>
<span><span class="co">#&gt; #define _assignFuns _rx7ecc92a2db6258ae79d04515021b2c0c742__assignFuns_u2gf</span></span>
<span><span class="co">#&gt; #define _rxord _rx7ecc92a2db6258ae79d04515021b2c0c743__rxord_G9Ds</span></span>
<span><span class="co">#&gt; #define __assignFuns2 _rx7ecc92a2db6258ae79d04515021b2c0c744___assignFuns2_Jf7E</span></span>
<span><span class="co">#&gt; #define _llikCauchyDscale _rx7ecc92a2db6258ae79d04515021b2c0c745__llikCauchyDscale_hGIo</span></span>
<span><span class="co">#&gt; #define _llikCauchyDlocation _rx7ecc92a2db6258ae79d04515021b2c0c746__llikCauchyDlocation_Ulnt</span></span>
<span><span class="co">#&gt; #define _llikCauchy _rx7ecc92a2db6258ae79d04515021b2c0c747__llikCauchy_59oA</span></span>
<span><span class="co">#&gt; #define _llikGammaDrate _rx7ecc92a2db6258ae79d04515021b2c0c748__llikGammaDrate_oSFK</span></span>
<span><span class="co">#&gt; #define _llikGammaDshape _rx7ecc92a2db6258ae79d04515021b2c0c749__llikGammaDshape_gaRu</span></span>
<span><span class="co">#&gt; #define _llikGamma _rx7ecc92a2db6258ae79d04515021b2c0c750__llikGamma_rtOT</span></span>
<span><span class="co">#&gt; #define _llikWeibullDscale _rx7ecc92a2db6258ae79d04515021b2c0c751__llikWeibullDscale_OXu6</span></span>
<span><span class="co">#&gt; #define _llikWeibullDshape _rx7ecc92a2db6258ae79d04515021b2c0c752__llikWeibullDshape_8lPy</span></span>
<span><span class="co">#&gt; #define _llikWeibull _rx7ecc92a2db6258ae79d04515021b2c0c753__llikWeibull_dXWT</span></span>
<span><span class="co">#&gt; #define _llikUnifDbeta _rx7ecc92a2db6258ae79d04515021b2c0c754__llikUnifDbeta_lxhn</span></span>
<span><span class="co">#&gt; #define _llikUnifDalpha _rx7ecc92a2db6258ae79d04515021b2c0c755__llikUnifDalpha_XqYQ</span></span>
<span><span class="co">#&gt; #define _llikUnif _rx7ecc92a2db6258ae79d04515021b2c0c756__llikUnif_oErQ</span></span>
<span><span class="co">#&gt; #define _llikGeomDp _rx7ecc92a2db6258ae79d04515021b2c0c757__llikGeomDp_tJ5Y</span></span>
<span><span class="co">#&gt; #define _llikGeom _rx7ecc92a2db6258ae79d04515021b2c0c758__llikGeom_qLDj</span></span>
<span><span class="co">#&gt; #define _llikFDdf2 _rx7ecc92a2db6258ae79d04515021b2c0c759__llikFDdf2_Aq6u</span></span>
<span><span class="co">#&gt; #define _llikFDdf1 _rx7ecc92a2db6258ae79d04515021b2c0c760__llikFDdf1_FAHA</span></span>
<span><span class="co">#&gt; #define _llikF _rx7ecc92a2db6258ae79d04515021b2c0c761__llikF_HEpB</span></span>
<span><span class="co">#&gt; #define _llikExpDrate _rx7ecc92a2db6258ae79d04515021b2c0c762__llikExpDrate_Lrrb</span></span>
<span><span class="co">#&gt; #define _llikExp _rx7ecc92a2db6258ae79d04515021b2c0c763__llikExp_GsC9</span></span>
<span><span class="co">#&gt; #define _llikChisqDdf _rx7ecc92a2db6258ae79d04515021b2c0c764__llikChisqDdf_8OcP</span></span>
<span><span class="co">#&gt; #define _llikChisq _rx7ecc92a2db6258ae79d04515021b2c0c765__llikChisq_5jgn</span></span>
<span><span class="co">#&gt; #define _llikTDsd _rx7ecc92a2db6258ae79d04515021b2c0c766__llikTDsd_aiGB</span></span>
<span><span class="co">#&gt; #define _llikTDmean _rx7ecc92a2db6258ae79d04515021b2c0c767__llikTDmean_uyg3</span></span>
<span><span class="co">#&gt; #define _llikTDdf _rx7ecc92a2db6258ae79d04515021b2c0c768__llikTDdf_su7d</span></span>
<span><span class="co">#&gt; #define _llikT _rx7ecc92a2db6258ae79d04515021b2c0c769__llikT_A5R4</span></span>
<span><span class="co">#&gt; #define _llikBetaDshape2 _rx7ecc92a2db6258ae79d04515021b2c0c770__llikBetaDshape2_xEja</span></span>
<span><span class="co">#&gt; #define _llikBetaDshape1 _rx7ecc92a2db6258ae79d04515021b2c0c771__llikBetaDshape1_JEX3</span></span>
<span><span class="co">#&gt; #define _llikBeta _rx7ecc92a2db6258ae79d04515021b2c0c772__llikBeta_JSA4</span></span>
<span><span class="co">#&gt; #define _llikNbinomMuDmu _rx7ecc92a2db6258ae79d04515021b2c0c773__llikNbinomMuDmu_DLk0</span></span>
<span><span class="co">#&gt; #define _llikNbinomMu _rx7ecc92a2db6258ae79d04515021b2c0c774__llikNbinomMu_iaX8</span></span>
<span><span class="co">#&gt; #define _llikNbinomDprob _rx7ecc92a2db6258ae79d04515021b2c0c775__llikNbinomDprob_iOwD</span></span>
<span><span class="co">#&gt; #define _llikNbinom _rx7ecc92a2db6258ae79d04515021b2c0c776__llikNbinom_r2tA</span></span>
<span><span class="co">#&gt; #define _llikBinomDprob _rx7ecc92a2db6258ae79d04515021b2c0c777__llikBinomDprob_FcrP</span></span>
<span><span class="co">#&gt; #define _llikBinom _rx7ecc92a2db6258ae79d04515021b2c0c778__llikBinom_Si0p</span></span>
<span><span class="co">#&gt; #define _llikPoisDlambda _rx7ecc92a2db6258ae79d04515021b2c0c779__llikPoisDlambda_NBQs</span></span>
<span><span class="co">#&gt; #define _llikPois _rx7ecc92a2db6258ae79d04515021b2c0c780__llikPois_UJdt</span></span>
<span><span class="co">#&gt; #define _llikNormDsd _rx7ecc92a2db6258ae79d04515021b2c0c781__llikNormDsd_dk1U</span></span>
<span><span class="co">#&gt; #define _llikNormDmean _rx7ecc92a2db6258ae79d04515021b2c0c782__llikNormDmean_sUUO</span></span>
<span><span class="co">#&gt; #define _llikNorm _rx7ecc92a2db6258ae79d04515021b2c0c783__llikNorm_eOs5</span></span>
<span><span class="co">#&gt; #define simeps _rx7ecc92a2db6258ae79d04515021b2c0c784_simeps_YTlB</span></span>
<span><span class="co">#&gt; #define simeta _rx7ecc92a2db6258ae79d04515021b2c0c785_simeta_bIes</span></span>
<span><span class="co">#&gt; #define expit _rx7ecc92a2db6258ae79d04515021b2c0c786_expit_6kdw</span></span>
<span><span class="co">#&gt; #define logit _rx7ecc92a2db6258ae79d04515021b2c0c787_logit_HaKg</span></span>
<span><span class="co">#&gt; #define gammapDer _rx7ecc92a2db6258ae79d04515021b2c0c788_gammapDer_bHaF</span></span>
<span><span class="co">#&gt; #define lowergamma _rx7ecc92a2db6258ae79d04515021b2c0c789_lowergamma_geB5</span></span>
<span><span class="co">#&gt; #define uppergamma _rx7ecc92a2db6258ae79d04515021b2c0c790_uppergamma_VJhx</span></span>
<span><span class="co">#&gt; #define gammaqInva _rx7ecc92a2db6258ae79d04515021b2c0c791_gammaqInva_YVSN</span></span>
<span><span class="co">#&gt; #define gammaqInv _rx7ecc92a2db6258ae79d04515021b2c0c792_gammaqInv_6OZ4</span></span>
<span><span class="co">#&gt; #define gammapInva _rx7ecc92a2db6258ae79d04515021b2c0c793_gammapInva_QFh0</span></span>
<span><span class="co">#&gt; #define gammapInv _rx7ecc92a2db6258ae79d04515021b2c0c794_gammapInv_hN30</span></span>
<span><span class="co">#&gt; #define gammaq _rx7ecc92a2db6258ae79d04515021b2c0c795_gammaq_Ibsb</span></span>
<span><span class="co">#&gt; #define gammap _rx7ecc92a2db6258ae79d04515021b2c0c796_gammap_wgqa</span></span>
<span><span class="co">#&gt; #define phi _rx7ecc92a2db6258ae79d04515021b2c0c797_phi_YGLA</span></span>
<span><span class="co">#&gt; #define d2ELUa _rx7ecc92a2db6258ae79d04515021b2c0c798_d2ELUa_xWXX</span></span>
<span><span class="co">#&gt; #define dELUa _rx7ecc92a2db6258ae79d04515021b2c0c799_dELUa_dtHD</span></span>
<span><span class="co">#&gt; #define d2aELU _rx7ecc92a2db6258ae79d04515021b2c0c800_d2aELU_7T5u</span></span>
<span><span class="co">#&gt; #define d2ELU _rx7ecc92a2db6258ae79d04515021b2c0c801_d2ELU_U3cj</span></span>
<span><span class="co">#&gt; #define dELU _rx7ecc92a2db6258ae79d04515021b2c0c802_dELU_lCEd</span></span>
<span><span class="co">#&gt; #define ELU _rx7ecc92a2db6258ae79d04515021b2c0c803_ELU_s1oh</span></span>
<span><span class="co">#&gt; #define dPReLUa1 _rx7ecc92a2db6258ae79d04515021b2c0c804_dPReLUa1_j5jX</span></span>
<span><span class="co">#&gt; #define dPReLUa _rx7ecc92a2db6258ae79d04515021b2c0c805_dPReLUa_apwC</span></span>
<span><span class="co">#&gt; #define dPReLU _rx7ecc92a2db6258ae79d04515021b2c0c806_dPReLU_h15e</span></span>
<span><span class="co">#&gt; #define PReLU _rx7ecc92a2db6258ae79d04515021b2c0c807_PReLU_OQeV</span></span>
<span><span class="co">#&gt; #define dSwish _rx7ecc92a2db6258ae79d04515021b2c0c808_dSwish_tQbM</span></span>
<span><span class="co">#&gt; #define Swish _rx7ecc92a2db6258ae79d04515021b2c0c809_Swish_3KIt</span></span>
<span><span class="co">#&gt; #define dlReLU _rx7ecc92a2db6258ae79d04515021b2c0c810_dlReLU_conX</span></span>
<span><span class="co">#&gt; #define lReLU _rx7ecc92a2db6258ae79d04515021b2c0c811_lReLU_PMIL</span></span>
<span><span class="co">#&gt; #define dSELU _rx7ecc92a2db6258ae79d04515021b2c0c812_dSELU_947r</span></span>
<span><span class="co">#&gt; #define SELU _rx7ecc92a2db6258ae79d04515021b2c0c813_SELU_25Hx</span></span>
<span><span class="co">#&gt; #define d4softplus _rx7ecc92a2db6258ae79d04515021b2c0c814_d4softplus_ZxUx</span></span>
<span><span class="co">#&gt; #define d3softplus _rx7ecc92a2db6258ae79d04515021b2c0c815_d3softplus_uSTw</span></span>
<span><span class="co">#&gt; #define d2softplus _rx7ecc92a2db6258ae79d04515021b2c0c816_d2softplus_4vX7</span></span>
<span><span class="co">#&gt; #define dsoftplus _rx7ecc92a2db6258ae79d04515021b2c0c817_dsoftplus_sHnB</span></span>
<span><span class="co">#&gt; #define softplus _rx7ecc92a2db6258ae79d04515021b2c0c818_softplus_id4x</span></span>
<span><span class="co">#&gt; #define d4GELU _rx7ecc92a2db6258ae79d04515021b2c0c819_d4GELU_M5V2</span></span>
<span><span class="co">#&gt; #define d3GELU _rx7ecc92a2db6258ae79d04515021b2c0c820_d3GELU_9rBs</span></span>
<span><span class="co">#&gt; #define d2GELU _rx7ecc92a2db6258ae79d04515021b2c0c821_d2GELU_B5n6</span></span>
<span><span class="co">#&gt; #define dGELU _rx7ecc92a2db6258ae79d04515021b2c0c822_dGELU_ApCj</span></span>
<span><span class="co">#&gt; #define GELU _rx7ecc92a2db6258ae79d04515021b2c0c823_GELU_psPQ</span></span>
<span><span class="co">#&gt; #define dReLU _rx7ecc92a2db6258ae79d04515021b2c0c824_dReLU_Lxmt</span></span>
<span><span class="co">#&gt; #define ReLU _rx7ecc92a2db6258ae79d04515021b2c0c825_ReLU_a8Xl</span></span>
<span><span class="co">#&gt; #define riweibull _rx7ecc92a2db6258ae79d04515021b2c0c826_riweibull_HtcY</span></span>
<span><span class="co">#&gt; #define riunif _rx7ecc92a2db6258ae79d04515021b2c0c827_riunif_Dzoh</span></span>
<span><span class="co">#&gt; #define rit_ _rx7ecc92a2db6258ae79d04515021b2c0c828_rit__lmWH</span></span>
<span><span class="co">#&gt; #define ripois _rx7ecc92a2db6258ae79d04515021b2c0c829_ripois_bj4x</span></span>
<span><span class="co">#&gt; #define ribeta _rx7ecc92a2db6258ae79d04515021b2c0c830_ribeta_LBSF</span></span>
<span><span class="co">#&gt; #define rigamma _rx7ecc92a2db6258ae79d04515021b2c0c831_rigamma_YCro</span></span>
<span><span class="co">#&gt; #define rigeom _rx7ecc92a2db6258ae79d04515021b2c0c832_rigeom_4j4l</span></span>
<span><span class="co">#&gt; #define rif _rx7ecc92a2db6258ae79d04515021b2c0c833_rif_GY4F</span></span>
<span><span class="co">#&gt; #define riexp _rx7ecc92a2db6258ae79d04515021b2c0c834_riexp_f7uT</span></span>
<span><span class="co">#&gt; #define richisq _rx7ecc92a2db6258ae79d04515021b2c0c835_richisq_ZG6q</span></span>
<span><span class="co">#&gt; #define ricauchy _rx7ecc92a2db6258ae79d04515021b2c0c836_ricauchy_Fo6w</span></span>
<span><span class="co">#&gt; #define rinbinomMu _rx7ecc92a2db6258ae79d04515021b2c0c837_rinbinomMu_BqJQ</span></span>
<span><span class="co">#&gt; #define rinbinom _rx7ecc92a2db6258ae79d04515021b2c0c838_rinbinom_v1lK</span></span>
<span><span class="co">#&gt; #define ribinom _rx7ecc92a2db6258ae79d04515021b2c0c839_ribinom_ju41</span></span>
<span><span class="co">#&gt; #define rinorm _rx7ecc92a2db6258ae79d04515021b2c0c840_rinorm_qenM</span></span>
<span><span class="co">#&gt; #define rxweibull _rx7ecc92a2db6258ae79d04515021b2c0c841_rxweibull_qr8g</span></span>
<span><span class="co">#&gt; #define rxunif _rx7ecc92a2db6258ae79d04515021b2c0c842_rxunif_3F4h</span></span>
<span><span class="co">#&gt; #define rxt_ _rx7ecc92a2db6258ae79d04515021b2c0c843_rxt__HGTT</span></span>
<span><span class="co">#&gt; #define rxpois _rx7ecc92a2db6258ae79d04515021b2c0c844_rxpois_IfiR</span></span>
<span><span class="co">#&gt; #define rxbeta _rx7ecc92a2db6258ae79d04515021b2c0c845_rxbeta_sUmh</span></span>
<span><span class="co">#&gt; #define rxgamma _rx7ecc92a2db6258ae79d04515021b2c0c846_rxgamma_i5En</span></span>
<span><span class="co">#&gt; #define rxgeom _rx7ecc92a2db6258ae79d04515021b2c0c847_rxgeom_FNNj</span></span>
<span><span class="co">#&gt; #define rxf _rx7ecc92a2db6258ae79d04515021b2c0c848_rxf_UpFQ</span></span>
<span><span class="co">#&gt; #define rxexp _rx7ecc92a2db6258ae79d04515021b2c0c849_rxexp_DJ6H</span></span>
<span><span class="co">#&gt; #define rxchisq _rx7ecc92a2db6258ae79d04515021b2c0c850_rxchisq_LdVY</span></span>
<span><span class="co">#&gt; #define rxcauchy _rx7ecc92a2db6258ae79d04515021b2c0c851_rxcauchy_VdxR</span></span>
<span><span class="co">#&gt; #define rxnbinomMu _rx7ecc92a2db6258ae79d04515021b2c0c852_rxnbinomMu_2osz</span></span>
<span><span class="co">#&gt; #define rxnbinom _rx7ecc92a2db6258ae79d04515021b2c0c853_rxnbinom_H4tv</span></span>
<span><span class="co">#&gt; #define rxbinom _rx7ecc92a2db6258ae79d04515021b2c0c854_rxbinom_loCO</span></span>
<span><span class="co">#&gt; #define rxnorm _rx7ecc92a2db6258ae79d04515021b2c0c855_rxnorm_s9GM</span></span>
<span><span class="co">#&gt; #define linCmtB _rx7ecc92a2db6258ae79d04515021b2c0c856_linCmtB_yMTL</span></span>
<span><span class="co">#&gt; #define linCmtA _rx7ecc92a2db6258ae79d04515021b2c0c857_linCmtA_O2XP</span></span>
<span><span class="co">#&gt; #include &lt;rxode2_model_shared.h&gt;</span></span>
<span><span class="co">#&gt; #define __MAX_PROD__ 0</span></span>
<span><span class="co">#&gt; #define _CMT CMT</span></span>
<span><span class="co">#&gt; #define _SYNC_simeps_ for (int _svari=_solveData-&gt;neps; _svari--;){  if (_solveData-&gt;svar[_svari] == 0) {TKA = _PP[0];};   if (_solveData-&gt;svar[_svari] == 1) {TCL = _PP[1];};   if (_solveData-&gt;svar[_svari] == 2) {TV2 = _PP[2];};   if (_solveData-&gt;svar[_svari] == 3) {TQ = _PP[3];};   if (_solveData-&gt;svar[_svari] == 4) {TV3 = _PP[4];};   if (_solveData-&gt;svar[_svari] == 5) {TKin = _PP[5];};   if (_solveData-&gt;svar[_svari] == 6) {TKout = _PP[6];};   if (_solveData-&gt;svar[_svari] == 7) {TEC50 = _PP[7];};   if (_solveData-&gt;svar[_svari] == 8) {c2_DoT_prop_DoT_sd = _PP[8];};   if (_solveData-&gt;svar[_svari] == 9) {eta_DoT_cl = _PP[9];};   if (_solveData-&gt;svar[_svari] == 10) {eta_DoT_v = _PP[10];};   if (_solveData-&gt;svar[_svari] == 11) {rxerr_DoT_C2 = _PP[11];}; }</span></span>
<span><span class="co">#&gt; #define _SYNC_simeta_ for (int _ovari=_solveData-&gt;neta; _ovari--;){  if (_solveData-&gt;ovar[_ovari] == 0) {TKA = _PP[0];};   if (_solveData-&gt;ovar[_ovari] == 1) {TCL = _PP[1];};   if (_solveData-&gt;ovar[_ovari] == 2) {TV2 = _PP[2];};   if (_solveData-&gt;ovar[_ovari] == 3) {TQ = _PP[3];};   if (_solveData-&gt;ovar[_ovari] == 4) {TV3 = _PP[4];};   if (_solveData-&gt;ovar[_ovari] == 5) {TKin = _PP[5];};   if (_solveData-&gt;ovar[_ovari] == 6) {TKout = _PP[6];};   if (_solveData-&gt;ovar[_ovari] == 7) {TEC50 = _PP[7];};   if (_solveData-&gt;ovar[_ovari] == 8) {c2_DoT_prop_DoT_sd = _PP[8];};   if (_solveData-&gt;ovar[_ovari] == 9) {eta_DoT_cl = _PP[9];};   if (_solveData-&gt;ovar[_ovari] == 10) {eta_DoT_v = _PP[10];};   if (_solveData-&gt;ovar[_ovari] == 11) {rxerr_DoT_C2 = _PP[11];}; }</span></span>
<span><span class="co">#&gt; _getRxSolve_t _getRxSolve_;</span></span>
<span><span class="co">#&gt; _simfun simeps;</span></span>
<span><span class="co">#&gt; _simfun simeta;</span></span>
<span><span class="co">#&gt; _udf_type _evalUdf=NULL;</span></span>
<span><span class="co">#&gt; rx_solve *_solveData=NULL;</span></span>
<span><span class="co">#&gt; rxode2_assign_ptr _assign_ptr=NULL;</span></span>
<span><span class="co">#&gt; _rxRmModelLibType _rxRmModelLib=NULL;</span></span>
<span><span class="co">#&gt; _rxGetModelLibType _rxGetModelLib=NULL;</span></span>
<span><span class="co">#&gt; rxode2_ode_solver_old_c _old_c=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _ptrid=NULL;</span></span>
<span><span class="co">#&gt; _rxIsCurrentC_type _rxIsCurrentC=NULL;</span></span>
<span><span class="co">#&gt; _rxSumType _sumPS=NULL;</span></span>
<span><span class="co">#&gt; _rxProdType _prodPS=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _prodType=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _sumType=NULL;</span></span>
<span><span class="co">#&gt; _update_par_ptr_p _update_par_ptr=NULL;</span></span>
<span><span class="co">#&gt; _getParCov_p _getParCov=NULL;</span></span>
<span><span class="co">#&gt; linCmtA_p linCmtA;</span></span>
<span><span class="co">#&gt; linCmtB_p linCmtB;</span></span>
<span><span class="co">#&gt; _rx_asgn _rxode2_rxAssignPtr=NULL;</span></span>
<span><span class="co">#&gt; _rx_asgn _rxQr=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn phi;</span></span>
<span><span class="co">#&gt; rxode2_fn ReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn dReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn dGELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d2GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d3GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d4GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn dsoftplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d2softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d3softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d4softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn SELU;</span></span>
<span><span class="co">#&gt; rxode2_fn dSELU;</span></span>
<span><span class="co">#&gt; rxode2_fn lReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn dlReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn Swish;</span></span>
<span><span class="co">#&gt; rxode2_fn dSwish;</span></span>
<span><span class="co">#&gt; rxode2_fn2 PReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLUa;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLUa1;</span></span>
<span><span class="co">#&gt; rxode2_fn2 ELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2ELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2aELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dELUa;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2ELUa;</span></span>
<span><span class="co">#&gt; rxode2_fn3 logit;</span></span>
<span><span class="co">#&gt; rxode2_fn3 expit;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammap;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaq;</span></span>
<span><span class="co">#&gt; rxode2_fn2 lowergamma;</span></span>
<span><span class="co">#&gt; rxode2_fn2 uppergamma;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapInv;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapDer;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapInva;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaqInv;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaqInva;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxnorm;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxbinom;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxnbinom;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxnbinomMu;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxcauchy;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxchisq;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxexp;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxf;</span></span>
<span><span class="co">#&gt; rxode2i_ifn rxgeom;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxgamma;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxbeta;</span></span>
<span><span class="co">#&gt; rxode2i_ifn rxpois;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxt_;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxunif;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxweibull;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rinorm;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom ribinom;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom rinbinom;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom rinbinomMu;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 ricauchy;</span></span>
<span><span class="co">#&gt; rxode2i2_fn richisq;</span></span>
<span><span class="co">#&gt; rxode2i2_fn riexp;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rif;</span></span>
<span><span class="co">#&gt; rxode2i2_ifn rigeom;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rigamma;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 ribeta;</span></span>
<span><span class="co">#&gt; rxode2i2_ifn ripois;</span></span>
<span><span class="co">#&gt; rxode2i2_fn rit_;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 riunif;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 riweibull;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNorm;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNormDmean;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNormDsd;</span></span>
<span><span class="co">#&gt; rxode2_llikPoisFun _llikPois;</span></span>
<span><span class="co">#&gt; rxode2_llikPoisFun _llikPoisDlambda;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikBinom;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikBinomDprob;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinom;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomDprob;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomMu;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomMuDmu;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBeta;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBetaDshape1;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBetaDshape2;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikT;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDdf;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDmean;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDsd;</span></span>
<span><span class="co">#&gt; rxode2_llikChisqFun _llikChisq;</span></span>
<span><span class="co">#&gt; rxode2_llikChisqFun _llikChisqDdf;</span></span>
<span><span class="co">#&gt; rxode2_llikExpFun _llikExp;</span></span>
<span><span class="co">#&gt; rxode2_llikExpFun _llikExpDrate;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikF;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikFDdf1;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikFDdf2;</span></span>
<span><span class="co">#&gt; rxode2_llikGeomFun _llikGeom;</span></span>
<span><span class="co">#&gt; rxode2_llikGeomFun _llikGeomDp;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnif;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnifDalpha;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnifDbeta;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibull;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibullDshape;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibullDscale;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGamma;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGammaDshape;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGammaDrate;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchy;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchyDlocation;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchyDscale;</span></span>
<span><span class="co">#&gt; rxode2_compareFactorVal_fn _compareFactorVal;</span></span>
<span><span class="co">#&gt; #include "extraC.h"</span></span>
<span><span class="co">#&gt; double _prod(double *input, double *p, int type, int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return _prodPS(input, p, n, type);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _udf(const char *funName, double *input, int n, ...) {</span></span>
<span><span class="co">#&gt;   if (n == -42) Rf_error("%s", "this has a ui user function that cannot be called directly");</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return _evalUdf(funName, n, input);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _sum(double *input, double *pld, int m, int type, int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   double ret = _sumPS(input, n, pld, m, type);</span></span>
<span><span class="co">#&gt;   if (type == 2 &amp;&amp; m &lt; 0){</span></span>
<span><span class="co">#&gt;     for (int i = -m; i--;){</span></span>
<span><span class="co">#&gt;       pld[i] = 0.0;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return ret;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _sign(unsigned int n, ...) {</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double s = 1;</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;     s = sign(va_arg(valist, double))*s;</span></span>
<span><span class="co">#&gt;     if (s == 0){</span></span>
<span><span class="co">#&gt;       break;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return s;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _rxord(int _cSub, unsigned int n,  ...) {</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind* ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   if (!ind-&gt;inLhs) {</span></span>
<span><span class="co">#&gt;     return 1.0;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double ret = 1.0;</span></span>
<span><span class="co">#&gt;   double p = 0.0;</span></span>
<span><span class="co">#&gt;   double u = rxunif(ind, 0.0, 1.0);</span></span>
<span><span class="co">#&gt;   int found = 0;</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;     p += va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     if (!found) {</span></span>
<span><span class="co">#&gt;       if (u &lt; p) {</span></span>
<span><span class="co">#&gt;         ret = (double)(i+1);</span></span>
<span><span class="co">#&gt;         found = 1;</span></span>
<span><span class="co">#&gt;       }</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   if (!found) ret =(double)(n+1);</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return ret;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _max(unsigned int n, ...) {</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double mx = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tmp = 0;</span></span>
<span><span class="co">#&gt;   if (n &gt;= 1){</span></span>
<span><span class="co">#&gt;     mx = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     for (unsigned int i = 1; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;       tmp = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;       if (tmp&gt;mx) mx=tmp;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     va_end(valist);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return mx;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _min(unsigned int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double mn = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tmp = 0;</span></span>
<span><span class="co">#&gt;   if (n &gt;= 1){</span></span>
<span><span class="co">#&gt;     mn = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     for (unsigned int i = 1; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;       tmp = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;       if (tmp&lt;mn) mn=tmp;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     va_end(valist);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return mn;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _transit4P(int cmt, double t, unsigned int id, double n, double mtt, double bio){</span></span>
<span><span class="co">#&gt;   double nd = (double) n;</span></span>
<span><span class="co">#&gt;   double ktr = (nd+1)/mtt;</span></span>
<span><span class="co">#&gt;   double lktr = _safe_log(nd+1)-_safe_log(mtt);</span></span>
<span><span class="co">#&gt;   double tlast = _solveData-&gt;subjects[id].tlastS[cmt];</span></span>
<span><span class="co">#&gt;   double dose = _solveData-&gt;subjects[id].curDoseS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(dose)) dose = 0.0;</span></span>
<span><span class="co">#&gt;   if (ISNA(tlast)) tlast = 0.0;</span></span>
<span><span class="co">#&gt;   double tad = (t-tlast);</span></span>
<span><span class="co">#&gt;   return exp(_safe_log(bio*dose)+lktr+n*(lktr+_safe_log(tad))-ktr*(tad)-lgamma1p(nd));</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _transit3P(int cmt, double t, unsigned int id, double n, double mtt){</span></span>
<span><span class="co">#&gt;   double nd = (double) n;</span></span>
<span><span class="co">#&gt;   double ktr = (nd+1)/mtt;</span></span>
<span><span class="co">#&gt;   double lktr = _safe_log(nd+1)-_safe_log(mtt);</span></span>
<span><span class="co">#&gt;   double tlast = _solveData-&gt;subjects[id].tlastS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(tlast)) tlast = 0.0;</span></span>
<span><span class="co">#&gt;   double tad = t-tlast;</span></span>
<span><span class="co">#&gt;   double podo = _solveData-&gt;subjects[id].curDoseS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(podo)) podo = 0.0;</span></span>
<span><span class="co">#&gt;   return exp(_safe_log(podo)+lktr+n*(lktr+_safe_log(tad))-ktr*(tad)-lgamma1p(nd));</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void _assignFuns0(void) {</span></span>
<span><span class="co">#&gt;   _evalUdf = (_udf_type) R_GetCCallable("rxode2", "_rxode2_evalUdf");</span></span>
<span><span class="co">#&gt;   _getRxSolve_ = (_getRxSolve_t) R_GetCCallable("rxode2","getRxSolve_");</span></span>
<span><span class="co">#&gt;   _assign_ptr=(rxode2_assign_ptr) R_GetCCallable("rxode2","rxode2_assign_fn_pointers");</span></span>
<span><span class="co">#&gt;   _rxRmModelLib=(_rxRmModelLibType) R_GetCCallable("rxode2","rxRmModelLib");</span></span>
<span><span class="co">#&gt;   _rxGetModelLib=(_rxGetModelLibType) R_GetCCallable("rxode2","rxGetModelLib");</span></span>
<span><span class="co">#&gt;   _rxode2_rxAssignPtr=(_rx_asgn)R_GetCCallable("rxode2","_rxode2_rxAssignPtr");</span></span>
<span><span class="co">#&gt;   _rxQr=(_rx_asgn)R_GetCCallable("rxode2","_rxode2_rxQr");</span></span>
<span><span class="co">#&gt;   _rxIsCurrentC = (_rxIsCurrentC_type)R_GetCCallable("rxode2","rxIsCurrentC");</span></span>
<span><span class="co">#&gt;   _sumPS  = (_rxSumType) R_GetCCallable("PreciseSums","PreciseSums_sum_r");</span></span>
<span><span class="co">#&gt;   _prodPS = (_rxProdType) R_GetCCallable("PreciseSums","PreciseSums_prod_r");</span></span>
<span><span class="co">#&gt;   _prodType=(rxode2_fn0i)R_GetCCallable("PreciseSums", "PreciseSums_prod_get");</span></span>
<span><span class="co">#&gt;   _sumType=(rxode2_fn0i)R_GetCCallable("PreciseSums", "PreciseSums_sum_get");</span></span>
<span><span class="co">#&gt;   _ptrid=(rxode2_fn0i)R_GetCCallable("rxode2", "rxode2_current_fn_pointer_id");</span></span>
<span><span class="co">#&gt;   _compareFactorVal=(rxode2_compareFactorVal_fn) R_GetCCallable("rxode2", "compareFactorVal");</span></span>
<span><span class="co">#&gt;   _update_par_ptr = (_update_par_ptr_p) R_GetCCallable("rxode2","_update_par_ptr");</span></span>
<span><span class="co">#&gt;   _getParCov = (_getParCov_p) R_GetCCallable("rxode2","_getParCov");</span></span>
<span><span class="co">#&gt;   // dynamic start</span></span>
<span><span class="co">#&gt;   _llikCauchyDscale = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchyDscale");</span></span>
<span><span class="co">#&gt;   _llikCauchyDlocation = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchyDlocation");</span></span>
<span><span class="co">#&gt;   _llikCauchy = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchy");</span></span>
<span><span class="co">#&gt;   _llikGammaDrate = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGammaDrate");</span></span>
<span><span class="co">#&gt;   _llikGammaDshape = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGammaDshape");</span></span>
<span><span class="co">#&gt;   _llikGamma = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGamma");</span></span>
<span><span class="co">#&gt;   _llikWeibullDscale = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibullDscale");</span></span>
<span><span class="co">#&gt;   _llikWeibullDshape = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibullDshape");</span></span>
<span><span class="co">#&gt;   _llikWeibull = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibull");</span></span>
<span><span class="co">#&gt;   _llikUnifDbeta = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnifDbeta");</span></span>
<span><span class="co">#&gt;   _llikUnifDalpha = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnifDalpha");</span></span>
<span><span class="co">#&gt;   _llikUnif = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnif");</span></span>
<span><span class="co">#&gt;   _llikGeomDp = (rxode2_llikGeomFun) R_GetCCallable("rxode2ll", "rxLlikGeomDp");</span></span>
<span><span class="co">#&gt;   _llikGeom = (rxode2_llikGeomFun) R_GetCCallable("rxode2ll", "rxLlikGeom");</span></span>
<span><span class="co">#&gt;   _llikFDdf2 = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikFDdf2");</span></span>
<span><span class="co">#&gt;   _llikFDdf1 = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikFDdf1");</span></span>
<span><span class="co">#&gt;   _llikF = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikF");</span></span>
<span><span class="co">#&gt;   _llikExpDrate = (rxode2_llikExpFun) R_GetCCallable("rxode2ll", "rxLlikExpDrate");</span></span>
<span><span class="co">#&gt;   _llikExp = (rxode2_llikExpFun) R_GetCCallable("rxode2ll", "rxLlikExp");</span></span>
<span><span class="co">#&gt;   _llikChisqDdf = (rxode2_llikChisqFun) R_GetCCallable("rxode2ll", "rxLlikChisqDdf");</span></span>
<span><span class="co">#&gt;   _llikChisq = (rxode2_llikChisqFun) R_GetCCallable("rxode2ll", "rxLlikChisq");</span></span>
<span><span class="co">#&gt;   _llikTDsd = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDsd");</span></span>
<span><span class="co">#&gt;   _llikTDmean = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDmean");</span></span>
<span><span class="co">#&gt;   _llikTDdf = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDdf");</span></span>
<span><span class="co">#&gt;   _llikT = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikT");</span></span>
<span><span class="co">#&gt;   _llikBetaDshape2 = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBetaDshape2");</span></span>
<span><span class="co">#&gt;   _llikBetaDshape1 = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBetaDshape1");</span></span>
<span><span class="co">#&gt;   _llikBeta = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBeta");</span></span>
<span><span class="co">#&gt;   _llikNbinomMuDmu = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomMuDmu");</span></span>
<span><span class="co">#&gt;   _llikNbinomMu = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomMu");</span></span>
<span><span class="co">#&gt;   _llikNbinomDprob = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomDprob");</span></span>
<span><span class="co">#&gt;   _llikNbinom = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinom");</span></span>
<span><span class="co">#&gt;   _llikBinomDprob = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikBinomDprob");</span></span>
<span><span class="co">#&gt;   _llikBinom = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikBinom");</span></span>
<span><span class="co">#&gt;   _llikPoisDlambda = (rxode2_llikPoisFun) R_GetCCallable("rxode2ll", "rxLlikPoisDlambda");</span></span>
<span><span class="co">#&gt;   _llikPois = (rxode2_llikPoisFun) R_GetCCallable("rxode2ll", "rxLlikPois");</span></span>
<span><span class="co">#&gt;   _llikNormDsd = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNormDsd");</span></span>
<span><span class="co">#&gt;   _llikNormDmean = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNormDmean");</span></span>
<span><span class="co">#&gt;   _llikNorm = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNorm");</span></span>
<span><span class="co">#&gt;   simeps = (_simfun) R_GetCCallable("rxode2", "simeps");</span></span>
<span><span class="co">#&gt;   simeta = (_simfun) R_GetCCallable("rxode2", "simeta");</span></span>
<span><span class="co">#&gt;   expit = (rxode2_fn3) R_GetCCallable("rxode2", "expit");</span></span>
<span><span class="co">#&gt;   logit = (rxode2_fn3) R_GetCCallable("rxode2", "logit");</span></span>
<span><span class="co">#&gt;   gammapDer = (rxode2_fn2) R_GetCCallable("rxode2", "gammapDer");</span></span>
<span><span class="co">#&gt;   lowergamma = (rxode2_fn2) R_GetCCallable("rxode2", "lowergamma");</span></span>
<span><span class="co">#&gt;   uppergamma = (rxode2_fn2) R_GetCCallable("rxode2", "uppergamma");</span></span>
<span><span class="co">#&gt;   gammaqInva = (rxode2_fn2) R_GetCCallable("rxode2", "gammaqInva");</span></span>
<span><span class="co">#&gt;   gammaqInv = (rxode2_fn2) R_GetCCallable("rxode2", "gammaqInv");</span></span>
<span><span class="co">#&gt;   gammapInva = (rxode2_fn2) R_GetCCallable("rxode2", "gammapInva");</span></span>
<span><span class="co">#&gt;   gammapInv = (rxode2_fn2) R_GetCCallable("rxode2", "gammapInv");</span></span>
<span><span class="co">#&gt;   gammaq = (rxode2_fn2) R_GetCCallable("rxode2", "gammaq");</span></span>
<span><span class="co">#&gt;   gammap = (rxode2_fn2) R_GetCCallable("rxode2", "gammap");</span></span>
<span><span class="co">#&gt;   phi = (rxode2_fn) R_GetCCallable("rxode2", "phi");</span></span>
<span><span class="co">#&gt;   d2ELUa = (rxode2_fn2) R_GetCCallable("rxode2", "d2ELUa");</span></span>
<span><span class="co">#&gt;   dELUa = (rxode2_fn2) R_GetCCallable("rxode2", "dELUa");</span></span>
<span><span class="co">#&gt;   d2aELU = (rxode2_fn2) R_GetCCallable("rxode2", "d2aELU");</span></span>
<span><span class="co">#&gt;   d2ELU = (rxode2_fn2) R_GetCCallable("rxode2", "d2ELU");</span></span>
<span><span class="co">#&gt;   dELU = (rxode2_fn2) R_GetCCallable("rxode2", "dELU");</span></span>
<span><span class="co">#&gt;   ELU = (rxode2_fn2) R_GetCCallable("rxode2", "ELU");</span></span>
<span><span class="co">#&gt;   dPReLUa1 = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLUa1");</span></span>
<span><span class="co">#&gt;   dPReLUa = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLUa");</span></span>
<span><span class="co">#&gt;   dPReLU = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLU");</span></span>
<span><span class="co">#&gt;   PReLU = (rxode2_fn2) R_GetCCallable("rxode2", "PReLU");</span></span>
<span><span class="co">#&gt;   dSwish = (rxode2_fn) R_GetCCallable("rxode2", "dSwish");</span></span>
<span><span class="co">#&gt;   Swish = (rxode2_fn) R_GetCCallable("rxode2", "Swish");</span></span>
<span><span class="co">#&gt;   dlReLU = (rxode2_fn) R_GetCCallable("rxode2", "dlReLU");</span></span>
<span><span class="co">#&gt;   lReLU = (rxode2_fn) R_GetCCallable("rxode2", "lReLU");</span></span>
<span><span class="co">#&gt;   dSELU = (rxode2_fn) R_GetCCallable("rxode2", "dSELU");</span></span>
<span><span class="co">#&gt;   SELU = (rxode2_fn) R_GetCCallable("rxode2", "SELU");</span></span>
<span><span class="co">#&gt;   d4softplus = (rxode2_fn) R_GetCCallable("rxode2", "d4softplus");</span></span>
<span><span class="co">#&gt;   d3softplus = (rxode2_fn) R_GetCCallable("rxode2", "d3softplus");</span></span>
<span><span class="co">#&gt;   d2softplus = (rxode2_fn) R_GetCCallable("rxode2", "d2softplus");</span></span>
<span><span class="co">#&gt;   dsoftplus = (rxode2_fn) R_GetCCallable("rxode2", "dsoftplus");</span></span>
<span><span class="co">#&gt;   softplus = (rxode2_fn) R_GetCCallable("rxode2", "softplus");</span></span>
<span><span class="co">#&gt;   d4GELU = (rxode2_fn) R_GetCCallable("rxode2", "d4GELU");</span></span>
<span><span class="co">#&gt;   d3GELU = (rxode2_fn) R_GetCCallable("rxode2", "d3GELU");</span></span>
<span><span class="co">#&gt;   d2GELU = (rxode2_fn) R_GetCCallable("rxode2", "d2GELU");</span></span>
<span><span class="co">#&gt;   dGELU = (rxode2_fn) R_GetCCallable("rxode2", "dGELU");</span></span>
<span><span class="co">#&gt;   GELU = (rxode2_fn) R_GetCCallable("rxode2", "GELU");</span></span>
<span><span class="co">#&gt;   dReLU = (rxode2_fn) R_GetCCallable("rxode2", "dReLU");</span></span>
<span><span class="co">#&gt;   ReLU = (rxode2_fn) R_GetCCallable("rxode2", "ReLU");</span></span>
<span><span class="co">#&gt;   riweibull = (rxode2i2_fn2) R_GetCCallable("rxode2", "riweibull");</span></span>
<span><span class="co">#&gt;   riunif = (rxode2i2_fn2) R_GetCCallable("rxode2", "riunif");</span></span>
<span><span class="co">#&gt;   rit_ = (rxode2i2_fn) R_GetCCallable("rxode2", "rit_");</span></span>
<span><span class="co">#&gt;   ripois = (rxode2i2_ifn) R_GetCCallable("rxode2", "ripois");</span></span>
<span><span class="co">#&gt;   ribeta = (rxode2i2_fn2) R_GetCCallable("rxode2", "ribeta");</span></span>
<span><span class="co">#&gt;   rigamma = (rxode2i2_fn2) R_GetCCallable("rxode2", "rigamma");</span></span>
<span><span class="co">#&gt;   rigeom = (rxode2i2_ifn) R_GetCCallable("rxode2", "rigeom");</span></span>
<span><span class="co">#&gt;   rif = (rxode2i2_fn2) R_GetCCallable("rxode2", "rif");</span></span>
<span><span class="co">#&gt;   riexp = (rxode2i2_fn) R_GetCCallable("rxode2", "riexp");</span></span>
<span><span class="co">#&gt;   richisq = (rxode2i2_fn) R_GetCCallable("rxode2", "richisq");</span></span>
<span><span class="co">#&gt;   ricauchy = (rxode2i2_fn2) R_GetCCallable("rxode2", "ricauchy");</span></span>
<span><span class="co">#&gt;   rinbinomMu = (rxode2i2_ribinom) R_GetCCallable("rxode2", "rinbinomMu");</span></span>
<span><span class="co">#&gt;   rinbinom = (rxode2i2_ribinom) R_GetCCallable("rxode2", "rinbinom");</span></span>
<span><span class="co">#&gt;   ribinom = (rxode2i2_ribinom) R_GetCCallable("rxode2", "ribinom");</span></span>
<span><span class="co">#&gt;   rinorm = (rxode2i2_fn2) R_GetCCallable("rxode2", "rinorm");</span></span>
<span><span class="co">#&gt;   rxweibull = (rxode2i_fn2) R_GetCCallable("rxode2", "rxweibull");</span></span>
<span><span class="co">#&gt;   rxunif = (rxode2i_fn2) R_GetCCallable("rxode2", "rxunif");</span></span>
<span><span class="co">#&gt;   rxt_ = (rxode2i_fn) R_GetCCallable("rxode2", "rxt_");</span></span>
<span><span class="co">#&gt;   rxpois = (rxode2i_ifn) R_GetCCallable("rxode2", "rxpois");</span></span>
<span><span class="co">#&gt;   rxbeta = (rxode2i_fn2) R_GetCCallable("rxode2", "rxbeta");</span></span>
<span><span class="co">#&gt;   rxgamma = (rxode2i_fn2) R_GetCCallable("rxode2", "rxgamma");</span></span>
<span><span class="co">#&gt;   rxgeom = (rxode2i_ifn) R_GetCCallable("rxode2", "rxgeom");</span></span>
<span><span class="co">#&gt;   rxf = (rxode2i_fn2) R_GetCCallable("rxode2", "rxf");</span></span>
<span><span class="co">#&gt;   rxexp = (rxode2i_fn) R_GetCCallable("rxode2", "rxexp");</span></span>
<span><span class="co">#&gt;   rxchisq = (rxode2i_fn) R_GetCCallable("rxode2", "rxchisq");</span></span>
<span><span class="co">#&gt;   rxcauchy = (rxode2i_fn2) R_GetCCallable("rxode2", "rxcauchy");</span></span>
<span><span class="co">#&gt;   rxnbinomMu = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxnbinomMu");</span></span>
<span><span class="co">#&gt;   rxnbinom = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxnbinom");</span></span>
<span><span class="co">#&gt;   rxbinom = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxbinom");</span></span>
<span><span class="co">#&gt;   rxnorm = (rxode2i_fn2) R_GetCCallable("rxode2", "rxnorm");</span></span>
<span><span class="co">#&gt;   linCmtB = (linCmtB_p) R_GetCCallable("rxode2", "linCmtB");</span></span>
<span><span class="co">#&gt;   linCmtA = (linCmtA_p) R_GetCCallable("rxode2", "linCmtA");</span></span>
<span><span class="co">#&gt;   // dynamic stop</span></span>
<span><span class="co">#&gt;   _solveData = _getRxSolve_();</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void _assignFuns(void) {</span></span>
<span><span class="co">#&gt;   if (_assign_ptr == NULL){</span></span>
<span><span class="co">#&gt;     _assignFuns0();</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void __assignFuns2(rx_solve rx,</span></span>
<span><span class="co">#&gt;                    rx_solving_options op,</span></span>
<span><span class="co">#&gt;                    t_F f,</span></span>
<span><span class="co">#&gt;                    t_LAG lag,</span></span>
<span><span class="co">#&gt;                    t_RATE rate,</span></span>
<span><span class="co">#&gt;                    t_DUR dur,</span></span>
<span><span class="co">#&gt;                    t_calc_mtime mtime,</span></span>
<span><span class="co">#&gt;                    t_ME me,</span></span>
<span><span class="co">#&gt;                    t_IndF indf,</span></span>
<span><span class="co">#&gt;                    t_getTime gettime,</span></span>
<span><span class="co">#&gt;                    t_locateTimeIndex timeindex,</span></span>
<span><span class="co">#&gt;                    t_handle_evidL handleEvid,</span></span>
<span><span class="co">#&gt;                    t_getDur getdur) {</span></span>
<span><span class="co">#&gt;   // assign start</span></span>
<span><span class="co">#&gt;     static rxode2_assignFuns2_t rxode2_assignFuns2 = NULL;</span></span>
<span><span class="co">#&gt;     if (rxode2_assignFuns2 == NULL) rxode2_assignFuns2 = (rxode2_assignFuns2_t)(R_GetCCallable("rxode2", "_rxode2_assignFuns2"));</span></span>
<span><span class="co">#&gt;     rxode2_assignFuns2(rx, op, f, lag, rate, dur, mtime, me, indf, gettime, timeindex, handleEvid, getdur);</span></span>
<span><span class="co">#&gt;   // assign stop</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void  rx_9a074c70b5926e5c95403ddefdfad9bb__ode_solver_solvedata (rx_solve *solve){</span></span>
<span><span class="co">#&gt;   _solveData = solve;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern rx_solve *rx_9a074c70b5926e5c95403ddefdfad9bb__ode_solver_get_solvedata(void){</span></span>
<span><span class="co">#&gt;   return _solveData;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; SEXP rx_9a074c70b5926e5c95403ddefdfad9bb__model_vars(void);</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; // prj-specific differential eqns</span></span>
<span><span class="co">#&gt; void rx_9a074c70b5926e5c95403ddefdfad9bb__dydt(int *_neq, double __t, double *__zzStateVar__, double *__DDtStateVar__)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   int _cSub = _neq[1];</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_neq[1]].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=1;</span></span>
<span><span class="co">#&gt;   double TKA = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TCL = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TV2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TQ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TV3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TKin = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TKout = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TEC50 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double c2_DoT_prop_DoT_sd = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_cl = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_v = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rxerr_DoT_C2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double KA = NA_REAL;</span></span>
<span><span class="co">#&gt;   double CL = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Q = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kin = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kout = NA_REAL;</span></span>
<span><span class="co">#&gt;   double EC50 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double centr = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double peri = NA_REAL;</span></span>
<span><span class="co">#&gt;   double depot = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_yj___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_lambda___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_low___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_hi___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_f_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_r_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double ipredSim = NA_REAL;</span></span>
<span><span class="co">#&gt;   double sim = NA_REAL;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   (void)TKA;</span></span>
<span><span class="co">#&gt;   (void)TCL;</span></span>
<span><span class="co">#&gt;   (void)TV2;</span></span>
<span><span class="co">#&gt;   (void)TQ;</span></span>
<span><span class="co">#&gt;   (void)TV3;</span></span>
<span><span class="co">#&gt;   (void)TKin;</span></span>
<span><span class="co">#&gt;   (void)TKout;</span></span>
<span><span class="co">#&gt;   (void)TEC50;</span></span>
<span><span class="co">#&gt;   (void)c2_DoT_prop_DoT_sd;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_cl;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_v;</span></span>
<span><span class="co">#&gt;   (void)rxerr_DoT_C2;</span></span>
<span><span class="co">#&gt;   (void)KA;</span></span>
<span><span class="co">#&gt;   (void)CL;</span></span>
<span><span class="co">#&gt;   (void)V2;</span></span>
<span><span class="co">#&gt;   (void)Q;</span></span>
<span><span class="co">#&gt;   (void)V3;</span></span>
<span><span class="co">#&gt;   (void)Kin;</span></span>
<span><span class="co">#&gt;   (void)Kout;</span></span>
<span><span class="co">#&gt;   (void)EC50;</span></span>
<span><span class="co">#&gt;   (void)C2;</span></span>
<span><span class="co">#&gt;   (void)centr;</span></span>
<span><span class="co">#&gt;   (void)C3;</span></span>
<span><span class="co">#&gt;   (void)peri;</span></span>
<span><span class="co">#&gt;   (void)depot;</span></span>
<span><span class="co">#&gt;   (void)rx_yj___;</span></span>
<span><span class="co">#&gt;   (void)rx_lambda___;</span></span>
<span><span class="co">#&gt;   (void)rx_low___;</span></span>
<span><span class="co">#&gt;   (void)rx_hi___;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_f_;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_;</span></span>
<span><span class="co">#&gt;   (void)rx_r_;</span></span>
<span><span class="co">#&gt;   (void)ipredSim;</span></span>
<span><span class="co">#&gt;   (void)sim;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   KA = _PL[0];</span></span>
<span><span class="co">#&gt;   CL = _PL[1];</span></span>
<span><span class="co">#&gt;   V2 = _PL[2];</span></span>
<span><span class="co">#&gt;   Q = _PL[3];</span></span>
<span><span class="co">#&gt;   V3 = _PL[4];</span></span>
<span><span class="co">#&gt;   Kin = _PL[5];</span></span>
<span><span class="co">#&gt;   Kout = _PL[6];</span></span>
<span><span class="co">#&gt;   EC50 = _PL[7];</span></span>
<span><span class="co">#&gt;   C2 = _PL[8];</span></span>
<span><span class="co">#&gt;   C3 = _PL[9];</span></span>
<span><span class="co">#&gt;   ipredSim = _PL[10];</span></span>
<span><span class="co">#&gt;   sim = _PL[11];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _update_par_ptr(__t, _cSub, _solveData, _idx);</span></span>
<span><span class="co">#&gt;   TKA = _PP[0];</span></span>
<span><span class="co">#&gt;   TCL = _PP[1];</span></span>
<span><span class="co">#&gt;   TV2 = _PP[2];</span></span>
<span><span class="co">#&gt;   TQ = _PP[3];</span></span>
<span><span class="co">#&gt;   TV3 = _PP[4];</span></span>
<span><span class="co">#&gt;   TKin = _PP[5];</span></span>
<span><span class="co">#&gt;   TKout = _PP[6];</span></span>
<span><span class="co">#&gt;   TEC50 = _PP[7];</span></span>
<span><span class="co">#&gt;   c2_DoT_prop_DoT_sd = _PP[8];</span></span>
<span><span class="co">#&gt;   eta_DoT_cl = _PP[9];</span></span>
<span><span class="co">#&gt;   eta_DoT_v = _PP[10];</span></span>
<span><span class="co">#&gt;   rxerr_DoT_C2 = _PP[11];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   depot = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">#&gt;   centr = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">#&gt;   peri = __zzStateVar__[__DDT2__]*((double)(_ON[__DDT2__]));</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   KA =TKA;</span></span>
<span><span class="co">#&gt;   CL =TCL*exp(eta_DoT_cl);</span></span>
<span><span class="co">#&gt;   V2 =TV2*exp(eta_DoT_v);</span></span>
<span><span class="co">#&gt;   Q =TQ;</span></span>
<span><span class="co">#&gt;   V3 =TV3;</span></span>
<span><span class="co">#&gt;   Kin =TKin;</span></span>
<span><span class="co">#&gt;   Kout =TKout;</span></span>
<span><span class="co">#&gt;   EC50 =TEC50;</span></span>
<span><span class="co">#&gt;   C2=centr/_div0(V2);</span></span>
<span><span class="co">#&gt;   C3=peri/_div0(V3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT0__] = ((double)(_ON[__DDT0__]))*(_IR[__DDT0__] -KA*depot);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT1__] = ((double)(_ON[__DDT1__]))*(_IR[__DDT1__] + KA*depot-CL*C2-Q*C2+Q*C3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT2__] = ((double)(_ON[__DDT2__]))*(_IR[__DDT2__] + Q*C2-Q*C3);</span></span>
<span><span class="co">#&gt;   rx_yj_ =2;</span></span>
<span><span class="co">#&gt;   rx_lambda_ =1;</span></span>
<span><span class="co">#&gt;   rx_low_ =0;</span></span>
<span><span class="co">#&gt;   rx_hi_ =1;</span></span>
<span><span class="co">#&gt;   rx_pred_f_ =C2;</span></span>
<span><span class="co">#&gt;   rx_pred_ =rx_pred_f_;</span></span>
<span><span class="co">#&gt;   rx_r_ =Rx_pow((rx_pred_f_*c2_DoT_prop_DoT_sd),2);</span></span>
<span><span class="co">#&gt;   ipredSim =rxTBSi(rx_pred_,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   sim =rxTBSi(rx_pred_+sqrt(rx_r_)*rxerr_DoT_C2,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   (&amp;_solveData-&gt;subjects[_cSub])-&gt;dadt_counter[0]++;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; // Jacobian derived vars</span></span>
<span><span class="co">#&gt; void rx_9a074c70b5926e5c95403ddefdfad9bb__calc_jac(int *_neq, double __t, double *__zzStateVar__, double *__PDStateVar__, unsigned int __NROWPD__) {</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;     int _cSub=_neq[1];</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_neq[1]].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=2;</span></span>
<span><span class="co">#&gt;   (&amp;_solveData-&gt;subjects[_cSub])-&gt;jac_counter[0]++;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Functional based initial conditions.</span></span>
<span><span class="co">#&gt; void rx_9a074c70b5926e5c95403ddefdfad9bb__inis(int _cSub, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;  _ind-&gt;_rxFlag=3;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // prj-specific derived vars</span></span>
<span><span class="co">#&gt; void rx_9a074c70b5926e5c95403ddefdfad9bb__calc_lhs(int _cSub, double __t, double *__zzStateVar__, double *_lhs) {</span></span>
<span><span class="co">#&gt;     int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=11;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_0__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_1__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_2__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_3__;</span></span>
<span><span class="co">#&gt;   double TKA = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TCL = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TV2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TQ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TV3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TKin = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TKout = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TEC50 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double c2_DoT_prop_DoT_sd = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_cl = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_v = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rxerr_DoT_C2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double KA = NA_REAL;</span></span>
<span><span class="co">#&gt;   double CL = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Q = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kin = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kout = NA_REAL;</span></span>
<span><span class="co">#&gt;   double EC50 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double centr = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double peri = NA_REAL;</span></span>
<span><span class="co">#&gt;   double depot = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_yj___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_lambda___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_low___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_hi___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_f_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_r_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double ipredSim = NA_REAL;</span></span>
<span><span class="co">#&gt;   double sim = NA_REAL;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_0__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_1__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_2__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_3__;</span></span>
<span><span class="co">#&gt;   (void)TKA;</span></span>
<span><span class="co">#&gt;   (void)TCL;</span></span>
<span><span class="co">#&gt;   (void)TV2;</span></span>
<span><span class="co">#&gt;   (void)TQ;</span></span>
<span><span class="co">#&gt;   (void)TV3;</span></span>
<span><span class="co">#&gt;   (void)TKin;</span></span>
<span><span class="co">#&gt;   (void)TKout;</span></span>
<span><span class="co">#&gt;   (void)TEC50;</span></span>
<span><span class="co">#&gt;   (void)c2_DoT_prop_DoT_sd;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_cl;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_v;</span></span>
<span><span class="co">#&gt;   (void)rxerr_DoT_C2;</span></span>
<span><span class="co">#&gt;   (void)KA;</span></span>
<span><span class="co">#&gt;   (void)CL;</span></span>
<span><span class="co">#&gt;   (void)V2;</span></span>
<span><span class="co">#&gt;   (void)Q;</span></span>
<span><span class="co">#&gt;   (void)V3;</span></span>
<span><span class="co">#&gt;   (void)Kin;</span></span>
<span><span class="co">#&gt;   (void)Kout;</span></span>
<span><span class="co">#&gt;   (void)EC50;</span></span>
<span><span class="co">#&gt;   (void)C2;</span></span>
<span><span class="co">#&gt;   (void)centr;</span></span>
<span><span class="co">#&gt;   (void)C3;</span></span>
<span><span class="co">#&gt;   (void)peri;</span></span>
<span><span class="co">#&gt;   (void)depot;</span></span>
<span><span class="co">#&gt;   (void)rx_yj___;</span></span>
<span><span class="co">#&gt;   (void)rx_lambda___;</span></span>
<span><span class="co">#&gt;   (void)rx_low___;</span></span>
<span><span class="co">#&gt;   (void)rx_hi___;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_f_;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_;</span></span>
<span><span class="co">#&gt;   (void)rx_r_;</span></span>
<span><span class="co">#&gt;   (void)ipredSim;</span></span>
<span><span class="co">#&gt;   (void)sim;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   KA = _PL[0];</span></span>
<span><span class="co">#&gt;   CL = _PL[1];</span></span>
<span><span class="co">#&gt;   V2 = _PL[2];</span></span>
<span><span class="co">#&gt;   Q = _PL[3];</span></span>
<span><span class="co">#&gt;   V3 = _PL[4];</span></span>
<span><span class="co">#&gt;   Kin = _PL[5];</span></span>
<span><span class="co">#&gt;   Kout = _PL[6];</span></span>
<span><span class="co">#&gt;   EC50 = _PL[7];</span></span>
<span><span class="co">#&gt;   C2 = _PL[8];</span></span>
<span><span class="co">#&gt;   C3 = _PL[9];</span></span>
<span><span class="co">#&gt;   ipredSim = _PL[10];</span></span>
<span><span class="co">#&gt;   sim = _PL[11];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _update_par_ptr(__t, _cSub, _solveData, _idx);</span></span>
<span><span class="co">#&gt;   TKA = _PP[0];</span></span>
<span><span class="co">#&gt;   TCL = _PP[1];</span></span>
<span><span class="co">#&gt;   TV2 = _PP[2];</span></span>
<span><span class="co">#&gt;   TQ = _PP[3];</span></span>
<span><span class="co">#&gt;   TV3 = _PP[4];</span></span>
<span><span class="co">#&gt;   TKin = _PP[5];</span></span>
<span><span class="co">#&gt;   TKout = _PP[6];</span></span>
<span><span class="co">#&gt;   TEC50 = _PP[7];</span></span>
<span><span class="co">#&gt;   c2_DoT_prop_DoT_sd = _PP[8];</span></span>
<span><span class="co">#&gt;   eta_DoT_cl = _PP[9];</span></span>
<span><span class="co">#&gt;   eta_DoT_v = _PP[10];</span></span>
<span><span class="co">#&gt;   rxerr_DoT_C2 = _PP[11];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   depot = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">#&gt;   centr = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">#&gt;   peri = __zzStateVar__[__DDT2__]*((double)(_ON[__DDT2__]));</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   KA =TKA;</span></span>
<span><span class="co">#&gt;   CL =TCL*exp(eta_DoT_cl);</span></span>
<span><span class="co">#&gt;   V2 =TV2*exp(eta_DoT_v);</span></span>
<span><span class="co">#&gt;   Q =TQ;</span></span>
<span><span class="co">#&gt;   V3 =TV3;</span></span>
<span><span class="co">#&gt;   Kin =TKin;</span></span>
<span><span class="co">#&gt;   Kout =TKout;</span></span>
<span><span class="co">#&gt;   EC50 =TEC50;</span></span>
<span><span class="co">#&gt;   C2=centr/_div0(V2);</span></span>
<span><span class="co">#&gt;   C3=peri/_div0(V3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_0__ = ((double)(_ON[__DDT0__]))*(_IR[__DDT0__] -KA*depot);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_1__ = ((double)(_ON[__DDT1__]))*(_IR[__DDT1__] + KA*depot-CL*C2-Q*C2+Q*C3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_2__ = ((double)(_ON[__DDT2__]))*(_IR[__DDT2__] + Q*C2-Q*C3);</span></span>
<span><span class="co">#&gt;   rx_yj_ =2;</span></span>
<span><span class="co">#&gt;   rx_lambda_ =1;</span></span>
<span><span class="co">#&gt;   rx_low_ =0;</span></span>
<span><span class="co">#&gt;   rx_hi_ =1;</span></span>
<span><span class="co">#&gt;   rx_pred_f_ =C2;</span></span>
<span><span class="co">#&gt;   rx_pred_ =rx_pred_f_;</span></span>
<span><span class="co">#&gt;   rx_r_ =Rx_pow((rx_pred_f_*c2_DoT_prop_DoT_sd),2);</span></span>
<span><span class="co">#&gt;   ipredSim =rxTBSi(rx_pred_,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   sim =rxTBSi(rx_pred_+sqrt(rx_r_)*rxerr_DoT_C2,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _lhs[_LHS_0_]=KA;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_1_]=CL;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_2_]=V2;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_3_]=Q;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_4_]=V3;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_5_]=Kin;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_6_]=Kout;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_7_]=EC50;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_8_]=C2;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_9_]=C3;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_10_]=ipredSim;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_11_]=sim;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Functional based bioavailability</span></span>
<span><span class="co">#&gt; double rx_9a074c70b5926e5c95403ddefdfad9bb__F(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return _amt;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; // Functional based absorption lag</span></span>
<span><span class="co">#&gt; double rx_9a074c70b5926e5c95403ddefdfad9bb__Lag(int _cSub,  int _cmt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return __t;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Modeled zero-order rate</span></span>
<span><span class="co">#&gt; double rx_9a074c70b5926e5c95403ddefdfad9bb__Rate(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return 0.0;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Modeled zero-order duration</span></span>
<span><span class="co">#&gt; double rx_9a074c70b5926e5c95403ddefdfad9bb__Dur(int _cSub,  int _cmt, double _amt, double __t){</span></span>
<span><span class="co">#&gt;  return 0.0;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Model Times</span></span>
<span><span class="co">#&gt; void rx_9a074c70b5926e5c95403ddefdfad9bb__mtime(int _cSub, double *_mtime){</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Matrix Exponential (0)</span></span>
<span><span class="co">#&gt; void rx_9a074c70b5926e5c95403ddefdfad9bb__ME(int _cSub, double _t, double __t, double *_mat, const double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=9;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Inductive linearization Matf</span></span>
<span><span class="co">#&gt; void rx_9a074c70b5926e5c95403ddefdfad9bb__IndF(int _cSub, double _t, double __t, double *_matf){</span></span>
<span><span class="co">#&gt;  int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=10;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern SEXP rx_9a074c70b5926e5c95403ddefdfad9bb__model_vars(void){</span></span>
<span><span class="co">#&gt;   int pro=0;</span></span>
<span><span class="co">#&gt;   SEXP _mv = PROTECT(_rxGetModelLib("rx_9a074c70b5926e5c95403ddefdfad9bb__model_vars"));pro++;</span></span>
<span><span class="co">#&gt;   if (!_rxIsCurrentC(_mv)){</span></span>
<span><span class="co">#&gt;     SEXP hash    = PROTECT(Rf_allocVector(STRSXP, 1));pro++;</span></span>
<span><span class="co">#&gt; #define __doBuf__  snprintf(buf, __doBufN__, "un]\"BAAA@QRtHACAAAAAAAjn|AAAv7#aT)5*Q$VAym4kbE[@2`KC+WXU[ZxDBS~vBbCeJs]N\?L}*GQ:[*zXB3m&amp;+.\?|ZwslOH*ZI!J]MqMD=s!~_Ko&lt;bZjH.u6N!^@&gt;M]:k_Ht4A`F3R3x83#Mf~#{9T~:Yl8[K`y3}.+N|M*,hm.`S\?s}]nIFZ8=jce+|+gD;Y16g8~``920}U7).xld,ey82YNN.{l}iY+`(86/;B/I|7[&lt;Yjy\?Izr`3%%I.`C)&gt;i%%zjiH)I@/)e6J&gt;v6b7p26i*=/eI~nk:;8%%[\?HMrlKP2Np.p88{+5.wPf{$$6XZE:~Aqz|x4wzJ&lt;a.wUr]Hpk%%gPkv}oRy&gt;De];l;R[dMVjq{=cEJ]nl.&amp;]HUw]/53zOPH*100210$rwY=Xi4:B&gt;Nd}C*X0pa#:}ZdE`PtOl!B]d$tO1iDdD(dc^$/)Wez;kv`$tMqMU$E#[Y^PZ+A\?e)LMS/!8f#oOTH3D/B6MSv8Z\?h[iSyJUh#qO;fMee&amp;tMiEXGqtYmRvYmL`&gt;c;Pn&amp;THiyHL{:#`Ko]x,QZZ4GQS_\"uQ&lt;PYz~;;y+n/B}]HvYm]c;PnOdJByB+p}Cy$UHUToC+@Tk:GSoan}&lt;DtJXL8YpXZX+pbu24g{/@yG\"tfqO:I#sm^[Ck+5E[%%H*q|c!`M_SO)o9,fwV[1h3T05b&lt;f}^7yR}CpJdm*k+7Z9t!@dj(dR\?mZ^yk\?m=,%%$e$~PZ`h2z;mZ.LS`=ZuUVv%%ZTtWP]AGxoby7zow*ul]3@/\"CZ&gt;w`U:nx6,T:oxsxQV0&lt;`fcWdj@UBhMSi&lt;488:h!ZMKp/e~7:U9WX(F7UaW|]~(g&gt;+#`\"gew2+,vi|&lt;MiB{Kh\"lBbLgt!Z6wC!@w.]EHt*tnJ*&gt;J%%Z2Ui]JF&gt;M{/v.ogZu^SVz_g8;~LGHn^mE2v2Oe2!1E7lT8jj_C\?.(`\"caQH1:71i:,n8c;rgNf]Ntj\"3MEg&amp;pW/oWSV\?xb:/&amp;[#(s(xW*[d$={l25h&gt;\?~A_c1\?ybWnqq(MUKD1{Re}&gt;E.gpk1:^9|s%%Y[U#+j5rCg6g8%%\?|:~g`c~n1s%%9q]OL#e(qTvn\?R/]ufnN+3(]q*&gt;)~ty*r.wMWr:ik\?B$WTV:;^%%*=F74]F4LMG0UFBzWFBj^vGEYAAg)RP/5e53I*oapc;DS[a2=Tl;=O}T&gt;%%=AJRu8}HFIn&lt;g8T{bjLZ~cT&lt;Z%%{8d&gt;ukKmvO*qds`&gt;HGqBtyY7W9wnOPJ2BpL&gt;MozOA&lt;\"#L_:jFU\"hQXDPRXX^vqi)MxZXDiG1.k63Oz@))JIrASE!37~z;mLoS0@__7umItJ8Pj@l=X!V`2Yk.MZqQfdrcz%%/i|kh|8,|Z3{,lO4zskFut}E^Nf\"O=.mlM}/.Jfvm[+w1NUDml2,s0mXpXm!&lt;+{9Z~&lt;B}rZ0]fQe+$lN!%%@d7#(%%pyeix&gt;o$_9,J37_&gt;mzP$N$&amp;satAZF)G*U1Hwks;nhWe],8UMYQOWW#$54[B{sLH*qX0&lt;@|tYHc=FbyNV)[R4+8uEqDdj&lt;dKgKBmQL&lt;ZC&amp;vG`Len1H5|+M\?.f,G\"pv{M6CFiCV[nsIdTpKKz/4BCX1b(Tv=wp\?hZv5ABPlF&amp;a5#8(D&gt;Gz{Ucu=`m`LAgB/8ErlTC:t1D^M[2xr13aoOhonXZ_{{:7D.M[[)v4Cyy;R[sUz;!%%a~q_K*`Jujywdx6_tXB@Npcf9}BvQ3@I[j{J+Ob%%OZcxVAm1q{f,a\"YIfcBGh/_g^##peC2Nx9To6FV2G6i\?}nsL58\?z)SZcF\"aTRC");</span></span>
<span><span class="co">#&gt;     char buf[1772];</span></span>
<span><span class="co">#&gt; #define __doBufN__ 1772</span></span>
<span><span class="co">#&gt;     __doBuf__</span></span>
<span><span class="co">#&gt; #undef __doBuf__</span></span>
<span><span class="co">#&gt; #undef __doBufN__</span></span>
<span><span class="co">#&gt;     SET_STRING_ELT(hash, 0, Rf_mkChar(buf));</span></span>
<span><span class="co">#&gt;     SEXP lst      = PROTECT(_rxQr(hash));pro++;</span></span>
<span><span class="co">#&gt;     _assign_ptr(lst);</span></span>
<span><span class="co">#&gt;     UNPROTECT(pro);</span></span>
<span><span class="co">#&gt;     return lst;</span></span>
<span><span class="co">#&gt;   } else {</span></span>
<span><span class="co">#&gt;     UNPROTECT(pro);</span></span>
<span><span class="co">#&gt;     return _mv;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void rx_9a074c70b5926e5c95403ddefdfad9bb__dydt_lsoda(int *neq, double *t, double *A, double *DADT)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   rx_9a074c70b5926e5c95403ddefdfad9bb__dydt(neq, *t, A, DADT);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern int rx_9a074c70b5926e5c95403ddefdfad9bb__dydt_liblsoda(double __t, double *y, double *ydot, void *data)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   int *neq = (int*)(data);</span></span>
<span><span class="co">#&gt;   rx_9a074c70b5926e5c95403ddefdfad9bb__dydt(neq, __t, y, ydot);</span></span>
<span><span class="co">#&gt;   return(0);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void rx_9a074c70b5926e5c95403ddefdfad9bb__calc_jac_lsoda(int *neq, double *t, double *A,int *ml, int *mu, double *JAC, int *nrowpd){</span></span>
<span><span class="co">#&gt;   // Update all covariate parameters</span></span>
<span><span class="co">#&gt;   rx_9a074c70b5926e5c95403ddefdfad9bb__calc_jac(neq, *t, A, JAC, *nrowpd);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; //Create function to call from R's main thread that assigns the required functions. Sometimes they don't get assigned.</span></span>
<span><span class="co">#&gt; extern void rx_9a074c70b5926e5c95403ddefdfad9bb__assignFuns(void){</span></span>
<span><span class="co">#&gt;   _assignFuns();</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; //Initialize the dll to match rxode2's calls</span></span>
<span><span class="co">#&gt; void R_init0_rx_9a074c70b5926e5c95403ddefdfad9bb_(void){</span></span>
<span><span class="co">#&gt;   // Get C callables on load; Otherwise it isn't thread safe</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_9a074c70b5926e5c95403ddefdfad9bb_","rx_9a074c70b5926e5c95403ddefdfad9bb__assignFuns2", (DL_FUNC) __assignFuns2);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_9a074c70b5926e5c95403ddefdfad9bb_","rx_9a074c70b5926e5c95403ddefdfad9bb__assignFuns", (DL_FUNC) rx_9a074c70b5926e5c95403ddefdfad9bb__assignFuns);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_9a074c70b5926e5c95403ddefdfad9bb_","rx_9a074c70b5926e5c95403ddefdfad9bb__inis",(DL_FUNC) rx_9a074c70b5926e5c95403ddefdfad9bb__inis);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_9a074c70b5926e5c95403ddefdfad9bb_","rx_9a074c70b5926e5c95403ddefdfad9bb__dydt",(DL_FUNC) rx_9a074c70b5926e5c95403ddefdfad9bb__dydt);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_9a074c70b5926e5c95403ddefdfad9bb_","rx_9a074c70b5926e5c95403ddefdfad9bb__calc_lhs",(DL_FUNC) rx_9a074c70b5926e5c95403ddefdfad9bb__calc_lhs);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_9a074c70b5926e5c95403ddefdfad9bb_","rx_9a074c70b5926e5c95403ddefdfad9bb__calc_jac",(DL_FUNC) rx_9a074c70b5926e5c95403ddefdfad9bb__calc_jac);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_9a074c70b5926e5c95403ddefdfad9bb_","rx_9a074c70b5926e5c95403ddefdfad9bb__dydt_lsoda", (DL_FUNC) rx_9a074c70b5926e5c95403ddefdfad9bb__dydt_lsoda);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_9a074c70b5926e5c95403ddefdfad9bb_","rx_9a074c70b5926e5c95403ddefdfad9bb__calc_jac_lsoda", (DL_FUNC) rx_9a074c70b5926e5c95403ddefdfad9bb__calc_jac_lsoda);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_9a074c70b5926e5c95403ddefdfad9bb_","rx_9a074c70b5926e5c95403ddefdfad9bb__ode_solver_solvedata", (DL_FUNC) rx_9a074c70b5926e5c95403ddefdfad9bb__ode_solver_solvedata);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_9a074c70b5926e5c95403ddefdfad9bb_","rx_9a074c70b5926e5c95403ddefdfad9bb__ode_solver_get_solvedata", (DL_FUNC) rx_9a074c70b5926e5c95403ddefdfad9bb__ode_solver_get_solvedata);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_9a074c70b5926e5c95403ddefdfad9bb_","rx_9a074c70b5926e5c95403ddefdfad9bb__F", (DL_FUNC) rx_9a074c70b5926e5c95403ddefdfad9bb__F);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_9a074c70b5926e5c95403ddefdfad9bb_","rx_9a074c70b5926e5c95403ddefdfad9bb__Lag", (DL_FUNC) rx_9a074c70b5926e5c95403ddefdfad9bb__Lag);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_9a074c70b5926e5c95403ddefdfad9bb_","rx_9a074c70b5926e5c95403ddefdfad9bb__Rate", (DL_FUNC) rx_9a074c70b5926e5c95403ddefdfad9bb__Rate);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_9a074c70b5926e5c95403ddefdfad9bb_","rx_9a074c70b5926e5c95403ddefdfad9bb__Dur", (DL_FUNC) rx_9a074c70b5926e5c95403ddefdfad9bb__Dur);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_9a074c70b5926e5c95403ddefdfad9bb_","rx_9a074c70b5926e5c95403ddefdfad9bb__mtime", (DL_FUNC) rx_9a074c70b5926e5c95403ddefdfad9bb__mtime);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_9a074c70b5926e5c95403ddefdfad9bb_","rx_9a074c70b5926e5c95403ddefdfad9bb__ME", (DL_FUNC) rx_9a074c70b5926e5c95403ddefdfad9bb__ME);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_9a074c70b5926e5c95403ddefdfad9bb_","rx_9a074c70b5926e5c95403ddefdfad9bb__IndF", (DL_FUNC) rx_9a074c70b5926e5c95403ddefdfad9bb__IndF);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_9a074c70b5926e5c95403ddefdfad9bb_","rx_9a074c70b5926e5c95403ddefdfad9bb__dydt_liblsoda", (DL_FUNC) rx_9a074c70b5926e5c95403ddefdfad9bb__dydt_liblsoda);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; //Initialize the dll to match rxode2's calls</span></span>
<span><span class="co">#&gt; void R_init_rx_9a074c70b5926e5c95403ddefdfad9bb_(DllInfo *info){</span></span>
<span><span class="co">#&gt;   // Get C callables on load; Otherwise it isn't thread safe</span></span>
<span><span class="co">#&gt;   R_init0_rx_9a074c70b5926e5c95403ddefdfad9bb_();</span></span>
<span><span class="co">#&gt;   static const R_CallMethodDef callMethods[]  = {</span></span>
<span><span class="co">#&gt;     {"rx_9a074c70b5926e5c95403ddefdfad9bb__model_vars", (DL_FUNC) &amp;rx_9a074c70b5926e5c95403ddefdfad9bb__model_vars, 0},</span></span>
<span><span class="co">#&gt;     {NULL, NULL, 0}</span></span>
<span><span class="co">#&gt;   };</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   R_registerRoutines(info, NULL, callMethods, NULL, NULL);</span></span>
<span><span class="co">#&gt;   R_useDynamicSymbols(info,FALSE);</span></span>
<span><span class="co">#&gt;   _assignFuns0();</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; void R_unload_rx_9a074c70b5926e5c95403ddefdfad9bb_ (DllInfo *info){</span></span>
<span><span class="co">#&gt;   // Free resources required for single subject solve.</span></span>
<span><span class="co">#&gt;   SEXP _mv = PROTECT(_rxGetModelLib("rx_9a074c70b5926e5c95403ddefdfad9bb__model_vars"));</span></span>
<span><span class="co">#&gt;   if (!Rf_isNull(_mv)){</span></span>
<span><span class="co">#&gt;     _rxRmModelLib("rx_9a074c70b5926e5c95403ddefdfad9bb__model_vars");</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   UNPROTECT(1);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’</span></span>
<span></span>
<span><span class="va">bench2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html" class="external-link">microbenchmark</a></span><span class="op">(</span>fastCompile<span class="op">=</span><span class="fu"><a href="../reference/rxSolve.html">rxSolve</a></span><span class="op">(</span><span class="va">mod2s</span>, <span class="va">ev</span>, nSub<span class="op">=</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bench</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">bench1</span>, <span class="va">bench2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bench</span><span class="op">)</span></span>
<span><span class="co">#&gt; Unit: milliseconds</span></span>
<span><span class="co">#&gt;             expr      min       lq     mean   median       uq      max neval</span></span>
<span><span class="co">#&gt;  standardCompile 344.8542 358.3078 425.7144 480.6894 489.4154 500.2992   100</span></span>
<span><span class="co">#&gt;      fastCompile 346.1593 356.8142 422.8275 477.0700 484.5741 497.3143   100</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">bench</span><span class="op">)</span></span></code></pre></div>
<p><img src="rxode2-speed_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>Note compiler settings can be tricky and if you setup your system
wide <code>Makevars</code> it may interact with this setting. For
example if you use <code>ccache</code> the compile may not be produced
with the same options since it was cached with the other options.</p>
<p>For example, on the github runner (which generates this page), there
is no advantage to the <code>"fast"</code> compile. However, on my
development laptop there is <a href="https://github.com/nlmixr2/rxode2/issues/583#issuecomment-1834468627" class="external-link">some
minimal speed increase</a>. You should probably check before using this
yourself.</p>
<p>This is disabled by default since there is only minimum increase in
speed.</p>
</div>
<div class="section level2">
<h2 id="a-real-life-example">A real life example<a class="anchor" aria-label="anchor" href="#a-real-life-example"></a>
</h2>
<p>cBefore some of the parallel solving was implemented, the fastest way
to run <code>rxode2</code> was with <code>lapply</code>. This is how Rik
Schoemaker created the data-set for <code>nlmixr</code> comparisons, but
reduced to run faster automatic building of the pkgdown website.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlmixr2.github.io/rxode2/">rxode2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="co">#Define the rxode2 model</span></span>
<span>  <span class="va">ode1</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">  d/dt(abs)    = -KA*abs;</span></span>
<span><span class="st">  d/dt(centr)  =  KA*abs-(CL/V)*centr;</span></span>
<span><span class="st">  C2=centr/V;</span></span>
<span><span class="st">  "</span></span>
<span></span>
<span><span class="co">#Create the rxode2 simulation object</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rxode2.html">rxode2</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">ode1</span><span class="op">)</span></span>
<span><span class="co">#&gt; C model:</span></span>
<span><span class="co">#&gt; // Define translation state order for 2 states</span></span>
<span><span class="co">#&gt; #define __DDT0__ 0 // abs</span></span>
<span><span class="co">#&gt; #define __DDT1__ 1 // centr</span></span>
<span><span class="co">#&gt; // Define 1 LHS values</span></span>
<span><span class="co">#&gt; #define _LHS_0_ 0 // C2</span></span>
<span><span class="co">#&gt; #define _getRxSolve_ _rxae993ae8c3d04c0cf41022fde630c465858__getRxSolve__8C9D</span></span>
<span><span class="co">#&gt; #define _evalUdf _rxae993ae8c3d04c0cf41022fde630c465859__evalUdf_yveR</span></span>
<span><span class="co">#&gt; #define _solveData _rxae993ae8c3d04c0cf41022fde630c465860__solveData_iQBN</span></span>
<span><span class="co">#&gt; #define _assign_ptr _rxae993ae8c3d04c0cf41022fde630c465861__assign_ptr_BJsJ</span></span>
<span><span class="co">#&gt; #define _rxRmModelLib _rxae993ae8c3d04c0cf41022fde630c465862__rxRmModelLib_kcQQ</span></span>
<span><span class="co">#&gt; #define _rxGetModelLib _rxae993ae8c3d04c0cf41022fde630c465863__rxGetModelLib_LI9K</span></span>
<span><span class="co">#&gt; #define _old_c _rxae993ae8c3d04c0cf41022fde630c465864__old_c_PXa2</span></span>
<span><span class="co">#&gt; #define _ptrid _rxae993ae8c3d04c0cf41022fde630c465865__ptrid_DgKv</span></span>
<span><span class="co">#&gt; #define _rxIsCurrentC _rxae993ae8c3d04c0cf41022fde630c465866__rxIsCurrentC_tF0d</span></span>
<span><span class="co">#&gt; #define _sumPS _rxae993ae8c3d04c0cf41022fde630c465867__sumPS_a0A7</span></span>
<span><span class="co">#&gt; #define _prodPS _rxae993ae8c3d04c0cf41022fde630c465868__prodPS_QaXb</span></span>
<span><span class="co">#&gt; #define _prodType _rxae993ae8c3d04c0cf41022fde630c465869__prodType_v5Gl</span></span>
<span><span class="co">#&gt; #define _sumType _rxae993ae8c3d04c0cf41022fde630c465870__sumType_q6SA</span></span>
<span><span class="co">#&gt; #define _update_par_ptr _rxae993ae8c3d04c0cf41022fde630c465871__update_par_ptr_Qui2</span></span>
<span><span class="co">#&gt; #define _getParCov _rxae993ae8c3d04c0cf41022fde630c465872__getParCov_VSzM</span></span>
<span><span class="co">#&gt; #define _rxode2_rxAssignPtr _rxae993ae8c3d04c0cf41022fde630c465873__rxode2_rxAssignPtr_atdL</span></span>
<span><span class="co">#&gt; #define _rxQr _rxae993ae8c3d04c0cf41022fde630c465874__rxQr_odlB</span></span>
<span><span class="co">#&gt; #define _compareFactorVal _rxae993ae8c3d04c0cf41022fde630c465875__compareFactorVal_nW0i</span></span>
<span><span class="co">#&gt; #define _sum _rxae993ae8c3d04c0cf41022fde630c465876__sum_b0iW</span></span>
<span><span class="co">#&gt; #define _udf _rxae993ae8c3d04c0cf41022fde630c465877__udf_hO1F</span></span>
<span><span class="co">#&gt; #define _sign _rxae993ae8c3d04c0cf41022fde630c465878__sign_242E</span></span>
<span><span class="co">#&gt; #define _prod _rxae993ae8c3d04c0cf41022fde630c465879__prod_13Vw</span></span>
<span><span class="co">#&gt; #define _max _rxae993ae8c3d04c0cf41022fde630c465880__max_vFbM</span></span>
<span><span class="co">#&gt; #define _min _rxae993ae8c3d04c0cf41022fde630c465881__min_PmLU</span></span>
<span><span class="co">#&gt; #define _transit4P _rxae993ae8c3d04c0cf41022fde630c465882__transit4P_8K3u</span></span>
<span><span class="co">#&gt; #define _transit3P _rxae993ae8c3d04c0cf41022fde630c465883__transit3P_5YdQ</span></span>
<span><span class="co">#&gt; #define _assignFuns0 _rxae993ae8c3d04c0cf41022fde630c465884__assignFuns0_GsmT</span></span>
<span><span class="co">#&gt; #define _assignFuns _rxae993ae8c3d04c0cf41022fde630c465885__assignFuns_hpMr</span></span>
<span><span class="co">#&gt; #define _rxord _rxae993ae8c3d04c0cf41022fde630c465886__rxord_FEgY</span></span>
<span><span class="co">#&gt; #define __assignFuns2 _rxae993ae8c3d04c0cf41022fde630c465887___assignFuns2_oTjF</span></span>
<span><span class="co">#&gt; #define _llikCauchyDscale _rxae993ae8c3d04c0cf41022fde630c465888__llikCauchyDscale_HoN2</span></span>
<span><span class="co">#&gt; #define _llikCauchyDlocation _rxae993ae8c3d04c0cf41022fde630c465889__llikCauchyDlocation_uECi</span></span>
<span><span class="co">#&gt; #define _llikCauchy _rxae993ae8c3d04c0cf41022fde630c465890__llikCauchy_cTeR</span></span>
<span><span class="co">#&gt; #define _llikGammaDrate _rxae993ae8c3d04c0cf41022fde630c465891__llikGammaDrate_RFvz</span></span>
<span><span class="co">#&gt; #define _llikGammaDshape _rxae993ae8c3d04c0cf41022fde630c465892__llikGammaDshape_PxPy</span></span>
<span><span class="co">#&gt; #define _llikGamma _rxae993ae8c3d04c0cf41022fde630c465893__llikGamma_hbKP</span></span>
<span><span class="co">#&gt; #define _llikWeibullDscale _rxae993ae8c3d04c0cf41022fde630c465894__llikWeibullDscale_ai7J</span></span>
<span><span class="co">#&gt; #define _llikWeibullDshape _rxae993ae8c3d04c0cf41022fde630c465895__llikWeibullDshape_jLQ1</span></span>
<span><span class="co">#&gt; #define _llikWeibull _rxae993ae8c3d04c0cf41022fde630c465896__llikWeibull_jCNx</span></span>
<span><span class="co">#&gt; #define _llikUnifDbeta _rxae993ae8c3d04c0cf41022fde630c465897__llikUnifDbeta_AOE4</span></span>
<span><span class="co">#&gt; #define _llikUnifDalpha _rxae993ae8c3d04c0cf41022fde630c465898__llikUnifDalpha_On1T</span></span>
<span><span class="co">#&gt; #define _llikUnif _rxae993ae8c3d04c0cf41022fde630c465899__llikUnif_4HaD</span></span>
<span><span class="co">#&gt; #define _llikGeomDp _rxae993ae8c3d04c0cf41022fde630c465900__llikGeomDp_e1Fi</span></span>
<span><span class="co">#&gt; #define _llikGeom _rxae993ae8c3d04c0cf41022fde630c465901__llikGeom_3YdV</span></span>
<span><span class="co">#&gt; #define _llikFDdf2 _rxae993ae8c3d04c0cf41022fde630c465902__llikFDdf2_wxHT</span></span>
<span><span class="co">#&gt; #define _llikFDdf1 _rxae993ae8c3d04c0cf41022fde630c465903__llikFDdf1_8t06</span></span>
<span><span class="co">#&gt; #define _llikF _rxae993ae8c3d04c0cf41022fde630c465904__llikF_fmFD</span></span>
<span><span class="co">#&gt; #define _llikExpDrate _rxae993ae8c3d04c0cf41022fde630c465905__llikExpDrate_WXhH</span></span>
<span><span class="co">#&gt; #define _llikExp _rxae993ae8c3d04c0cf41022fde630c465906__llikExp_UByE</span></span>
<span><span class="co">#&gt; #define _llikChisqDdf _rxae993ae8c3d04c0cf41022fde630c465907__llikChisqDdf_pRVQ</span></span>
<span><span class="co">#&gt; #define _llikChisq _rxae993ae8c3d04c0cf41022fde630c465908__llikChisq_57Zr</span></span>
<span><span class="co">#&gt; #define _llikTDsd _rxae993ae8c3d04c0cf41022fde630c465909__llikTDsd_CuQw</span></span>
<span><span class="co">#&gt; #define _llikTDmean _rxae993ae8c3d04c0cf41022fde630c465910__llikTDmean_OC66</span></span>
<span><span class="co">#&gt; #define _llikTDdf _rxae993ae8c3d04c0cf41022fde630c465911__llikTDdf_3JoL</span></span>
<span><span class="co">#&gt; #define _llikT _rxae993ae8c3d04c0cf41022fde630c465912__llikT_0gM0</span></span>
<span><span class="co">#&gt; #define _llikBetaDshape2 _rxae993ae8c3d04c0cf41022fde630c465913__llikBetaDshape2_FNIp</span></span>
<span><span class="co">#&gt; #define _llikBetaDshape1 _rxae993ae8c3d04c0cf41022fde630c465914__llikBetaDshape1_0Q6W</span></span>
<span><span class="co">#&gt; #define _llikBeta _rxae993ae8c3d04c0cf41022fde630c465915__llikBeta_dRFz</span></span>
<span><span class="co">#&gt; #define _llikNbinomMuDmu _rxae993ae8c3d04c0cf41022fde630c465916__llikNbinomMuDmu_NQVl</span></span>
<span><span class="co">#&gt; #define _llikNbinomMu _rxae993ae8c3d04c0cf41022fde630c465917__llikNbinomMu_ZHZX</span></span>
<span><span class="co">#&gt; #define _llikNbinomDprob _rxae993ae8c3d04c0cf41022fde630c465918__llikNbinomDprob_JrGO</span></span>
<span><span class="co">#&gt; #define _llikNbinom _rxae993ae8c3d04c0cf41022fde630c465919__llikNbinom_gCAG</span></span>
<span><span class="co">#&gt; #define _llikBinomDprob _rxae993ae8c3d04c0cf41022fde630c465920__llikBinomDprob_F0vi</span></span>
<span><span class="co">#&gt; #define _llikBinom _rxae993ae8c3d04c0cf41022fde630c465921__llikBinom_BMhY</span></span>
<span><span class="co">#&gt; #define _llikPoisDlambda _rxae993ae8c3d04c0cf41022fde630c465922__llikPoisDlambda_mSmy</span></span>
<span><span class="co">#&gt; #define _llikPois _rxae993ae8c3d04c0cf41022fde630c465923__llikPois_tbJr</span></span>
<span><span class="co">#&gt; #define _llikNormDsd _rxae993ae8c3d04c0cf41022fde630c465924__llikNormDsd_lMy8</span></span>
<span><span class="co">#&gt; #define _llikNormDmean _rxae993ae8c3d04c0cf41022fde630c465925__llikNormDmean_3aIv</span></span>
<span><span class="co">#&gt; #define _llikNorm _rxae993ae8c3d04c0cf41022fde630c465926__llikNorm_Mti7</span></span>
<span><span class="co">#&gt; #define simeps _rxae993ae8c3d04c0cf41022fde630c465927_simeps_Mp3O</span></span>
<span><span class="co">#&gt; #define simeta _rxae993ae8c3d04c0cf41022fde630c465928_simeta_k4F9</span></span>
<span><span class="co">#&gt; #define expit _rxae993ae8c3d04c0cf41022fde630c465929_expit_anYW</span></span>
<span><span class="co">#&gt; #define logit _rxae993ae8c3d04c0cf41022fde630c465930_logit_sRZC</span></span>
<span><span class="co">#&gt; #define gammapDer _rxae993ae8c3d04c0cf41022fde630c465931_gammapDer_GwJ8</span></span>
<span><span class="co">#&gt; #define lowergamma _rxae993ae8c3d04c0cf41022fde630c465932_lowergamma_Pw40</span></span>
<span><span class="co">#&gt; #define uppergamma _rxae993ae8c3d04c0cf41022fde630c465933_uppergamma_aLW7</span></span>
<span><span class="co">#&gt; #define gammaqInva _rxae993ae8c3d04c0cf41022fde630c465934_gammaqInva_NDeu</span></span>
<span><span class="co">#&gt; #define gammaqInv _rxae993ae8c3d04c0cf41022fde630c465935_gammaqInv_PQZT</span></span>
<span><span class="co">#&gt; #define gammapInva _rxae993ae8c3d04c0cf41022fde630c465936_gammapInva_uwBe</span></span>
<span><span class="co">#&gt; #define gammapInv _rxae993ae8c3d04c0cf41022fde630c465937_gammapInv_Bp1i</span></span>
<span><span class="co">#&gt; #define gammaq _rxae993ae8c3d04c0cf41022fde630c465938_gammaq_bjrI</span></span>
<span><span class="co">#&gt; #define gammap _rxae993ae8c3d04c0cf41022fde630c465939_gammap_ThYV</span></span>
<span><span class="co">#&gt; #define phi _rxae993ae8c3d04c0cf41022fde630c465940_phi_Vap7</span></span>
<span><span class="co">#&gt; #define d2ELUa _rxae993ae8c3d04c0cf41022fde630c465941_d2ELUa_I2Q3</span></span>
<span><span class="co">#&gt; #define dELUa _rxae993ae8c3d04c0cf41022fde630c465942_dELUa_QRiT</span></span>
<span><span class="co">#&gt; #define d2aELU _rxae993ae8c3d04c0cf41022fde630c465943_d2aELU_hYGc</span></span>
<span><span class="co">#&gt; #define d2ELU _rxae993ae8c3d04c0cf41022fde630c465944_d2ELU_OtBh</span></span>
<span><span class="co">#&gt; #define dELU _rxae993ae8c3d04c0cf41022fde630c465945_dELU_UZs4</span></span>
<span><span class="co">#&gt; #define ELU _rxae993ae8c3d04c0cf41022fde630c465946_ELU_Bug3</span></span>
<span><span class="co">#&gt; #define dPReLUa1 _rxae993ae8c3d04c0cf41022fde630c465947_dPReLUa1_jNvl</span></span>
<span><span class="co">#&gt; #define dPReLUa _rxae993ae8c3d04c0cf41022fde630c465948_dPReLUa_tpwF</span></span>
<span><span class="co">#&gt; #define dPReLU _rxae993ae8c3d04c0cf41022fde630c465949_dPReLU_TEKN</span></span>
<span><span class="co">#&gt; #define PReLU _rxae993ae8c3d04c0cf41022fde630c465950_PReLU_evez</span></span>
<span><span class="co">#&gt; #define dSwish _rxae993ae8c3d04c0cf41022fde630c465951_dSwish_NqFT</span></span>
<span><span class="co">#&gt; #define Swish _rxae993ae8c3d04c0cf41022fde630c465952_Swish_9gM9</span></span>
<span><span class="co">#&gt; #define dlReLU _rxae993ae8c3d04c0cf41022fde630c465953_dlReLU_rEsT</span></span>
<span><span class="co">#&gt; #define lReLU _rxae993ae8c3d04c0cf41022fde630c465954_lReLU_GC4c</span></span>
<span><span class="co">#&gt; #define dSELU _rxae993ae8c3d04c0cf41022fde630c465955_dSELU_Cyu5</span></span>
<span><span class="co">#&gt; #define SELU _rxae993ae8c3d04c0cf41022fde630c465956_SELU_bvZO</span></span>
<span><span class="co">#&gt; #define d4softplus _rxae993ae8c3d04c0cf41022fde630c465957_d4softplus_u1um</span></span>
<span><span class="co">#&gt; #define d3softplus _rxae993ae8c3d04c0cf41022fde630c465958_d3softplus_gIZZ</span></span>
<span><span class="co">#&gt; #define d2softplus _rxae993ae8c3d04c0cf41022fde630c465959_d2softplus_QERR</span></span>
<span><span class="co">#&gt; #define dsoftplus _rxae993ae8c3d04c0cf41022fde630c465960_dsoftplus_IiDL</span></span>
<span><span class="co">#&gt; #define softplus _rxae993ae8c3d04c0cf41022fde630c465961_softplus_NWVG</span></span>
<span><span class="co">#&gt; #define d4GELU _rxae993ae8c3d04c0cf41022fde630c465962_d4GELU_2pp1</span></span>
<span><span class="co">#&gt; #define d3GELU _rxae993ae8c3d04c0cf41022fde630c465963_d3GELU_40pW</span></span>
<span><span class="co">#&gt; #define d2GELU _rxae993ae8c3d04c0cf41022fde630c465964_d2GELU_6jXh</span></span>
<span><span class="co">#&gt; #define dGELU _rxae993ae8c3d04c0cf41022fde630c465965_dGELU_QemV</span></span>
<span><span class="co">#&gt; #define GELU _rxae993ae8c3d04c0cf41022fde630c465966_GELU_NKc5</span></span>
<span><span class="co">#&gt; #define dReLU _rxae993ae8c3d04c0cf41022fde630c465967_dReLU_lUKq</span></span>
<span><span class="co">#&gt; #define ReLU _rxae993ae8c3d04c0cf41022fde630c465968_ReLU_1UQZ</span></span>
<span><span class="co">#&gt; #define riweibull _rxae993ae8c3d04c0cf41022fde630c465969_riweibull_ih1A</span></span>
<span><span class="co">#&gt; #define riunif _rxae993ae8c3d04c0cf41022fde630c465970_riunif_kbqa</span></span>
<span><span class="co">#&gt; #define rit_ _rxae993ae8c3d04c0cf41022fde630c465971_rit__4Jgt</span></span>
<span><span class="co">#&gt; #define ripois _rxae993ae8c3d04c0cf41022fde630c465972_ripois_9oJE</span></span>
<span><span class="co">#&gt; #define ribeta _rxae993ae8c3d04c0cf41022fde630c465973_ribeta_YZYM</span></span>
<span><span class="co">#&gt; #define rigamma _rxae993ae8c3d04c0cf41022fde630c465974_rigamma_LHvv</span></span>
<span><span class="co">#&gt; #define rigeom _rxae993ae8c3d04c0cf41022fde630c465975_rigeom_UYye</span></span>
<span><span class="co">#&gt; #define rif _rxae993ae8c3d04c0cf41022fde630c465976_rif_qicv</span></span>
<span><span class="co">#&gt; #define riexp _rxae993ae8c3d04c0cf41022fde630c465977_riexp_5IXw</span></span>
<span><span class="co">#&gt; #define richisq _rxae993ae8c3d04c0cf41022fde630c465978_richisq_MIWm</span></span>
<span><span class="co">#&gt; #define ricauchy _rxae993ae8c3d04c0cf41022fde630c465979_ricauchy_ckHg</span></span>
<span><span class="co">#&gt; #define rinbinomMu _rxae993ae8c3d04c0cf41022fde630c465980_rinbinomMu_7aIc</span></span>
<span><span class="co">#&gt; #define rinbinom _rxae993ae8c3d04c0cf41022fde630c465981_rinbinom_WWEb</span></span>
<span><span class="co">#&gt; #define ribinom _rxae993ae8c3d04c0cf41022fde630c465982_ribinom_c7Rt</span></span>
<span><span class="co">#&gt; #define rinorm _rxae993ae8c3d04c0cf41022fde630c465983_rinorm_IOdx</span></span>
<span><span class="co">#&gt; #define rxweibull _rxae993ae8c3d04c0cf41022fde630c465984_rxweibull_KonO</span></span>
<span><span class="co">#&gt; #define rxunif _rxae993ae8c3d04c0cf41022fde630c465985_rxunif_ZSpn</span></span>
<span><span class="co">#&gt; #define rxt_ _rxae993ae8c3d04c0cf41022fde630c465986_rxt__2tUN</span></span>
<span><span class="co">#&gt; #define rxpois _rxae993ae8c3d04c0cf41022fde630c465987_rxpois_yS1A</span></span>
<span><span class="co">#&gt; #define rxbeta _rxae993ae8c3d04c0cf41022fde630c465988_rxbeta_V69I</span></span>
<span><span class="co">#&gt; #define rxgamma _rxae993ae8c3d04c0cf41022fde630c465989_rxgamma_tVXi</span></span>
<span><span class="co">#&gt; #define rxgeom _rxae993ae8c3d04c0cf41022fde630c465990_rxgeom_iMr4</span></span>
<span><span class="co">#&gt; #define rxf _rxae993ae8c3d04c0cf41022fde630c465991_rxf_y2iV</span></span>
<span><span class="co">#&gt; #define rxexp _rxae993ae8c3d04c0cf41022fde630c465992_rxexp_dNeb</span></span>
<span><span class="co">#&gt; #define rxchisq _rxae993ae8c3d04c0cf41022fde630c465993_rxchisq_W9TL</span></span>
<span><span class="co">#&gt; #define rxcauchy _rxae993ae8c3d04c0cf41022fde630c465994_rxcauchy_6tvw</span></span>
<span><span class="co">#&gt; #define rxnbinomMu _rxae993ae8c3d04c0cf41022fde630c465995_rxnbinomMu_hnLN</span></span>
<span><span class="co">#&gt; #define rxnbinom _rxae993ae8c3d04c0cf41022fde630c465996_rxnbinom_SPAZ</span></span>
<span><span class="co">#&gt; #define rxbinom _rxae993ae8c3d04c0cf41022fde630c465997_rxbinom_VAut</span></span>
<span><span class="co">#&gt; #define rxnorm _rxae993ae8c3d04c0cf41022fde630c465998_rxnorm_E606</span></span>
<span><span class="co">#&gt; #define linCmtB _rxae993ae8c3d04c0cf41022fde630c465999_linCmtB_df0H</span></span>
<span><span class="co">#&gt; #define linCmtA _rxae993ae8c3d04c0cf41022fde630c4651000_linCmtA_2jGg</span></span>
<span><span class="co">#&gt; #include &lt;rxode2_model_shared.h&gt;</span></span>
<span><span class="co">#&gt; #define __MAX_PROD__ 0</span></span>
<span><span class="co">#&gt; #define _CMT CMT</span></span>
<span><span class="co">#&gt; #define _SYNC_simeps_ for (int _svari=_solveData-&gt;neps; _svari--;){  if (_solveData-&gt;svar[_svari] == 0) {KA = _PP[0];};   if (_solveData-&gt;svar[_svari] == 1) {CL = _PP[1];};   if (_solveData-&gt;svar[_svari] == 2) {V = _PP[2];}; }</span></span>
<span><span class="co">#&gt; #define _SYNC_simeta_ for (int _ovari=_solveData-&gt;neta; _ovari--;){  if (_solveData-&gt;ovar[_ovari] == 0) {KA = _PP[0];};   if (_solveData-&gt;ovar[_ovari] == 1) {CL = _PP[1];};   if (_solveData-&gt;ovar[_ovari] == 2) {V = _PP[2];}; }</span></span>
<span><span class="co">#&gt; _getRxSolve_t _getRxSolve_;</span></span>
<span><span class="co">#&gt; _simfun simeps;</span></span>
<span><span class="co">#&gt; _simfun simeta;</span></span>
<span><span class="co">#&gt; _udf_type _evalUdf=NULL;</span></span>
<span><span class="co">#&gt; rx_solve *_solveData=NULL;</span></span>
<span><span class="co">#&gt; rxode2_assign_ptr _assign_ptr=NULL;</span></span>
<span><span class="co">#&gt; _rxRmModelLibType _rxRmModelLib=NULL;</span></span>
<span><span class="co">#&gt; _rxGetModelLibType _rxGetModelLib=NULL;</span></span>
<span><span class="co">#&gt; rxode2_ode_solver_old_c _old_c=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _ptrid=NULL;</span></span>
<span><span class="co">#&gt; _rxIsCurrentC_type _rxIsCurrentC=NULL;</span></span>
<span><span class="co">#&gt; _rxSumType _sumPS=NULL;</span></span>
<span><span class="co">#&gt; _rxProdType _prodPS=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _prodType=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _sumType=NULL;</span></span>
<span><span class="co">#&gt; _update_par_ptr_p _update_par_ptr=NULL;</span></span>
<span><span class="co">#&gt; _getParCov_p _getParCov=NULL;</span></span>
<span><span class="co">#&gt; linCmtA_p linCmtA;</span></span>
<span><span class="co">#&gt; linCmtB_p linCmtB;</span></span>
<span><span class="co">#&gt; _rx_asgn _rxode2_rxAssignPtr=NULL;</span></span>
<span><span class="co">#&gt; _rx_asgn _rxQr=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn phi;</span></span>
<span><span class="co">#&gt; rxode2_fn ReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn dReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn dGELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d2GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d3GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d4GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn dsoftplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d2softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d3softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d4softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn SELU;</span></span>
<span><span class="co">#&gt; rxode2_fn dSELU;</span></span>
<span><span class="co">#&gt; rxode2_fn lReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn dlReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn Swish;</span></span>
<span><span class="co">#&gt; rxode2_fn dSwish;</span></span>
<span><span class="co">#&gt; rxode2_fn2 PReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLUa;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLUa1;</span></span>
<span><span class="co">#&gt; rxode2_fn2 ELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2ELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2aELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dELUa;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2ELUa;</span></span>
<span><span class="co">#&gt; rxode2_fn3 logit;</span></span>
<span><span class="co">#&gt; rxode2_fn3 expit;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammap;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaq;</span></span>
<span><span class="co">#&gt; rxode2_fn2 lowergamma;</span></span>
<span><span class="co">#&gt; rxode2_fn2 uppergamma;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapInv;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapDer;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapInva;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaqInv;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaqInva;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxnorm;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxbinom;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxnbinom;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxnbinomMu;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxcauchy;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxchisq;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxexp;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxf;</span></span>
<span><span class="co">#&gt; rxode2i_ifn rxgeom;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxgamma;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxbeta;</span></span>
<span><span class="co">#&gt; rxode2i_ifn rxpois;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxt_;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxunif;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxweibull;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rinorm;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom ribinom;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom rinbinom;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom rinbinomMu;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 ricauchy;</span></span>
<span><span class="co">#&gt; rxode2i2_fn richisq;</span></span>
<span><span class="co">#&gt; rxode2i2_fn riexp;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rif;</span></span>
<span><span class="co">#&gt; rxode2i2_ifn rigeom;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rigamma;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 ribeta;</span></span>
<span><span class="co">#&gt; rxode2i2_ifn ripois;</span></span>
<span><span class="co">#&gt; rxode2i2_fn rit_;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 riunif;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 riweibull;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNorm;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNormDmean;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNormDsd;</span></span>
<span><span class="co">#&gt; rxode2_llikPoisFun _llikPois;</span></span>
<span><span class="co">#&gt; rxode2_llikPoisFun _llikPoisDlambda;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikBinom;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikBinomDprob;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinom;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomDprob;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomMu;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomMuDmu;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBeta;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBetaDshape1;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBetaDshape2;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikT;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDdf;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDmean;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDsd;</span></span>
<span><span class="co">#&gt; rxode2_llikChisqFun _llikChisq;</span></span>
<span><span class="co">#&gt; rxode2_llikChisqFun _llikChisqDdf;</span></span>
<span><span class="co">#&gt; rxode2_llikExpFun _llikExp;</span></span>
<span><span class="co">#&gt; rxode2_llikExpFun _llikExpDrate;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikF;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikFDdf1;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikFDdf2;</span></span>
<span><span class="co">#&gt; rxode2_llikGeomFun _llikGeom;</span></span>
<span><span class="co">#&gt; rxode2_llikGeomFun _llikGeomDp;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnif;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnifDalpha;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnifDbeta;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibull;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibullDshape;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibullDscale;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGamma;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGammaDshape;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGammaDrate;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchy;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchyDlocation;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchyDscale;</span></span>
<span><span class="co">#&gt; rxode2_compareFactorVal_fn _compareFactorVal;</span></span>
<span><span class="co">#&gt; #include "extraC.h"</span></span>
<span><span class="co">#&gt; double _prod(double *input, double *p, int type, int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return _prodPS(input, p, n, type);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _udf(const char *funName, double *input, int n, ...) {</span></span>
<span><span class="co">#&gt;   if (n == -42) Rf_error("%s", "this has a ui user function that cannot be called directly");</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return _evalUdf(funName, n, input);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _sum(double *input, double *pld, int m, int type, int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   double ret = _sumPS(input, n, pld, m, type);</span></span>
<span><span class="co">#&gt;   if (type == 2 &amp;&amp; m &lt; 0){</span></span>
<span><span class="co">#&gt;     for (int i = -m; i--;){</span></span>
<span><span class="co">#&gt;       pld[i] = 0.0;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return ret;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _sign(unsigned int n, ...) {</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double s = 1;</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;     s = sign(va_arg(valist, double))*s;</span></span>
<span><span class="co">#&gt;     if (s == 0){</span></span>
<span><span class="co">#&gt;       break;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return s;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _rxord(int _cSub, unsigned int n,  ...) {</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind* ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   if (!ind-&gt;inLhs) {</span></span>
<span><span class="co">#&gt;     return 1.0;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double ret = 1.0;</span></span>
<span><span class="co">#&gt;   double p = 0.0;</span></span>
<span><span class="co">#&gt;   double u = rxunif(ind, 0.0, 1.0);</span></span>
<span><span class="co">#&gt;   int found = 0;</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;     p += va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     if (!found) {</span></span>
<span><span class="co">#&gt;       if (u &lt; p) {</span></span>
<span><span class="co">#&gt;         ret = (double)(i+1);</span></span>
<span><span class="co">#&gt;         found = 1;</span></span>
<span><span class="co">#&gt;       }</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   if (!found) ret =(double)(n+1);</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return ret;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _max(unsigned int n, ...) {</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double mx = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tmp = 0;</span></span>
<span><span class="co">#&gt;   if (n &gt;= 1){</span></span>
<span><span class="co">#&gt;     mx = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     for (unsigned int i = 1; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;       tmp = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;       if (tmp&gt;mx) mx=tmp;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     va_end(valist);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return mx;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _min(unsigned int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double mn = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tmp = 0;</span></span>
<span><span class="co">#&gt;   if (n &gt;= 1){</span></span>
<span><span class="co">#&gt;     mn = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     for (unsigned int i = 1; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;       tmp = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;       if (tmp&lt;mn) mn=tmp;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     va_end(valist);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return mn;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _transit4P(int cmt, double t, unsigned int id, double n, double mtt, double bio){</span></span>
<span><span class="co">#&gt;   double nd = (double) n;</span></span>
<span><span class="co">#&gt;   double ktr = (nd+1)/mtt;</span></span>
<span><span class="co">#&gt;   double lktr = _safe_log(nd+1)-_safe_log(mtt);</span></span>
<span><span class="co">#&gt;   double tlast = _solveData-&gt;subjects[id].tlastS[cmt];</span></span>
<span><span class="co">#&gt;   double dose = _solveData-&gt;subjects[id].curDoseS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(dose)) dose = 0.0;</span></span>
<span><span class="co">#&gt;   if (ISNA(tlast)) tlast = 0.0;</span></span>
<span><span class="co">#&gt;   double tad = (t-tlast);</span></span>
<span><span class="co">#&gt;   return exp(_safe_log(bio*dose)+lktr+n*(lktr+_safe_log(tad))-ktr*(tad)-lgamma1p(nd));</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _transit3P(int cmt, double t, unsigned int id, double n, double mtt){</span></span>
<span><span class="co">#&gt;   double nd = (double) n;</span></span>
<span><span class="co">#&gt;   double ktr = (nd+1)/mtt;</span></span>
<span><span class="co">#&gt;   double lktr = _safe_log(nd+1)-_safe_log(mtt);</span></span>
<span><span class="co">#&gt;   double tlast = _solveData-&gt;subjects[id].tlastS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(tlast)) tlast = 0.0;</span></span>
<span><span class="co">#&gt;   double tad = t-tlast;</span></span>
<span><span class="co">#&gt;   double podo = _solveData-&gt;subjects[id].curDoseS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(podo)) podo = 0.0;</span></span>
<span><span class="co">#&gt;   return exp(_safe_log(podo)+lktr+n*(lktr+_safe_log(tad))-ktr*(tad)-lgamma1p(nd));</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void _assignFuns0(void) {</span></span>
<span><span class="co">#&gt;   _evalUdf = (_udf_type) R_GetCCallable("rxode2", "_rxode2_evalUdf");</span></span>
<span><span class="co">#&gt;   _getRxSolve_ = (_getRxSolve_t) R_GetCCallable("rxode2","getRxSolve_");</span></span>
<span><span class="co">#&gt;   _assign_ptr=(rxode2_assign_ptr) R_GetCCallable("rxode2","rxode2_assign_fn_pointers");</span></span>
<span><span class="co">#&gt;   _rxRmModelLib=(_rxRmModelLibType) R_GetCCallable("rxode2","rxRmModelLib");</span></span>
<span><span class="co">#&gt;   _rxGetModelLib=(_rxGetModelLibType) R_GetCCallable("rxode2","rxGetModelLib");</span></span>
<span><span class="co">#&gt;   _rxode2_rxAssignPtr=(_rx_asgn)R_GetCCallable("rxode2","_rxode2_rxAssignPtr");</span></span>
<span><span class="co">#&gt;   _rxQr=(_rx_asgn)R_GetCCallable("rxode2","_rxode2_rxQr");</span></span>
<span><span class="co">#&gt;   _rxIsCurrentC = (_rxIsCurrentC_type)R_GetCCallable("rxode2","rxIsCurrentC");</span></span>
<span><span class="co">#&gt;   _sumPS  = (_rxSumType) R_GetCCallable("PreciseSums","PreciseSums_sum_r");</span></span>
<span><span class="co">#&gt;   _prodPS = (_rxProdType) R_GetCCallable("PreciseSums","PreciseSums_prod_r");</span></span>
<span><span class="co">#&gt;   _prodType=(rxode2_fn0i)R_GetCCallable("PreciseSums", "PreciseSums_prod_get");</span></span>
<span><span class="co">#&gt;   _sumType=(rxode2_fn0i)R_GetCCallable("PreciseSums", "PreciseSums_sum_get");</span></span>
<span><span class="co">#&gt;   _ptrid=(rxode2_fn0i)R_GetCCallable("rxode2", "rxode2_current_fn_pointer_id");</span></span>
<span><span class="co">#&gt;   _compareFactorVal=(rxode2_compareFactorVal_fn) R_GetCCallable("rxode2", "compareFactorVal");</span></span>
<span><span class="co">#&gt;   _update_par_ptr = (_update_par_ptr_p) R_GetCCallable("rxode2","_update_par_ptr");</span></span>
<span><span class="co">#&gt;   _getParCov = (_getParCov_p) R_GetCCallable("rxode2","_getParCov");</span></span>
<span><span class="co">#&gt;   // dynamic start</span></span>
<span><span class="co">#&gt;   _llikCauchyDscale = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchyDscale");</span></span>
<span><span class="co">#&gt;   _llikCauchyDlocation = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchyDlocation");</span></span>
<span><span class="co">#&gt;   _llikCauchy = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchy");</span></span>
<span><span class="co">#&gt;   _llikGammaDrate = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGammaDrate");</span></span>
<span><span class="co">#&gt;   _llikGammaDshape = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGammaDshape");</span></span>
<span><span class="co">#&gt;   _llikGamma = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGamma");</span></span>
<span><span class="co">#&gt;   _llikWeibullDscale = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibullDscale");</span></span>
<span><span class="co">#&gt;   _llikWeibullDshape = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibullDshape");</span></span>
<span><span class="co">#&gt;   _llikWeibull = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibull");</span></span>
<span><span class="co">#&gt;   _llikUnifDbeta = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnifDbeta");</span></span>
<span><span class="co">#&gt;   _llikUnifDalpha = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnifDalpha");</span></span>
<span><span class="co">#&gt;   _llikUnif = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnif");</span></span>
<span><span class="co">#&gt;   _llikGeomDp = (rxode2_llikGeomFun) R_GetCCallable("rxode2ll", "rxLlikGeomDp");</span></span>
<span><span class="co">#&gt;   _llikGeom = (rxode2_llikGeomFun) R_GetCCallable("rxode2ll", "rxLlikGeom");</span></span>
<span><span class="co">#&gt;   _llikFDdf2 = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikFDdf2");</span></span>
<span><span class="co">#&gt;   _llikFDdf1 = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikFDdf1");</span></span>
<span><span class="co">#&gt;   _llikF = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikF");</span></span>
<span><span class="co">#&gt;   _llikExpDrate = (rxode2_llikExpFun) R_GetCCallable("rxode2ll", "rxLlikExpDrate");</span></span>
<span><span class="co">#&gt;   _llikExp = (rxode2_llikExpFun) R_GetCCallable("rxode2ll", "rxLlikExp");</span></span>
<span><span class="co">#&gt;   _llikChisqDdf = (rxode2_llikChisqFun) R_GetCCallable("rxode2ll", "rxLlikChisqDdf");</span></span>
<span><span class="co">#&gt;   _llikChisq = (rxode2_llikChisqFun) R_GetCCallable("rxode2ll", "rxLlikChisq");</span></span>
<span><span class="co">#&gt;   _llikTDsd = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDsd");</span></span>
<span><span class="co">#&gt;   _llikTDmean = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDmean");</span></span>
<span><span class="co">#&gt;   _llikTDdf = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDdf");</span></span>
<span><span class="co">#&gt;   _llikT = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikT");</span></span>
<span><span class="co">#&gt;   _llikBetaDshape2 = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBetaDshape2");</span></span>
<span><span class="co">#&gt;   _llikBetaDshape1 = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBetaDshape1");</span></span>
<span><span class="co">#&gt;   _llikBeta = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBeta");</span></span>
<span><span class="co">#&gt;   _llikNbinomMuDmu = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomMuDmu");</span></span>
<span><span class="co">#&gt;   _llikNbinomMu = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomMu");</span></span>
<span><span class="co">#&gt;   _llikNbinomDprob = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomDprob");</span></span>
<span><span class="co">#&gt;   _llikNbinom = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinom");</span></span>
<span><span class="co">#&gt;   _llikBinomDprob = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikBinomDprob");</span></span>
<span><span class="co">#&gt;   _llikBinom = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikBinom");</span></span>
<span><span class="co">#&gt;   _llikPoisDlambda = (rxode2_llikPoisFun) R_GetCCallable("rxode2ll", "rxLlikPoisDlambda");</span></span>
<span><span class="co">#&gt;   _llikPois = (rxode2_llikPoisFun) R_GetCCallable("rxode2ll", "rxLlikPois");</span></span>
<span><span class="co">#&gt;   _llikNormDsd = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNormDsd");</span></span>
<span><span class="co">#&gt;   _llikNormDmean = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNormDmean");</span></span>
<span><span class="co">#&gt;   _llikNorm = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNorm");</span></span>
<span><span class="co">#&gt;   simeps = (_simfun) R_GetCCallable("rxode2", "simeps");</span></span>
<span><span class="co">#&gt;   simeta = (_simfun) R_GetCCallable("rxode2", "simeta");</span></span>
<span><span class="co">#&gt;   expit = (rxode2_fn3) R_GetCCallable("rxode2", "expit");</span></span>
<span><span class="co">#&gt;   logit = (rxode2_fn3) R_GetCCallable("rxode2", "logit");</span></span>
<span><span class="co">#&gt;   gammapDer = (rxode2_fn2) R_GetCCallable("rxode2", "gammapDer");</span></span>
<span><span class="co">#&gt;   lowergamma = (rxode2_fn2) R_GetCCallable("rxode2", "lowergamma");</span></span>
<span><span class="co">#&gt;   uppergamma = (rxode2_fn2) R_GetCCallable("rxode2", "uppergamma");</span></span>
<span><span class="co">#&gt;   gammaqInva = (rxode2_fn2) R_GetCCallable("rxode2", "gammaqInva");</span></span>
<span><span class="co">#&gt;   gammaqInv = (rxode2_fn2) R_GetCCallable("rxode2", "gammaqInv");</span></span>
<span><span class="co">#&gt;   gammapInva = (rxode2_fn2) R_GetCCallable("rxode2", "gammapInva");</span></span>
<span><span class="co">#&gt;   gammapInv = (rxode2_fn2) R_GetCCallable("rxode2", "gammapInv");</span></span>
<span><span class="co">#&gt;   gammaq = (rxode2_fn2) R_GetCCallable("rxode2", "gammaq");</span></span>
<span><span class="co">#&gt;   gammap = (rxode2_fn2) R_GetCCallable("rxode2", "gammap");</span></span>
<span><span class="co">#&gt;   phi = (rxode2_fn) R_GetCCallable("rxode2", "phi");</span></span>
<span><span class="co">#&gt;   d2ELUa = (rxode2_fn2) R_GetCCallable("rxode2", "d2ELUa");</span></span>
<span><span class="co">#&gt;   dELUa = (rxode2_fn2) R_GetCCallable("rxode2", "dELUa");</span></span>
<span><span class="co">#&gt;   d2aELU = (rxode2_fn2) R_GetCCallable("rxode2", "d2aELU");</span></span>
<span><span class="co">#&gt;   d2ELU = (rxode2_fn2) R_GetCCallable("rxode2", "d2ELU");</span></span>
<span><span class="co">#&gt;   dELU = (rxode2_fn2) R_GetCCallable("rxode2", "dELU");</span></span>
<span><span class="co">#&gt;   ELU = (rxode2_fn2) R_GetCCallable("rxode2", "ELU");</span></span>
<span><span class="co">#&gt;   dPReLUa1 = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLUa1");</span></span>
<span><span class="co">#&gt;   dPReLUa = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLUa");</span></span>
<span><span class="co">#&gt;   dPReLU = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLU");</span></span>
<span><span class="co">#&gt;   PReLU = (rxode2_fn2) R_GetCCallable("rxode2", "PReLU");</span></span>
<span><span class="co">#&gt;   dSwish = (rxode2_fn) R_GetCCallable("rxode2", "dSwish");</span></span>
<span><span class="co">#&gt;   Swish = (rxode2_fn) R_GetCCallable("rxode2", "Swish");</span></span>
<span><span class="co">#&gt;   dlReLU = (rxode2_fn) R_GetCCallable("rxode2", "dlReLU");</span></span>
<span><span class="co">#&gt;   lReLU = (rxode2_fn) R_GetCCallable("rxode2", "lReLU");</span></span>
<span><span class="co">#&gt;   dSELU = (rxode2_fn) R_GetCCallable("rxode2", "dSELU");</span></span>
<span><span class="co">#&gt;   SELU = (rxode2_fn) R_GetCCallable("rxode2", "SELU");</span></span>
<span><span class="co">#&gt;   d4softplus = (rxode2_fn) R_GetCCallable("rxode2", "d4softplus");</span></span>
<span><span class="co">#&gt;   d3softplus = (rxode2_fn) R_GetCCallable("rxode2", "d3softplus");</span></span>
<span><span class="co">#&gt;   d2softplus = (rxode2_fn) R_GetCCallable("rxode2", "d2softplus");</span></span>
<span><span class="co">#&gt;   dsoftplus = (rxode2_fn) R_GetCCallable("rxode2", "dsoftplus");</span></span>
<span><span class="co">#&gt;   softplus = (rxode2_fn) R_GetCCallable("rxode2", "softplus");</span></span>
<span><span class="co">#&gt;   d4GELU = (rxode2_fn) R_GetCCallable("rxode2", "d4GELU");</span></span>
<span><span class="co">#&gt;   d3GELU = (rxode2_fn) R_GetCCallable("rxode2", "d3GELU");</span></span>
<span><span class="co">#&gt;   d2GELU = (rxode2_fn) R_GetCCallable("rxode2", "d2GELU");</span></span>
<span><span class="co">#&gt;   dGELU = (rxode2_fn) R_GetCCallable("rxode2", "dGELU");</span></span>
<span><span class="co">#&gt;   GELU = (rxode2_fn) R_GetCCallable("rxode2", "GELU");</span></span>
<span><span class="co">#&gt;   dReLU = (rxode2_fn) R_GetCCallable("rxode2", "dReLU");</span></span>
<span><span class="co">#&gt;   ReLU = (rxode2_fn) R_GetCCallable("rxode2", "ReLU");</span></span>
<span><span class="co">#&gt;   riweibull = (rxode2i2_fn2) R_GetCCallable("rxode2", "riweibull");</span></span>
<span><span class="co">#&gt;   riunif = (rxode2i2_fn2) R_GetCCallable("rxode2", "riunif");</span></span>
<span><span class="co">#&gt;   rit_ = (rxode2i2_fn) R_GetCCallable("rxode2", "rit_");</span></span>
<span><span class="co">#&gt;   ripois = (rxode2i2_ifn) R_GetCCallable("rxode2", "ripois");</span></span>
<span><span class="co">#&gt;   ribeta = (rxode2i2_fn2) R_GetCCallable("rxode2", "ribeta");</span></span>
<span><span class="co">#&gt;   rigamma = (rxode2i2_fn2) R_GetCCallable("rxode2", "rigamma");</span></span>
<span><span class="co">#&gt;   rigeom = (rxode2i2_ifn) R_GetCCallable("rxode2", "rigeom");</span></span>
<span><span class="co">#&gt;   rif = (rxode2i2_fn2) R_GetCCallable("rxode2", "rif");</span></span>
<span><span class="co">#&gt;   riexp = (rxode2i2_fn) R_GetCCallable("rxode2", "riexp");</span></span>
<span><span class="co">#&gt;   richisq = (rxode2i2_fn) R_GetCCallable("rxode2", "richisq");</span></span>
<span><span class="co">#&gt;   ricauchy = (rxode2i2_fn2) R_GetCCallable("rxode2", "ricauchy");</span></span>
<span><span class="co">#&gt;   rinbinomMu = (rxode2i2_ribinom) R_GetCCallable("rxode2", "rinbinomMu");</span></span>
<span><span class="co">#&gt;   rinbinom = (rxode2i2_ribinom) R_GetCCallable("rxode2", "rinbinom");</span></span>
<span><span class="co">#&gt;   ribinom = (rxode2i2_ribinom) R_GetCCallable("rxode2", "ribinom");</span></span>
<span><span class="co">#&gt;   rinorm = (rxode2i2_fn2) R_GetCCallable("rxode2", "rinorm");</span></span>
<span><span class="co">#&gt;   rxweibull = (rxode2i_fn2) R_GetCCallable("rxode2", "rxweibull");</span></span>
<span><span class="co">#&gt;   rxunif = (rxode2i_fn2) R_GetCCallable("rxode2", "rxunif");</span></span>
<span><span class="co">#&gt;   rxt_ = (rxode2i_fn) R_GetCCallable("rxode2", "rxt_");</span></span>
<span><span class="co">#&gt;   rxpois = (rxode2i_ifn) R_GetCCallable("rxode2", "rxpois");</span></span>
<span><span class="co">#&gt;   rxbeta = (rxode2i_fn2) R_GetCCallable("rxode2", "rxbeta");</span></span>
<span><span class="co">#&gt;   rxgamma = (rxode2i_fn2) R_GetCCallable("rxode2", "rxgamma");</span></span>
<span><span class="co">#&gt;   rxgeom = (rxode2i_ifn) R_GetCCallable("rxode2", "rxgeom");</span></span>
<span><span class="co">#&gt;   rxf = (rxode2i_fn2) R_GetCCallable("rxode2", "rxf");</span></span>
<span><span class="co">#&gt;   rxexp = (rxode2i_fn) R_GetCCallable("rxode2", "rxexp");</span></span>
<span><span class="co">#&gt;   rxchisq = (rxode2i_fn) R_GetCCallable("rxode2", "rxchisq");</span></span>
<span><span class="co">#&gt;   rxcauchy = (rxode2i_fn2) R_GetCCallable("rxode2", "rxcauchy");</span></span>
<span><span class="co">#&gt;   rxnbinomMu = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxnbinomMu");</span></span>
<span><span class="co">#&gt;   rxnbinom = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxnbinom");</span></span>
<span><span class="co">#&gt;   rxbinom = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxbinom");</span></span>
<span><span class="co">#&gt;   rxnorm = (rxode2i_fn2) R_GetCCallable("rxode2", "rxnorm");</span></span>
<span><span class="co">#&gt;   linCmtB = (linCmtB_p) R_GetCCallable("rxode2", "linCmtB");</span></span>
<span><span class="co">#&gt;   linCmtA = (linCmtA_p) R_GetCCallable("rxode2", "linCmtA");</span></span>
<span><span class="co">#&gt;   // dynamic stop</span></span>
<span><span class="co">#&gt;   _solveData = _getRxSolve_();</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void _assignFuns(void) {</span></span>
<span><span class="co">#&gt;   if (_assign_ptr == NULL){</span></span>
<span><span class="co">#&gt;     _assignFuns0();</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void __assignFuns2(rx_solve rx,</span></span>
<span><span class="co">#&gt;                    rx_solving_options op,</span></span>
<span><span class="co">#&gt;                    t_F f,</span></span>
<span><span class="co">#&gt;                    t_LAG lag,</span></span>
<span><span class="co">#&gt;                    t_RATE rate,</span></span>
<span><span class="co">#&gt;                    t_DUR dur,</span></span>
<span><span class="co">#&gt;                    t_calc_mtime mtime,</span></span>
<span><span class="co">#&gt;                    t_ME me,</span></span>
<span><span class="co">#&gt;                    t_IndF indf,</span></span>
<span><span class="co">#&gt;                    t_getTime gettime,</span></span>
<span><span class="co">#&gt;                    t_locateTimeIndex timeindex,</span></span>
<span><span class="co">#&gt;                    t_handle_evidL handleEvid,</span></span>
<span><span class="co">#&gt;                    t_getDur getdur) {</span></span>
<span><span class="co">#&gt;   // assign start</span></span>
<span><span class="co">#&gt;     static rxode2_assignFuns2_t rxode2_assignFuns2 = NULL;</span></span>
<span><span class="co">#&gt;     if (rxode2_assignFuns2 == NULL) rxode2_assignFuns2 = (rxode2_assignFuns2_t)(R_GetCCallable("rxode2", "_rxode2_assignFuns2"));</span></span>
<span><span class="co">#&gt;     rxode2_assignFuns2(rx, op, f, lag, rate, dur, mtime, me, indf, gettime, timeindex, handleEvid, getdur);</span></span>
<span><span class="co">#&gt;   // assign stop</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void  rx_a3eeed02be9e472e5c95791e3344b303__ode_solver_solvedata (rx_solve *solve){</span></span>
<span><span class="co">#&gt;   _solveData = solve;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern rx_solve *rx_a3eeed02be9e472e5c95791e3344b303__ode_solver_get_solvedata(void){</span></span>
<span><span class="co">#&gt;   return _solveData;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; SEXP rx_a3eeed02be9e472e5c95791e3344b303__model_vars(void);</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; // prj-specific differential eqns</span></span>
<span><span class="co">#&gt; void rx_a3eeed02be9e472e5c95791e3344b303__dydt(int *_neq, double __t, double *__zzStateVar__, double *__DDtStateVar__)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   int _cSub = _neq[1];</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_neq[1]].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=1;</span></span>
<span><span class="co">#&gt;   double _rxNotFun_abs = NA_REAL;</span></span>
<span><span class="co">#&gt;   double KA = NA_REAL;</span></span>
<span><span class="co">#&gt;   double centr = NA_REAL;</span></span>
<span><span class="co">#&gt;   double CL = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C2 = NA_REAL;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   (void)_rxNotFun_abs;</span></span>
<span><span class="co">#&gt;   (void)KA;</span></span>
<span><span class="co">#&gt;   (void)centr;</span></span>
<span><span class="co">#&gt;   (void)CL;</span></span>
<span><span class="co">#&gt;   (void)V;</span></span>
<span><span class="co">#&gt;   (void)C2;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   C2 = _PL[0];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _update_par_ptr(__t, _cSub, _solveData, _idx);</span></span>
<span><span class="co">#&gt;   KA = _PP[0];</span></span>
<span><span class="co">#&gt;   CL = _PP[1];</span></span>
<span><span class="co">#&gt;   V = _PP[2];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _rxNotFun_abs = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">#&gt;   centr = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT0__] = ((double)(_ON[__DDT0__]))*(_IR[__DDT0__] -KA*_rxNotFun_abs);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT1__] = ((double)(_ON[__DDT1__]))*(_IR[__DDT1__] + KA*_rxNotFun_abs-(CL/_div0(V))*centr);</span></span>
<span><span class="co">#&gt;   C2=centr/_div0(V);</span></span>
<span><span class="co">#&gt;   (&amp;_solveData-&gt;subjects[_cSub])-&gt;dadt_counter[0]++;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; // Jacobian derived vars</span></span>
<span><span class="co">#&gt; void rx_a3eeed02be9e472e5c95791e3344b303__calc_jac(int *_neq, double __t, double *__zzStateVar__, double *__PDStateVar__, unsigned int __NROWPD__) {</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;     int _cSub=_neq[1];</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_neq[1]].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=2;</span></span>
<span><span class="co">#&gt;   (&amp;_solveData-&gt;subjects[_cSub])-&gt;jac_counter[0]++;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Functional based initial conditions.</span></span>
<span><span class="co">#&gt; void rx_a3eeed02be9e472e5c95791e3344b303__inis(int _cSub, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;  _ind-&gt;_rxFlag=3;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // prj-specific derived vars</span></span>
<span><span class="co">#&gt; void rx_a3eeed02be9e472e5c95791e3344b303__calc_lhs(int _cSub, double __t, double *__zzStateVar__, double *_lhs) {</span></span>
<span><span class="co">#&gt;     int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=11;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_0__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_1__;</span></span>
<span><span class="co">#&gt;   double _rxNotFun_abs = NA_REAL;</span></span>
<span><span class="co">#&gt;   double KA = NA_REAL;</span></span>
<span><span class="co">#&gt;   double centr = NA_REAL;</span></span>
<span><span class="co">#&gt;   double CL = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C2 = NA_REAL;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_0__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_1__;</span></span>
<span><span class="co">#&gt;   (void)_rxNotFun_abs;</span></span>
<span><span class="co">#&gt;   (void)KA;</span></span>
<span><span class="co">#&gt;   (void)centr;</span></span>
<span><span class="co">#&gt;   (void)CL;</span></span>
<span><span class="co">#&gt;   (void)V;</span></span>
<span><span class="co">#&gt;   (void)C2;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   C2 = _PL[0];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _update_par_ptr(__t, _cSub, _solveData, _idx);</span></span>
<span><span class="co">#&gt;   KA = _PP[0];</span></span>
<span><span class="co">#&gt;   CL = _PP[1];</span></span>
<span><span class="co">#&gt;   V = _PP[2];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _rxNotFun_abs = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">#&gt;   centr = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   __DDtStateVar_0__ = ((double)(_ON[__DDT0__]))*(_IR[__DDT0__] -KA*_rxNotFun_abs);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_1__ = ((double)(_ON[__DDT1__]))*(_IR[__DDT1__] + KA*_rxNotFun_abs-(CL/_div0(V))*centr);</span></span>
<span><span class="co">#&gt;   C2=centr/_div0(V);</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _lhs[_LHS_0_]=C2;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Functional based bioavailability</span></span>
<span><span class="co">#&gt; double rx_a3eeed02be9e472e5c95791e3344b303__F(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return _amt;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; // Functional based absorption lag</span></span>
<span><span class="co">#&gt; double rx_a3eeed02be9e472e5c95791e3344b303__Lag(int _cSub,  int _cmt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return __t;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Modeled zero-order rate</span></span>
<span><span class="co">#&gt; double rx_a3eeed02be9e472e5c95791e3344b303__Rate(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return 0.0;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Modeled zero-order duration</span></span>
<span><span class="co">#&gt; double rx_a3eeed02be9e472e5c95791e3344b303__Dur(int _cSub,  int _cmt, double _amt, double __t){</span></span>
<span><span class="co">#&gt;  return 0.0;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Model Times</span></span>
<span><span class="co">#&gt; void rx_a3eeed02be9e472e5c95791e3344b303__mtime(int _cSub, double *_mtime){</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Matrix Exponential (0)</span></span>
<span><span class="co">#&gt; void rx_a3eeed02be9e472e5c95791e3344b303__ME(int _cSub, double _t, double __t, double *_mat, const double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=9;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Inductive linearization Matf</span></span>
<span><span class="co">#&gt; void rx_a3eeed02be9e472e5c95791e3344b303__IndF(int _cSub, double _t, double __t, double *_matf){</span></span>
<span><span class="co">#&gt;  int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=10;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern SEXP rx_a3eeed02be9e472e5c95791e3344b303__model_vars(void){</span></span>
<span><span class="co">#&gt;   int pro=0;</span></span>
<span><span class="co">#&gt;   SEXP _mv = PROTECT(_rxGetModelLib("rx_a3eeed02be9e472e5c95791e3344b303__model_vars"));pro++;</span></span>
<span><span class="co">#&gt;   if (!_rxIsCurrentC(_mv)){</span></span>
<span><span class="co">#&gt;     SEXP hash    = PROTECT(Rf_allocVector(STRSXP, 1));pro++;</span></span>
<span><span class="co">#&gt; #define __doBuf__  snprintf(buf, __doBufN__, "un]\"BAAA@QRtHACAAAAAAAXL4AAAv7#aT)~p7\?NAQ_a.gtjmYBaifxhYw/nz6*5t3p,(SV&lt;!Hd/p7whxPTnGh.B&amp;r{%%4o&amp;4;2[tW^~Q=6~Z^a#z^@P!BJ7ckEg(X&amp;aZLT\"aD*q0t2x0\?noV%%^[g=Glv*)Il[}\"#.$w\"aiOV^/P+U}NIq~(@*{(of^b1h=4y#Q~L$_KAV;d)BYP&gt;~Y,DBcjvaB*4&lt;{!8:4wi1sez%%jSq9\"2[PA[N&lt;Qi6N@n:G[r7op9{pm;sqt53D)nrpD]^SdFUIFM)):1,M{T!+RCvX&amp;RD=~0g@{ghOfbSvC5@Z$)/ny`EM~3pV7HI&lt;clOn.H[5A@#,ZhoHU|Voz[AwZoO5B}]C\?{u[*\"Z1ASJ]4EfE0eOw&lt;4\?JQf*%%&lt;4Ye\"x#RjcG!\":$w!;mQOA[w].873f`M*[GRNv&amp;M]MGyvWb&amp;YC7*6Fh/e!#Zz~N60q&lt;UN&gt;rzHCWO@kdYF_oK[`b|5AsP0AGUgK^K8},,aHQk=f}2WqQp|hzughT]|VGz%%9Yy!bCiV^fd8}j8XHEN&gt;oE@k9W31GQ/C.vSVy\?@Ohhk*sU6)1EJ`GyH~OghHlh09Q8~4qD1ek~6\?6&amp;$&gt;SES&lt;Me,\?kZLb\"&amp;\"\"C*E}[\"6{1\?F=xAZuLMjjkrFkPnEI@xv+T\?jnN+A/E{2jHU&gt;_sn:on_eFi~&amp;ld`+R@&gt;l\"|d{t&amp;o9\"5*&lt;uxaiG=YJerg0*^px#mx%%Qd+:kuJu/K1@9sULJ)rTw/6DB}_*4z_p$a@9_q_*l.(Dw~&amp;&amp;$j0#sqk^gY=Pf/19qG6&lt;1)mY&amp;]0Qo^C.qOv3O=uKgLU7hwp4\?+EYjN`c&lt;MhEOGnL`dt`PDd/SZvOpN3L$m!y!G;MHRMmAxFu`&gt;#lFhK~J}UJ/Q1.n+VkPbk_4Q9{+_FR+4M~aTK)QMu4H&gt;G(to)I`+h![*:X96%%x7[2uC(O|VHE8y(!GCZ6Si++QjU1yRf1j.@[$N*\"dRs|0%%26tmGA@:+Y%%]9~EXy9G%%S5LKR2SwqtDb/cTg7FL`|iAVNujU7_)IJ;)cYzRGLjfE3/8C9i]JQ%%%%\?KU/Jf7nYMgG&lt;,B*~G{9Hrge&lt;P|;`v&lt;]o&lt;]938O+{D#PfL(q8%%DZNuW58EyO/|I,@/OLPBWx;Z$N/6,R{D{nSd0(&amp;:KGD");</span></span>
<span><span class="co">#&gt;     char buf[1151];</span></span>
<span><span class="co">#&gt; #define __doBufN__ 1151</span></span>
<span><span class="co">#&gt;     __doBuf__</span></span>
<span><span class="co">#&gt; #undef __doBuf__</span></span>
<span><span class="co">#&gt; #undef __doBufN__</span></span>
<span><span class="co">#&gt;     SET_STRING_ELT(hash, 0, Rf_mkChar(buf));</span></span>
<span><span class="co">#&gt;     SEXP lst      = PROTECT(_rxQr(hash));pro++;</span></span>
<span><span class="co">#&gt;     _assign_ptr(lst);</span></span>
<span><span class="co">#&gt;     UNPROTECT(pro);</span></span>
<span><span class="co">#&gt;     return lst;</span></span>
<span><span class="co">#&gt;   } else {</span></span>
<span><span class="co">#&gt;     UNPROTECT(pro);</span></span>
<span><span class="co">#&gt;     return _mv;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void rx_a3eeed02be9e472e5c95791e3344b303__dydt_lsoda(int *neq, double *t, double *A, double *DADT)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   rx_a3eeed02be9e472e5c95791e3344b303__dydt(neq, *t, A, DADT);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern int rx_a3eeed02be9e472e5c95791e3344b303__dydt_liblsoda(double __t, double *y, double *ydot, void *data)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   int *neq = (int*)(data);</span></span>
<span><span class="co">#&gt;   rx_a3eeed02be9e472e5c95791e3344b303__dydt(neq, __t, y, ydot);</span></span>
<span><span class="co">#&gt;   return(0);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void rx_a3eeed02be9e472e5c95791e3344b303__calc_jac_lsoda(int *neq, double *t, double *A,int *ml, int *mu, double *JAC, int *nrowpd){</span></span>
<span><span class="co">#&gt;   // Update all covariate parameters</span></span>
<span><span class="co">#&gt;   rx_a3eeed02be9e472e5c95791e3344b303__calc_jac(neq, *t, A, JAC, *nrowpd);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; //Create function to call from R's main thread that assigns the required functions. Sometimes they don't get assigned.</span></span>
<span><span class="co">#&gt; extern void rx_a3eeed02be9e472e5c95791e3344b303__assignFuns(void){</span></span>
<span><span class="co">#&gt;   _assignFuns();</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; //Initialize the dll to match rxode2's calls</span></span>
<span><span class="co">#&gt; void R_init0_rx_a3eeed02be9e472e5c95791e3344b303_(void){</span></span>
<span><span class="co">#&gt;   // Get C callables on load; Otherwise it isn't thread safe</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_a3eeed02be9e472e5c95791e3344b303_","rx_a3eeed02be9e472e5c95791e3344b303__assignFuns2", (DL_FUNC) __assignFuns2);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_a3eeed02be9e472e5c95791e3344b303_","rx_a3eeed02be9e472e5c95791e3344b303__assignFuns", (DL_FUNC) rx_a3eeed02be9e472e5c95791e3344b303__assignFuns);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_a3eeed02be9e472e5c95791e3344b303_","rx_a3eeed02be9e472e5c95791e3344b303__inis",(DL_FUNC) rx_a3eeed02be9e472e5c95791e3344b303__inis);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_a3eeed02be9e472e5c95791e3344b303_","rx_a3eeed02be9e472e5c95791e3344b303__dydt",(DL_FUNC) rx_a3eeed02be9e472e5c95791e3344b303__dydt);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_a3eeed02be9e472e5c95791e3344b303_","rx_a3eeed02be9e472e5c95791e3344b303__calc_lhs",(DL_FUNC) rx_a3eeed02be9e472e5c95791e3344b303__calc_lhs);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_a3eeed02be9e472e5c95791e3344b303_","rx_a3eeed02be9e472e5c95791e3344b303__calc_jac",(DL_FUNC) rx_a3eeed02be9e472e5c95791e3344b303__calc_jac);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_a3eeed02be9e472e5c95791e3344b303_","rx_a3eeed02be9e472e5c95791e3344b303__dydt_lsoda", (DL_FUNC) rx_a3eeed02be9e472e5c95791e3344b303__dydt_lsoda);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_a3eeed02be9e472e5c95791e3344b303_","rx_a3eeed02be9e472e5c95791e3344b303__calc_jac_lsoda", (DL_FUNC) rx_a3eeed02be9e472e5c95791e3344b303__calc_jac_lsoda);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_a3eeed02be9e472e5c95791e3344b303_","rx_a3eeed02be9e472e5c95791e3344b303__ode_solver_solvedata", (DL_FUNC) rx_a3eeed02be9e472e5c95791e3344b303__ode_solver_solvedata);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_a3eeed02be9e472e5c95791e3344b303_","rx_a3eeed02be9e472e5c95791e3344b303__ode_solver_get_solvedata", (DL_FUNC) rx_a3eeed02be9e472e5c95791e3344b303__ode_solver_get_solvedata);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_a3eeed02be9e472e5c95791e3344b303_","rx_a3eeed02be9e472e5c95791e3344b303__F", (DL_FUNC) rx_a3eeed02be9e472e5c95791e3344b303__F);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_a3eeed02be9e472e5c95791e3344b303_","rx_a3eeed02be9e472e5c95791e3344b303__Lag", (DL_FUNC) rx_a3eeed02be9e472e5c95791e3344b303__Lag);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_a3eeed02be9e472e5c95791e3344b303_","rx_a3eeed02be9e472e5c95791e3344b303__Rate", (DL_FUNC) rx_a3eeed02be9e472e5c95791e3344b303__Rate);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_a3eeed02be9e472e5c95791e3344b303_","rx_a3eeed02be9e472e5c95791e3344b303__Dur", (DL_FUNC) rx_a3eeed02be9e472e5c95791e3344b303__Dur);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_a3eeed02be9e472e5c95791e3344b303_","rx_a3eeed02be9e472e5c95791e3344b303__mtime", (DL_FUNC) rx_a3eeed02be9e472e5c95791e3344b303__mtime);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_a3eeed02be9e472e5c95791e3344b303_","rx_a3eeed02be9e472e5c95791e3344b303__ME", (DL_FUNC) rx_a3eeed02be9e472e5c95791e3344b303__ME);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_a3eeed02be9e472e5c95791e3344b303_","rx_a3eeed02be9e472e5c95791e3344b303__IndF", (DL_FUNC) rx_a3eeed02be9e472e5c95791e3344b303__IndF);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_a3eeed02be9e472e5c95791e3344b303_","rx_a3eeed02be9e472e5c95791e3344b303__dydt_liblsoda", (DL_FUNC) rx_a3eeed02be9e472e5c95791e3344b303__dydt_liblsoda);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; //Initialize the dll to match rxode2's calls</span></span>
<span><span class="co">#&gt; void R_init_rx_a3eeed02be9e472e5c95791e3344b303_(DllInfo *info){</span></span>
<span><span class="co">#&gt;   // Get C callables on load; Otherwise it isn't thread safe</span></span>
<span><span class="co">#&gt;   R_init0_rx_a3eeed02be9e472e5c95791e3344b303_();</span></span>
<span><span class="co">#&gt;   static const R_CallMethodDef callMethods[]  = {</span></span>
<span><span class="co">#&gt;     {"rx_a3eeed02be9e472e5c95791e3344b303__model_vars", (DL_FUNC) &amp;rx_a3eeed02be9e472e5c95791e3344b303__model_vars, 0},</span></span>
<span><span class="co">#&gt;     {NULL, NULL, 0}</span></span>
<span><span class="co">#&gt;   };</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   R_registerRoutines(info, NULL, callMethods, NULL, NULL);</span></span>
<span><span class="co">#&gt;   R_useDynamicSymbols(info,FALSE);</span></span>
<span><span class="co">#&gt;   _assignFuns0();</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; void R_unload_rx_a3eeed02be9e472e5c95791e3344b303_ (DllInfo *info){</span></span>
<span><span class="co">#&gt;   // Free resources required for single subject solve.</span></span>
<span><span class="co">#&gt;   SEXP _mv = PROTECT(_rxGetModelLib("rx_a3eeed02be9e472e5c95791e3344b303__model_vars"));</span></span>
<span><span class="co">#&gt;   if (!Rf_isNull(_mv)){</span></span>
<span><span class="co">#&gt;     _rxRmModelLib("rx_a3eeed02be9e472e5c95791e3344b303__model_vars");</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   UNPROTECT(1);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’</span></span>
<span></span>
<span><span class="co">#Population parameter values on log-scale</span></span>
<span>  <span class="va">paramsl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>CL <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>               V <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">70</span><span class="op">)</span>,</span>
<span>               KA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#make 10,000 subjects to sample from:</span></span>
<span>  <span class="va">nsubg</span> <span class="op">&lt;-</span> <span class="fl">300</span> <span class="co"># subjects per dose</span></span>
<span>  <span class="va">doses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">30</span>, <span class="fl">60</span>, <span class="fl">120</span><span class="op">)</span></span>
<span>  <span class="va">nsub</span> <span class="op">&lt;-</span> <span class="va">nsubg</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">doses</span><span class="op">)</span></span>
<span><span class="co">#IIV of 30% for each parameter</span></span>
<span>  <span class="va">omega</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.09</span>, <span class="fl">0.09</span>, <span class="fl">0.09</span><span class="op">)</span><span class="op">)</span><span class="co"># IIV covariance matrix</span></span>
<span>  <span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span><span class="co">#Sample from the multivariate normal</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">98176247</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/rxSetSeed.html">rxSetSeed</a></span><span class="op">(</span><span class="fl">98176247</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span>
<span>  <span class="va">mv</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="va">nsub</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">omega</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="va">omega</span><span class="op">)</span> <span class="co"># Sample from covariance matrix</span></span>
<span><span class="co">#Combine population parameters with IIV</span></span>
<span>  <span class="va">params.all</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>      <span class="st">"ID"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">nsub</span><span class="op">)</span>,</span>
<span>      <span class="st">"CL"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">paramsl</span><span class="op">[</span><span class="st">'CL'</span><span class="op">]</span> <span class="op">+</span> <span class="va">mv</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>      <span class="st">"V"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">paramsl</span><span class="op">[</span><span class="st">'V'</span><span class="op">]</span> <span class="op">+</span> <span class="va">mv</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>      <span class="st">"KA"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">paramsl</span><span class="op">[</span><span class="st">'KA'</span><span class="op">]</span> <span class="op">+</span> <span class="va">mv</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="co">#set the doses (looping through the 4 doses)</span></span>
<span><span class="va">params.all</span><span class="op">[</span>, <span class="va">AMT</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">100</span> <span class="op">*</span> <span class="va">doses</span>,<span class="va">nsubg</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">Startlapply</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Run the simulations using lapply for speed</span></span>
<span>  <span class="va">s</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">nsub</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span><span class="co">#selects the parameters associated with the subject to be simulated</span></span>
<span>    <span class="va">params</span> <span class="op">&lt;-</span> <span class="va">params.all</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span><span class="co">#creates an eventTable with 7 doses every 24 hours</span></span>
<span>    <span class="va">ev</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eventTable.html">eventTable</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="va">ev</span><span class="op">$</span><span class="fu">add.dosing</span><span class="op">(</span></span>
<span>      dose <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">AMT</span>,</span>
<span>      nbr.doses <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      dosing.to <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      rate <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>      start.time <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span></span>
<span><span class="co">#generates 4 random samples in a 24 hour period</span></span>
<span>    <span class="va">ev</span><span class="op">$</span><span class="fu">add.sampling</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">600</span>, <span class="fl">0</span>, <span class="fl">1440</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span> <span class="op">/</span> <span class="fl">60</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#runs the rxode2 simulation</span></span>
<span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span><span class="va">params</span>, <span class="va">ev</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#merges the parameters and ID number to the simulation output</span></span>
<span>    <span class="va">x</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span> <span class="op">:=</span> <span class="va">params</span><span class="op">]</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#runs the entire sequence of 100 subjects and binds the results to the object res</span></span>
<span>  <span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>, <span class="va">s</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Stoplapply</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">Stoplapply</span> <span class="op">-</span> <span class="va">Startlapply</span><span class="op">)</span></span>
<span><span class="co">#&gt; Time difference of 14.42819 secs</span></span></code></pre></div>
<p>By applying some of the new parallel solving concepts you can simply
run the same simulation both with less code and faster:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rxode2.html">rxode2</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">CL</span> <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span>    <span class="va">V</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">70</span><span class="op">)</span></span>
<span>    <span class="va">KA</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">CL</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">CL</span> <span class="op">+</span> <span class="va">eta.CL</span><span class="op">)</span></span>
<span>    <span class="va">V</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">V</span> <span class="op">+</span> <span class="va">eta.V</span><span class="op">)</span></span>
<span>    <span class="va">KA</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">KA</span> <span class="op">+</span> <span class="va">eta.KA</span><span class="op">)</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">abs</span><span class="op">)</span>    <span class="op">=</span> <span class="op">-</span><span class="va">KA</span><span class="op">*</span><span class="va">abs</span>;</span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">centr</span><span class="op">)</span>  <span class="op">=</span>  <span class="va">KA</span><span class="op">*</span><span class="va">abs</span><span class="op">-</span><span class="op">(</span><span class="va">CL</span><span class="op">/</span><span class="va">V</span><span class="op">)</span><span class="op">*</span><span class="va">centr</span>;</span>
<span>    <span class="va">C2</span><span class="op">=</span><span class="va">centr</span><span class="op">/</span><span class="va">V</span>;</span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; C model:</span></span>
<span><span class="co">#&gt; // Define translation state order for 2 states</span></span>
<span><span class="co">#&gt; #define __DDT0__ 0 // abs</span></span>
<span><span class="co">#&gt; #define __DDT1__ 1 // centr</span></span>
<span><span class="co">#&gt; // Define 4 LHS values</span></span>
<span><span class="co">#&gt; #define _LHS_0_ 0 // CL</span></span>
<span><span class="co">#&gt; #define _LHS_1_ 1 // V</span></span>
<span><span class="co">#&gt; #define _LHS_2_ 2 // KA</span></span>
<span><span class="co">#&gt; #define _LHS_3_ 3 // C2</span></span>
<span><span class="co">#&gt; #define _getRxSolve_ _rxaf2688f8455851d8cd10ffc0c6e95dc31001__getRxSolve__YnCf</span></span>
<span><span class="co">#&gt; #define _evalUdf _rxaf2688f8455851d8cd10ffc0c6e95dc31002__evalUdf_DOOd</span></span>
<span><span class="co">#&gt; #define _solveData _rxaf2688f8455851d8cd10ffc0c6e95dc31003__solveData_E2Sx</span></span>
<span><span class="co">#&gt; #define _assign_ptr _rxaf2688f8455851d8cd10ffc0c6e95dc31004__assign_ptr_jaQ3</span></span>
<span><span class="co">#&gt; #define _rxRmModelLib _rxaf2688f8455851d8cd10ffc0c6e95dc31005__rxRmModelLib_eF6w</span></span>
<span><span class="co">#&gt; #define _rxGetModelLib _rxaf2688f8455851d8cd10ffc0c6e95dc31006__rxGetModelLib_t3Yf</span></span>
<span><span class="co">#&gt; #define _old_c _rxaf2688f8455851d8cd10ffc0c6e95dc31007__old_c_rXeQ</span></span>
<span><span class="co">#&gt; #define _ptrid _rxaf2688f8455851d8cd10ffc0c6e95dc31008__ptrid_OXfS</span></span>
<span><span class="co">#&gt; #define _rxIsCurrentC _rxaf2688f8455851d8cd10ffc0c6e95dc31009__rxIsCurrentC_mFVb</span></span>
<span><span class="co">#&gt; #define _sumPS _rxaf2688f8455851d8cd10ffc0c6e95dc31010__sumPS_SLh4</span></span>
<span><span class="co">#&gt; #define _prodPS _rxaf2688f8455851d8cd10ffc0c6e95dc31011__prodPS_koB6</span></span>
<span><span class="co">#&gt; #define _prodType _rxaf2688f8455851d8cd10ffc0c6e95dc31012__prodType_hVGK</span></span>
<span><span class="co">#&gt; #define _sumType _rxaf2688f8455851d8cd10ffc0c6e95dc31013__sumType_cbDT</span></span>
<span><span class="co">#&gt; #define _update_par_ptr _rxaf2688f8455851d8cd10ffc0c6e95dc31014__update_par_ptr_3SPL</span></span>
<span><span class="co">#&gt; #define _getParCov _rxaf2688f8455851d8cd10ffc0c6e95dc31015__getParCov_ghJS</span></span>
<span><span class="co">#&gt; #define _rxode2_rxAssignPtr _rxaf2688f8455851d8cd10ffc0c6e95dc31016__rxode2_rxAssignPtr_Drh0</span></span>
<span><span class="co">#&gt; #define _rxQr _rxaf2688f8455851d8cd10ffc0c6e95dc31017__rxQr_qDbn</span></span>
<span><span class="co">#&gt; #define _compareFactorVal _rxaf2688f8455851d8cd10ffc0c6e95dc31018__compareFactorVal_w5ZD</span></span>
<span><span class="co">#&gt; #define _sum _rxaf2688f8455851d8cd10ffc0c6e95dc31019__sum_d8ZE</span></span>
<span><span class="co">#&gt; #define _udf _rxaf2688f8455851d8cd10ffc0c6e95dc31020__udf_eUe8</span></span>
<span><span class="co">#&gt; #define _sign _rxaf2688f8455851d8cd10ffc0c6e95dc31021__sign_OsjG</span></span>
<span><span class="co">#&gt; #define _prod _rxaf2688f8455851d8cd10ffc0c6e95dc31022__prod_Y84I</span></span>
<span><span class="co">#&gt; #define _max _rxaf2688f8455851d8cd10ffc0c6e95dc31023__max_jNPG</span></span>
<span><span class="co">#&gt; #define _min _rxaf2688f8455851d8cd10ffc0c6e95dc31024__min_XFkq</span></span>
<span><span class="co">#&gt; #define _transit4P _rxaf2688f8455851d8cd10ffc0c6e95dc31025__transit4P_p1OV</span></span>
<span><span class="co">#&gt; #define _transit3P _rxaf2688f8455851d8cd10ffc0c6e95dc31026__transit3P_VAm8</span></span>
<span><span class="co">#&gt; #define _assignFuns0 _rxaf2688f8455851d8cd10ffc0c6e95dc31027__assignFuns0_XiTh</span></span>
<span><span class="co">#&gt; #define _assignFuns _rxaf2688f8455851d8cd10ffc0c6e95dc31028__assignFuns_dbtL</span></span>
<span><span class="co">#&gt; #define _rxord _rxaf2688f8455851d8cd10ffc0c6e95dc31029__rxord_KmoL</span></span>
<span><span class="co">#&gt; #define __assignFuns2 _rxaf2688f8455851d8cd10ffc0c6e95dc31030___assignFuns2_1bqT</span></span>
<span><span class="co">#&gt; #define _llikCauchyDscale _rxaf2688f8455851d8cd10ffc0c6e95dc31031__llikCauchyDscale_1gUq</span></span>
<span><span class="co">#&gt; #define _llikCauchyDlocation _rxaf2688f8455851d8cd10ffc0c6e95dc31032__llikCauchyDlocation_5GnC</span></span>
<span><span class="co">#&gt; #define _llikCauchy _rxaf2688f8455851d8cd10ffc0c6e95dc31033__llikCauchy_9nfm</span></span>
<span><span class="co">#&gt; #define _llikGammaDrate _rxaf2688f8455851d8cd10ffc0c6e95dc31034__llikGammaDrate_Jza5</span></span>
<span><span class="co">#&gt; #define _llikGammaDshape _rxaf2688f8455851d8cd10ffc0c6e95dc31035__llikGammaDshape_tOjR</span></span>
<span><span class="co">#&gt; #define _llikGamma _rxaf2688f8455851d8cd10ffc0c6e95dc31036__llikGamma_6nZ9</span></span>
<span><span class="co">#&gt; #define _llikWeibullDscale _rxaf2688f8455851d8cd10ffc0c6e95dc31037__llikWeibullDscale_KHAe</span></span>
<span><span class="co">#&gt; #define _llikWeibullDshape _rxaf2688f8455851d8cd10ffc0c6e95dc31038__llikWeibullDshape_VNUH</span></span>
<span><span class="co">#&gt; #define _llikWeibull _rxaf2688f8455851d8cd10ffc0c6e95dc31039__llikWeibull_0yFo</span></span>
<span><span class="co">#&gt; #define _llikUnifDbeta _rxaf2688f8455851d8cd10ffc0c6e95dc31040__llikUnifDbeta_UOJh</span></span>
<span><span class="co">#&gt; #define _llikUnifDalpha _rxaf2688f8455851d8cd10ffc0c6e95dc31041__llikUnifDalpha_H6nE</span></span>
<span><span class="co">#&gt; #define _llikUnif _rxaf2688f8455851d8cd10ffc0c6e95dc31042__llikUnif_1FdZ</span></span>
<span><span class="co">#&gt; #define _llikGeomDp _rxaf2688f8455851d8cd10ffc0c6e95dc31043__llikGeomDp_YLDa</span></span>
<span><span class="co">#&gt; #define _llikGeom _rxaf2688f8455851d8cd10ffc0c6e95dc31044__llikGeom_Vt9q</span></span>
<span><span class="co">#&gt; #define _llikFDdf2 _rxaf2688f8455851d8cd10ffc0c6e95dc31045__llikFDdf2_u6mv</span></span>
<span><span class="co">#&gt; #define _llikFDdf1 _rxaf2688f8455851d8cd10ffc0c6e95dc31046__llikFDdf1_A1G4</span></span>
<span><span class="co">#&gt; #define _llikF _rxaf2688f8455851d8cd10ffc0c6e95dc31047__llikF_Khic</span></span>
<span><span class="co">#&gt; #define _llikExpDrate _rxaf2688f8455851d8cd10ffc0c6e95dc31048__llikExpDrate_klZB</span></span>
<span><span class="co">#&gt; #define _llikExp _rxaf2688f8455851d8cd10ffc0c6e95dc31049__llikExp_qIBy</span></span>
<span><span class="co">#&gt; #define _llikChisqDdf _rxaf2688f8455851d8cd10ffc0c6e95dc31050__llikChisqDdf_OdiT</span></span>
<span><span class="co">#&gt; #define _llikChisq _rxaf2688f8455851d8cd10ffc0c6e95dc31051__llikChisq_Cx0I</span></span>
<span><span class="co">#&gt; #define _llikTDsd _rxaf2688f8455851d8cd10ffc0c6e95dc31052__llikTDsd_GAJr</span></span>
<span><span class="co">#&gt; #define _llikTDmean _rxaf2688f8455851d8cd10ffc0c6e95dc31053__llikTDmean_F82r</span></span>
<span><span class="co">#&gt; #define _llikTDdf _rxaf2688f8455851d8cd10ffc0c6e95dc31054__llikTDdf_TDXm</span></span>
<span><span class="co">#&gt; #define _llikT _rxaf2688f8455851d8cd10ffc0c6e95dc31055__llikT_12G7</span></span>
<span><span class="co">#&gt; #define _llikBetaDshape2 _rxaf2688f8455851d8cd10ffc0c6e95dc31056__llikBetaDshape2_WK1g</span></span>
<span><span class="co">#&gt; #define _llikBetaDshape1 _rxaf2688f8455851d8cd10ffc0c6e95dc31057__llikBetaDshape1_ZXhF</span></span>
<span><span class="co">#&gt; #define _llikBeta _rxaf2688f8455851d8cd10ffc0c6e95dc31058__llikBeta_uiqg</span></span>
<span><span class="co">#&gt; #define _llikNbinomMuDmu _rxaf2688f8455851d8cd10ffc0c6e95dc31059__llikNbinomMuDmu_b9NT</span></span>
<span><span class="co">#&gt; #define _llikNbinomMu _rxaf2688f8455851d8cd10ffc0c6e95dc31060__llikNbinomMu_45U4</span></span>
<span><span class="co">#&gt; #define _llikNbinomDprob _rxaf2688f8455851d8cd10ffc0c6e95dc31061__llikNbinomDprob_aqYs</span></span>
<span><span class="co">#&gt; #define _llikNbinom _rxaf2688f8455851d8cd10ffc0c6e95dc31062__llikNbinom_Yx0E</span></span>
<span><span class="co">#&gt; #define _llikBinomDprob _rxaf2688f8455851d8cd10ffc0c6e95dc31063__llikBinomDprob_jYtp</span></span>
<span><span class="co">#&gt; #define _llikBinom _rxaf2688f8455851d8cd10ffc0c6e95dc31064__llikBinom_0VAf</span></span>
<span><span class="co">#&gt; #define _llikPoisDlambda _rxaf2688f8455851d8cd10ffc0c6e95dc31065__llikPoisDlambda_VHAF</span></span>
<span><span class="co">#&gt; #define _llikPois _rxaf2688f8455851d8cd10ffc0c6e95dc31066__llikPois_x0JK</span></span>
<span><span class="co">#&gt; #define _llikNormDsd _rxaf2688f8455851d8cd10ffc0c6e95dc31067__llikNormDsd_fxip</span></span>
<span><span class="co">#&gt; #define _llikNormDmean _rxaf2688f8455851d8cd10ffc0c6e95dc31068__llikNormDmean_MJgL</span></span>
<span><span class="co">#&gt; #define _llikNorm _rxaf2688f8455851d8cd10ffc0c6e95dc31069__llikNorm_XHY9</span></span>
<span><span class="co">#&gt; #define simeps _rxaf2688f8455851d8cd10ffc0c6e95dc31070_simeps_loxl</span></span>
<span><span class="co">#&gt; #define simeta _rxaf2688f8455851d8cd10ffc0c6e95dc31071_simeta_O0cJ</span></span>
<span><span class="co">#&gt; #define expit _rxaf2688f8455851d8cd10ffc0c6e95dc31072_expit_g78a</span></span>
<span><span class="co">#&gt; #define logit _rxaf2688f8455851d8cd10ffc0c6e95dc31073_logit_U5Vp</span></span>
<span><span class="co">#&gt; #define gammapDer _rxaf2688f8455851d8cd10ffc0c6e95dc31074_gammapDer_lk7u</span></span>
<span><span class="co">#&gt; #define lowergamma _rxaf2688f8455851d8cd10ffc0c6e95dc31075_lowergamma_S5sW</span></span>
<span><span class="co">#&gt; #define uppergamma _rxaf2688f8455851d8cd10ffc0c6e95dc31076_uppergamma_4kAi</span></span>
<span><span class="co">#&gt; #define gammaqInva _rxaf2688f8455851d8cd10ffc0c6e95dc31077_gammaqInva_RXys</span></span>
<span><span class="co">#&gt; #define gammaqInv _rxaf2688f8455851d8cd10ffc0c6e95dc31078_gammaqInv_kZke</span></span>
<span><span class="co">#&gt; #define gammapInva _rxaf2688f8455851d8cd10ffc0c6e95dc31079_gammapInva_JFzu</span></span>
<span><span class="co">#&gt; #define gammapInv _rxaf2688f8455851d8cd10ffc0c6e95dc31080_gammapInv_aww1</span></span>
<span><span class="co">#&gt; #define gammaq _rxaf2688f8455851d8cd10ffc0c6e95dc31081_gammaq_gnkh</span></span>
<span><span class="co">#&gt; #define gammap _rxaf2688f8455851d8cd10ffc0c6e95dc31082_gammap_Xf54</span></span>
<span><span class="co">#&gt; #define phi _rxaf2688f8455851d8cd10ffc0c6e95dc31083_phi_9brL</span></span>
<span><span class="co">#&gt; #define d2ELUa _rxaf2688f8455851d8cd10ffc0c6e95dc31084_d2ELUa_pIUM</span></span>
<span><span class="co">#&gt; #define dELUa _rxaf2688f8455851d8cd10ffc0c6e95dc31085_dELUa_JO2r</span></span>
<span><span class="co">#&gt; #define d2aELU _rxaf2688f8455851d8cd10ffc0c6e95dc31086_d2aELU_yaIL</span></span>
<span><span class="co">#&gt; #define d2ELU _rxaf2688f8455851d8cd10ffc0c6e95dc31087_d2ELU_vPjM</span></span>
<span><span class="co">#&gt; #define dELU _rxaf2688f8455851d8cd10ffc0c6e95dc31088_dELU_X9Bs</span></span>
<span><span class="co">#&gt; #define ELU _rxaf2688f8455851d8cd10ffc0c6e95dc31089_ELU_syVV</span></span>
<span><span class="co">#&gt; #define dPReLUa1 _rxaf2688f8455851d8cd10ffc0c6e95dc31090_dPReLUa1_17BA</span></span>
<span><span class="co">#&gt; #define dPReLUa _rxaf2688f8455851d8cd10ffc0c6e95dc31091_dPReLUa_hcmP</span></span>
<span><span class="co">#&gt; #define dPReLU _rxaf2688f8455851d8cd10ffc0c6e95dc31092_dPReLU_1Tde</span></span>
<span><span class="co">#&gt; #define PReLU _rxaf2688f8455851d8cd10ffc0c6e95dc31093_PReLU_yKsJ</span></span>
<span><span class="co">#&gt; #define dSwish _rxaf2688f8455851d8cd10ffc0c6e95dc31094_dSwish_7Ve4</span></span>
<span><span class="co">#&gt; #define Swish _rxaf2688f8455851d8cd10ffc0c6e95dc31095_Swish_4Wru</span></span>
<span><span class="co">#&gt; #define dlReLU _rxaf2688f8455851d8cd10ffc0c6e95dc31096_dlReLU_3Iei</span></span>
<span><span class="co">#&gt; #define lReLU _rxaf2688f8455851d8cd10ffc0c6e95dc31097_lReLU_gfAH</span></span>
<span><span class="co">#&gt; #define dSELU _rxaf2688f8455851d8cd10ffc0c6e95dc31098_dSELU_lpLz</span></span>
<span><span class="co">#&gt; #define SELU _rxaf2688f8455851d8cd10ffc0c6e95dc31099_SELU_puGl</span></span>
<span><span class="co">#&gt; #define d4softplus _rxaf2688f8455851d8cd10ffc0c6e95dc31100_d4softplus_Nxze</span></span>
<span><span class="co">#&gt; #define d3softplus _rxaf2688f8455851d8cd10ffc0c6e95dc31101_d3softplus_W7Og</span></span>
<span><span class="co">#&gt; #define d2softplus _rxaf2688f8455851d8cd10ffc0c6e95dc31102_d2softplus_MWsu</span></span>
<span><span class="co">#&gt; #define dsoftplus _rxaf2688f8455851d8cd10ffc0c6e95dc31103_dsoftplus_chdx</span></span>
<span><span class="co">#&gt; #define softplus _rxaf2688f8455851d8cd10ffc0c6e95dc31104_softplus_21YJ</span></span>
<span><span class="co">#&gt; #define d4GELU _rxaf2688f8455851d8cd10ffc0c6e95dc31105_d4GELU_GHOE</span></span>
<span><span class="co">#&gt; #define d3GELU _rxaf2688f8455851d8cd10ffc0c6e95dc31106_d3GELU_EcYl</span></span>
<span><span class="co">#&gt; #define d2GELU _rxaf2688f8455851d8cd10ffc0c6e95dc31107_d2GELU_aMWa</span></span>
<span><span class="co">#&gt; #define dGELU _rxaf2688f8455851d8cd10ffc0c6e95dc31108_dGELU_Hm1D</span></span>
<span><span class="co">#&gt; #define GELU _rxaf2688f8455851d8cd10ffc0c6e95dc31109_GELU_522P</span></span>
<span><span class="co">#&gt; #define dReLU _rxaf2688f8455851d8cd10ffc0c6e95dc31110_dReLU_6laM</span></span>
<span><span class="co">#&gt; #define ReLU _rxaf2688f8455851d8cd10ffc0c6e95dc31111_ReLU_jWqd</span></span>
<span><span class="co">#&gt; #define riweibull _rxaf2688f8455851d8cd10ffc0c6e95dc31112_riweibull_E7nm</span></span>
<span><span class="co">#&gt; #define riunif _rxaf2688f8455851d8cd10ffc0c6e95dc31113_riunif_q1qg</span></span>
<span><span class="co">#&gt; #define rit_ _rxaf2688f8455851d8cd10ffc0c6e95dc31114_rit__RjXD</span></span>
<span><span class="co">#&gt; #define ripois _rxaf2688f8455851d8cd10ffc0c6e95dc31115_ripois_0gfh</span></span>
<span><span class="co">#&gt; #define ribeta _rxaf2688f8455851d8cd10ffc0c6e95dc31116_ribeta_ijML</span></span>
<span><span class="co">#&gt; #define rigamma _rxaf2688f8455851d8cd10ffc0c6e95dc31117_rigamma_bGw3</span></span>
<span><span class="co">#&gt; #define rigeom _rxaf2688f8455851d8cd10ffc0c6e95dc31118_rigeom_FraR</span></span>
<span><span class="co">#&gt; #define rif _rxaf2688f8455851d8cd10ffc0c6e95dc31119_rif_0qYy</span></span>
<span><span class="co">#&gt; #define riexp _rxaf2688f8455851d8cd10ffc0c6e95dc31120_riexp_GyE0</span></span>
<span><span class="co">#&gt; #define richisq _rxaf2688f8455851d8cd10ffc0c6e95dc31121_richisq_la8Z</span></span>
<span><span class="co">#&gt; #define ricauchy _rxaf2688f8455851d8cd10ffc0c6e95dc31122_ricauchy_oKb0</span></span>
<span><span class="co">#&gt; #define rinbinomMu _rxaf2688f8455851d8cd10ffc0c6e95dc31123_rinbinomMu_cvWv</span></span>
<span><span class="co">#&gt; #define rinbinom _rxaf2688f8455851d8cd10ffc0c6e95dc31124_rinbinom_x6Sb</span></span>
<span><span class="co">#&gt; #define ribinom _rxaf2688f8455851d8cd10ffc0c6e95dc31125_ribinom_zuIm</span></span>
<span><span class="co">#&gt; #define rinorm _rxaf2688f8455851d8cd10ffc0c6e95dc31126_rinorm_4N7U</span></span>
<span><span class="co">#&gt; #define rxweibull _rxaf2688f8455851d8cd10ffc0c6e95dc31127_rxweibull_bIWH</span></span>
<span><span class="co">#&gt; #define rxunif _rxaf2688f8455851d8cd10ffc0c6e95dc31128_rxunif_2CkW</span></span>
<span><span class="co">#&gt; #define rxt_ _rxaf2688f8455851d8cd10ffc0c6e95dc31129_rxt__sPsZ</span></span>
<span><span class="co">#&gt; #define rxpois _rxaf2688f8455851d8cd10ffc0c6e95dc31130_rxpois_XrhF</span></span>
<span><span class="co">#&gt; #define rxbeta _rxaf2688f8455851d8cd10ffc0c6e95dc31131_rxbeta_bB3Z</span></span>
<span><span class="co">#&gt; #define rxgamma _rxaf2688f8455851d8cd10ffc0c6e95dc31132_rxgamma_h2zW</span></span>
<span><span class="co">#&gt; #define rxgeom _rxaf2688f8455851d8cd10ffc0c6e95dc31133_rxgeom_V5IJ</span></span>
<span><span class="co">#&gt; #define rxf _rxaf2688f8455851d8cd10ffc0c6e95dc31134_rxf_uRsv</span></span>
<span><span class="co">#&gt; #define rxexp _rxaf2688f8455851d8cd10ffc0c6e95dc31135_rxexp_AO6N</span></span>
<span><span class="co">#&gt; #define rxchisq _rxaf2688f8455851d8cd10ffc0c6e95dc31136_rxchisq_m60I</span></span>
<span><span class="co">#&gt; #define rxcauchy _rxaf2688f8455851d8cd10ffc0c6e95dc31137_rxcauchy_KppK</span></span>
<span><span class="co">#&gt; #define rxnbinomMu _rxaf2688f8455851d8cd10ffc0c6e95dc31138_rxnbinomMu_F16E</span></span>
<span><span class="co">#&gt; #define rxnbinom _rxaf2688f8455851d8cd10ffc0c6e95dc31139_rxnbinom_pipt</span></span>
<span><span class="co">#&gt; #define rxbinom _rxaf2688f8455851d8cd10ffc0c6e95dc31140_rxbinom_tt3V</span></span>
<span><span class="co">#&gt; #define rxnorm _rxaf2688f8455851d8cd10ffc0c6e95dc31141_rxnorm_qSTU</span></span>
<span><span class="co">#&gt; #define linCmtB _rxaf2688f8455851d8cd10ffc0c6e95dc31142_linCmtB_g7h6</span></span>
<span><span class="co">#&gt; #define linCmtA _rxaf2688f8455851d8cd10ffc0c6e95dc31143_linCmtA_NZDD</span></span>
<span><span class="co">#&gt; #include &lt;rxode2_model_shared.h&gt;</span></span>
<span><span class="co">#&gt; #define __MAX_PROD__ 0</span></span>
<span><span class="co">#&gt; #define _CMT CMT</span></span>
<span><span class="co">#&gt; #define _SYNC_simeps_ for (int _svari=_solveData-&gt;neps; _svari--;){  if (_solveData-&gt;svar[_svari] == 0) {eta_DoT_CL = _PP[0];};   if (_solveData-&gt;svar[_svari] == 1) {eta_DoT_V = _PP[1];};   if (_solveData-&gt;svar[_svari] == 2) {eta_DoT_KA = _PP[2];}; }</span></span>
<span><span class="co">#&gt; #define _SYNC_simeta_ for (int _ovari=_solveData-&gt;neta; _ovari--;){  if (_solveData-&gt;ovar[_ovari] == 0) {eta_DoT_CL = _PP[0];};   if (_solveData-&gt;ovar[_ovari] == 1) {eta_DoT_V = _PP[1];};   if (_solveData-&gt;ovar[_ovari] == 2) {eta_DoT_KA = _PP[2];}; }</span></span>
<span><span class="co">#&gt; _getRxSolve_t _getRxSolve_;</span></span>
<span><span class="co">#&gt; _simfun simeps;</span></span>
<span><span class="co">#&gt; _simfun simeta;</span></span>
<span><span class="co">#&gt; _udf_type _evalUdf=NULL;</span></span>
<span><span class="co">#&gt; rx_solve *_solveData=NULL;</span></span>
<span><span class="co">#&gt; rxode2_assign_ptr _assign_ptr=NULL;</span></span>
<span><span class="co">#&gt; _rxRmModelLibType _rxRmModelLib=NULL;</span></span>
<span><span class="co">#&gt; _rxGetModelLibType _rxGetModelLib=NULL;</span></span>
<span><span class="co">#&gt; rxode2_ode_solver_old_c _old_c=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _ptrid=NULL;</span></span>
<span><span class="co">#&gt; _rxIsCurrentC_type _rxIsCurrentC=NULL;</span></span>
<span><span class="co">#&gt; _rxSumType _sumPS=NULL;</span></span>
<span><span class="co">#&gt; _rxProdType _prodPS=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _prodType=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _sumType=NULL;</span></span>
<span><span class="co">#&gt; _update_par_ptr_p _update_par_ptr=NULL;</span></span>
<span><span class="co">#&gt; _getParCov_p _getParCov=NULL;</span></span>
<span><span class="co">#&gt; linCmtA_p linCmtA;</span></span>
<span><span class="co">#&gt; linCmtB_p linCmtB;</span></span>
<span><span class="co">#&gt; _rx_asgn _rxode2_rxAssignPtr=NULL;</span></span>
<span><span class="co">#&gt; _rx_asgn _rxQr=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn phi;</span></span>
<span><span class="co">#&gt; rxode2_fn ReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn dReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn dGELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d2GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d3GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d4GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn dsoftplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d2softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d3softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d4softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn SELU;</span></span>
<span><span class="co">#&gt; rxode2_fn dSELU;</span></span>
<span><span class="co">#&gt; rxode2_fn lReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn dlReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn Swish;</span></span>
<span><span class="co">#&gt; rxode2_fn dSwish;</span></span>
<span><span class="co">#&gt; rxode2_fn2 PReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLUa;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLUa1;</span></span>
<span><span class="co">#&gt; rxode2_fn2 ELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2ELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2aELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dELUa;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2ELUa;</span></span>
<span><span class="co">#&gt; rxode2_fn3 logit;</span></span>
<span><span class="co">#&gt; rxode2_fn3 expit;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammap;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaq;</span></span>
<span><span class="co">#&gt; rxode2_fn2 lowergamma;</span></span>
<span><span class="co">#&gt; rxode2_fn2 uppergamma;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapInv;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapDer;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapInva;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaqInv;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaqInva;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxnorm;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxbinom;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxnbinom;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxnbinomMu;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxcauchy;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxchisq;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxexp;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxf;</span></span>
<span><span class="co">#&gt; rxode2i_ifn rxgeom;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxgamma;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxbeta;</span></span>
<span><span class="co">#&gt; rxode2i_ifn rxpois;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxt_;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxunif;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxweibull;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rinorm;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom ribinom;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom rinbinom;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom rinbinomMu;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 ricauchy;</span></span>
<span><span class="co">#&gt; rxode2i2_fn richisq;</span></span>
<span><span class="co">#&gt; rxode2i2_fn riexp;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rif;</span></span>
<span><span class="co">#&gt; rxode2i2_ifn rigeom;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rigamma;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 ribeta;</span></span>
<span><span class="co">#&gt; rxode2i2_ifn ripois;</span></span>
<span><span class="co">#&gt; rxode2i2_fn rit_;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 riunif;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 riweibull;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNorm;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNormDmean;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNormDsd;</span></span>
<span><span class="co">#&gt; rxode2_llikPoisFun _llikPois;</span></span>
<span><span class="co">#&gt; rxode2_llikPoisFun _llikPoisDlambda;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikBinom;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikBinomDprob;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinom;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomDprob;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomMu;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomMuDmu;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBeta;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBetaDshape1;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBetaDshape2;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikT;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDdf;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDmean;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDsd;</span></span>
<span><span class="co">#&gt; rxode2_llikChisqFun _llikChisq;</span></span>
<span><span class="co">#&gt; rxode2_llikChisqFun _llikChisqDdf;</span></span>
<span><span class="co">#&gt; rxode2_llikExpFun _llikExp;</span></span>
<span><span class="co">#&gt; rxode2_llikExpFun _llikExpDrate;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikF;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikFDdf1;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikFDdf2;</span></span>
<span><span class="co">#&gt; rxode2_llikGeomFun _llikGeom;</span></span>
<span><span class="co">#&gt; rxode2_llikGeomFun _llikGeomDp;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnif;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnifDalpha;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnifDbeta;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibull;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibullDshape;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibullDscale;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGamma;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGammaDshape;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGammaDrate;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchy;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchyDlocation;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchyDscale;</span></span>
<span><span class="co">#&gt; rxode2_compareFactorVal_fn _compareFactorVal;</span></span>
<span><span class="co">#&gt; #include "extraC.h"</span></span>
<span><span class="co">#&gt; double _prod(double *input, double *p, int type, int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return _prodPS(input, p, n, type);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _udf(const char *funName, double *input, int n, ...) {</span></span>
<span><span class="co">#&gt;   if (n == -42) Rf_error("%s", "this has a ui user function that cannot be called directly");</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return _evalUdf(funName, n, input);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _sum(double *input, double *pld, int m, int type, int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   double ret = _sumPS(input, n, pld, m, type);</span></span>
<span><span class="co">#&gt;   if (type == 2 &amp;&amp; m &lt; 0){</span></span>
<span><span class="co">#&gt;     for (int i = -m; i--;){</span></span>
<span><span class="co">#&gt;       pld[i] = 0.0;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return ret;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _sign(unsigned int n, ...) {</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double s = 1;</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;     s = sign(va_arg(valist, double))*s;</span></span>
<span><span class="co">#&gt;     if (s == 0){</span></span>
<span><span class="co">#&gt;       break;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return s;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _rxord(int _cSub, unsigned int n,  ...) {</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind* ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   if (!ind-&gt;inLhs) {</span></span>
<span><span class="co">#&gt;     return 1.0;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double ret = 1.0;</span></span>
<span><span class="co">#&gt;   double p = 0.0;</span></span>
<span><span class="co">#&gt;   double u = rxunif(ind, 0.0, 1.0);</span></span>
<span><span class="co">#&gt;   int found = 0;</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;     p += va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     if (!found) {</span></span>
<span><span class="co">#&gt;       if (u &lt; p) {</span></span>
<span><span class="co">#&gt;         ret = (double)(i+1);</span></span>
<span><span class="co">#&gt;         found = 1;</span></span>
<span><span class="co">#&gt;       }</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   if (!found) ret =(double)(n+1);</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return ret;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _max(unsigned int n, ...) {</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double mx = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tmp = 0;</span></span>
<span><span class="co">#&gt;   if (n &gt;= 1){</span></span>
<span><span class="co">#&gt;     mx = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     for (unsigned int i = 1; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;       tmp = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;       if (tmp&gt;mx) mx=tmp;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     va_end(valist);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return mx;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _min(unsigned int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double mn = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tmp = 0;</span></span>
<span><span class="co">#&gt;   if (n &gt;= 1){</span></span>
<span><span class="co">#&gt;     mn = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     for (unsigned int i = 1; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;       tmp = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;       if (tmp&lt;mn) mn=tmp;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     va_end(valist);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return mn;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _transit4P(int cmt, double t, unsigned int id, double n, double mtt, double bio){</span></span>
<span><span class="co">#&gt;   double nd = (double) n;</span></span>
<span><span class="co">#&gt;   double ktr = (nd+1)/mtt;</span></span>
<span><span class="co">#&gt;   double lktr = _safe_log(nd+1)-_safe_log(mtt);</span></span>
<span><span class="co">#&gt;   double tlast = _solveData-&gt;subjects[id].tlastS[cmt];</span></span>
<span><span class="co">#&gt;   double dose = _solveData-&gt;subjects[id].curDoseS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(dose)) dose = 0.0;</span></span>
<span><span class="co">#&gt;   if (ISNA(tlast)) tlast = 0.0;</span></span>
<span><span class="co">#&gt;   double tad = (t-tlast);</span></span>
<span><span class="co">#&gt;   return exp(_safe_log(bio*dose)+lktr+n*(lktr+_safe_log(tad))-ktr*(tad)-lgamma1p(nd));</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _transit3P(int cmt, double t, unsigned int id, double n, double mtt){</span></span>
<span><span class="co">#&gt;   double nd = (double) n;</span></span>
<span><span class="co">#&gt;   double ktr = (nd+1)/mtt;</span></span>
<span><span class="co">#&gt;   double lktr = _safe_log(nd+1)-_safe_log(mtt);</span></span>
<span><span class="co">#&gt;   double tlast = _solveData-&gt;subjects[id].tlastS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(tlast)) tlast = 0.0;</span></span>
<span><span class="co">#&gt;   double tad = t-tlast;</span></span>
<span><span class="co">#&gt;   double podo = _solveData-&gt;subjects[id].curDoseS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(podo)) podo = 0.0;</span></span>
<span><span class="co">#&gt;   return exp(_safe_log(podo)+lktr+n*(lktr+_safe_log(tad))-ktr*(tad)-lgamma1p(nd));</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void _assignFuns0(void) {</span></span>
<span><span class="co">#&gt;   _evalUdf = (_udf_type) R_GetCCallable("rxode2", "_rxode2_evalUdf");</span></span>
<span><span class="co">#&gt;   _getRxSolve_ = (_getRxSolve_t) R_GetCCallable("rxode2","getRxSolve_");</span></span>
<span><span class="co">#&gt;   _assign_ptr=(rxode2_assign_ptr) R_GetCCallable("rxode2","rxode2_assign_fn_pointers");</span></span>
<span><span class="co">#&gt;   _rxRmModelLib=(_rxRmModelLibType) R_GetCCallable("rxode2","rxRmModelLib");</span></span>
<span><span class="co">#&gt;   _rxGetModelLib=(_rxGetModelLibType) R_GetCCallable("rxode2","rxGetModelLib");</span></span>
<span><span class="co">#&gt;   _rxode2_rxAssignPtr=(_rx_asgn)R_GetCCallable("rxode2","_rxode2_rxAssignPtr");</span></span>
<span><span class="co">#&gt;   _rxQr=(_rx_asgn)R_GetCCallable("rxode2","_rxode2_rxQr");</span></span>
<span><span class="co">#&gt;   _rxIsCurrentC = (_rxIsCurrentC_type)R_GetCCallable("rxode2","rxIsCurrentC");</span></span>
<span><span class="co">#&gt;   _sumPS  = (_rxSumType) R_GetCCallable("PreciseSums","PreciseSums_sum_r");</span></span>
<span><span class="co">#&gt;   _prodPS = (_rxProdType) R_GetCCallable("PreciseSums","PreciseSums_prod_r");</span></span>
<span><span class="co">#&gt;   _prodType=(rxode2_fn0i)R_GetCCallable("PreciseSums", "PreciseSums_prod_get");</span></span>
<span><span class="co">#&gt;   _sumType=(rxode2_fn0i)R_GetCCallable("PreciseSums", "PreciseSums_sum_get");</span></span>
<span><span class="co">#&gt;   _ptrid=(rxode2_fn0i)R_GetCCallable("rxode2", "rxode2_current_fn_pointer_id");</span></span>
<span><span class="co">#&gt;   _compareFactorVal=(rxode2_compareFactorVal_fn) R_GetCCallable("rxode2", "compareFactorVal");</span></span>
<span><span class="co">#&gt;   _update_par_ptr = (_update_par_ptr_p) R_GetCCallable("rxode2","_update_par_ptr");</span></span>
<span><span class="co">#&gt;   _getParCov = (_getParCov_p) R_GetCCallable("rxode2","_getParCov");</span></span>
<span><span class="co">#&gt;   // dynamic start</span></span>
<span><span class="co">#&gt;   _llikCauchyDscale = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchyDscale");</span></span>
<span><span class="co">#&gt;   _llikCauchyDlocation = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchyDlocation");</span></span>
<span><span class="co">#&gt;   _llikCauchy = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchy");</span></span>
<span><span class="co">#&gt;   _llikGammaDrate = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGammaDrate");</span></span>
<span><span class="co">#&gt;   _llikGammaDshape = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGammaDshape");</span></span>
<span><span class="co">#&gt;   _llikGamma = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGamma");</span></span>
<span><span class="co">#&gt;   _llikWeibullDscale = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibullDscale");</span></span>
<span><span class="co">#&gt;   _llikWeibullDshape = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibullDshape");</span></span>
<span><span class="co">#&gt;   _llikWeibull = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibull");</span></span>
<span><span class="co">#&gt;   _llikUnifDbeta = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnifDbeta");</span></span>
<span><span class="co">#&gt;   _llikUnifDalpha = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnifDalpha");</span></span>
<span><span class="co">#&gt;   _llikUnif = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnif");</span></span>
<span><span class="co">#&gt;   _llikGeomDp = (rxode2_llikGeomFun) R_GetCCallable("rxode2ll", "rxLlikGeomDp");</span></span>
<span><span class="co">#&gt;   _llikGeom = (rxode2_llikGeomFun) R_GetCCallable("rxode2ll", "rxLlikGeom");</span></span>
<span><span class="co">#&gt;   _llikFDdf2 = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikFDdf2");</span></span>
<span><span class="co">#&gt;   _llikFDdf1 = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikFDdf1");</span></span>
<span><span class="co">#&gt;   _llikF = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikF");</span></span>
<span><span class="co">#&gt;   _llikExpDrate = (rxode2_llikExpFun) R_GetCCallable("rxode2ll", "rxLlikExpDrate");</span></span>
<span><span class="co">#&gt;   _llikExp = (rxode2_llikExpFun) R_GetCCallable("rxode2ll", "rxLlikExp");</span></span>
<span><span class="co">#&gt;   _llikChisqDdf = (rxode2_llikChisqFun) R_GetCCallable("rxode2ll", "rxLlikChisqDdf");</span></span>
<span><span class="co">#&gt;   _llikChisq = (rxode2_llikChisqFun) R_GetCCallable("rxode2ll", "rxLlikChisq");</span></span>
<span><span class="co">#&gt;   _llikTDsd = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDsd");</span></span>
<span><span class="co">#&gt;   _llikTDmean = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDmean");</span></span>
<span><span class="co">#&gt;   _llikTDdf = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDdf");</span></span>
<span><span class="co">#&gt;   _llikT = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikT");</span></span>
<span><span class="co">#&gt;   _llikBetaDshape2 = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBetaDshape2");</span></span>
<span><span class="co">#&gt;   _llikBetaDshape1 = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBetaDshape1");</span></span>
<span><span class="co">#&gt;   _llikBeta = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBeta");</span></span>
<span><span class="co">#&gt;   _llikNbinomMuDmu = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomMuDmu");</span></span>
<span><span class="co">#&gt;   _llikNbinomMu = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomMu");</span></span>
<span><span class="co">#&gt;   _llikNbinomDprob = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomDprob");</span></span>
<span><span class="co">#&gt;   _llikNbinom = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinom");</span></span>
<span><span class="co">#&gt;   _llikBinomDprob = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikBinomDprob");</span></span>
<span><span class="co">#&gt;   _llikBinom = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikBinom");</span></span>
<span><span class="co">#&gt;   _llikPoisDlambda = (rxode2_llikPoisFun) R_GetCCallable("rxode2ll", "rxLlikPoisDlambda");</span></span>
<span><span class="co">#&gt;   _llikPois = (rxode2_llikPoisFun) R_GetCCallable("rxode2ll", "rxLlikPois");</span></span>
<span><span class="co">#&gt;   _llikNormDsd = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNormDsd");</span></span>
<span><span class="co">#&gt;   _llikNormDmean = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNormDmean");</span></span>
<span><span class="co">#&gt;   _llikNorm = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNorm");</span></span>
<span><span class="co">#&gt;   simeps = (_simfun) R_GetCCallable("rxode2", "simeps");</span></span>
<span><span class="co">#&gt;   simeta = (_simfun) R_GetCCallable("rxode2", "simeta");</span></span>
<span><span class="co">#&gt;   expit = (rxode2_fn3) R_GetCCallable("rxode2", "expit");</span></span>
<span><span class="co">#&gt;   logit = (rxode2_fn3) R_GetCCallable("rxode2", "logit");</span></span>
<span><span class="co">#&gt;   gammapDer = (rxode2_fn2) R_GetCCallable("rxode2", "gammapDer");</span></span>
<span><span class="co">#&gt;   lowergamma = (rxode2_fn2) R_GetCCallable("rxode2", "lowergamma");</span></span>
<span><span class="co">#&gt;   uppergamma = (rxode2_fn2) R_GetCCallable("rxode2", "uppergamma");</span></span>
<span><span class="co">#&gt;   gammaqInva = (rxode2_fn2) R_GetCCallable("rxode2", "gammaqInva");</span></span>
<span><span class="co">#&gt;   gammaqInv = (rxode2_fn2) R_GetCCallable("rxode2", "gammaqInv");</span></span>
<span><span class="co">#&gt;   gammapInva = (rxode2_fn2) R_GetCCallable("rxode2", "gammapInva");</span></span>
<span><span class="co">#&gt;   gammapInv = (rxode2_fn2) R_GetCCallable("rxode2", "gammapInv");</span></span>
<span><span class="co">#&gt;   gammaq = (rxode2_fn2) R_GetCCallable("rxode2", "gammaq");</span></span>
<span><span class="co">#&gt;   gammap = (rxode2_fn2) R_GetCCallable("rxode2", "gammap");</span></span>
<span><span class="co">#&gt;   phi = (rxode2_fn) R_GetCCallable("rxode2", "phi");</span></span>
<span><span class="co">#&gt;   d2ELUa = (rxode2_fn2) R_GetCCallable("rxode2", "d2ELUa");</span></span>
<span><span class="co">#&gt;   dELUa = (rxode2_fn2) R_GetCCallable("rxode2", "dELUa");</span></span>
<span><span class="co">#&gt;   d2aELU = (rxode2_fn2) R_GetCCallable("rxode2", "d2aELU");</span></span>
<span><span class="co">#&gt;   d2ELU = (rxode2_fn2) R_GetCCallable("rxode2", "d2ELU");</span></span>
<span><span class="co">#&gt;   dELU = (rxode2_fn2) R_GetCCallable("rxode2", "dELU");</span></span>
<span><span class="co">#&gt;   ELU = (rxode2_fn2) R_GetCCallable("rxode2", "ELU");</span></span>
<span><span class="co">#&gt;   dPReLUa1 = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLUa1");</span></span>
<span><span class="co">#&gt;   dPReLUa = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLUa");</span></span>
<span><span class="co">#&gt;   dPReLU = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLU");</span></span>
<span><span class="co">#&gt;   PReLU = (rxode2_fn2) R_GetCCallable("rxode2", "PReLU");</span></span>
<span><span class="co">#&gt;   dSwish = (rxode2_fn) R_GetCCallable("rxode2", "dSwish");</span></span>
<span><span class="co">#&gt;   Swish = (rxode2_fn) R_GetCCallable("rxode2", "Swish");</span></span>
<span><span class="co">#&gt;   dlReLU = (rxode2_fn) R_GetCCallable("rxode2", "dlReLU");</span></span>
<span><span class="co">#&gt;   lReLU = (rxode2_fn) R_GetCCallable("rxode2", "lReLU");</span></span>
<span><span class="co">#&gt;   dSELU = (rxode2_fn) R_GetCCallable("rxode2", "dSELU");</span></span>
<span><span class="co">#&gt;   SELU = (rxode2_fn) R_GetCCallable("rxode2", "SELU");</span></span>
<span><span class="co">#&gt;   d4softplus = (rxode2_fn) R_GetCCallable("rxode2", "d4softplus");</span></span>
<span><span class="co">#&gt;   d3softplus = (rxode2_fn) R_GetCCallable("rxode2", "d3softplus");</span></span>
<span><span class="co">#&gt;   d2softplus = (rxode2_fn) R_GetCCallable("rxode2", "d2softplus");</span></span>
<span><span class="co">#&gt;   dsoftplus = (rxode2_fn) R_GetCCallable("rxode2", "dsoftplus");</span></span>
<span><span class="co">#&gt;   softplus = (rxode2_fn) R_GetCCallable("rxode2", "softplus");</span></span>
<span><span class="co">#&gt;   d4GELU = (rxode2_fn) R_GetCCallable("rxode2", "d4GELU");</span></span>
<span><span class="co">#&gt;   d3GELU = (rxode2_fn) R_GetCCallable("rxode2", "d3GELU");</span></span>
<span><span class="co">#&gt;   d2GELU = (rxode2_fn) R_GetCCallable("rxode2", "d2GELU");</span></span>
<span><span class="co">#&gt;   dGELU = (rxode2_fn) R_GetCCallable("rxode2", "dGELU");</span></span>
<span><span class="co">#&gt;   GELU = (rxode2_fn) R_GetCCallable("rxode2", "GELU");</span></span>
<span><span class="co">#&gt;   dReLU = (rxode2_fn) R_GetCCallable("rxode2", "dReLU");</span></span>
<span><span class="co">#&gt;   ReLU = (rxode2_fn) R_GetCCallable("rxode2", "ReLU");</span></span>
<span><span class="co">#&gt;   riweibull = (rxode2i2_fn2) R_GetCCallable("rxode2", "riweibull");</span></span>
<span><span class="co">#&gt;   riunif = (rxode2i2_fn2) R_GetCCallable("rxode2", "riunif");</span></span>
<span><span class="co">#&gt;   rit_ = (rxode2i2_fn) R_GetCCallable("rxode2", "rit_");</span></span>
<span><span class="co">#&gt;   ripois = (rxode2i2_ifn) R_GetCCallable("rxode2", "ripois");</span></span>
<span><span class="co">#&gt;   ribeta = (rxode2i2_fn2) R_GetCCallable("rxode2", "ribeta");</span></span>
<span><span class="co">#&gt;   rigamma = (rxode2i2_fn2) R_GetCCallable("rxode2", "rigamma");</span></span>
<span><span class="co">#&gt;   rigeom = (rxode2i2_ifn) R_GetCCallable("rxode2", "rigeom");</span></span>
<span><span class="co">#&gt;   rif = (rxode2i2_fn2) R_GetCCallable("rxode2", "rif");</span></span>
<span><span class="co">#&gt;   riexp = (rxode2i2_fn) R_GetCCallable("rxode2", "riexp");</span></span>
<span><span class="co">#&gt;   richisq = (rxode2i2_fn) R_GetCCallable("rxode2", "richisq");</span></span>
<span><span class="co">#&gt;   ricauchy = (rxode2i2_fn2) R_GetCCallable("rxode2", "ricauchy");</span></span>
<span><span class="co">#&gt;   rinbinomMu = (rxode2i2_ribinom) R_GetCCallable("rxode2", "rinbinomMu");</span></span>
<span><span class="co">#&gt;   rinbinom = (rxode2i2_ribinom) R_GetCCallable("rxode2", "rinbinom");</span></span>
<span><span class="co">#&gt;   ribinom = (rxode2i2_ribinom) R_GetCCallable("rxode2", "ribinom");</span></span>
<span><span class="co">#&gt;   rinorm = (rxode2i2_fn2) R_GetCCallable("rxode2", "rinorm");</span></span>
<span><span class="co">#&gt;   rxweibull = (rxode2i_fn2) R_GetCCallable("rxode2", "rxweibull");</span></span>
<span><span class="co">#&gt;   rxunif = (rxode2i_fn2) R_GetCCallable("rxode2", "rxunif");</span></span>
<span><span class="co">#&gt;   rxt_ = (rxode2i_fn) R_GetCCallable("rxode2", "rxt_");</span></span>
<span><span class="co">#&gt;   rxpois = (rxode2i_ifn) R_GetCCallable("rxode2", "rxpois");</span></span>
<span><span class="co">#&gt;   rxbeta = (rxode2i_fn2) R_GetCCallable("rxode2", "rxbeta");</span></span>
<span><span class="co">#&gt;   rxgamma = (rxode2i_fn2) R_GetCCallable("rxode2", "rxgamma");</span></span>
<span><span class="co">#&gt;   rxgeom = (rxode2i_ifn) R_GetCCallable("rxode2", "rxgeom");</span></span>
<span><span class="co">#&gt;   rxf = (rxode2i_fn2) R_GetCCallable("rxode2", "rxf");</span></span>
<span><span class="co">#&gt;   rxexp = (rxode2i_fn) R_GetCCallable("rxode2", "rxexp");</span></span>
<span><span class="co">#&gt;   rxchisq = (rxode2i_fn) R_GetCCallable("rxode2", "rxchisq");</span></span>
<span><span class="co">#&gt;   rxcauchy = (rxode2i_fn2) R_GetCCallable("rxode2", "rxcauchy");</span></span>
<span><span class="co">#&gt;   rxnbinomMu = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxnbinomMu");</span></span>
<span><span class="co">#&gt;   rxnbinom = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxnbinom");</span></span>
<span><span class="co">#&gt;   rxbinom = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxbinom");</span></span>
<span><span class="co">#&gt;   rxnorm = (rxode2i_fn2) R_GetCCallable("rxode2", "rxnorm");</span></span>
<span><span class="co">#&gt;   linCmtB = (linCmtB_p) R_GetCCallable("rxode2", "linCmtB");</span></span>
<span><span class="co">#&gt;   linCmtA = (linCmtA_p) R_GetCCallable("rxode2", "linCmtA");</span></span>
<span><span class="co">#&gt;   // dynamic stop</span></span>
<span><span class="co">#&gt;   _solveData = _getRxSolve_();</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void _assignFuns(void) {</span></span>
<span><span class="co">#&gt;   if (_assign_ptr == NULL){</span></span>
<span><span class="co">#&gt;     _assignFuns0();</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void __assignFuns2(rx_solve rx,</span></span>
<span><span class="co">#&gt;                    rx_solving_options op,</span></span>
<span><span class="co">#&gt;                    t_F f,</span></span>
<span><span class="co">#&gt;                    t_LAG lag,</span></span>
<span><span class="co">#&gt;                    t_RATE rate,</span></span>
<span><span class="co">#&gt;                    t_DUR dur,</span></span>
<span><span class="co">#&gt;                    t_calc_mtime mtime,</span></span>
<span><span class="co">#&gt;                    t_ME me,</span></span>
<span><span class="co">#&gt;                    t_IndF indf,</span></span>
<span><span class="co">#&gt;                    t_getTime gettime,</span></span>
<span><span class="co">#&gt;                    t_locateTimeIndex timeindex,</span></span>
<span><span class="co">#&gt;                    t_handle_evidL handleEvid,</span></span>
<span><span class="co">#&gt;                    t_getDur getdur) {</span></span>
<span><span class="co">#&gt;   // assign start</span></span>
<span><span class="co">#&gt;     static rxode2_assignFuns2_t rxode2_assignFuns2 = NULL;</span></span>
<span><span class="co">#&gt;     if (rxode2_assignFuns2 == NULL) rxode2_assignFuns2 = (rxode2_assignFuns2_t)(R_GetCCallable("rxode2", "_rxode2_assignFuns2"));</span></span>
<span><span class="co">#&gt;     rxode2_assignFuns2(rx, op, f, lag, rate, dur, mtime, me, indf, gettime, timeindex, handleEvid, getdur);</span></span>
<span><span class="co">#&gt;   // assign stop</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void  rx_8af2d396a93189882a9f440693a0c5bb__ode_solver_solvedata (rx_solve *solve){</span></span>
<span><span class="co">#&gt;   _solveData = solve;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern rx_solve *rx_8af2d396a93189882a9f440693a0c5bb__ode_solver_get_solvedata(void){</span></span>
<span><span class="co">#&gt;   return _solveData;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; SEXP rx_8af2d396a93189882a9f440693a0c5bb__model_vars(void);</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; // prj-specific differential eqns</span></span>
<span><span class="co">#&gt; void rx_8af2d396a93189882a9f440693a0c5bb__dydt(int *_neq, double __t, double *__zzStateVar__, double *__DDtStateVar__)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   int _cSub = _neq[1];</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_neq[1]].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=1;</span></span>
<span><span class="co">#&gt;   double CL = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V = NA_REAL;</span></span>
<span><span class="co">#&gt;   double KA = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_CL = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_V = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_KA = NA_REAL;</span></span>
<span><span class="co">#&gt;   double _rxNotFun_abs = NA_REAL;</span></span>
<span><span class="co">#&gt;   double centr = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C2 = NA_REAL;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   (void)CL;</span></span>
<span><span class="co">#&gt;   (void)V;</span></span>
<span><span class="co">#&gt;   (void)KA;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_CL;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_V;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_KA;</span></span>
<span><span class="co">#&gt;   (void)_rxNotFun_abs;</span></span>
<span><span class="co">#&gt;   (void)centr;</span></span>
<span><span class="co">#&gt;   (void)C2;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   CL = _PL[0];</span></span>
<span><span class="co">#&gt;   V = _PL[1];</span></span>
<span><span class="co">#&gt;   KA = _PL[2];</span></span>
<span><span class="co">#&gt;   C2 = _PL[3];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _update_par_ptr(__t, _cSub, _solveData, _idx);</span></span>
<span><span class="co">#&gt;   eta_DoT_CL = _PP[0];</span></span>
<span><span class="co">#&gt;   eta_DoT_V = _PP[1];</span></span>
<span><span class="co">#&gt;   eta_DoT_KA = _PP[2];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _rxNotFun_abs = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">#&gt;   centr = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   CL=_safe_log(4);</span></span>
<span><span class="co">#&gt;   V=_safe_log(70);</span></span>
<span><span class="co">#&gt;   KA=_safe_log(1);</span></span>
<span><span class="co">#&gt;   CL=exp(CL+eta_DoT_CL);</span></span>
<span><span class="co">#&gt;   V=exp(V+eta_DoT_V);</span></span>
<span><span class="co">#&gt;   KA=exp(KA+eta_DoT_KA);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT0__] = ((double)(_ON[__DDT0__]))*(_IR[__DDT0__] -KA*_rxNotFun_abs);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT1__] = ((double)(_ON[__DDT1__]))*(_IR[__DDT1__] + KA*_rxNotFun_abs-(CL/_div0(V))*centr);</span></span>
<span><span class="co">#&gt;   C2=centr/_div0(V);</span></span>
<span><span class="co">#&gt;   (&amp;_solveData-&gt;subjects[_cSub])-&gt;dadt_counter[0]++;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; // Jacobian derived vars</span></span>
<span><span class="co">#&gt; void rx_8af2d396a93189882a9f440693a0c5bb__calc_jac(int *_neq, double __t, double *__zzStateVar__, double *__PDStateVar__, unsigned int __NROWPD__) {</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;     int _cSub=_neq[1];</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_neq[1]].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=2;</span></span>
<span><span class="co">#&gt;   (&amp;_solveData-&gt;subjects[_cSub])-&gt;jac_counter[0]++;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Functional based initial conditions.</span></span>
<span><span class="co">#&gt; void rx_8af2d396a93189882a9f440693a0c5bb__inis(int _cSub, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;  _ind-&gt;_rxFlag=3;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // prj-specific derived vars</span></span>
<span><span class="co">#&gt; void rx_8af2d396a93189882a9f440693a0c5bb__calc_lhs(int _cSub, double __t, double *__zzStateVar__, double *_lhs) {</span></span>
<span><span class="co">#&gt;     int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=11;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_0__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_1__;</span></span>
<span><span class="co">#&gt;   double CL = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V = NA_REAL;</span></span>
<span><span class="co">#&gt;   double KA = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_CL = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_V = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_KA = NA_REAL;</span></span>
<span><span class="co">#&gt;   double _rxNotFun_abs = NA_REAL;</span></span>
<span><span class="co">#&gt;   double centr = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C2 = NA_REAL;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_0__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_1__;</span></span>
<span><span class="co">#&gt;   (void)CL;</span></span>
<span><span class="co">#&gt;   (void)V;</span></span>
<span><span class="co">#&gt;   (void)KA;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_CL;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_V;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_KA;</span></span>
<span><span class="co">#&gt;   (void)_rxNotFun_abs;</span></span>
<span><span class="co">#&gt;   (void)centr;</span></span>
<span><span class="co">#&gt;   (void)C2;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   CL = _PL[0];</span></span>
<span><span class="co">#&gt;   V = _PL[1];</span></span>
<span><span class="co">#&gt;   KA = _PL[2];</span></span>
<span><span class="co">#&gt;   C2 = _PL[3];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _update_par_ptr(__t, _cSub, _solveData, _idx);</span></span>
<span><span class="co">#&gt;   eta_DoT_CL = _PP[0];</span></span>
<span><span class="co">#&gt;   eta_DoT_V = _PP[1];</span></span>
<span><span class="co">#&gt;   eta_DoT_KA = _PP[2];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _rxNotFun_abs = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">#&gt;   centr = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   CL=_safe_log(4);</span></span>
<span><span class="co">#&gt;   V=_safe_log(70);</span></span>
<span><span class="co">#&gt;   KA=_safe_log(1);</span></span>
<span><span class="co">#&gt;   CL=exp(CL+eta_DoT_CL);</span></span>
<span><span class="co">#&gt;   V=exp(V+eta_DoT_V);</span></span>
<span><span class="co">#&gt;   KA=exp(KA+eta_DoT_KA);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_0__ = ((double)(_ON[__DDT0__]))*(_IR[__DDT0__] -KA*_rxNotFun_abs);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_1__ = ((double)(_ON[__DDT1__]))*(_IR[__DDT1__] + KA*_rxNotFun_abs-(CL/_div0(V))*centr);</span></span>
<span><span class="co">#&gt;   C2=centr/_div0(V);</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _lhs[_LHS_0_]=CL;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_1_]=V;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_2_]=KA;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_3_]=C2;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Functional based bioavailability</span></span>
<span><span class="co">#&gt; double rx_8af2d396a93189882a9f440693a0c5bb__F(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return _amt;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; // Functional based absorption lag</span></span>
<span><span class="co">#&gt; double rx_8af2d396a93189882a9f440693a0c5bb__Lag(int _cSub,  int _cmt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return __t;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Modeled zero-order rate</span></span>
<span><span class="co">#&gt; double rx_8af2d396a93189882a9f440693a0c5bb__Rate(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return 0.0;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Modeled zero-order duration</span></span>
<span><span class="co">#&gt; double rx_8af2d396a93189882a9f440693a0c5bb__Dur(int _cSub,  int _cmt, double _amt, double __t){</span></span>
<span><span class="co">#&gt;  return 0.0;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Model Times</span></span>
<span><span class="co">#&gt; void rx_8af2d396a93189882a9f440693a0c5bb__mtime(int _cSub, double *_mtime){</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Matrix Exponential (0)</span></span>
<span><span class="co">#&gt; void rx_8af2d396a93189882a9f440693a0c5bb__ME(int _cSub, double _t, double __t, double *_mat, const double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=9;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Inductive linearization Matf</span></span>
<span><span class="co">#&gt; void rx_8af2d396a93189882a9f440693a0c5bb__IndF(int _cSub, double _t, double __t, double *_matf){</span></span>
<span><span class="co">#&gt;  int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=10;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern SEXP rx_8af2d396a93189882a9f440693a0c5bb__model_vars(void){</span></span>
<span><span class="co">#&gt;   int pro=0;</span></span>
<span><span class="co">#&gt;   SEXP _mv = PROTECT(_rxGetModelLib("rx_8af2d396a93189882a9f440693a0c5bb__model_vars"));pro++;</span></span>
<span><span class="co">#&gt;   if (!_rxIsCurrentC(_mv)){</span></span>
<span><span class="co">#&gt;     SEXP hash    = PROTECT(Rf_allocVector(STRSXP, 1));pro++;</span></span>
<span><span class="co">#&gt; #define __doBuf__  snprintf(buf, __doBufN__, "un]\"BAAA@QRtHACAAAAAAAN/8AAAv7#aT)rtJFPASOp:h\"P*Tu1)3r9jjOr1l4\"jTwvVUy3_D3Q|n%%$fp$XMB&gt;T=HoOj4[MX$@U\?X$qW;`Mo@uuV=}jJTQ]Kn~_MuWYLKt]}rd4dHM$GuZgKHZF&amp;_}0``.^4L7K/G&gt;f8.U5%%38Or5+;s\"gZ)EUs00:Lz!DBjh9b~W}3a3|TxU)YHu6R`hq;JaS=sVXo:f4]M,z(;#IWjl\"npA.On`0mpy*hrnf[Pk*h^$/)4X^MBq=&gt;MbxAh#.T&amp;&gt;XttkrA@J@9CP=mHB`WSS=5|gax)\"SZxR9]7hGN6Z*8DGQSkTbTC.NwXX}SZD6Sqe&gt;.Vyizgzg+gbj%%JnS7tJ}v5j1SYoCFQ:Tn/\?XjCy;.Y8]yDI9{)/HC|1n9t[*G_UeJ6PTq!B`A@u[jAOghc==R=n/E8A@8X9]jtcJVf.d&lt;W@Eeb#59YHGlq9R4vSAh@hUsUQt1pRY{k4u^)[M.;`^&amp;:7TPj[^4e,(4[QebjY)*/p9D)~`8e!N^P$bLf3~|Jb=XJ{Bug&lt;7::C&lt;t&gt;P5o.xqtz[z/OfR=#.dXoFxT]]`~{!b=)/|jdi1zdeXy\?&gt;pa{jb/izV\"\?5yl|Q;=eJ4$L\"&amp;K:P)sVolRI=[KC%%G&lt;I25mHsVgS(Aa;:ZN&amp;G&amp;NHy*;jj&amp;ie_gH.&gt;6P:fp3HZeZg#/5rtWi$McW/]BoXnrt8)be~Sdb^&lt;mm=`gQdwS\?vV+fw^)6GK|*ps&amp;ucHGA{7^B&amp;^fgXt]yL5kE;2NmWNp1:C_JBlpO1ftLd#eyX/n(&gt;ud:~|V=s[F{}SLV,7fM|L0zXGXo|werZsN9YT.Rhq;K84.n#)aaEP1LT\?0@jYF~wILKObvPAdZMOe+VF3\"2+ORPJv+hZ_t}kjL;CDdA8.y:C`wY0Sd\")OO5YJbbzF5Y&lt;}.H3:Vu+/h@Py!)&gt;\"|}*cvyGAyw!}4`+Jv!Xn^.6IcCLXi%%navuO!ymTVV1CjGiKZ*ScPD\"&lt;R*Iv\"|O3qz{z}HNdh^b@7l}be6gTw9}{y(f)+D%%|7Q$!C;U0Ffr}:Wy2,cA31;=&gt;dsJ3SInl^j7cP]w_P2_D]OS/G([d((\?j&gt;ew.#2Vdp0MH;38oKcxcyghYGqY_.b[|Wz413wNNKkEYT*}P4mjn3;kX|xlXNR&amp;@S&amp;@MZCgP\"OeKu{i4hZ46}.7lB%%jt$Dx`!3HZq.[iL*9X3w9{SQ*&lt;Zx60&lt;\?_c#.}jBrjg2wyqAiHkqGgCyA");</span></span>
<span><span class="co">#&gt;     char buf[1238];</span></span>
<span><span class="co">#&gt; #define __doBufN__ 1238</span></span>
<span><span class="co">#&gt;     __doBuf__</span></span>
<span><span class="co">#&gt; #undef __doBuf__</span></span>
<span><span class="co">#&gt; #undef __doBufN__</span></span>
<span><span class="co">#&gt;     SET_STRING_ELT(hash, 0, Rf_mkChar(buf));</span></span>
<span><span class="co">#&gt;     SEXP lst      = PROTECT(_rxQr(hash));pro++;</span></span>
<span><span class="co">#&gt;     _assign_ptr(lst);</span></span>
<span><span class="co">#&gt;     UNPROTECT(pro);</span></span>
<span><span class="co">#&gt;     return lst;</span></span>
<span><span class="co">#&gt;   } else {</span></span>
<span><span class="co">#&gt;     UNPROTECT(pro);</span></span>
<span><span class="co">#&gt;     return _mv;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void rx_8af2d396a93189882a9f440693a0c5bb__dydt_lsoda(int *neq, double *t, double *A, double *DADT)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   rx_8af2d396a93189882a9f440693a0c5bb__dydt(neq, *t, A, DADT);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern int rx_8af2d396a93189882a9f440693a0c5bb__dydt_liblsoda(double __t, double *y, double *ydot, void *data)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   int *neq = (int*)(data);</span></span>
<span><span class="co">#&gt;   rx_8af2d396a93189882a9f440693a0c5bb__dydt(neq, __t, y, ydot);</span></span>
<span><span class="co">#&gt;   return(0);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void rx_8af2d396a93189882a9f440693a0c5bb__calc_jac_lsoda(int *neq, double *t, double *A,int *ml, int *mu, double *JAC, int *nrowpd){</span></span>
<span><span class="co">#&gt;   // Update all covariate parameters</span></span>
<span><span class="co">#&gt;   rx_8af2d396a93189882a9f440693a0c5bb__calc_jac(neq, *t, A, JAC, *nrowpd);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; //Create function to call from R's main thread that assigns the required functions. Sometimes they don't get assigned.</span></span>
<span><span class="co">#&gt; extern void rx_8af2d396a93189882a9f440693a0c5bb__assignFuns(void){</span></span>
<span><span class="co">#&gt;   _assignFuns();</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; //Initialize the dll to match rxode2's calls</span></span>
<span><span class="co">#&gt; void R_init0_rx_8af2d396a93189882a9f440693a0c5bb_(void){</span></span>
<span><span class="co">#&gt;   // Get C callables on load; Otherwise it isn't thread safe</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_8af2d396a93189882a9f440693a0c5bb_","rx_8af2d396a93189882a9f440693a0c5bb__assignFuns2", (DL_FUNC) __assignFuns2);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_8af2d396a93189882a9f440693a0c5bb_","rx_8af2d396a93189882a9f440693a0c5bb__assignFuns", (DL_FUNC) rx_8af2d396a93189882a9f440693a0c5bb__assignFuns);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_8af2d396a93189882a9f440693a0c5bb_","rx_8af2d396a93189882a9f440693a0c5bb__inis",(DL_FUNC) rx_8af2d396a93189882a9f440693a0c5bb__inis);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_8af2d396a93189882a9f440693a0c5bb_","rx_8af2d396a93189882a9f440693a0c5bb__dydt",(DL_FUNC) rx_8af2d396a93189882a9f440693a0c5bb__dydt);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_8af2d396a93189882a9f440693a0c5bb_","rx_8af2d396a93189882a9f440693a0c5bb__calc_lhs",(DL_FUNC) rx_8af2d396a93189882a9f440693a0c5bb__calc_lhs);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_8af2d396a93189882a9f440693a0c5bb_","rx_8af2d396a93189882a9f440693a0c5bb__calc_jac",(DL_FUNC) rx_8af2d396a93189882a9f440693a0c5bb__calc_jac);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_8af2d396a93189882a9f440693a0c5bb_","rx_8af2d396a93189882a9f440693a0c5bb__dydt_lsoda", (DL_FUNC) rx_8af2d396a93189882a9f440693a0c5bb__dydt_lsoda);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_8af2d396a93189882a9f440693a0c5bb_","rx_8af2d396a93189882a9f440693a0c5bb__calc_jac_lsoda", (DL_FUNC) rx_8af2d396a93189882a9f440693a0c5bb__calc_jac_lsoda);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_8af2d396a93189882a9f440693a0c5bb_","rx_8af2d396a93189882a9f440693a0c5bb__ode_solver_solvedata", (DL_FUNC) rx_8af2d396a93189882a9f440693a0c5bb__ode_solver_solvedata);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_8af2d396a93189882a9f440693a0c5bb_","rx_8af2d396a93189882a9f440693a0c5bb__ode_solver_get_solvedata", (DL_FUNC) rx_8af2d396a93189882a9f440693a0c5bb__ode_solver_get_solvedata);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_8af2d396a93189882a9f440693a0c5bb_","rx_8af2d396a93189882a9f440693a0c5bb__F", (DL_FUNC) rx_8af2d396a93189882a9f440693a0c5bb__F);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_8af2d396a93189882a9f440693a0c5bb_","rx_8af2d396a93189882a9f440693a0c5bb__Lag", (DL_FUNC) rx_8af2d396a93189882a9f440693a0c5bb__Lag);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_8af2d396a93189882a9f440693a0c5bb_","rx_8af2d396a93189882a9f440693a0c5bb__Rate", (DL_FUNC) rx_8af2d396a93189882a9f440693a0c5bb__Rate);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_8af2d396a93189882a9f440693a0c5bb_","rx_8af2d396a93189882a9f440693a0c5bb__Dur", (DL_FUNC) rx_8af2d396a93189882a9f440693a0c5bb__Dur);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_8af2d396a93189882a9f440693a0c5bb_","rx_8af2d396a93189882a9f440693a0c5bb__mtime", (DL_FUNC) rx_8af2d396a93189882a9f440693a0c5bb__mtime);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_8af2d396a93189882a9f440693a0c5bb_","rx_8af2d396a93189882a9f440693a0c5bb__ME", (DL_FUNC) rx_8af2d396a93189882a9f440693a0c5bb__ME);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_8af2d396a93189882a9f440693a0c5bb_","rx_8af2d396a93189882a9f440693a0c5bb__IndF", (DL_FUNC) rx_8af2d396a93189882a9f440693a0c5bb__IndF);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_8af2d396a93189882a9f440693a0c5bb_","rx_8af2d396a93189882a9f440693a0c5bb__dydt_liblsoda", (DL_FUNC) rx_8af2d396a93189882a9f440693a0c5bb__dydt_liblsoda);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; //Initialize the dll to match rxode2's calls</span></span>
<span><span class="co">#&gt; void R_init_rx_8af2d396a93189882a9f440693a0c5bb_(DllInfo *info){</span></span>
<span><span class="co">#&gt;   // Get C callables on load; Otherwise it isn't thread safe</span></span>
<span><span class="co">#&gt;   R_init0_rx_8af2d396a93189882a9f440693a0c5bb_();</span></span>
<span><span class="co">#&gt;   static const R_CallMethodDef callMethods[]  = {</span></span>
<span><span class="co">#&gt;     {"rx_8af2d396a93189882a9f440693a0c5bb__model_vars", (DL_FUNC) &amp;rx_8af2d396a93189882a9f440693a0c5bb__model_vars, 0},</span></span>
<span><span class="co">#&gt;     {NULL, NULL, 0}</span></span>
<span><span class="co">#&gt;   };</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   R_registerRoutines(info, NULL, callMethods, NULL, NULL);</span></span>
<span><span class="co">#&gt;   R_useDynamicSymbols(info,FALSE);</span></span>
<span><span class="co">#&gt;   _assignFuns0();</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; void R_unload_rx_8af2d396a93189882a9f440693a0c5bb_ (DllInfo *info){</span></span>
<span><span class="co">#&gt;   // Free resources required for single subject solve.</span></span>
<span><span class="co">#&gt;   SEXP _mv = PROTECT(_rxGetModelLib("rx_8af2d396a93189882a9f440693a0c5bb__model_vars"));</span></span>
<span><span class="co">#&gt;   if (!Rf_isNull(_mv)){</span></span>
<span><span class="co">#&gt;     _rxRmModelLib("rx_8af2d396a93189882a9f440693a0c5bb__model_vars");</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   UNPROTECT(1);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’</span></span>
<span></span>
<span><span class="va">omega</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://nlmixr2.github.io/lotri/reference/lotri.html" class="external-link">lotri</a></span><span class="op">(</span><span class="va">eta.CL</span> <span class="op">~</span> <span class="fl">0.09</span>,</span>
<span>               <span class="va">eta.V</span> <span class="op">~</span> <span class="fl">0.09</span>,</span>
<span>               <span class="va">eta.KA</span> <span class="op">~</span> <span class="fl">0.09</span><span class="op">)</span></span>
<span></span>
<span><span class="va">doses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">30</span>, <span class="fl">60</span>, <span class="fl">120</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">startParallel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">ev</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">doses</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">{</span></span>
<span>            <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>                <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>amt<span class="op">=</span><span class="va">doses</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Add single dose</span></span>
<span>                <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Add 0 observation</span></span>
<span>                <span class="co">## Generate 4 samples in 24 hour period</span></span>
<span>                <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">24</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>                <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">nsubg</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">nsubg</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>                <span class="co">## Convert to data frame to skip sorting the data</span></span>
<span>                <span class="co">## When binding the data together</span></span>
<span>                <span class="va">as.data.frame</span></span>
<span>        <span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## To better compare, use the same output, that is data.table</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rxSolve.html">rxSolve</a></span><span class="op">(</span><span class="va">rx</span>, <span class="va">ev</span>, omega<span class="op">=</span><span class="va">omega</span>, returnType<span class="op">=</span><span class="st">"data.table"</span><span class="op">)</span></span>
<span><span class="va">endParallel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">endParallel</span> <span class="op">-</span> <span class="va">startParallel</span><span class="op">)</span></span>
<span><span class="co">#&gt; Time difference of 0.1220148 secs</span></span></code></pre></div>
<p>You can see a striking time difference between the two methods; A few
things to keep in mind:</p>
<ul>
<li><p><code>rxode2</code> use the thread-safe sitmo
<code>threefry</code> routines for simulation of <code>eta</code>
values. Therefore the results are expected to be different (also the
random samples are taken in a different order which would be
different)</p></li>
<li><p>This prior simulation was run in R 3.5, which has a different
random number generator so the results in this simulation will be
different from the actual nlmixr comparison when using the slower
simulation.</p></li>
<li><p>This speed comparison used <code>data.table</code>.
<code>rxode2</code> uses <code>data.table</code> internally (when
available) try to speed up sorting, so this would be different than
installations where <code>data.table</code> is not installed. You can
force rxode2 to use <code><a href="https://rdrr.io/r/base/order.html" class="external-link">order()</a></code> when sorting by using
<code>forderForceBase(TRUE)</code>. In this case there is little
difference between the two, though in other examples
<code>data.table</code>’s presence leads to a speed increase (and less
likely it could lead to a slowdown).</p></li>
</ul>
<div class="section level3">
<h3 id="want-more-ways-to-run-multi-subject-simulations">Want more ways to run multi-subject simulations<a class="anchor" aria-label="anchor" href="#want-more-ways-to-run-multi-subject-simulations"></a>
</h3>
<p>The version since the tutorial has even more ways to run
multi-subject simulations, including adding variability in sampling and
dosing times with <code><a href="../reference/et.html">et()</a></code> (see <a href="https://nlmixr2.github.io/rxode2/articles/rxode2-events.html#add-doses-and-samples-within-a-sampling-window">rxode2
events</a> for more information), ability to supply both an
<code>omega</code> and <code>sigma</code> matrix as well as adding as a
<code>thetaMat</code> to R to simulate with uncertainty in the
<code>omega</code>, <code>sigma</code> and <code>theta</code> matrices;
see <a href="https://nlmixr2.github.io/rxode2/articles/rxode2-sim-var.html">rxode2
simulation vignette</a>.</p>
</div>
<div class="section level3">
<h3 id="session-information">Session Information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h3>
<p>The session information:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.1 (2025-06-13)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 24.04.2 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] MASS_7.3-65          data.table_1.17.8    ggplot2_3.5.2       </span></span>
<span><span class="co">#&gt; [4] microbenchmark_1.5.0 rxode2_4.0.2        </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] sass_0.4.10         generics_0.1.4      lattice_0.22-7     </span></span>
<span><span class="co">#&gt;  [4] digest_0.6.37       magrittr_2.0.3      evaluate_1.0.4     </span></span>
<span><span class="co">#&gt;  [7] grid_4.5.1          RColorBrewer_1.1-3  fastmap_1.2.0      </span></span>
<span><span class="co">#&gt; [10] lotri_1.0.1         jsonlite_2.0.0      rxode2ll_2.0.13    </span></span>
<span><span class="co">#&gt; [13] backports_1.5.0     scales_1.4.0        lazyeval_0.2.2     </span></span>
<span><span class="co">#&gt; [16] textshaping_1.0.1   jquerylib_0.1.4     RApiSerialize_0.1.4</span></span>
<span><span class="co">#&gt; [19] cli_3.6.5           rlang_1.1.6         symengine_0.2.10   </span></span>
<span><span class="co">#&gt; [22] crayon_1.5.3        units_0.8-7         withr_3.0.2        </span></span>
<span><span class="co">#&gt; [25] cachem_1.1.0        yaml_2.3.10         tools_4.5.1        </span></span>
<span><span class="co">#&gt; [28] qs_0.27.3           memoise_2.0.1       checkmate_2.3.2    </span></span>
<span><span class="co">#&gt; [31] dplyr_1.1.4         vctrs_0.6.5         R6_2.6.1           </span></span>
<span><span class="co">#&gt; [34] lifecycle_1.0.4     fs_1.6.6            stringfish_0.17.0  </span></span>
<span><span class="co">#&gt; [37] htmlwidgets_1.6.4   ragg_1.4.0          PreciseSums_0.7    </span></span>
<span><span class="co">#&gt; [40] pkgconfig_2.0.3     desc_1.4.3          pkgdown_2.1.3      </span></span>
<span><span class="co">#&gt; [43] RcppParallel_5.1.10 rex_1.2.1           pillar_1.11.0      </span></span>
<span><span class="co">#&gt; [46] bslib_0.9.0         gtable_0.3.6        glue_1.8.0         </span></span>
<span><span class="co">#&gt; [49] Rcpp_1.1.0          systemfonts_1.2.3   xfun_0.52          </span></span>
<span><span class="co">#&gt; [52] tibble_3.3.0        tidyselect_1.2.1    sys_3.4.3          </span></span>
<span><span class="co">#&gt; [55] knitr_1.50          farver_2.1.2        dparser_1.3.1-13   </span></span>
<span><span class="co">#&gt; [58] htmltools_0.5.8.1   nlme_3.1-168        labeling_0.4.3     </span></span>
<span><span class="co">#&gt; [61] rmarkdown_2.29      compiler_4.5.1</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthew L. Fidler, Wenping Wang, Melissa Hallow.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
