<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Speeding up rxode2 • rxode2</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Speeding up rxode2">
<meta name="google-site-verification" content="fp9A3qPrCar1DKeVQg4Mfrf6-An5keP9OwhIxUkntbU">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rxode2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">5.0.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-book"></span> Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Getting started</h6></li>
    <li><a class="dropdown-item" href="../articles/rxode2-syntax.html">rxode2 mini language syntax</a></li>
    <li><a class="dropdown-item" href="../articles/Modifying-Models.html">rxode2 model modification |&gt;</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-pipeline.html">rxode2 pipeline ie |&gt;</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-speed.html">Speeding up rxode2 ODE solving</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-data-frame.html">Adaptive Data Frames with rxode2</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-plot.html">Plotting with rxode2</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced Features, Model Types, Technical Details</h6></li>
    <li><a class="dropdown-item" href="../articles/rxode2-model-types.html">rxode2 model types</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-cmt.html">Chainging rxode2 compartment numbers</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-transit-compartments.html">rxode2 transit compartment models</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-shiny.html">Using Shiny with rxode2</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-covariates.html">rxode2 covariates</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-stiff.html">Stiff Systems and Jacobian specification</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-rxUse.html">Adding compiled rxode2 models to your package</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-dosing-events" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-stethoscope"></span> Dosing/Events</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-dosing-events">
<li><a class="dropdown-item" href="../articles/rxode2-datasets.html">nlmixr/rxode2 dataset overview</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-event-types.html">Supported Event Types</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-event-table.html">Easy rxode2 Event Tables</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-events-classic.html">Classic rxode2 events explained</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-simulations" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-desktop"></span> Simulations</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-simulations">
<li><a class="dropdown-item" href="../articles/rxode2-single-subject.html">Single Subject ODE solving</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-sim-var.html">Multiple Subject rxode2 Simulation</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-prior-data.html">Using Prior Data for ODE solving</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-help" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-life-ring"></span> Help</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-help">
<li><a class="dropdown-item" href="../articles/rxode2-tutorials.html">Running the interactive tutorials</a></li>
    <li><a class="external-link dropdown-item" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4728294/pdf/PSP4-5-03.pdf">2015 CPT tutorial</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/rxode2-covariates.html">Adding Circadian Rythmn (time-varying covariates)</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-wt.html">Weight Based Dosing</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-nesting.html">Simulating Multiple levels of nesting (iov, between study etc)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changes/News</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="https://nlmixr2.github.io/rxode2/reference/index.html"><span class="fa fa-file-code-o"></span> Functions</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-archive"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-">
<li><a class="dropdown-item" href="https://nlmixr2.github.io/rxode2-manual/">rxode2 User Guide</a></li>
    <li><a class="external-link dropdown-item" href="https://nlmixr2.org/">nlmixr2</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nlmixr2/rxode2"><span class="fa fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nlmixr2/rxode2/releases"><span class="fa fa-download"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Speeding up rxode2</h1>
                        <h4 data-toc-skip class="author">Matthew
Fidler</h4>
            
            <h4 data-toc-skip class="date">2026-01-06</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nlmixr2/rxode2/blob/main/vignettes/rxode2-speed.Rmd" class="external-link"><code>vignettes/rxode2-speed.Rmd</code></a></small>
      <div class="d-none name"><code>rxode2-speed.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="a-note-about-the-speed-of-the-functional-form-for-rxode2">A note about the speed of the functional form for rxode2<a class="anchor" aria-label="anchor" href="#a-note-about-the-speed-of-the-functional-form-for-rxode2"></a>
</h2>
<p>The functional form has the benefit that it is what is supported by
nlmixr2 and therefore there is only one interface between solving and
estimating, and it takes some computation time to get to the underlying
“classic” simulation code.</p>
<p>These models are in the form of:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlmixr2.github.io/rxode2/">rxode2</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; rxode2 5.0.1.9000 using 2 threads (see ?getRxThreads)</span></span>
<span><span class="co">#&gt;   no cache: create with `rxCreateCache()`</span></span>
<span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/ini.html">ini</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">KA</span>   <span class="op">&lt;-</span> <span class="fl">0.3</span></span>
<span>    <span class="va">CL</span>   <span class="op">&lt;-</span> <span class="fl">7</span></span>
<span>    <span class="va">V2</span>   <span class="op">&lt;-</span> <span class="fl">40</span></span>
<span>    <span class="va">Q</span>    <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span>    <span class="va">V3</span>   <span class="op">&lt;-</span> <span class="fl">300</span></span>
<span>    <span class="va">Kin</span>  <span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span>    <span class="va">Kout</span> <span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span>    <span class="va">EC50</span> <span class="op">&lt;-</span> <span class="fl">8</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/model.html">model</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">C2</span> <span class="op">=</span> <span class="va">centr</span><span class="op">/</span><span class="va">V2</span></span>
<span>    <span class="va">C3</span> <span class="op">=</span> <span class="va">peri</span><span class="op">/</span><span class="va">V3</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">depot</span><span class="op">)</span> <span class="op">=</span> <span class="op">-</span><span class="va">KA</span><span class="op">*</span><span class="va">depot</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">centr</span><span class="op">)</span> <span class="op">=</span> <span class="va">KA</span><span class="op">*</span><span class="va">depot</span> <span class="op">-</span> <span class="va">CL</span><span class="op">*</span><span class="va">C2</span> <span class="op">-</span> <span class="va">Q</span><span class="op">*</span><span class="va">C2</span> <span class="op">+</span> <span class="va">Q</span><span class="op">*</span><span class="va">C3</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">peri</span><span class="op">)</span> <span class="op">=</span> <span class="va">Q</span><span class="op">*</span><span class="va">C2</span> <span class="op">-</span> <span class="va">Q</span><span class="op">*</span><span class="va">C3</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">eff</span><span class="op">)</span> <span class="op">=</span> <span class="va">Kin</span> <span class="op">-</span> <span class="va">Kout</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">C2</span><span class="op">/</span><span class="op">(</span><span class="va">EC50</span><span class="op">+</span><span class="va">C2</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="va">eff</span></span>
<span>    <span class="fu">eff</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span> <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Or you can also specify the end-points for simulation/estimation just
like <code>nlmixr2</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod2f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/ini.html">ini</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">TKA</span>   <span class="op">&lt;-</span> <span class="fl">0.3</span></span>
<span>    <span class="va">TCL</span>   <span class="op">&lt;-</span> <span class="fl">7</span></span>
<span>    <span class="va">TV2</span>   <span class="op">&lt;-</span> <span class="fl">40</span></span>
<span>    <span class="va">TQ</span>    <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span>    <span class="va">TV3</span>   <span class="op">&lt;-</span> <span class="fl">300</span></span>
<span>    <span class="va">TKin</span>  <span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span>    <span class="va">TKout</span> <span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span>    <span class="va">TEC50</span> <span class="op">&lt;-</span> <span class="fl">8</span></span>
<span>    <span class="va">eta.cl</span> <span class="op">+</span> <span class="va">eta.v</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.09</span>,</span>
<span>                       <span class="fl">0.08</span>, <span class="fl">0.25</span><span class="op">)</span></span>
<span>    <span class="va">c2.prop.sd</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span>    <span class="va">eff.add.sd</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/model.html">model</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">KA</span> <span class="op">&lt;-</span> <span class="va">TKA</span></span>
<span>    <span class="va">CL</span> <span class="op">&lt;-</span> <span class="va">TCL</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">eta.cl</span><span class="op">)</span></span>
<span>    <span class="va">V2</span>  <span class="op">&lt;-</span> <span class="va">TV2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">eta.v</span><span class="op">)</span></span>
<span>    <span class="va">Q</span>   <span class="op">&lt;-</span> <span class="va">TQ</span></span>
<span>    <span class="va">V3</span>  <span class="op">&lt;-</span> <span class="va">TV3</span></span>
<span>    <span class="va">Kin</span>  <span class="op">&lt;-</span> <span class="va">TKin</span></span>
<span>    <span class="va">Kout</span> <span class="op">&lt;-</span> <span class="va">TKout</span></span>
<span>    <span class="va">EC50</span> <span class="op">&lt;-</span> <span class="va">TEC50</span></span>
<span>    <span class="va">C2</span> <span class="op">=</span> <span class="va">centr</span><span class="op">/</span><span class="va">V2</span></span>
<span>    <span class="va">C3</span> <span class="op">=</span> <span class="va">peri</span><span class="op">/</span><span class="va">V3</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">depot</span><span class="op">)</span> <span class="op">=</span> <span class="op">-</span><span class="va">KA</span><span class="op">*</span><span class="va">depot</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">centr</span><span class="op">)</span> <span class="op">=</span> <span class="va">KA</span><span class="op">*</span><span class="va">depot</span> <span class="op">-</span> <span class="va">CL</span><span class="op">*</span><span class="va">C2</span> <span class="op">-</span> <span class="va">Q</span><span class="op">*</span><span class="va">C2</span> <span class="op">+</span> <span class="va">Q</span><span class="op">*</span><span class="va">C3</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">peri</span><span class="op">)</span> <span class="op">=</span> <span class="va">Q</span><span class="op">*</span><span class="va">C2</span> <span class="op">-</span> <span class="va">Q</span><span class="op">*</span><span class="va">C3</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">eff</span><span class="op">)</span> <span class="op">=</span> <span class="va">Kin</span> <span class="op">-</span> <span class="va">Kout</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">C2</span><span class="op">/</span><span class="op">(</span><span class="va">EC50</span><span class="op">+</span><span class="va">C2</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="va">eff</span></span>
<span>    <span class="fu">eff</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span> <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="va">C2</span> <span class="op">~</span> <span class="fu">prop</span><span class="op">(</span><span class="va">c2.prop.sd</span><span class="op">)</span></span>
<span>    <span class="va">eff</span> <span class="op">~</span> <span class="fu">add</span><span class="op">(</span><span class="va">eff.add.sd</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>For every solve, there is a compile (or a cached compile) of the
underlying model. If you wish to speed this process up you can use the
two underlying <code>rxode2</code> classic models. This takes two
steps:</p>
<ul>
<li><p>Parsing/evaluating the model</p></li>
<li><p>Creating the simulation model</p></li>
</ul>
<p>The first step can be done by <code>rxode2(mod1)</code> or
<code>mod1()</code> (or for the second model too).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu">mod1</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">mod2f</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rxode2.html">rxode2</a></span><span class="op">(</span><span class="va">mod2f</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> parameter labels from comments are typically ignored in non-interactive mode</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Need to run with the source intact to parse comments</span></span></code></pre></div>
<p>The second step is to create the underlying “classic”
<code>rxode2</code> model, which can be done with two different
methods:<code>$simulationModel</code> and
<code>$simulationIniModel</code>. The <code>$simulationModel</code> will
provide the simulation code without the initial conditions pre-pended,
the <code>$simulationIniModel</code> will pre-pend the values. When the
endpoints are specified, the simulation code for each endpoint is also
output. You can see the differences below:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">$</span><span class="va">simulationModel</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">rxode2 </span>5.0.1.9000 model named <span style="color: #BBBB00; font-weight: bold;">rx_5f6f9bffa1cafee704f8082d85523d9a</span> model (<span style="color: #00BB00;">✔</span> <span style="color: #00BB00; font-weight: bold;">ready</span>). </span></span>
<span><span class="co">#&gt; DLL: /tmp/RtmpnLBzEe/rxode2/rx_5f6f9bffa1cafee704f8082d85523d9a__.rxd/rx_5f6f9bffa1cafee704f8082d85523d9a_.so</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Calculated Variables:</span></span>
<span><span class="co">#&gt; [1] "C2" "C3"</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── rxode2 Model Syntax ──</span></span></span>
<span><span class="co">#&gt; rxode2({</span></span>
<span><span class="co">#&gt;     param(KA, CL, V2, Q, V3, Kin, Kout, EC50)</span></span>
<span><span class="co">#&gt;     C2 = centr/V2</span></span>
<span><span class="co">#&gt;     C3 = peri/V3</span></span>
<span><span class="co">#&gt;     d/dt(depot) = -KA * depot</span></span>
<span><span class="co">#&gt;     d/dt(centr) = KA * depot - CL * C2 - Q * C2 + Q * C3</span></span>
<span><span class="co">#&gt;     d/dt(peri) = Q * C2 - Q * C3</span></span>
<span><span class="co">#&gt;     d/dt(eff) = Kin - Kout * (1 - C2/(EC50 + C2)) * eff</span></span>
<span><span class="co">#&gt;     eff(0) = 1</span></span>
<span><span class="co">#&gt; })</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">$</span><span class="va">simulationIniModel</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">rxode2 </span>5.0.1.9000 model named <span style="color: #BBBB00; font-weight: bold;">rx_1befdc058ab5e5bd878aed0a284f2f16</span> model (<span style="color: #00BB00;">✔</span> <span style="color: #00BB00; font-weight: bold;">ready</span>). </span></span>
<span><span class="co">#&gt; DLL: /tmp/RtmpnLBzEe/rxode2/rx_1befdc058ab5e5bd878aed0a284f2f16__.rxd/rx_1befdc058ab5e5bd878aed0a284f2f16_.so</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Calculated Variables:</span></span>
<span><span class="co">#&gt; [1] "C2" "C3"</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── rxode2 Model Syntax ──</span></span></span>
<span><span class="co">#&gt; rxode2({</span></span>
<span><span class="co">#&gt;     param(KA, CL, V2, Q, V3, Kin, Kout, EC50)</span></span>
<span><span class="co">#&gt;     KA = 0.3</span></span>
<span><span class="co">#&gt;     CL = 7</span></span>
<span><span class="co">#&gt;     V2 = 40</span></span>
<span><span class="co">#&gt;     Q = 10</span></span>
<span><span class="co">#&gt;     V3 = 300</span></span>
<span><span class="co">#&gt;     Kin = 0.2</span></span>
<span><span class="co">#&gt;     Kout = 0.2</span></span>
<span><span class="co">#&gt;     EC50 = 8</span></span>
<span><span class="co">#&gt;     C2 = centr/V2</span></span>
<span><span class="co">#&gt;     C3 = peri/V3</span></span>
<span><span class="co">#&gt;     d/dt(depot) = -KA * depot</span></span>
<span><span class="co">#&gt;     d/dt(centr) = KA * depot - CL * C2 - Q * C2 + Q * C3</span></span>
<span><span class="co">#&gt;     d/dt(peri) = Q * C2 - Q * C3</span></span>
<span><span class="co">#&gt;     d/dt(eff) = Kin - Kout * (1 - C2/(EC50 + C2)) * eff</span></span>
<span><span class="co">#&gt;     eff(0) = 1</span></span>
<span><span class="co">#&gt; })</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod2f</span><span class="op">$</span><span class="va">simulationModel</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">rxode2 </span>5.0.1.9000 model named <span style="color: #BBBB00; font-weight: bold;">rx_dc935a8ab94760a6b875705190d40221</span> model (<span style="color: #00BB00;">✔</span> <span style="color: #00BB00; font-weight: bold;">ready</span>). </span></span>
<span><span class="co">#&gt; DLL: /tmp/RtmpnLBzEe/rxode2/rx_dc935a8ab94760a6b875705190d40221__.rxd/rx_dc935a8ab94760a6b875705190d40221_.so</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Calculated Variables:</span></span>
<span><span class="co">#&gt;  [1] "KA"       "CL"       "V2"       "Q"        "V3"       "Kin"     </span></span>
<span><span class="co">#&gt;  [7] "Kout"     "EC50"     "C2"       "C3"       "ipredSim" "sim"     </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── rxode2 Model Syntax ──</span></span></span>
<span><span class="co">#&gt; rxode2({</span></span>
<span><span class="co">#&gt;     param(TKA, TCL, TV2, TQ, TV3, TKin, TKout, TEC50, c2.prop.sd, </span></span>
<span><span class="co">#&gt;         eff.add.sd, eta.cl, eta.v)</span></span>
<span><span class="co">#&gt;     KA = TKA</span></span>
<span><span class="co">#&gt;     CL = TCL * exp(eta.cl)</span></span>
<span><span class="co">#&gt;     V2 = TV2 * exp(eta.v)</span></span>
<span><span class="co">#&gt;     Q = TQ</span></span>
<span><span class="co">#&gt;     V3 = TV3</span></span>
<span><span class="co">#&gt;     Kin = TKin</span></span>
<span><span class="co">#&gt;     Kout = TKout</span></span>
<span><span class="co">#&gt;     EC50 = TEC50</span></span>
<span><span class="co">#&gt;     C2 = centr/V2</span></span>
<span><span class="co">#&gt;     C3 = peri/V3</span></span>
<span><span class="co">#&gt;     d/dt(depot) = -KA * depot</span></span>
<span><span class="co">#&gt;     d/dt(centr) = KA * depot - CL * C2 - Q * C2 + Q * C3</span></span>
<span><span class="co">#&gt;     d/dt(peri) = Q * C2 - Q * C3</span></span>
<span><span class="co">#&gt;     d/dt(eff) = Kin - Kout * (1 - C2/(EC50 + C2)) * eff</span></span>
<span><span class="co">#&gt;     eff(0) = 1</span></span>
<span><span class="co">#&gt;     if (CMT == 5) {</span></span>
<span><span class="co">#&gt;         rx_yj_ ~ 2</span></span>
<span><span class="co">#&gt;         rx_lambda_ ~ 1</span></span>
<span><span class="co">#&gt;         rx_low_ ~ 0</span></span>
<span><span class="co">#&gt;         rx_hi_ ~ 1</span></span>
<span><span class="co">#&gt;         rx_pred_f_ ~ C2</span></span>
<span><span class="co">#&gt;         rx_pred_ ~ rx_pred_f_</span></span>
<span><span class="co">#&gt;         rx_r_ ~ (rx_pred_f_ * c2.prop.sd)^2</span></span>
<span><span class="co">#&gt;         ipredSim = rxTBSi(rx_pred_, rx_lambda_, rx_yj_, rx_low_, </span></span>
<span><span class="co">#&gt;             rx_hi_)</span></span>
<span><span class="co">#&gt;         sim = rxTBSi(rx_pred_ + sqrt(rx_r_) * rxerr.C2, rx_lambda_, </span></span>
<span><span class="co">#&gt;             rx_yj_, rx_low_, rx_hi_)</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     if (CMT == 4) {</span></span>
<span><span class="co">#&gt;         rx_yj_ ~ 2</span></span>
<span><span class="co">#&gt;         rx_lambda_ ~ 1</span></span>
<span><span class="co">#&gt;         rx_low_ ~ 0</span></span>
<span><span class="co">#&gt;         rx_hi_ ~ 1</span></span>
<span><span class="co">#&gt;         rx_pred_f_ ~ eff</span></span>
<span><span class="co">#&gt;         rx_pred_ ~ rx_pred_f_</span></span>
<span><span class="co">#&gt;         rx_r_ ~ (eff.add.sd)^2</span></span>
<span><span class="co">#&gt;         ipredSim = rxTBSi(rx_pred_, rx_lambda_, rx_yj_, rx_low_, </span></span>
<span><span class="co">#&gt;             rx_hi_)</span></span>
<span><span class="co">#&gt;         sim = rxTBSi(rx_pred_ + sqrt(rx_r_) * rxerr.eff, rx_lambda_, </span></span>
<span><span class="co">#&gt;             rx_yj_, rx_low_, rx_hi_)</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     cmt(C2)</span></span>
<span><span class="co">#&gt;     dvid(5, 4)</span></span>
<span><span class="co">#&gt; })</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod2f</span><span class="op">$</span><span class="va">simulationIniModel</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">rxode2 </span>5.0.1.9000 model named <span style="color: #BBBB00; font-weight: bold;">rx_5e2b3054279e7ff3ab0d8e9589a76904</span> model (<span style="color: #00BB00;">✔</span> <span style="color: #00BB00; font-weight: bold;">ready</span>). </span></span>
<span><span class="co">#&gt; DLL: /tmp/RtmpnLBzEe/rxode2/rx_5e2b3054279e7ff3ab0d8e9589a76904__.rxd/rx_5e2b3054279e7ff3ab0d8e9589a76904_.so</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Calculated Variables:</span></span>
<span><span class="co">#&gt;  [1] "KA"       "CL"       "V2"       "Q"        "V3"       "Kin"     </span></span>
<span><span class="co">#&gt;  [7] "Kout"     "EC50"     "C2"       "C3"       "ipredSim" "sim"     </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── rxode2 Model Syntax ──</span></span></span>
<span><span class="co">#&gt; rxode2({</span></span>
<span><span class="co">#&gt;     param(TKA, TCL, TV2, TQ, TV3, TKin, TKout, TEC50, c2.prop.sd, </span></span>
<span><span class="co">#&gt;         eff.add.sd, eta.cl, eta.v)</span></span>
<span><span class="co">#&gt;     rxerr.C2 = 1</span></span>
<span><span class="co">#&gt;     rxerr.eff = 1</span></span>
<span><span class="co">#&gt;     TKA = 0.3</span></span>
<span><span class="co">#&gt;     TCL = 7</span></span>
<span><span class="co">#&gt;     TV2 = 40</span></span>
<span><span class="co">#&gt;     TQ = 10</span></span>
<span><span class="co">#&gt;     TV3 = 300</span></span>
<span><span class="co">#&gt;     TKin = 0.2</span></span>
<span><span class="co">#&gt;     TKout = 0.2</span></span>
<span><span class="co">#&gt;     TEC50 = 8</span></span>
<span><span class="co">#&gt;     c2.prop.sd = 0.1</span></span>
<span><span class="co">#&gt;     eff.add.sd = 0.1</span></span>
<span><span class="co">#&gt;     eta.cl = 0</span></span>
<span><span class="co">#&gt;     eta.v = 0</span></span>
<span><span class="co">#&gt;     KA = TKA</span></span>
<span><span class="co">#&gt;     CL = TCL * exp(eta.cl)</span></span>
<span><span class="co">#&gt;     V2 = TV2 * exp(eta.v)</span></span>
<span><span class="co">#&gt;     Q = TQ</span></span>
<span><span class="co">#&gt;     V3 = TV3</span></span>
<span><span class="co">#&gt;     Kin = TKin</span></span>
<span><span class="co">#&gt;     Kout = TKout</span></span>
<span><span class="co">#&gt;     EC50 = TEC50</span></span>
<span><span class="co">#&gt;     C2 = centr/V2</span></span>
<span><span class="co">#&gt;     C3 = peri/V3</span></span>
<span><span class="co">#&gt;     d/dt(depot) = -KA * depot</span></span>
<span><span class="co">#&gt;     d/dt(centr) = KA * depot - CL * C2 - Q * C2 + Q * C3</span></span>
<span><span class="co">#&gt;     d/dt(peri) = Q * C2 - Q * C3</span></span>
<span><span class="co">#&gt;     d/dt(eff) = Kin - Kout * (1 - C2/(EC50 + C2)) * eff</span></span>
<span><span class="co">#&gt;     eff(0) = 1</span></span>
<span><span class="co">#&gt;     if (CMT == 5) {</span></span>
<span><span class="co">#&gt;         rx_yj_ ~ 2</span></span>
<span><span class="co">#&gt;         rx_lambda_ ~ 1</span></span>
<span><span class="co">#&gt;         rx_low_ ~ 0</span></span>
<span><span class="co">#&gt;         rx_hi_ ~ 1</span></span>
<span><span class="co">#&gt;         rx_pred_f_ ~ C2</span></span>
<span><span class="co">#&gt;         rx_pred_ ~ rx_pred_f_</span></span>
<span><span class="co">#&gt;         rx_r_ ~ (rx_pred_f_ * c2.prop.sd)^2</span></span>
<span><span class="co">#&gt;         ipredSim = rxTBSi(rx_pred_, rx_lambda_, rx_yj_, rx_low_, </span></span>
<span><span class="co">#&gt;             rx_hi_)</span></span>
<span><span class="co">#&gt;         sim = rxTBSi(rx_pred_ + sqrt(rx_r_) * rxerr.C2, rx_lambda_, </span></span>
<span><span class="co">#&gt;             rx_yj_, rx_low_, rx_hi_)</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     if (CMT == 4) {</span></span>
<span><span class="co">#&gt;         rx_yj_ ~ 2</span></span>
<span><span class="co">#&gt;         rx_lambda_ ~ 1</span></span>
<span><span class="co">#&gt;         rx_low_ ~ 0</span></span>
<span><span class="co">#&gt;         rx_hi_ ~ 1</span></span>
<span><span class="co">#&gt;         rx_pred_f_ ~ eff</span></span>
<span><span class="co">#&gt;         rx_pred_ ~ rx_pred_f_</span></span>
<span><span class="co">#&gt;         rx_r_ ~ (eff.add.sd)^2</span></span>
<span><span class="co">#&gt;         ipredSim = rxTBSi(rx_pred_, rx_lambda_, rx_yj_, rx_low_, </span></span>
<span><span class="co">#&gt;             rx_hi_)</span></span>
<span><span class="co">#&gt;         sim = rxTBSi(rx_pred_ + sqrt(rx_r_) * rxerr.eff, rx_lambda_, </span></span>
<span><span class="co">#&gt;             rx_yj_, rx_low_, rx_hi_)</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     cmt(C2)</span></span>
<span><span class="co">#&gt;     dvid(5, 4)</span></span>
<span><span class="co">#&gt; })</span></span></code></pre></div>
<p>If you wish to speed up multiple simualtions from the
<code>rxode2</code> functions, you need to pre-calculate care of the
steps above:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="va">mod1</span><span class="op">$</span><span class="va">simulationModel</span></span>
<span></span>
<span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="va">mod2f</span><span class="op">$</span><span class="va">simulationModel</span></span></code></pre></div>
<p>These functions then can act like a normal ui model to be solved. You
can convert them back to a UI <code><a href="../reference/as.rxUi.html">as.rxUi()</a></code> or a function
<code><a href="https://rdrr.io/r/base/as.function.html" class="external-link">as.function()</a></code> as needed.</p>
<p>To increase speed for multiple simulations from the same model you
should use the lower level simulation model (ie
<code>$simulationModel</code> or <code>$simulationIniModel</code>
depending on what you need)</p>
</div>
<div class="section level2">
<h2 id="increasing-rxode2-speed-by-multi-subject-parallel-solving">Increasing rxode2 speed by multi-subject parallel solving<a class="anchor" aria-label="anchor" href="#increasing-rxode2-speed-by-multi-subject-parallel-solving"></a>
</h2>
<p>Using the classic <code>rxode2</code> model specification (which we
can convert from a functional/ui model style) we will continue the
discussion on <code>rxode2</code> speed enhancements.</p>
<p><code>rxode2</code> originally developed as an ODE solver that
allowed an ODE solve for a single subject. This flexibility is still
supported.</p>
<p>The original code from the <code>rxode2</code> tutorial is below:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlmixr2.github.io/rxode2/">rxode2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joshuaulrich/microbenchmark/" class="external-link">microbenchmark</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rxode2.html">rxode2</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">C2</span> <span class="op">=</span> <span class="va">centr</span><span class="op">/</span><span class="va">V2</span></span>
<span>    <span class="va">C3</span> <span class="op">=</span> <span class="va">peri</span><span class="op">/</span><span class="va">V3</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">depot</span><span class="op">)</span> <span class="op">=</span> <span class="op">-</span><span class="va">KA</span><span class="op">*</span><span class="va">depot</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">centr</span><span class="op">)</span> <span class="op">=</span> <span class="va">KA</span><span class="op">*</span><span class="va">depot</span> <span class="op">-</span> <span class="va">CL</span><span class="op">*</span><span class="va">C2</span> <span class="op">-</span> <span class="va">Q</span><span class="op">*</span><span class="va">C2</span> <span class="op">+</span> <span class="va">Q</span><span class="op">*</span><span class="va">C3</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">peri</span><span class="op">)</span> <span class="op">=</span> <span class="va">Q</span><span class="op">*</span><span class="va">C2</span> <span class="op">-</span> <span class="va">Q</span><span class="op">*</span><span class="va">C3</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">eff</span><span class="op">)</span> <span class="op">=</span> <span class="va">Kin</span> <span class="op">-</span> <span class="va">Kout</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">C2</span><span class="op">/</span><span class="op">(</span><span class="va">EC50</span><span class="op">+</span><span class="va">C2</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="va">eff</span></span>
<span>    <span class="fu">eff</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span> <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Create an event table</span></span>
<span></span>
<span><span class="va">ev</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>amt<span class="op">=</span><span class="fl">10000</span>, addl<span class="op">=</span><span class="fl">9</span>,ii<span class="op">=</span><span class="fl">12</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>time<span class="op">=</span><span class="fl">120</span>, amt<span class="op">=</span><span class="fl">20000</span>, addl<span class="op">=</span><span class="fl">4</span>, ii<span class="op">=</span><span class="fl">24</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">240</span><span class="op">)</span> <span class="co">## Add Sampling</span></span>
<span></span>
<span><span class="va">nsub</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="co"># 100 sub-problems</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.09</span>,<span class="fl">0.08</span>,<span class="fl">0.08</span>,<span class="fl">0.25</span><span class="op">)</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span> <span class="co"># IIV covariance matrix</span></span>
<span><span class="va">mv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rxRmvn.html">rxRmvn</a></span><span class="op">(</span>n<span class="op">=</span><span class="va">nsub</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span>, <span class="va">sigma</span><span class="op">)</span> <span class="co"># Sample from covariance matrix</span></span>
<span><span class="va">CL</span> <span class="op">&lt;-</span> <span class="fl">7</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">mv</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">V2</span> <span class="op">&lt;-</span> <span class="fl">40</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">mv</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">params.all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>KA<span class="op">=</span><span class="fl">0.3</span>, CL<span class="op">=</span><span class="va">CL</span>, V2<span class="op">=</span><span class="va">V2</span>, Q<span class="op">=</span><span class="fl">10</span>, V3<span class="op">=</span><span class="fl">300</span>,</span>
<span>                    Kin<span class="op">=</span><span class="fl">0.2</span>, Kout<span class="op">=</span><span class="fl">0.2</span>, EC50<span class="op">=</span><span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="for-loop">For Loop<a class="anchor" aria-label="anchor" href="#for-loop"></a>
</h3>
<p>The slowest way to code this is to use a <code>for</code> loop. In
this example we will enclose it in a function to compare timing.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">runFor</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">res</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nsub</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">params</span> <span class="op">&lt;-</span> <span class="va">params.all</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span></span>
<span>        <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">mod1</span><span class="op">$</span><span class="fu">solve</span><span class="op">(</span><span class="va">params</span>, <span class="va">ev</span><span class="op">)</span></span>
<span>        <span class="co">##Store results for effect compartment</span></span>
<span>        <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">res</span>, <span class="va">x</span><span class="op">[</span>, <span class="st">"eff"</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="running-with-apply">Running with apply<a class="anchor" aria-label="anchor" href="#running-with-apply"></a>
</h3>
<p>In general for R, the <code>apply</code> types of functions perform
better than a <code>for</code> loop, so the tutorial also suggests this
speed enhancement</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">runSapply</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">params.all</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">theta</span><span class="op">)</span></span>
<span>        <span class="va">mod1</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span><span class="va">theta</span>, <span class="va">ev</span><span class="op">)</span><span class="op">[</span>, <span class="st">"eff"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="run-using-a-single-threaded-solve">Run using a single-threaded solve<a class="anchor" aria-label="anchor" href="#run-using-a-single-threaded-solve"></a>
</h3>
<p>You can also have rxode2 solve all the subject simultaneously without
collecting the results in R, using a single threaded solve.</p>
<p>The data output is slightly different here, but still gives the same
information:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">runSingleThread</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/symengine/man/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">mod1</span>, <span class="va">params.all</span>, <span class="va">ev</span>, cores<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sim.id"</span>, <span class="st">"time"</span>, <span class="st">"eff"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="run-a-2-threaded-solve">Run a 2 threaded solve<a class="anchor" aria-label="anchor" href="#run-a-2-threaded-solve"></a>
</h3>
<p>rxode2 supports multi-threaded solves, so another option is to have
<code>2</code> threads (called <code>cores</code> in the solve options,
you can see the options in <code><a href="../reference/rxSolve.html">rxControl()</a></code> or
<code><a href="../reference/rxSolve.html">rxSolve()</a></code>).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">run2Thread</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/symengine/man/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">mod1</span>, <span class="va">params.all</span>, <span class="va">ev</span>, cores<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sim.id"</span>, <span class="st">"time"</span>, <span class="st">"eff"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="compare-the-times-between-all-the-methods">Compare the times between all the methods<a class="anchor" aria-label="anchor" href="#compare-the-times-between-all-the-methods"></a>
</h3>
<p>Now the moment of truth, the timings:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bench</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html" class="external-link">microbenchmark</a></span><span class="op">(</span><span class="fu">runFor</span><span class="op">(</span><span class="op">)</span>, <span class="fu">runSapply</span><span class="op">(</span><span class="op">)</span>, <span class="fu">runSingleThread</span><span class="op">(</span><span class="op">)</span>,<span class="fu">run2Thread</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bench</span><span class="op">)</span></span>
<span><span class="co">#&gt; Unit: milliseconds</span></span>
<span><span class="co">#&gt;               expr       min        lq      mean    median        uq       max</span></span>
<span><span class="co">#&gt;           runFor() 434.79949 442.05745 448.70710 444.88310 447.84103 600.92708</span></span>
<span><span class="co">#&gt;        runSapply() 436.21765 443.14319 451.03638 447.38316 450.08590 629.23923</span></span>
<span><span class="co">#&gt;  runSingleThread()  36.90931  37.32654  38.04211  37.65032  38.26562  43.04233</span></span>
<span><span class="co">#&gt;       run2Thread()  23.65291  24.15850  24.74721  24.49409  25.00260  30.12082</span></span>
<span><span class="co">#&gt;  neval</span></span>
<span><span class="co">#&gt;    100</span></span>
<span><span class="co">#&gt;    100</span></span>
<span><span class="co">#&gt;    100</span></span>
<span><span class="co">#&gt;    100</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">bench</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: `aes_string()` was deprecated in ggplot2 3.0.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please use tidy evaluation idioms with `aes()`.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> See also `vignette("ggplot2-in-packages")` for more information.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The deprecated feature was likely used in the <span style="color: #0000BB;">microbenchmark</span> package.</span></span>
<span><span class="co">#&gt;   Please report the issue at</span></span>
<span><span class="co">#&gt;   <span style="color: #0000BB; font-style: italic;">&lt;https://github.com/joshuaulrich/microbenchmark/issues/&gt;</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span></code></pre></div>
<p><img src="rxode2-speed_files/figure-html/unnamed-chunk-10-1.png" class="r-plt" alt="" width="700"></p>
<p>It is clear that the <strong>largest</strong> jump in performance
when using the <code>solve</code> method and providing <em>all</em> the
parameters to rxode2 to solve without looping over each subject with
either a <code>for</code> or a <code>sapply</code>. The number of
cores/threads applied to the solve also plays a role in the solving.</p>
<p>We can explore the number of threads further with the following
code:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">runThread</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/symengine/man/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">mod1</span>, <span class="va">params.all</span>, <span class="va">ev</span>, cores<span class="op">=</span><span class="va">n</span><span class="op">)</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sim.id"</span>, <span class="st">"time"</span>, <span class="st">"eff"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">bench</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eval.html" class="external-link">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/parse.html" class="external-link">parse</a></span><span class="op">(</span>text<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"microbenchmark(%s)"</span>,</span>
<span>                                     <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"runThread("</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="../reference/getRxThreads.html">rxCores</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,<span class="st">")"</span><span class="op">)</span>,</span>
<span>                                           collapse<span class="op">=</span><span class="st">","</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bench</span><span class="op">)</span></span>
<span><span class="co">#&gt; Unit: milliseconds</span></span>
<span><span class="co">#&gt;          expr      min       lq     mean   median       uq      max neval</span></span>
<span><span class="co">#&gt;  runThread(1) 37.08507 37.62803 38.17937 37.87664 38.28721 42.92213   100</span></span>
<span><span class="co">#&gt;  runThread(2) 23.89866 24.53717 25.95936 24.93756 25.53131 37.09831   100</span></span>
<span><span class="co">#&gt;  runThread(3) 25.48594 26.22422 27.90241 26.85713 29.69100 33.97072   100</span></span>
<span><span class="co">#&gt;  runThread(4) 25.21326 25.67140 26.19662 25.90523 26.37722 30.68742   100</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">bench</span><span class="op">)</span></span></code></pre></div>
<p><img src="rxode2-speed_files/figure-html/unnamed-chunk-12-1.png" class="r-plt" alt="" width="700"></p>
<p>There can be a suite spot in speed vs number or cores. The system
type (mac, linux, windows and/or processor), complexity of the ODE
solving and the number of subjects may affect this arbitrary number of
threads. 4 threads is a good number to use without any prior knowledge
because most systems these days have at least 4 threads (or 2 processors
with 4 threads).</p>
</div>
</div>
<div class="section level2">
<h2 id="increasing-speed-with-compiler-options">Increasing speed with compiler options<a class="anchor" aria-label="anchor" href="#increasing-speed-with-compiler-options"></a>
</h2>
<p>One of the way that allows faster ODE solving is to make some
approximations that make some math operators like <code><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp()</a></code>
faster but not technically accurate enough to follow the IEEE standard
for the math functions values (there are other implications that I will
not cover here).</p>
<p>While these are optimizations are <a href="https://github.com/JuliaLang/julia/blob/master/base/fastmath.jl" class="external-link">opt-in
for Julia</a> since they compile everything each session, CRAN has a
more conservative approach since individuals do not compile each R
function before running it.</p>
<p>Still, <code>rxode2</code> models can be compiled with this option
without disturbing CRAN policies. The key is to set an option. Here is
an example:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using the first example subset to PK</span></span>
<span><span class="va">mod2f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/ini.html">ini</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">TKA</span>   <span class="op">&lt;-</span> <span class="fl">0.3</span></span>
<span>    <span class="va">TCL</span>   <span class="op">&lt;-</span> <span class="fl">7</span></span>
<span>    <span class="va">TV2</span>   <span class="op">&lt;-</span> <span class="fl">40</span></span>
<span>    <span class="va">TQ</span>    <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span>    <span class="va">TV3</span>   <span class="op">&lt;-</span> <span class="fl">300</span></span>
<span>    <span class="va">TKin</span>  <span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span>    <span class="va">TKout</span> <span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span>    <span class="va">TEC50</span> <span class="op">&lt;-</span> <span class="fl">8</span></span>
<span>    <span class="va">eta.cl</span> <span class="op">+</span> <span class="va">eta.v</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.09</span>,</span>
<span>                       <span class="fl">0.08</span>, <span class="fl">0.25</span><span class="op">)</span></span>
<span>    <span class="va">c2.prop.sd</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/model.html">model</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">KA</span> <span class="op">&lt;-</span> <span class="va">TKA</span></span>
<span>    <span class="va">CL</span> <span class="op">&lt;-</span> <span class="va">TCL</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">eta.cl</span><span class="op">)</span></span>
<span>    <span class="va">V2</span>  <span class="op">&lt;-</span> <span class="va">TV2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">eta.v</span><span class="op">)</span></span>
<span>    <span class="va">Q</span>   <span class="op">&lt;-</span> <span class="va">TQ</span></span>
<span>    <span class="va">V3</span>  <span class="op">&lt;-</span> <span class="va">TV3</span></span>
<span>    <span class="va">Kin</span>  <span class="op">&lt;-</span> <span class="va">TKin</span></span>
<span>    <span class="va">Kout</span> <span class="op">&lt;-</span> <span class="va">TKout</span></span>
<span>    <span class="va">EC50</span> <span class="op">&lt;-</span> <span class="va">TEC50</span></span>
<span>    <span class="va">C2</span> <span class="op">=</span> <span class="va">centr</span><span class="op">/</span><span class="va">V2</span></span>
<span>    <span class="va">C3</span> <span class="op">=</span> <span class="va">peri</span><span class="op">/</span><span class="va">V3</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">depot</span><span class="op">)</span> <span class="op">=</span> <span class="op">-</span><span class="va">KA</span><span class="op">*</span><span class="va">depot</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">centr</span><span class="op">)</span> <span class="op">=</span> <span class="va">KA</span><span class="op">*</span><span class="va">depot</span> <span class="op">-</span> <span class="va">CL</span><span class="op">*</span><span class="va">C2</span> <span class="op">-</span> <span class="va">Q</span><span class="op">*</span><span class="va">C2</span> <span class="op">+</span> <span class="va">Q</span><span class="op">*</span><span class="va">C3</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">peri</span><span class="op">)</span> <span class="op">=</span> <span class="va">Q</span><span class="op">*</span><span class="va">C2</span> <span class="op">-</span> <span class="va">Q</span><span class="op">*</span><span class="va">C3</span></span>
<span>    <span class="va">C2</span> <span class="op">~</span> <span class="fu">prop</span><span class="op">(</span><span class="va">c2.prop.sd</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">mod2f</span> <span class="op">&lt;-</span> <span class="fu">mod2f</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod2s</span> <span class="op">&lt;-</span> <span class="va">mod2f</span><span class="op">$</span><span class="va">simulationIniModel</span></span>
<span></span>
<span><span class="va">ev</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>amountUnits<span class="op">=</span><span class="st">"mg"</span>, timeUnits<span class="op">=</span><span class="st">"hours"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>amt<span class="op">=</span><span class="fl">10000</span>, addl<span class="op">=</span><span class="fl">9</span>,ii<span class="op">=</span><span class="fl">12</span>,cmt<span class="op">=</span><span class="st">"depot"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>time<span class="op">=</span><span class="fl">120</span>, amt<span class="op">=</span><span class="fl">2000</span>, addl<span class="op">=</span><span class="fl">4</span>, ii<span class="op">=</span><span class="fl">14</span>, cmt<span class="op">=</span><span class="st">"depot"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">240</span><span class="op">)</span> <span class="co"># Add sampling</span></span>
<span></span>
<span><span class="va">bench1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html" class="external-link">microbenchmark</a></span><span class="op">(</span>standardCompile<span class="op">=</span><span class="fu"><a href="../reference/rxSolve.html">rxSolve</a></span><span class="op">(</span><span class="va">mod2s</span>, <span class="va">ev</span>, nSub<span class="op">=</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Now clear the cache of models so we can change the compile options for the same model</span></span>
<span><span class="fu"><a href="../reference/rxClean.html">rxClean</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use withr to preserve the options</span></span>
<span><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_options.html" class="external-link">with_options</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rxode2.compile.O<span class="op">=</span><span class="st">"fast"</span><span class="op">)</span>, <span class="op">{</span></span>
<span>  <span class="va">mod2s</span> <span class="op">&lt;-</span> <span class="va">mod2f</span><span class="op">$</span><span class="va">simulationIniModel</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bench2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html" class="external-link">microbenchmark</a></span><span class="op">(</span>fastCompile<span class="op">=</span><span class="fu"><a href="../reference/rxSolve.html">rxSolve</a></span><span class="op">(</span><span class="va">mod2s</span>, <span class="va">ev</span>, nSub<span class="op">=</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bench</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">bench1</span>, <span class="va">bench2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bench</span><span class="op">)</span></span>
<span><span class="co">#&gt; Unit: milliseconds</span></span>
<span><span class="co">#&gt;             expr      min       lq     mean   median       uq      max neval</span></span>
<span><span class="co">#&gt;  standardCompile 390.0097 399.5505 484.3826 486.2245 568.5475 597.5808   100</span></span>
<span><span class="co">#&gt;      fastCompile 388.7150 396.0264 488.1106 414.9734 580.2813 738.0748   100</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">bench</span><span class="op">)</span></span></code></pre></div>
<p><img src="rxode2-speed_files/figure-html/unnamed-chunk-13-1.png" class="r-plt" alt="" width="700"></p>
<p>Note compiler settings can be tricky and if you setup your system
wide <code>Makevars</code> it may interact with this setting. For
example if you use <code>ccache</code> the compile may not be produced
with the same options since it was cached with the other options.</p>
<p>For example, on the github runner (which generates this page), there
is no advantage to the <code>"fast"</code> compile. However, on my
development laptop there is <a href="https://github.com/nlmixr2/rxode2/issues/583#issuecomment-1834468627" class="external-link">some
minimal speed increase</a>. You should probably check before using this
yourself.</p>
<p>This is disabled by default since there is only minimum increase in
speed.</p>
</div>
<div class="section level2">
<h2 id="a-real-life-example">A real life example<a class="anchor" aria-label="anchor" href="#a-real-life-example"></a>
</h2>
<p>cBefore some of the parallel solving was implemented, the fastest way
to run <code>rxode2</code> was with <code>lapply</code>. This is how Rik
Schoemaker created the data-set for <code>nlmixr</code> comparisons, but
reduced to run faster automatic building of the pkgdown website.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlmixr2.github.io/rxode2/">rxode2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="co">#Define the rxode2 model</span></span>
<span>  <span class="va">ode1</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">  d/dt(abs)    = -KA*abs;</span></span>
<span><span class="st">  d/dt(centr)  =  KA*abs-(CL/V)*centr;</span></span>
<span><span class="st">  C2=centr/V;</span></span>
<span><span class="st">  "</span></span>
<span></span>
<span><span class="co">#Create the rxode2 simulation object</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rxode2.html">rxode2</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">ode1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Population parameter values on log-scale</span></span>
<span>  <span class="va">paramsl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>CL <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>               V <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">70</span><span class="op">)</span>,</span>
<span>               KA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#make 10,000 subjects to sample from:</span></span>
<span>  <span class="va">nsubg</span> <span class="op">&lt;-</span> <span class="fl">300</span> <span class="co"># subjects per dose</span></span>
<span>  <span class="va">doses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">30</span>, <span class="fl">60</span>, <span class="fl">120</span><span class="op">)</span></span>
<span>  <span class="va">nsub</span> <span class="op">&lt;-</span> <span class="va">nsubg</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">doses</span><span class="op">)</span></span>
<span><span class="co">#IIV of 30% for each parameter</span></span>
<span>  <span class="va">omega</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.09</span>, <span class="fl">0.09</span>, <span class="fl">0.09</span><span class="op">)</span><span class="op">)</span><span class="co"># IIV covariance matrix</span></span>
<span>  <span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span><span class="co">#Sample from the multivariate normal</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">98176247</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/rxSetSeed.html">rxSetSeed</a></span><span class="op">(</span><span class="fl">98176247</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span>
<span>  <span class="va">mv</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="va">nsub</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">omega</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="va">omega</span><span class="op">)</span> <span class="co"># Sample from covariance matrix</span></span>
<span><span class="co">#Combine population parameters with IIV</span></span>
<span>  <span class="va">params.all</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span>
<span>      <span class="st">"ID"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">nsub</span><span class="op">)</span>,</span>
<span>      <span class="st">"CL"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">paramsl</span><span class="op">[</span><span class="st">'CL'</span><span class="op">]</span> <span class="op">+</span> <span class="va">mv</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>      <span class="st">"V"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">paramsl</span><span class="op">[</span><span class="st">'V'</span><span class="op">]</span> <span class="op">+</span> <span class="va">mv</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>      <span class="st">"KA"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">paramsl</span><span class="op">[</span><span class="st">'KA'</span><span class="op">]</span> <span class="op">+</span> <span class="va">mv</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="co">#set the doses (looping through the 4 doses)</span></span>
<span><span class="va">params.all</span><span class="op">[</span>, <span class="va">AMT</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">100</span> <span class="op">*</span> <span class="va">doses</span>,<span class="va">nsubg</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">Startlapply</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Run the simulations using lapply for speed</span></span>
<span>  <span class="va">s</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">nsub</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span><span class="co">#selects the parameters associated with the subject to be simulated</span></span>
<span>    <span class="va">params</span> <span class="op">&lt;-</span> <span class="va">params.all</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span><span class="co">#creates an eventTable with 7 doses every 24 hours</span></span>
<span>    <span class="va">ev</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eventTable.html">eventTable</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="va">ev</span><span class="op">$</span><span class="fu">add.dosing</span><span class="op">(</span></span>
<span>      dose <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">AMT</span>,</span>
<span>      nbr.doses <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      dosing.to <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      rate <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>      start.time <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span></span>
<span><span class="co">#generates 4 random samples in a 24 hour period</span></span>
<span>    <span class="va">ev</span><span class="op">$</span><span class="fu">add.sampling</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">600</span>, <span class="fl">0</span>, <span class="fl">1440</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span> <span class="op">/</span> <span class="fl">60</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#runs the rxode2 simulation</span></span>
<span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span><span class="va">params</span>, <span class="va">ev</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#merges the parameters and ID number to the simulation output</span></span>
<span>    <span class="va">x</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span> <span class="op">:=</span> <span class="va">params</span><span class="op">]</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#runs the entire sequence of 100 subjects and binds the results to the object res</span></span>
<span>  <span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>, <span class="va">s</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Stoplapply</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">Stoplapply</span> <span class="op">-</span> <span class="va">Startlapply</span><span class="op">)</span></span>
<span><span class="co">#&gt; Time difference of 16.56305 secs</span></span></code></pre></div>
<p>By applying some of the new parallel solving concepts you can simply
run the same simulation both with less code and faster:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rxode2.html">rxode2</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">CL</span> <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span>    <span class="va">V</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">70</span><span class="op">)</span></span>
<span>    <span class="va">KA</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">CL</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">CL</span> <span class="op">+</span> <span class="va">eta.CL</span><span class="op">)</span></span>
<span>    <span class="va">V</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">V</span> <span class="op">+</span> <span class="va">eta.V</span><span class="op">)</span></span>
<span>    <span class="va">KA</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">KA</span> <span class="op">+</span> <span class="va">eta.KA</span><span class="op">)</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">abs</span><span class="op">)</span>    <span class="op">=</span> <span class="op">-</span><span class="va">KA</span><span class="op">*</span><span class="va">abs</span>;</span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">centr</span><span class="op">)</span>  <span class="op">=</span>  <span class="va">KA</span><span class="op">*</span><span class="va">abs</span><span class="op">-</span><span class="op">(</span><span class="va">CL</span><span class="op">/</span><span class="va">V</span><span class="op">)</span><span class="op">*</span><span class="va">centr</span>;</span>
<span>    <span class="va">C2</span><span class="op">=</span><span class="va">centr</span><span class="op">/</span><span class="va">V</span>;</span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">omega</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://nlmixr2.github.io/lotri/reference/lotri.html" class="external-link">lotri</a></span><span class="op">(</span><span class="va">eta.CL</span> <span class="op">~</span> <span class="fl">0.09</span>,</span>
<span>               <span class="va">eta.V</span> <span class="op">~</span> <span class="fl">0.09</span>,</span>
<span>               <span class="va">eta.KA</span> <span class="op">~</span> <span class="fl">0.09</span><span class="op">)</span></span>
<span></span>
<span><span class="va">doses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">30</span>, <span class="fl">60</span>, <span class="fl">120</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">startParallel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">ev</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">"rbind"</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">doses</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">{</span></span>
<span>            <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>                <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>amt<span class="op">=</span><span class="va">doses</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># Add single dose</span></span>
<span>                <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># Add 0 observation</span></span>
<span>                <span class="co">## Generate 4 samples in 24 hour period</span></span>
<span>                <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">24</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>                <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">nsubg</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">nsubg</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>                <span class="co">## Convert to data frame to skip sorting the data</span></span>
<span>                <span class="co">## When binding the data together</span></span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span>        <span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## To better compare, use the same output, that is data.table</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rxSolve.html">rxSolve</a></span><span class="op">(</span><span class="va">rx</span>, <span class="va">ev</span>, omega<span class="op">=</span><span class="va">omega</span>, returnType<span class="op">=</span><span class="st">"data.table"</span><span class="op">)</span></span>
<span><span class="va">endParallel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">endParallel</span> <span class="op">-</span> <span class="va">startParallel</span><span class="op">)</span></span>
<span><span class="co">#&gt; Time difference of 0.6211731 secs</span></span></code></pre></div>
<p>You can see a striking time difference between the two methods; A few
things to keep in mind:</p>
<ul>
<li><p><code>rxode2</code> use the thread-safe sitmo
<code>threefry</code> routines for simulation of <code>eta</code>
values. Therefore the results are expected to be different (also the
random samples are taken in a different order which would be
different)</p></li>
<li><p>This prior simulation was run in R 3.5, which has a different
random number generator so the results in this simulation will be
different from the actual nlmixr comparison when using the slower
simulation.</p></li>
<li><p>This speed comparison used <code>data.table</code>.
<code>rxode2</code> uses <code>data.table</code> internally (when
available) try to speed up sorting, so this would be different than
installations where <code>data.table</code> is not installed. You can
force rxode2 to use <code><a href="https://rdrr.io/r/base/order.html" class="external-link">order()</a></code> when sorting by using
<code>forderForceBase(TRUE)</code>. In this case there is little
difference between the two, though in other examples
<code>data.table</code>’s presence leads to a speed increase (and less
likely it could lead to a slowdown).</p></li>
</ul>
<div class="section level3">
<h3 id="want-more-ways-to-run-multi-subject-simulations">Want more ways to run multi-subject simulations<a class="anchor" aria-label="anchor" href="#want-more-ways-to-run-multi-subject-simulations"></a>
</h3>
<p>The version since the tutorial has even more ways to run
multi-subject simulations, including adding variability in sampling and
dosing times with <code><a href="../reference/et.html">et()</a></code> (see <a href="https://nlmixr2.github.io/rxode2/articles/rxode2-events.html#add-doses-and-samples-within-a-sampling-window">rxode2
events</a> for more information), ability to supply both an
<code>omega</code> and <code>sigma</code> matrix as well as adding as a
<code>thetaMat</code> to R to simulate with uncertainty in the
<code>omega</code>, <code>sigma</code> and <code>theta</code> matrices;
see <a href="https://nlmixr2.github.io/rxode2/articles/rxode2-sim-var.html">rxode2
simulation vignette</a>.</p>
</div>
<div class="section level3">
<h3 id="session-information">Session Information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h3>
<p>The session information:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.2 (2025-10-31)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 24.04.3 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] MASS_7.3-65          data.table_1.18.0    ggplot2_4.0.1       </span></span>
<span><span class="co">#&gt; [4] microbenchmark_1.5.0 rxode2_5.0.1.9000   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] sass_0.4.10           generics_0.1.4        lattice_0.22-7       </span></span>
<span><span class="co">#&gt;  [4] digest_0.6.39         magrittr_2.0.4        evaluate_1.0.5       </span></span>
<span><span class="co">#&gt;  [7] grid_4.5.2            RColorBrewer_1.1-3    fastmap_1.2.0        </span></span>
<span><span class="co">#&gt; [10] lotri_1.0.2           qs2_0.1.6             jsonlite_2.0.0       </span></span>
<span><span class="co">#&gt; [13] rxode2ll_2.0.13       backports_1.5.0       scales_1.4.0         </span></span>
<span><span class="co">#&gt; [16] lazyeval_0.2.2        textshaping_1.0.4     jquerylib_0.1.4      </span></span>
<span><span class="co">#&gt; [19] cli_3.6.5             symengine_0.2.10      crayon_1.5.3         </span></span>
<span><span class="co">#&gt; [22] rlang_1.1.6           units_1.0-0           withr_3.0.2          </span></span>
<span><span class="co">#&gt; [25] cachem_1.1.0          yaml_2.3.12           otel_0.2.0           </span></span>
<span><span class="co">#&gt; [28] tools_4.5.2           memoise_2.0.1         checkmate_2.3.3      </span></span>
<span><span class="co">#&gt; [31] dplyr_1.1.4           vctrs_0.6.5           R6_2.6.1             </span></span>
<span><span class="co">#&gt; [34] lifecycle_1.0.4       fs_1.6.6              stringfish_0.17.0    </span></span>
<span><span class="co">#&gt; [37] htmlwidgets_1.6.4     ragg_1.5.0            PreciseSums_0.7      </span></span>
<span><span class="co">#&gt; [40] pkgconfig_2.0.3       desc_1.4.3            rex_1.2.1            </span></span>
<span><span class="co">#&gt; [43] pkgdown_2.2.0         RcppParallel_5.1.11-1 bslib_0.9.0          </span></span>
<span><span class="co">#&gt; [46] pillar_1.11.1         gtable_0.3.6          glue_1.8.0           </span></span>
<span><span class="co">#&gt; [49] Rcpp_1.1.0            systemfonts_1.3.1     xfun_0.55            </span></span>
<span><span class="co">#&gt; [52] tibble_3.3.0          tidyselect_1.2.1      sys_3.4.3            </span></span>
<span><span class="co">#&gt; [55] knitr_1.51            farver_2.1.2          dparser_1.3.1-13     </span></span>
<span><span class="co">#&gt; [58] htmltools_0.5.9       nlme_3.1-168          labeling_0.4.3       </span></span>
<span><span class="co">#&gt; [61] rmarkdown_2.30        compiler_4.5.2        S7_0.2.1</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthew L. Fidler, Wenping Wang, Melissa Hallow.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
