<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>rxode2 Covariates • rxode2</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="rxode2 Covariates">
<meta name="google-site-verification" content="fp9A3qPrCar1DKeVQg4Mfrf6-An5keP9OwhIxUkntbU">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rxode2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-book"></span> Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Getting started</h6></li>
    <li><a class="dropdown-item" href="../articles/rxode2-syntax.html">rxode2 mini language syntax</a></li>
    <li><a class="dropdown-item" href="../articles/Modifying-Models.html">rxode2 model modification %&gt;%</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-pipeline.html">rxode2 pipeline ie %&gt;%</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-speed.html">Speeding up rxode2 ODE solving</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-data-frame.html">Adaptive Data Frames with rxode2</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-plot.html">Plotting with rxode2</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced Features, Model Types, Technical Details</h6></li>
    <li><a class="dropdown-item" href="../articles/rxode2-model-types.html">rxode2 model types</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-cmt.html">Chainging rxode2 compartment numbers</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-transit-compartments.html">rxode2 transit compartment models</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-shiny.html">Using Shiny with rxode2</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-covariates.html">rxode2 covariates</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-stiff.html">Stiff Systems and Jacobian specification</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-rxUse.html">Adding compiled rxode2 models to your package</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-dosing-events" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-stethoscope"></span> Dosing/Events</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-dosing-events">
<li><a class="dropdown-item" href="../articles/rxode2-datasets.html">nlmixr/rxode2 dataset overview</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-event-types.html">Supported Event Types</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-event-table.html">Easy rxode2 Event Tables</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-events-classic.html">Classic rxode2 events explained</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-simulations" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-desktop"></span> Simulations</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-simulations">
<li><a class="dropdown-item" href="../articles/rxode2-single-subject.html">Single Subject ODE solving</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-sim-var.html">Multiple Subject rxode2 Simulation</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-prior-data.html">Using Prior Data for ODE solving</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-help" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-life-ring"></span> Help</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-help">
<li><a class="dropdown-item" href="../articles/rxode2-tutorials.html">Running the interactive tutorials</a></li>
    <li><a class="external-link dropdown-item" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4728294/pdf/PSP4-5-03.pdf">2015 CPT tutorial</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/rxode2-covariates.html">Adding Circadian Rythmn (time-varying covariates)</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-wt.html">Weight Based Dosing</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-nesting.html">Simulating Multiple levels of nesting (iov, between study etc)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changes/News</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="https://nlmixr2.github.io/rxode2/reference/index.html"><span class="fa fa-file-code-o"></span> Functions</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-archive"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-">
<li><a class="dropdown-item" href="https://nlmixr2.github.io/rxode2-manual/">rxode2 User Guide</a></li>
    <li><a class="external-link dropdown-item" href="https://nlmixr2.org/">nlmixr2</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nlmixr2/rxode2"><span class="fa fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nlmixr2/rxode2/releases"><span class="fa fa-download"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>rxode2 Covariates</h1>
            
            <h4 data-toc-skip class="date">2025-07-23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nlmixr2/rxode2/blob/main/vignettes/rxode2-covariates.Rmd" class="external-link"><code>vignettes/rxode2-covariates.Rmd</code></a></small>
      <div class="d-none name"><code>rxode2-covariates.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="individual-covariates">Individual Covariates<a class="anchor" aria-label="anchor" href="#individual-covariates"></a>
</h2>
<p>If there is an individual covariate you wish to solve for you may
specify it by the <code>iCov</code> dataset:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlmixr2.github.io/rxode2/">rxode2</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## rxode2 4.0.2 using 2 threads (see ?getRxThreads)</span></span>
<span><span class="co">##   no cache: create with `rxCreateCache()`</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-quantities.github.io/units/" class="external-link">units</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## udunits database from /usr/share/xml/udunits/udunits2.xml</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://opensource.nibr.com/xgx/" class="external-link">xgxr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod3</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/ini.html">ini</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">TKA</span>   <span class="op">&lt;-</span> <span class="fl">2.94E-01</span></span>
<span>    <span class="co">## Clearance with individuals</span></span>
<span>    <span class="va">TCL</span>   <span class="op">&lt;-</span> <span class="fl">1.86E+01</span> </span>
<span>    <span class="va">TV2</span>   <span class="op">&lt;-</span><span class="fl">4.02E+01</span></span>
<span>    <span class="va">TQ</span>    <span class="op">&lt;-</span><span class="fl">1.05E+01</span></span>
<span>    <span class="va">TV3</span>   <span class="op">&lt;-</span><span class="fl">2.97E+02</span></span>
<span>    <span class="va">TKin</span>  <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>    <span class="va">TKout</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>    <span class="va">TEC50</span> <span class="op">&lt;-</span><span class="fl">200</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/model.html">model</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">KA</span>            <span class="op">&lt;-</span> <span class="va">TKA</span></span>
<span>    <span class="va">CL</span>            <span class="op">&lt;-</span> <span class="va">TCL</span> <span class="op">*</span> <span class="op">(</span><span class="va">WT</span> <span class="op">/</span> <span class="fl">70</span><span class="op">)</span> <span class="op">^</span> <span class="fl">0.75</span></span>
<span>    <span class="va">V2</span>            <span class="op">&lt;-</span> <span class="va">TV2</span></span>
<span>    <span class="va">Q</span>             <span class="op">&lt;-</span> <span class="va">TQ</span></span>
<span>    <span class="va">V3</span>            <span class="op">&lt;-</span> <span class="va">TV3</span></span>
<span>    <span class="va">Kin</span>           <span class="op">&lt;-</span> <span class="va">TKin</span></span>
<span>    <span class="va">Kout</span>          <span class="op">&lt;-</span> <span class="va">TKout</span></span>
<span>    <span class="va">EC50</span>          <span class="op">&lt;-</span> <span class="va">TEC50</span></span>
<span>    <span class="va">Tz</span>            <span class="op">&lt;-</span> <span class="fl">8</span></span>
<span>    <span class="va">amp</span>           <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span>    <span class="va">C2</span>            <span class="op">&lt;-</span> <span class="va">central</span><span class="op">/</span><span class="va">V2</span></span>
<span>    <span class="va">C3</span>            <span class="op">&lt;-</span> <span class="va">peri</span><span class="op">/</span><span class="va">V3</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">depot</span><span class="op">)</span>   <span class="op">&lt;-</span> <span class="op">-</span><span class="va">KA</span><span class="op">*</span><span class="va">depot</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">central</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">KA</span><span class="op">*</span><span class="va">depot</span> <span class="op">-</span> <span class="va">CL</span><span class="op">*</span><span class="va">C2</span> <span class="op">-</span> <span class="va">Q</span><span class="op">*</span><span class="va">C2</span> <span class="op">+</span> <span class="va">Q</span><span class="op">*</span><span class="va">C3</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">peri</span><span class="op">)</span>    <span class="op">&lt;-</span>                    <span class="va">Q</span><span class="op">*</span><span class="va">C2</span> <span class="op">-</span> <span class="va">Q</span><span class="op">*</span><span class="va">C3</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">eff</span><span class="op">)</span>     <span class="op">&lt;-</span>  <span class="va">Kin</span> <span class="op">-</span> <span class="va">Kout</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">C2</span><span class="op">/</span><span class="op">(</span><span class="va">EC50</span><span class="op">+</span><span class="va">C2</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="va">eff</span></span>
<span>    <span class="fu">eff</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>        <span class="op">&lt;-</span> <span class="fl">1</span>  <span class="co">## This specifies that the effect compartment starts at 1.</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">ev</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>amount.units<span class="op">=</span><span class="st">"mg"</span>, time.units<span class="op">=</span><span class="st">"hours"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>amt<span class="op">=</span><span class="fl">10000</span>, cmt<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">48</span>,length.out<span class="op">=</span><span class="fl">100</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>id<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/rxSetSeed.html">rxSetSeed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">## Now use iCov to simulate a 4-id sample</span></span>
<span><span class="va">r1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/symengine/man/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">mod3</span>, <span class="va">ev</span>,</span>
<span>            <span class="co"># Create individual covariate data-frame</span></span>
<span>            iCov<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>id<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, WT<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">70</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> parameter labels from comments are typically ignored in non-interactive mode</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Need to run with the source intact to parse comments</span></span></code></pre>
<pre><code><span><span class="co">## C model:</span></span>
<span><span class="co">## // Define translation state order for 4 states</span></span>
<span><span class="co">## #define __DDT0__ 0 // depot</span></span>
<span><span class="co">## #define _DEPOT_ 0 // depot</span></span>
<span><span class="co">## #define __DDT1__ 1 // central</span></span>
<span><span class="co">## #define _CENTRAL_ 1 // central</span></span>
<span><span class="co">## #define __DDT2__ 2 // peri</span></span>
<span><span class="co">## #define __DDT3__ 3 // eff</span></span>
<span><span class="co">## // Define 10 LHS values</span></span>
<span><span class="co">## #define _LHS_0_ 0 // KA</span></span>
<span><span class="co">## #define _LHS_1_ 1 // CL</span></span>
<span><span class="co">## #define _LHS_2_ 2 // V2</span></span>
<span><span class="co">## #define _LHS_3_ 3 // Q</span></span>
<span><span class="co">## #define _LHS_4_ 4 // V3</span></span>
<span><span class="co">## #define _LHS_5_ 5 // Kin</span></span>
<span><span class="co">## #define _LHS_6_ 6 // Kout</span></span>
<span><span class="co">## #define _LHS_7_ 7 // EC50</span></span>
<span><span class="co">## #define _LHS_8_ 8 // C2</span></span>
<span><span class="co">## #define _LHS_9_ 9 // C3</span></span>
<span><span class="co">## #define _getRxSolve_ _rx14f172af8145a690eda8fb18e2ff73870__getRxSolve__cQeZ</span></span>
<span><span class="co">## #define _evalUdf _rx14f172af8145a690eda8fb18e2ff73871__evalUdf_7aMQ</span></span>
<span><span class="co">## #define _solveData _rx14f172af8145a690eda8fb18e2ff73872__solveData_3GOp</span></span>
<span><span class="co">## #define _assign_ptr _rx14f172af8145a690eda8fb18e2ff73873__assign_ptr_rcmM</span></span>
<span><span class="co">## #define _rxRmModelLib _rx14f172af8145a690eda8fb18e2ff73874__rxRmModelLib_PhpE</span></span>
<span><span class="co">## #define _rxGetModelLib _rx14f172af8145a690eda8fb18e2ff73875__rxGetModelLib_lMX5</span></span>
<span><span class="co">## #define _old_c _rx14f172af8145a690eda8fb18e2ff73876__old_c_AtQk</span></span>
<span><span class="co">## #define _ptrid _rx14f172af8145a690eda8fb18e2ff73877__ptrid_pxgV</span></span>
<span><span class="co">## #define _rxIsCurrentC _rx14f172af8145a690eda8fb18e2ff73878__rxIsCurrentC_HE0j</span></span>
<span><span class="co">## #define _sumPS _rx14f172af8145a690eda8fb18e2ff73879__sumPS_F91U</span></span>
<span><span class="co">## #define _prodPS _rx14f172af8145a690eda8fb18e2ff738710__prodPS_6nLw</span></span>
<span><span class="co">## #define _prodType _rx14f172af8145a690eda8fb18e2ff738711__prodType_FTBa</span></span>
<span><span class="co">## #define _sumType _rx14f172af8145a690eda8fb18e2ff738712__sumType_SSOV</span></span>
<span><span class="co">## #define _update_par_ptr _rx14f172af8145a690eda8fb18e2ff738713__update_par_ptr_17TO</span></span>
<span><span class="co">## #define _getParCov _rx14f172af8145a690eda8fb18e2ff738714__getParCov_plZR</span></span>
<span><span class="co">## #define _rxode2_rxAssignPtr _rx14f172af8145a690eda8fb18e2ff738715__rxode2_rxAssignPtr_5D4X</span></span>
<span><span class="co">## #define _rxQr _rx14f172af8145a690eda8fb18e2ff738716__rxQr_dW2X</span></span>
<span><span class="co">## #define _compareFactorVal _rx14f172af8145a690eda8fb18e2ff738717__compareFactorVal_NxFC</span></span>
<span><span class="co">## #define _sum _rx14f172af8145a690eda8fb18e2ff738718__sum_rSDc</span></span>
<span><span class="co">## #define _udf _rx14f172af8145a690eda8fb18e2ff738719__udf_C1nH</span></span>
<span><span class="co">## #define _sign _rx14f172af8145a690eda8fb18e2ff738720__sign_AAUi</span></span>
<span><span class="co">## #define _prod _rx14f172af8145a690eda8fb18e2ff738721__prod_aWNp</span></span>
<span><span class="co">## #define _max _rx14f172af8145a690eda8fb18e2ff738722__max_FXk1</span></span>
<span><span class="co">## #define _min _rx14f172af8145a690eda8fb18e2ff738723__min_L3MP</span></span>
<span><span class="co">## #define _transit4P _rx14f172af8145a690eda8fb18e2ff738724__transit4P_utyT</span></span>
<span><span class="co">## #define _transit3P _rx14f172af8145a690eda8fb18e2ff738725__transit3P_gQmq</span></span>
<span><span class="co">## #define _assignFuns0 _rx14f172af8145a690eda8fb18e2ff738726__assignFuns0_BWhu</span></span>
<span><span class="co">## #define _assignFuns _rx14f172af8145a690eda8fb18e2ff738727__assignFuns_Gnch</span></span>
<span><span class="co">## #define _rxord _rx14f172af8145a690eda8fb18e2ff738728__rxord_6KKZ</span></span>
<span><span class="co">## #define __assignFuns2 _rx14f172af8145a690eda8fb18e2ff738729___assignFuns2_CDdL</span></span>
<span><span class="co">## #define _llikCauchyDscale _rx14f172af8145a690eda8fb18e2ff738730__llikCauchyDscale_rwt2</span></span>
<span><span class="co">## #define _llikCauchyDlocation _rx14f172af8145a690eda8fb18e2ff738731__llikCauchyDlocation_lEJH</span></span>
<span><span class="co">## #define _llikCauchy _rx14f172af8145a690eda8fb18e2ff738732__llikCauchy_ir6Y</span></span>
<span><span class="co">## #define _llikGammaDrate _rx14f172af8145a690eda8fb18e2ff738733__llikGammaDrate_eE4v</span></span>
<span><span class="co">## #define _llikGammaDshape _rx14f172af8145a690eda8fb18e2ff738734__llikGammaDshape_9oPb</span></span>
<span><span class="co">## #define _llikGamma _rx14f172af8145a690eda8fb18e2ff738735__llikGamma_4usC</span></span>
<span><span class="co">## #define _llikWeibullDscale _rx14f172af8145a690eda8fb18e2ff738736__llikWeibullDscale_49KB</span></span>
<span><span class="co">## #define _llikWeibullDshape _rx14f172af8145a690eda8fb18e2ff738737__llikWeibullDshape_9Iw6</span></span>
<span><span class="co">## #define _llikWeibull _rx14f172af8145a690eda8fb18e2ff738738__llikWeibull_iWPP</span></span>
<span><span class="co">## #define _llikUnifDbeta _rx14f172af8145a690eda8fb18e2ff738739__llikUnifDbeta_lGly</span></span>
<span><span class="co">## #define _llikUnifDalpha _rx14f172af8145a690eda8fb18e2ff738740__llikUnifDalpha_faYl</span></span>
<span><span class="co">## #define _llikUnif _rx14f172af8145a690eda8fb18e2ff738741__llikUnif_khzS</span></span>
<span><span class="co">## #define _llikGeomDp _rx14f172af8145a690eda8fb18e2ff738742__llikGeomDp_7ETL</span></span>
<span><span class="co">## #define _llikGeom _rx14f172af8145a690eda8fb18e2ff738743__llikGeom_K7QT</span></span>
<span><span class="co">## #define _llikFDdf2 _rx14f172af8145a690eda8fb18e2ff738744__llikFDdf2_Wcsg</span></span>
<span><span class="co">## #define _llikFDdf1 _rx14f172af8145a690eda8fb18e2ff738745__llikFDdf1_iB44</span></span>
<span><span class="co">## #define _llikF _rx14f172af8145a690eda8fb18e2ff738746__llikF_3WoR</span></span>
<span><span class="co">## #define _llikExpDrate _rx14f172af8145a690eda8fb18e2ff738747__llikExpDrate_YHti</span></span>
<span><span class="co">## #define _llikExp _rx14f172af8145a690eda8fb18e2ff738748__llikExp_DXfq</span></span>
<span><span class="co">## #define _llikChisqDdf _rx14f172af8145a690eda8fb18e2ff738749__llikChisqDdf_9flz</span></span>
<span><span class="co">## #define _llikChisq _rx14f172af8145a690eda8fb18e2ff738750__llikChisq_Gsif</span></span>
<span><span class="co">## #define _llikTDsd _rx14f172af8145a690eda8fb18e2ff738751__llikTDsd_kP3l</span></span>
<span><span class="co">## #define _llikTDmean _rx14f172af8145a690eda8fb18e2ff738752__llikTDmean_qWr7</span></span>
<span><span class="co">## #define _llikTDdf _rx14f172af8145a690eda8fb18e2ff738753__llikTDdf_6grl</span></span>
<span><span class="co">## #define _llikT _rx14f172af8145a690eda8fb18e2ff738754__llikT_JENn</span></span>
<span><span class="co">## #define _llikBetaDshape2 _rx14f172af8145a690eda8fb18e2ff738755__llikBetaDshape2_oOWS</span></span>
<span><span class="co">## #define _llikBetaDshape1 _rx14f172af8145a690eda8fb18e2ff738756__llikBetaDshape1_qDlH</span></span>
<span><span class="co">## #define _llikBeta _rx14f172af8145a690eda8fb18e2ff738757__llikBeta_tWpj</span></span>
<span><span class="co">## #define _llikNbinomMuDmu _rx14f172af8145a690eda8fb18e2ff738758__llikNbinomMuDmu_JXZ3</span></span>
<span><span class="co">## #define _llikNbinomMu _rx14f172af8145a690eda8fb18e2ff738759__llikNbinomMu_Uh7t</span></span>
<span><span class="co">## #define _llikNbinomDprob _rx14f172af8145a690eda8fb18e2ff738760__llikNbinomDprob_jjBs</span></span>
<span><span class="co">## #define _llikNbinom _rx14f172af8145a690eda8fb18e2ff738761__llikNbinom_bD8o</span></span>
<span><span class="co">## #define _llikBinomDprob _rx14f172af8145a690eda8fb18e2ff738762__llikBinomDprob_MR7p</span></span>
<span><span class="co">## #define _llikBinom _rx14f172af8145a690eda8fb18e2ff738763__llikBinom_vIjP</span></span>
<span><span class="co">## #define _llikPoisDlambda _rx14f172af8145a690eda8fb18e2ff738764__llikPoisDlambda_1OFS</span></span>
<span><span class="co">## #define _llikPois _rx14f172af8145a690eda8fb18e2ff738765__llikPois_KsAz</span></span>
<span><span class="co">## #define _llikNormDsd _rx14f172af8145a690eda8fb18e2ff738766__llikNormDsd_gElz</span></span>
<span><span class="co">## #define _llikNormDmean _rx14f172af8145a690eda8fb18e2ff738767__llikNormDmean_kjp1</span></span>
<span><span class="co">## #define _llikNorm _rx14f172af8145a690eda8fb18e2ff738768__llikNorm_2z7v</span></span>
<span><span class="co">## #define simeps _rx14f172af8145a690eda8fb18e2ff738769_simeps_1yvY</span></span>
<span><span class="co">## #define simeta _rx14f172af8145a690eda8fb18e2ff738770_simeta_esry</span></span>
<span><span class="co">## #define expit _rx14f172af8145a690eda8fb18e2ff738771_expit_hzXR</span></span>
<span><span class="co">## #define logit _rx14f172af8145a690eda8fb18e2ff738772_logit_u5XA</span></span>
<span><span class="co">## #define gammapDer _rx14f172af8145a690eda8fb18e2ff738773_gammapDer_L0Oa</span></span>
<span><span class="co">## #define lowergamma _rx14f172af8145a690eda8fb18e2ff738774_lowergamma_shCN</span></span>
<span><span class="co">## #define uppergamma _rx14f172af8145a690eda8fb18e2ff738775_uppergamma_Bo0M</span></span>
<span><span class="co">## #define gammaqInva _rx14f172af8145a690eda8fb18e2ff738776_gammaqInva_jOs8</span></span>
<span><span class="co">## #define gammaqInv _rx14f172af8145a690eda8fb18e2ff738777_gammaqInv_7C3a</span></span>
<span><span class="co">## #define gammapInva _rx14f172af8145a690eda8fb18e2ff738778_gammapInva_kaIz</span></span>
<span><span class="co">## #define gammapInv _rx14f172af8145a690eda8fb18e2ff738779_gammapInv_hGFN</span></span>
<span><span class="co">## #define gammaq _rx14f172af8145a690eda8fb18e2ff738780_gammaq_KxFa</span></span>
<span><span class="co">## #define gammap _rx14f172af8145a690eda8fb18e2ff738781_gammap_pC4k</span></span>
<span><span class="co">## #define phi _rx14f172af8145a690eda8fb18e2ff738782_phi_Zj4v</span></span>
<span><span class="co">## #define d2ELUa _rx14f172af8145a690eda8fb18e2ff738783_d2ELUa_7lL7</span></span>
<span><span class="co">## #define dELUa _rx14f172af8145a690eda8fb18e2ff738784_dELUa_Y8rq</span></span>
<span><span class="co">## #define d2aELU _rx14f172af8145a690eda8fb18e2ff738785_d2aELU_Hoty</span></span>
<span><span class="co">## #define d2ELU _rx14f172af8145a690eda8fb18e2ff738786_d2ELU_aeNT</span></span>
<span><span class="co">## #define dELU _rx14f172af8145a690eda8fb18e2ff738787_dELU_pohj</span></span>
<span><span class="co">## #define ELU _rx14f172af8145a690eda8fb18e2ff738788_ELU_fHjH</span></span>
<span><span class="co">## #define dPReLUa1 _rx14f172af8145a690eda8fb18e2ff738789_dPReLUa1_5dQM</span></span>
<span><span class="co">## #define dPReLUa _rx14f172af8145a690eda8fb18e2ff738790_dPReLUa_jxyM</span></span>
<span><span class="co">## #define dPReLU _rx14f172af8145a690eda8fb18e2ff738791_dPReLU_N5bT</span></span>
<span><span class="co">## #define PReLU _rx14f172af8145a690eda8fb18e2ff738792_PReLU_kJW4</span></span>
<span><span class="co">## #define dSwish _rx14f172af8145a690eda8fb18e2ff738793_dSwish_XOqp</span></span>
<span><span class="co">## #define Swish _rx14f172af8145a690eda8fb18e2ff738794_Swish_FP6W</span></span>
<span><span class="co">## #define dlReLU _rx14f172af8145a690eda8fb18e2ff738795_dlReLU_4DNf</span></span>
<span><span class="co">## #define lReLU _rx14f172af8145a690eda8fb18e2ff738796_lReLU_2g5j</span></span>
<span><span class="co">## #define dSELU _rx14f172af8145a690eda8fb18e2ff738797_dSELU_8c8u</span></span>
<span><span class="co">## #define SELU _rx14f172af8145a690eda8fb18e2ff738798_SELU_tgdk</span></span>
<span><span class="co">## #define d4softplus _rx14f172af8145a690eda8fb18e2ff738799_d4softplus_uMoD</span></span>
<span><span class="co">## #define d3softplus _rx14f172af8145a690eda8fb18e2ff7387100_d3softplus_8Igg</span></span>
<span><span class="co">## #define d2softplus _rx14f172af8145a690eda8fb18e2ff7387101_d2softplus_qa61</span></span>
<span><span class="co">## #define dsoftplus _rx14f172af8145a690eda8fb18e2ff7387102_dsoftplus_Q86S</span></span>
<span><span class="co">## #define softplus _rx14f172af8145a690eda8fb18e2ff7387103_softplus_Yctr</span></span>
<span><span class="co">## #define d4GELU _rx14f172af8145a690eda8fb18e2ff7387104_d4GELU_Kx2z</span></span>
<span><span class="co">## #define d3GELU _rx14f172af8145a690eda8fb18e2ff7387105_d3GELU_df55</span></span>
<span><span class="co">## #define d2GELU _rx14f172af8145a690eda8fb18e2ff7387106_d2GELU_lBL3</span></span>
<span><span class="co">## #define dGELU _rx14f172af8145a690eda8fb18e2ff7387107_dGELU_KI9t</span></span>
<span><span class="co">## #define GELU _rx14f172af8145a690eda8fb18e2ff7387108_GELU_NzO8</span></span>
<span><span class="co">## #define dReLU _rx14f172af8145a690eda8fb18e2ff7387109_dReLU_faNu</span></span>
<span><span class="co">## #define ReLU _rx14f172af8145a690eda8fb18e2ff7387110_ReLU_TDlv</span></span>
<span><span class="co">## #define riweibull _rx14f172af8145a690eda8fb18e2ff7387111_riweibull_X2wM</span></span>
<span><span class="co">## #define riunif _rx14f172af8145a690eda8fb18e2ff7387112_riunif_iHu0</span></span>
<span><span class="co">## #define rit_ _rx14f172af8145a690eda8fb18e2ff7387113_rit__OE6M</span></span>
<span><span class="co">## #define ripois _rx14f172af8145a690eda8fb18e2ff7387114_ripois_OKVz</span></span>
<span><span class="co">## #define ribeta _rx14f172af8145a690eda8fb18e2ff7387115_ribeta_eamr</span></span>
<span><span class="co">## #define rigamma _rx14f172af8145a690eda8fb18e2ff7387116_rigamma_CO0h</span></span>
<span><span class="co">## #define rigeom _rx14f172af8145a690eda8fb18e2ff7387117_rigeom_8M52</span></span>
<span><span class="co">## #define rif _rx14f172af8145a690eda8fb18e2ff7387118_rif_w8lE</span></span>
<span><span class="co">## #define riexp _rx14f172af8145a690eda8fb18e2ff7387119_riexp_nvee</span></span>
<span><span class="co">## #define richisq _rx14f172af8145a690eda8fb18e2ff7387120_richisq_hHRF</span></span>
<span><span class="co">## #define ricauchy _rx14f172af8145a690eda8fb18e2ff7387121_ricauchy_XFMT</span></span>
<span><span class="co">## #define rinbinomMu _rx14f172af8145a690eda8fb18e2ff7387122_rinbinomMu_MJqN</span></span>
<span><span class="co">## #define rinbinom _rx14f172af8145a690eda8fb18e2ff7387123_rinbinom_rzpI</span></span>
<span><span class="co">## #define ribinom _rx14f172af8145a690eda8fb18e2ff7387124_ribinom_4YB5</span></span>
<span><span class="co">## #define rinorm _rx14f172af8145a690eda8fb18e2ff7387125_rinorm_Furm</span></span>
<span><span class="co">## #define rxweibull _rx14f172af8145a690eda8fb18e2ff7387126_rxweibull_FJ7v</span></span>
<span><span class="co">## #define rxunif _rx14f172af8145a690eda8fb18e2ff7387127_rxunif_8a9d</span></span>
<span><span class="co">## #define rxt_ _rx14f172af8145a690eda8fb18e2ff7387128_rxt__eygz</span></span>
<span><span class="co">## #define rxpois _rx14f172af8145a690eda8fb18e2ff7387129_rxpois_0bVb</span></span>
<span><span class="co">## #define rxbeta _rx14f172af8145a690eda8fb18e2ff7387130_rxbeta_pzmx</span></span>
<span><span class="co">## #define rxgamma _rx14f172af8145a690eda8fb18e2ff7387131_rxgamma_Xm0k</span></span>
<span><span class="co">## #define rxgeom _rx14f172af8145a690eda8fb18e2ff7387132_rxgeom_V0Mz</span></span>
<span><span class="co">## #define rxf _rx14f172af8145a690eda8fb18e2ff7387133_rxf_OBMR</span></span>
<span><span class="co">## #define rxexp _rx14f172af8145a690eda8fb18e2ff7387134_rxexp_J0aj</span></span>
<span><span class="co">## #define rxchisq _rx14f172af8145a690eda8fb18e2ff7387135_rxchisq_zPvV</span></span>
<span><span class="co">## #define rxcauchy _rx14f172af8145a690eda8fb18e2ff7387136_rxcauchy_ECJJ</span></span>
<span><span class="co">## #define rxnbinomMu _rx14f172af8145a690eda8fb18e2ff7387137_rxnbinomMu_kkzi</span></span>
<span><span class="co">## #define rxnbinom _rx14f172af8145a690eda8fb18e2ff7387138_rxnbinom_cNW8</span></span>
<span><span class="co">## #define rxbinom _rx14f172af8145a690eda8fb18e2ff7387139_rxbinom_7Ns1</span></span>
<span><span class="co">## #define rxnorm _rx14f172af8145a690eda8fb18e2ff7387140_rxnorm_Wg6Z</span></span>
<span><span class="co">## #define linCmtB _rx14f172af8145a690eda8fb18e2ff7387141_linCmtB_WGOj</span></span>
<span><span class="co">## #define linCmtA _rx14f172af8145a690eda8fb18e2ff7387142_linCmtA_bOuz</span></span>
<span><span class="co">## #include &lt;rxode2_model_shared.h&gt;</span></span>
<span><span class="co">## #define __MAX_PROD__ 0</span></span>
<span><span class="co">## #define _CMT CMT</span></span>
<span><span class="co">## #define _SYNC_simeps_ for (int _svari=_solveData-&gt;neps; _svari--;){  if (_solveData-&gt;svar[_svari] == 0) {TKA = _PP[0];};   if (_solveData-&gt;svar[_svari] == 1) {TCL = _PP[1];};   if (_solveData-&gt;svar[_svari] == 2) {TV2 = _PP[2];};   if (_solveData-&gt;svar[_svari] == 3) {TQ = _PP[3];};   if (_solveData-&gt;svar[_svari] == 4) {TV3 = _PP[4];};   if (_solveData-&gt;svar[_svari] == 5) {TKin = _PP[5];};   if (_solveData-&gt;svar[_svari] == 6) {TKout = _PP[6];};   if (_solveData-&gt;svar[_svari] == 7) {TEC50 = _PP[7];};   if (_solveData-&gt;svar[_svari] == 8) {WT = _PP[8];};   if (_solveData-&gt;svar[_svari] == 9) {Tz = _PP[9];};   if (_solveData-&gt;svar[_svari] == 10) {amp = _PP[10];}; }</span></span>
<span><span class="co">## #define _SYNC_simeta_ for (int _ovari=_solveData-&gt;neta; _ovari--;){  if (_solveData-&gt;ovar[_ovari] == 0) {TKA = _PP[0];};   if (_solveData-&gt;ovar[_ovari] == 1) {TCL = _PP[1];};   if (_solveData-&gt;ovar[_ovari] == 2) {TV2 = _PP[2];};   if (_solveData-&gt;ovar[_ovari] == 3) {TQ = _PP[3];};   if (_solveData-&gt;ovar[_ovari] == 4) {TV3 = _PP[4];};   if (_solveData-&gt;ovar[_ovari] == 5) {TKin = _PP[5];};   if (_solveData-&gt;ovar[_ovari] == 6) {TKout = _PP[6];};   if (_solveData-&gt;ovar[_ovari] == 7) {TEC50 = _PP[7];};   if (_solveData-&gt;ovar[_ovari] == 8) {WT = _PP[8];};   if (_solveData-&gt;ovar[_ovari] == 9) {Tz = _PP[9];};   if (_solveData-&gt;ovar[_ovari] == 10) {amp = _PP[10];}; }</span></span>
<span><span class="co">## _getRxSolve_t _getRxSolve_;</span></span>
<span><span class="co">## _simfun simeps;</span></span>
<span><span class="co">## _simfun simeta;</span></span>
<span><span class="co">## _udf_type _evalUdf=NULL;</span></span>
<span><span class="co">## rx_solve *_solveData=NULL;</span></span>
<span><span class="co">## rxode2_assign_ptr _assign_ptr=NULL;</span></span>
<span><span class="co">## _rxRmModelLibType _rxRmModelLib=NULL;</span></span>
<span><span class="co">## _rxGetModelLibType _rxGetModelLib=NULL;</span></span>
<span><span class="co">## rxode2_ode_solver_old_c _old_c=NULL;</span></span>
<span><span class="co">## rxode2_fn0i _ptrid=NULL;</span></span>
<span><span class="co">## _rxIsCurrentC_type _rxIsCurrentC=NULL;</span></span>
<span><span class="co">## _rxSumType _sumPS=NULL;</span></span>
<span><span class="co">## _rxProdType _prodPS=NULL;</span></span>
<span><span class="co">## rxode2_fn0i _prodType=NULL;</span></span>
<span><span class="co">## rxode2_fn0i _sumType=NULL;</span></span>
<span><span class="co">## _update_par_ptr_p _update_par_ptr=NULL;</span></span>
<span><span class="co">## _getParCov_p _getParCov=NULL;</span></span>
<span><span class="co">## linCmtA_p linCmtA;</span></span>
<span><span class="co">## linCmtB_p linCmtB;</span></span>
<span><span class="co">## _rx_asgn _rxode2_rxAssignPtr=NULL;</span></span>
<span><span class="co">## _rx_asgn _rxQr=NULL;</span></span>
<span><span class="co">## rxode2_fn phi;</span></span>
<span><span class="co">## rxode2_fn ReLU;</span></span>
<span><span class="co">## rxode2_fn dReLU;</span></span>
<span><span class="co">## rxode2_fn GELU;</span></span>
<span><span class="co">## rxode2_fn dGELU;</span></span>
<span><span class="co">## rxode2_fn d2GELU;</span></span>
<span><span class="co">## rxode2_fn d3GELU;</span></span>
<span><span class="co">## rxode2_fn d4GELU;</span></span>
<span><span class="co">## rxode2_fn softplus;</span></span>
<span><span class="co">## rxode2_fn dsoftplus;</span></span>
<span><span class="co">## rxode2_fn d2softplus;</span></span>
<span><span class="co">## rxode2_fn d3softplus;</span></span>
<span><span class="co">## rxode2_fn d4softplus;</span></span>
<span><span class="co">## rxode2_fn SELU;</span></span>
<span><span class="co">## rxode2_fn dSELU;</span></span>
<span><span class="co">## rxode2_fn lReLU;</span></span>
<span><span class="co">## rxode2_fn dlReLU;</span></span>
<span><span class="co">## rxode2_fn Swish;</span></span>
<span><span class="co">## rxode2_fn dSwish;</span></span>
<span><span class="co">## rxode2_fn2 PReLU;</span></span>
<span><span class="co">## rxode2_fn2 dPReLU;</span></span>
<span><span class="co">## rxode2_fn2 dPReLUa;</span></span>
<span><span class="co">## rxode2_fn2 dPReLUa1;</span></span>
<span><span class="co">## rxode2_fn2 ELU;</span></span>
<span><span class="co">## rxode2_fn2 dELU;</span></span>
<span><span class="co">## rxode2_fn2 d2ELU;</span></span>
<span><span class="co">## rxode2_fn2 d2aELU;</span></span>
<span><span class="co">## rxode2_fn2 dELUa;</span></span>
<span><span class="co">## rxode2_fn2 d2ELUa;</span></span>
<span><span class="co">## rxode2_fn3 logit;</span></span>
<span><span class="co">## rxode2_fn3 expit;</span></span>
<span><span class="co">## rxode2_fn2 gammap;</span></span>
<span><span class="co">## rxode2_fn2 gammaq;</span></span>
<span><span class="co">## rxode2_fn2 lowergamma;</span></span>
<span><span class="co">## rxode2_fn2 uppergamma;</span></span>
<span><span class="co">## rxode2_fn2 gammapInv;</span></span>
<span><span class="co">## rxode2_fn2 gammapDer;</span></span>
<span><span class="co">## rxode2_fn2 gammapInva;</span></span>
<span><span class="co">## rxode2_fn2 gammaqInv;</span></span>
<span><span class="co">## rxode2_fn2 gammaqInva;</span></span>
<span><span class="co">## rxode2i_fn2 rxnorm;</span></span>
<span><span class="co">## rxode2i_rxbinom rxbinom;</span></span>
<span><span class="co">## rxode2i_rxbinom rxnbinom;</span></span>
<span><span class="co">## rxode2i_rxbinom rxnbinomMu;</span></span>
<span><span class="co">## rxode2i_fn2 rxcauchy;</span></span>
<span><span class="co">## rxode2i_fn rxchisq;</span></span>
<span><span class="co">## rxode2i_fn rxexp;</span></span>
<span><span class="co">## rxode2i_fn2 rxf;</span></span>
<span><span class="co">## rxode2i_ifn rxgeom;</span></span>
<span><span class="co">## rxode2i_fn2 rxgamma;</span></span>
<span><span class="co">## rxode2i_fn2 rxbeta;</span></span>
<span><span class="co">## rxode2i_ifn rxpois;</span></span>
<span><span class="co">## rxode2i_fn rxt_;</span></span>
<span><span class="co">## rxode2i_fn2 rxunif;</span></span>
<span><span class="co">## rxode2i_fn2 rxweibull;</span></span>
<span><span class="co">## rxode2i2_fn2 rinorm;</span></span>
<span><span class="co">## rxode2i2_ribinom ribinom;</span></span>
<span><span class="co">## rxode2i2_ribinom rinbinom;</span></span>
<span><span class="co">## rxode2i2_ribinom rinbinomMu;</span></span>
<span><span class="co">## rxode2i2_fn2 ricauchy;</span></span>
<span><span class="co">## rxode2i2_fn richisq;</span></span>
<span><span class="co">## rxode2i2_fn riexp;</span></span>
<span><span class="co">## rxode2i2_fn2 rif;</span></span>
<span><span class="co">## rxode2i2_ifn rigeom;</span></span>
<span><span class="co">## rxode2i2_fn2 rigamma;</span></span>
<span><span class="co">## rxode2i2_fn2 ribeta;</span></span>
<span><span class="co">## rxode2i2_ifn ripois;</span></span>
<span><span class="co">## rxode2i2_fn rit_;</span></span>
<span><span class="co">## rxode2i2_fn2 riunif;</span></span>
<span><span class="co">## rxode2i2_fn2 riweibull;</span></span>
<span><span class="co">## rxode2_llikNormFun _llikNorm;</span></span>
<span><span class="co">## rxode2_llikNormFun _llikNormDmean;</span></span>
<span><span class="co">## rxode2_llikNormFun _llikNormDsd;</span></span>
<span><span class="co">## rxode2_llikPoisFun _llikPois;</span></span>
<span><span class="co">## rxode2_llikPoisFun _llikPoisDlambda;</span></span>
<span><span class="co">## rxode2_llikBinomFun _llikBinom;</span></span>
<span><span class="co">## rxode2_llikBinomFun _llikBinomDprob;</span></span>
<span><span class="co">## rxode2_llikBinomFun _llikNbinom;</span></span>
<span><span class="co">## rxode2_llikBinomFun _llikNbinomDprob;</span></span>
<span><span class="co">## rxode2_llikBinomFun _llikNbinomMu;</span></span>
<span><span class="co">## rxode2_llikBinomFun _llikNbinomMuDmu;</span></span>
<span><span class="co">## rxode2_llikBetaFun _llikBeta;</span></span>
<span><span class="co">## rxode2_llikBetaFun _llikBetaDshape1;</span></span>
<span><span class="co">## rxode2_llikBetaFun _llikBetaDshape2;</span></span>
<span><span class="co">## rxode2_llikTFun _llikT;</span></span>
<span><span class="co">## rxode2_llikTFun _llikTDdf;</span></span>
<span><span class="co">## rxode2_llikTFun _llikTDmean;</span></span>
<span><span class="co">## rxode2_llikTFun _llikTDsd;</span></span>
<span><span class="co">## rxode2_llikChisqFun _llikChisq;</span></span>
<span><span class="co">## rxode2_llikChisqFun _llikChisqDdf;</span></span>
<span><span class="co">## rxode2_llikExpFun _llikExp;</span></span>
<span><span class="co">## rxode2_llikExpFun _llikExpDrate;</span></span>
<span><span class="co">## rxode2_llikFFun _llikF;</span></span>
<span><span class="co">## rxode2_llikFFun _llikFDdf1;</span></span>
<span><span class="co">## rxode2_llikFFun _llikFDdf2;</span></span>
<span><span class="co">## rxode2_llikGeomFun _llikGeom;</span></span>
<span><span class="co">## rxode2_llikGeomFun _llikGeomDp;</span></span>
<span><span class="co">## rxode2_llikUnifFun _llikUnif;</span></span>
<span><span class="co">## rxode2_llikUnifFun _llikUnifDalpha;</span></span>
<span><span class="co">## rxode2_llikUnifFun _llikUnifDbeta;</span></span>
<span><span class="co">## rxode2_llikWeibullFun _llikWeibull;</span></span>
<span><span class="co">## rxode2_llikWeibullFun _llikWeibullDshape;</span></span>
<span><span class="co">## rxode2_llikWeibullFun _llikWeibullDscale;</span></span>
<span><span class="co">## rxode2_llikGammaFun _llikGamma;</span></span>
<span><span class="co">## rxode2_llikGammaFun _llikGammaDshape;</span></span>
<span><span class="co">## rxode2_llikGammaFun _llikGammaDrate;</span></span>
<span><span class="co">## rxode2_llikCauchyFun _llikCauchy;</span></span>
<span><span class="co">## rxode2_llikCauchyFun _llikCauchyDlocation;</span></span>
<span><span class="co">## rxode2_llikCauchyFun _llikCauchyDscale;</span></span>
<span><span class="co">## rxode2_compareFactorVal_fn _compareFactorVal;</span></span>
<span><span class="co">## #include "extraC.h"</span></span>
<span><span class="co">## double _prod(double *input, double *p, int type, int n, ...){</span></span>
<span><span class="co">##   va_list valist;</span></span>
<span><span class="co">##   va_start(valist, n);</span></span>
<span><span class="co">##   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">##     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">##   }</span></span>
<span><span class="co">##   va_end(valist);</span></span>
<span><span class="co">##   return _prodPS(input, p, n, type);</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## double _udf(const char *funName, double *input, int n, ...) {</span></span>
<span><span class="co">##   if (n == -42) Rf_error("%s", "this has a ui user function that cannot be called directly");</span></span>
<span><span class="co">##   va_list valist;</span></span>
<span><span class="co">##   va_start(valist, n);</span></span>
<span><span class="co">##   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">##     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">##   }</span></span>
<span><span class="co">##   va_end(valist);</span></span>
<span><span class="co">##   return _evalUdf(funName, n, input);</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## double _sum(double *input, double *pld, int m, int type, int n, ...){</span></span>
<span><span class="co">##   va_list valist;</span></span>
<span><span class="co">##   va_start(valist, n);</span></span>
<span><span class="co">##   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">##     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">##   }</span></span>
<span><span class="co">##   va_end(valist);</span></span>
<span><span class="co">##   double ret = _sumPS(input, n, pld, m, type);</span></span>
<span><span class="co">##   if (type == 2 &amp;&amp; m &lt; 0){</span></span>
<span><span class="co">##     for (int i = -m; i--;){</span></span>
<span><span class="co">##       pld[i] = 0.0;</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##   }</span></span>
<span><span class="co">##   return ret;</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## double _sign(unsigned int n, ...) {</span></span>
<span><span class="co">##   va_list valist;</span></span>
<span><span class="co">##   va_start(valist, n);</span></span>
<span><span class="co">##   double s = 1;</span></span>
<span><span class="co">##   for (unsigned int i = 0; i &lt; n; i++) {</span></span>
<span><span class="co">##     s = sign(va_arg(valist, double))*s;</span></span>
<span><span class="co">##     if (s == 0){</span></span>
<span><span class="co">##       break;</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##   }</span></span>
<span><span class="co">##   va_end(valist);</span></span>
<span><span class="co">##   return s;</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## double _rxord(int _cSub, unsigned int n,  ...) {</span></span>
<span><span class="co">##   rx_solving_options_ind* ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">##   if (!ind-&gt;inLhs) {</span></span>
<span><span class="co">##     return 1.0;</span></span>
<span><span class="co">##   }</span></span>
<span><span class="co">##   va_list valist;</span></span>
<span><span class="co">##   va_start(valist, n);</span></span>
<span><span class="co">##   double ret = 1.0;</span></span>
<span><span class="co">##   double p = 0.0;</span></span>
<span><span class="co">##   double u = rxunif(ind, 0.0, 1.0);</span></span>
<span><span class="co">##   int found = 0;</span></span>
<span><span class="co">##   for (unsigned int i = 0; i &lt; n; i++) {</span></span>
<span><span class="co">##     p += va_arg(valist, double);</span></span>
<span><span class="co">##     if (!found) {</span></span>
<span><span class="co">##       if (u &lt; p) {</span></span>
<span><span class="co">##         ret = (double)(i+1);</span></span>
<span><span class="co">##         found = 1;</span></span>
<span><span class="co">##       }</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##   }</span></span>
<span><span class="co">##   if (!found) ret =(double)(n+1);</span></span>
<span><span class="co">##   va_end(valist);</span></span>
<span><span class="co">##   return ret;</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## double _max(unsigned int n, ...) {</span></span>
<span><span class="co">##   va_list valist;</span></span>
<span><span class="co">##   va_start(valist, n);</span></span>
<span><span class="co">##   double mx = NA_REAL;</span></span>
<span><span class="co">##   double tmp = 0;</span></span>
<span><span class="co">##   if (n &gt;= 1){</span></span>
<span><span class="co">##     mx = va_arg(valist, double);</span></span>
<span><span class="co">##     for (unsigned int i = 1; i &lt; n; i++) {</span></span>
<span><span class="co">##       tmp = va_arg(valist, double);</span></span>
<span><span class="co">##       if (tmp&gt;mx) mx=tmp;</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     va_end(valist);</span></span>
<span><span class="co">##   }</span></span>
<span><span class="co">##   return mx;</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## double _min(unsigned int n, ...){</span></span>
<span><span class="co">##   va_list valist;</span></span>
<span><span class="co">##   va_start(valist, n);</span></span>
<span><span class="co">##   double mn = NA_REAL;</span></span>
<span><span class="co">##   double tmp = 0;</span></span>
<span><span class="co">##   if (n &gt;= 1){</span></span>
<span><span class="co">##     mn = va_arg(valist, double);</span></span>
<span><span class="co">##     for (unsigned int i = 1; i &lt; n; i++){</span></span>
<span><span class="co">##       tmp = va_arg(valist, double);</span></span>
<span><span class="co">##       if (tmp&lt;mn) mn=tmp;</span></span>
<span><span class="co">##     }</span></span>
<span><span class="co">##     va_end(valist);</span></span>
<span><span class="co">##   }</span></span>
<span><span class="co">##   return mn;</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## double _transit4P(int cmt, double t, unsigned int id, double n, double mtt, double bio){</span></span>
<span><span class="co">##   double nd = (double) n;</span></span>
<span><span class="co">##   double ktr = (nd+1)/mtt;</span></span>
<span><span class="co">##   double lktr = _safe_log(nd+1)-_safe_log(mtt);</span></span>
<span><span class="co">##   double tlast = _solveData-&gt;subjects[id].tlastS[cmt];</span></span>
<span><span class="co">##   double dose = _solveData-&gt;subjects[id].curDoseS[cmt];</span></span>
<span><span class="co">##   if (ISNA(dose)) dose = 0.0;</span></span>
<span><span class="co">##   if (ISNA(tlast)) tlast = 0.0;</span></span>
<span><span class="co">##   double tad = (t-tlast);</span></span>
<span><span class="co">##   return exp(_safe_log(bio*dose)+lktr+n*(lktr+_safe_log(tad))-ktr*(tad)-lgamma1p(nd));</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## double _transit3P(int cmt, double t, unsigned int id, double n, double mtt){</span></span>
<span><span class="co">##   double nd = (double) n;</span></span>
<span><span class="co">##   double ktr = (nd+1)/mtt;</span></span>
<span><span class="co">##   double lktr = _safe_log(nd+1)-_safe_log(mtt);</span></span>
<span><span class="co">##   double tlast = _solveData-&gt;subjects[id].tlastS[cmt];</span></span>
<span><span class="co">##   if (ISNA(tlast)) tlast = 0.0;</span></span>
<span><span class="co">##   double tad = t-tlast;</span></span>
<span><span class="co">##   double podo = _solveData-&gt;subjects[id].curDoseS[cmt];</span></span>
<span><span class="co">##   if (ISNA(podo)) podo = 0.0;</span></span>
<span><span class="co">##   return exp(_safe_log(podo)+lktr+n*(lktr+_safe_log(tad))-ktr*(tad)-lgamma1p(nd));</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## void _assignFuns0(void) {</span></span>
<span><span class="co">##   _evalUdf = (_udf_type) R_GetCCallable("rxode2", "_rxode2_evalUdf");</span></span>
<span><span class="co">##   _getRxSolve_ = (_getRxSolve_t) R_GetCCallable("rxode2","getRxSolve_");</span></span>
<span><span class="co">##   _assign_ptr=(rxode2_assign_ptr) R_GetCCallable("rxode2","rxode2_assign_fn_pointers");</span></span>
<span><span class="co">##   _rxRmModelLib=(_rxRmModelLibType) R_GetCCallable("rxode2","rxRmModelLib");</span></span>
<span><span class="co">##   _rxGetModelLib=(_rxGetModelLibType) R_GetCCallable("rxode2","rxGetModelLib");</span></span>
<span><span class="co">##   _rxode2_rxAssignPtr=(_rx_asgn)R_GetCCallable("rxode2","_rxode2_rxAssignPtr");</span></span>
<span><span class="co">##   _rxQr=(_rx_asgn)R_GetCCallable("rxode2","_rxode2_rxQr");</span></span>
<span><span class="co">##   _rxIsCurrentC = (_rxIsCurrentC_type)R_GetCCallable("rxode2","rxIsCurrentC");</span></span>
<span><span class="co">##   _sumPS  = (_rxSumType) R_GetCCallable("PreciseSums","PreciseSums_sum_r");</span></span>
<span><span class="co">##   _prodPS = (_rxProdType) R_GetCCallable("PreciseSums","PreciseSums_prod_r");</span></span>
<span><span class="co">##   _prodType=(rxode2_fn0i)R_GetCCallable("PreciseSums", "PreciseSums_prod_get");</span></span>
<span><span class="co">##   _sumType=(rxode2_fn0i)R_GetCCallable("PreciseSums", "PreciseSums_sum_get");</span></span>
<span><span class="co">##   _ptrid=(rxode2_fn0i)R_GetCCallable("rxode2", "rxode2_current_fn_pointer_id");</span></span>
<span><span class="co">##   _compareFactorVal=(rxode2_compareFactorVal_fn) R_GetCCallable("rxode2", "compareFactorVal");</span></span>
<span><span class="co">##   _update_par_ptr = (_update_par_ptr_p) R_GetCCallable("rxode2","_update_par_ptr");</span></span>
<span><span class="co">##   _getParCov = (_getParCov_p) R_GetCCallable("rxode2","_getParCov");</span></span>
<span><span class="co">##   // dynamic start</span></span>
<span><span class="co">##   _llikCauchyDscale = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchyDscale");</span></span>
<span><span class="co">##   _llikCauchyDlocation = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchyDlocation");</span></span>
<span><span class="co">##   _llikCauchy = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchy");</span></span>
<span><span class="co">##   _llikGammaDrate = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGammaDrate");</span></span>
<span><span class="co">##   _llikGammaDshape = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGammaDshape");</span></span>
<span><span class="co">##   _llikGamma = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGamma");</span></span>
<span><span class="co">##   _llikWeibullDscale = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibullDscale");</span></span>
<span><span class="co">##   _llikWeibullDshape = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibullDshape");</span></span>
<span><span class="co">##   _llikWeibull = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibull");</span></span>
<span><span class="co">##   _llikUnifDbeta = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnifDbeta");</span></span>
<span><span class="co">##   _llikUnifDalpha = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnifDalpha");</span></span>
<span><span class="co">##   _llikUnif = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnif");</span></span>
<span><span class="co">##   _llikGeomDp = (rxode2_llikGeomFun) R_GetCCallable("rxode2ll", "rxLlikGeomDp");</span></span>
<span><span class="co">##   _llikGeom = (rxode2_llikGeomFun) R_GetCCallable("rxode2ll", "rxLlikGeom");</span></span>
<span><span class="co">##   _llikFDdf2 = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikFDdf2");</span></span>
<span><span class="co">##   _llikFDdf1 = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikFDdf1");</span></span>
<span><span class="co">##   _llikF = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikF");</span></span>
<span><span class="co">##   _llikExpDrate = (rxode2_llikExpFun) R_GetCCallable("rxode2ll", "rxLlikExpDrate");</span></span>
<span><span class="co">##   _llikExp = (rxode2_llikExpFun) R_GetCCallable("rxode2ll", "rxLlikExp");</span></span>
<span><span class="co">##   _llikChisqDdf = (rxode2_llikChisqFun) R_GetCCallable("rxode2ll", "rxLlikChisqDdf");</span></span>
<span><span class="co">##   _llikChisq = (rxode2_llikChisqFun) R_GetCCallable("rxode2ll", "rxLlikChisq");</span></span>
<span><span class="co">##   _llikTDsd = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDsd");</span></span>
<span><span class="co">##   _llikTDmean = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDmean");</span></span>
<span><span class="co">##   _llikTDdf = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDdf");</span></span>
<span><span class="co">##   _llikT = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikT");</span></span>
<span><span class="co">##   _llikBetaDshape2 = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBetaDshape2");</span></span>
<span><span class="co">##   _llikBetaDshape1 = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBetaDshape1");</span></span>
<span><span class="co">##   _llikBeta = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBeta");</span></span>
<span><span class="co">##   _llikNbinomMuDmu = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomMuDmu");</span></span>
<span><span class="co">##   _llikNbinomMu = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomMu");</span></span>
<span><span class="co">##   _llikNbinomDprob = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomDprob");</span></span>
<span><span class="co">##   _llikNbinom = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinom");</span></span>
<span><span class="co">##   _llikBinomDprob = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikBinomDprob");</span></span>
<span><span class="co">##   _llikBinom = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikBinom");</span></span>
<span><span class="co">##   _llikPoisDlambda = (rxode2_llikPoisFun) R_GetCCallable("rxode2ll", "rxLlikPoisDlambda");</span></span>
<span><span class="co">##   _llikPois = (rxode2_llikPoisFun) R_GetCCallable("rxode2ll", "rxLlikPois");</span></span>
<span><span class="co">##   _llikNormDsd = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNormDsd");</span></span>
<span><span class="co">##   _llikNormDmean = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNormDmean");</span></span>
<span><span class="co">##   _llikNorm = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNorm");</span></span>
<span><span class="co">##   simeps = (_simfun) R_GetCCallable("rxode2", "simeps");</span></span>
<span><span class="co">##   simeta = (_simfun) R_GetCCallable("rxode2", "simeta");</span></span>
<span><span class="co">##   expit = (rxode2_fn3) R_GetCCallable("rxode2", "expit");</span></span>
<span><span class="co">##   logit = (rxode2_fn3) R_GetCCallable("rxode2", "logit");</span></span>
<span><span class="co">##   gammapDer = (rxode2_fn2) R_GetCCallable("rxode2", "gammapDer");</span></span>
<span><span class="co">##   lowergamma = (rxode2_fn2) R_GetCCallable("rxode2", "lowergamma");</span></span>
<span><span class="co">##   uppergamma = (rxode2_fn2) R_GetCCallable("rxode2", "uppergamma");</span></span>
<span><span class="co">##   gammaqInva = (rxode2_fn2) R_GetCCallable("rxode2", "gammaqInva");</span></span>
<span><span class="co">##   gammaqInv = (rxode2_fn2) R_GetCCallable("rxode2", "gammaqInv");</span></span>
<span><span class="co">##   gammapInva = (rxode2_fn2) R_GetCCallable("rxode2", "gammapInva");</span></span>
<span><span class="co">##   gammapInv = (rxode2_fn2) R_GetCCallable("rxode2", "gammapInv");</span></span>
<span><span class="co">##   gammaq = (rxode2_fn2) R_GetCCallable("rxode2", "gammaq");</span></span>
<span><span class="co">##   gammap = (rxode2_fn2) R_GetCCallable("rxode2", "gammap");</span></span>
<span><span class="co">##   phi = (rxode2_fn) R_GetCCallable("rxode2", "phi");</span></span>
<span><span class="co">##   d2ELUa = (rxode2_fn2) R_GetCCallable("rxode2", "d2ELUa");</span></span>
<span><span class="co">##   dELUa = (rxode2_fn2) R_GetCCallable("rxode2", "dELUa");</span></span>
<span><span class="co">##   d2aELU = (rxode2_fn2) R_GetCCallable("rxode2", "d2aELU");</span></span>
<span><span class="co">##   d2ELU = (rxode2_fn2) R_GetCCallable("rxode2", "d2ELU");</span></span>
<span><span class="co">##   dELU = (rxode2_fn2) R_GetCCallable("rxode2", "dELU");</span></span>
<span><span class="co">##   ELU = (rxode2_fn2) R_GetCCallable("rxode2", "ELU");</span></span>
<span><span class="co">##   dPReLUa1 = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLUa1");</span></span>
<span><span class="co">##   dPReLUa = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLUa");</span></span>
<span><span class="co">##   dPReLU = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLU");</span></span>
<span><span class="co">##   PReLU = (rxode2_fn2) R_GetCCallable("rxode2", "PReLU");</span></span>
<span><span class="co">##   dSwish = (rxode2_fn) R_GetCCallable("rxode2", "dSwish");</span></span>
<span><span class="co">##   Swish = (rxode2_fn) R_GetCCallable("rxode2", "Swish");</span></span>
<span><span class="co">##   dlReLU = (rxode2_fn) R_GetCCallable("rxode2", "dlReLU");</span></span>
<span><span class="co">##   lReLU = (rxode2_fn) R_GetCCallable("rxode2", "lReLU");</span></span>
<span><span class="co">##   dSELU = (rxode2_fn) R_GetCCallable("rxode2", "dSELU");</span></span>
<span><span class="co">##   SELU = (rxode2_fn) R_GetCCallable("rxode2", "SELU");</span></span>
<span><span class="co">##   d4softplus = (rxode2_fn) R_GetCCallable("rxode2", "d4softplus");</span></span>
<span><span class="co">##   d3softplus = (rxode2_fn) R_GetCCallable("rxode2", "d3softplus");</span></span>
<span><span class="co">##   d2softplus = (rxode2_fn) R_GetCCallable("rxode2", "d2softplus");</span></span>
<span><span class="co">##   dsoftplus = (rxode2_fn) R_GetCCallable("rxode2", "dsoftplus");</span></span>
<span><span class="co">##   softplus = (rxode2_fn) R_GetCCallable("rxode2", "softplus");</span></span>
<span><span class="co">##   d4GELU = (rxode2_fn) R_GetCCallable("rxode2", "d4GELU");</span></span>
<span><span class="co">##   d3GELU = (rxode2_fn) R_GetCCallable("rxode2", "d3GELU");</span></span>
<span><span class="co">##   d2GELU = (rxode2_fn) R_GetCCallable("rxode2", "d2GELU");</span></span>
<span><span class="co">##   dGELU = (rxode2_fn) R_GetCCallable("rxode2", "dGELU");</span></span>
<span><span class="co">##   GELU = (rxode2_fn) R_GetCCallable("rxode2", "GELU");</span></span>
<span><span class="co">##   dReLU = (rxode2_fn) R_GetCCallable("rxode2", "dReLU");</span></span>
<span><span class="co">##   ReLU = (rxode2_fn) R_GetCCallable("rxode2", "ReLU");</span></span>
<span><span class="co">##   riweibull = (rxode2i2_fn2) R_GetCCallable("rxode2", "riweibull");</span></span>
<span><span class="co">##   riunif = (rxode2i2_fn2) R_GetCCallable("rxode2", "riunif");</span></span>
<span><span class="co">##   rit_ = (rxode2i2_fn) R_GetCCallable("rxode2", "rit_");</span></span>
<span><span class="co">##   ripois = (rxode2i2_ifn) R_GetCCallable("rxode2", "ripois");</span></span>
<span><span class="co">##   ribeta = (rxode2i2_fn2) R_GetCCallable("rxode2", "ribeta");</span></span>
<span><span class="co">##   rigamma = (rxode2i2_fn2) R_GetCCallable("rxode2", "rigamma");</span></span>
<span><span class="co">##   rigeom = (rxode2i2_ifn) R_GetCCallable("rxode2", "rigeom");</span></span>
<span><span class="co">##   rif = (rxode2i2_fn2) R_GetCCallable("rxode2", "rif");</span></span>
<span><span class="co">##   riexp = (rxode2i2_fn) R_GetCCallable("rxode2", "riexp");</span></span>
<span><span class="co">##   richisq = (rxode2i2_fn) R_GetCCallable("rxode2", "richisq");</span></span>
<span><span class="co">##   ricauchy = (rxode2i2_fn2) R_GetCCallable("rxode2", "ricauchy");</span></span>
<span><span class="co">##   rinbinomMu = (rxode2i2_ribinom) R_GetCCallable("rxode2", "rinbinomMu");</span></span>
<span><span class="co">##   rinbinom = (rxode2i2_ribinom) R_GetCCallable("rxode2", "rinbinom");</span></span>
<span><span class="co">##   ribinom = (rxode2i2_ribinom) R_GetCCallable("rxode2", "ribinom");</span></span>
<span><span class="co">##   rinorm = (rxode2i2_fn2) R_GetCCallable("rxode2", "rinorm");</span></span>
<span><span class="co">##   rxweibull = (rxode2i_fn2) R_GetCCallable("rxode2", "rxweibull");</span></span>
<span><span class="co">##   rxunif = (rxode2i_fn2) R_GetCCallable("rxode2", "rxunif");</span></span>
<span><span class="co">##   rxt_ = (rxode2i_fn) R_GetCCallable("rxode2", "rxt_");</span></span>
<span><span class="co">##   rxpois = (rxode2i_ifn) R_GetCCallable("rxode2", "rxpois");</span></span>
<span><span class="co">##   rxbeta = (rxode2i_fn2) R_GetCCallable("rxode2", "rxbeta");</span></span>
<span><span class="co">##   rxgamma = (rxode2i_fn2) R_GetCCallable("rxode2", "rxgamma");</span></span>
<span><span class="co">##   rxgeom = (rxode2i_ifn) R_GetCCallable("rxode2", "rxgeom");</span></span>
<span><span class="co">##   rxf = (rxode2i_fn2) R_GetCCallable("rxode2", "rxf");</span></span>
<span><span class="co">##   rxexp = (rxode2i_fn) R_GetCCallable("rxode2", "rxexp");</span></span>
<span><span class="co">##   rxchisq = (rxode2i_fn) R_GetCCallable("rxode2", "rxchisq");</span></span>
<span><span class="co">##   rxcauchy = (rxode2i_fn2) R_GetCCallable("rxode2", "rxcauchy");</span></span>
<span><span class="co">##   rxnbinomMu = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxnbinomMu");</span></span>
<span><span class="co">##   rxnbinom = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxnbinom");</span></span>
<span><span class="co">##   rxbinom = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxbinom");</span></span>
<span><span class="co">##   rxnorm = (rxode2i_fn2) R_GetCCallable("rxode2", "rxnorm");</span></span>
<span><span class="co">##   linCmtB = (linCmtB_p) R_GetCCallable("rxode2", "linCmtB");</span></span>
<span><span class="co">##   linCmtA = (linCmtA_p) R_GetCCallable("rxode2", "linCmtA");</span></span>
<span><span class="co">##   // dynamic stop</span></span>
<span><span class="co">##   _solveData = _getRxSolve_();</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## void _assignFuns(void) {</span></span>
<span><span class="co">##   if (_assign_ptr == NULL){</span></span>
<span><span class="co">##     _assignFuns0();</span></span>
<span><span class="co">##   }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## void __assignFuns2(rx_solve rx,</span></span>
<span><span class="co">##                    rx_solving_options op,</span></span>
<span><span class="co">##                    t_F f,</span></span>
<span><span class="co">##                    t_LAG lag,</span></span>
<span><span class="co">##                    t_RATE rate,</span></span>
<span><span class="co">##                    t_DUR dur,</span></span>
<span><span class="co">##                    t_calc_mtime mtime,</span></span>
<span><span class="co">##                    t_ME me,</span></span>
<span><span class="co">##                    t_IndF indf,</span></span>
<span><span class="co">##                    t_getTime gettime,</span></span>
<span><span class="co">##                    t_locateTimeIndex timeindex,</span></span>
<span><span class="co">##                    t_handle_evidL handleEvid,</span></span>
<span><span class="co">##                    t_getDur getdur) {</span></span>
<span><span class="co">##   // assign start</span></span>
<span><span class="co">##     static rxode2_assignFuns2_t rxode2_assignFuns2 = NULL;</span></span>
<span><span class="co">##     if (rxode2_assignFuns2 == NULL) rxode2_assignFuns2 = (rxode2_assignFuns2_t)(R_GetCCallable("rxode2", "_rxode2_assignFuns2"));</span></span>
<span><span class="co">##     rxode2_assignFuns2(rx, op, f, lag, rate, dur, mtime, me, indf, gettime, timeindex, handleEvid, getdur);</span></span>
<span><span class="co">##   // assign stop</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## extern void  rx_67629c27e5da09d61f2b9775c5c9bf2f__ode_solver_solvedata (rx_solve *solve){</span></span>
<span><span class="co">##   _solveData = solve;</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## extern rx_solve *rx_67629c27e5da09d61f2b9775c5c9bf2f__ode_solver_get_solvedata(void){</span></span>
<span><span class="co">##   return _solveData;</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## SEXP rx_67629c27e5da09d61f2b9775c5c9bf2f__model_vars(void);</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## // prj-specific differential eqns</span></span>
<span><span class="co">## void rx_67629c27e5da09d61f2b9775c5c9bf2f__dydt(int *_neq, double __t, double *__zzStateVar__, double *__DDtStateVar__)</span></span>
<span><span class="co">## {</span></span>
<span><span class="co">##   int _itwhile = 0;</span></span>
<span><span class="co">##   (void)_itwhile;</span></span>
<span><span class="co">##   int _cSub = _neq[1];</span></span>
<span><span class="co">##   double t = __t + _solveData-&gt;subjects[_neq[1]].curShift;</span></span>
<span><span class="co">##   (void)t;</span></span>
<span><span class="co">##   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">##   _ind-&gt;_rxFlag=1;</span></span>
<span><span class="co">##   double TKA = NA_REAL;</span></span>
<span><span class="co">##   double TCL = NA_REAL;</span></span>
<span><span class="co">##   double TV2 = NA_REAL;</span></span>
<span><span class="co">##   double TQ = NA_REAL;</span></span>
<span><span class="co">##   double TV3 = NA_REAL;</span></span>
<span><span class="co">##   double TKin = NA_REAL;</span></span>
<span><span class="co">##   double TKout = NA_REAL;</span></span>
<span><span class="co">##   double TEC50 = NA_REAL;</span></span>
<span><span class="co">##   double WT = NA_REAL;</span></span>
<span><span class="co">##   double KA = NA_REAL;</span></span>
<span><span class="co">##   double CL = NA_REAL;</span></span>
<span><span class="co">##   double V2 = NA_REAL;</span></span>
<span><span class="co">##   double Q = NA_REAL;</span></span>
<span><span class="co">##   double V3 = NA_REAL;</span></span>
<span><span class="co">##   double Kin = NA_REAL;</span></span>
<span><span class="co">##   double Kout = NA_REAL;</span></span>
<span><span class="co">##   double EC50 = NA_REAL;</span></span>
<span><span class="co">##   double Tz = NA_REAL;</span></span>
<span><span class="co">##   double amp = NA_REAL;</span></span>
<span><span class="co">##   double C2 = NA_REAL;</span></span>
<span><span class="co">##   double central = NA_REAL;</span></span>
<span><span class="co">##   double C3 = NA_REAL;</span></span>
<span><span class="co">##   double peri = NA_REAL;</span></span>
<span><span class="co">##   double depot = NA_REAL;</span></span>
<span><span class="co">##   double eff = NA_REAL;</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   (void)t;</span></span>
<span><span class="co">##   (void)TKA;</span></span>
<span><span class="co">##   (void)TCL;</span></span>
<span><span class="co">##   (void)TV2;</span></span>
<span><span class="co">##   (void)TQ;</span></span>
<span><span class="co">##   (void)TV3;</span></span>
<span><span class="co">##   (void)TKin;</span></span>
<span><span class="co">##   (void)TKout;</span></span>
<span><span class="co">##   (void)TEC50;</span></span>
<span><span class="co">##   (void)WT;</span></span>
<span><span class="co">##   (void)KA;</span></span>
<span><span class="co">##   (void)CL;</span></span>
<span><span class="co">##   (void)V2;</span></span>
<span><span class="co">##   (void)Q;</span></span>
<span><span class="co">##   (void)V3;</span></span>
<span><span class="co">##   (void)Kin;</span></span>
<span><span class="co">##   (void)Kout;</span></span>
<span><span class="co">##   (void)EC50;</span></span>
<span><span class="co">##   (void)Tz;</span></span>
<span><span class="co">##   (void)amp;</span></span>
<span><span class="co">##   (void)C2;</span></span>
<span><span class="co">##   (void)central;</span></span>
<span><span class="co">##   (void)C3;</span></span>
<span><span class="co">##   (void)peri;</span></span>
<span><span class="co">##   (void)depot;</span></span>
<span><span class="co">##   (void)eff;</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   KA = _PL[0];</span></span>
<span><span class="co">##   CL = _PL[1];</span></span>
<span><span class="co">##   V2 = _PL[2];</span></span>
<span><span class="co">##   Q = _PL[3];</span></span>
<span><span class="co">##   V3 = _PL[4];</span></span>
<span><span class="co">##   Kin = _PL[5];</span></span>
<span><span class="co">##   Kout = _PL[6];</span></span>
<span><span class="co">##   EC50 = _PL[7];</span></span>
<span><span class="co">##   C2 = _PL[8];</span></span>
<span><span class="co">##   C3 = _PL[9];</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   _update_par_ptr(__t, _cSub, _solveData, _idx);</span></span>
<span><span class="co">##   TKA = _PP[0];</span></span>
<span><span class="co">##   TCL = _PP[1];</span></span>
<span><span class="co">##   TV2 = _PP[2];</span></span>
<span><span class="co">##   TQ = _PP[3];</span></span>
<span><span class="co">##   TV3 = _PP[4];</span></span>
<span><span class="co">##   TKin = _PP[5];</span></span>
<span><span class="co">##   TKout = _PP[6];</span></span>
<span><span class="co">##   TEC50 = _PP[7];</span></span>
<span><span class="co">##   WT = _PP[8];</span></span>
<span><span class="co">##   Tz = _PP[9];</span></span>
<span><span class="co">##   amp = _PP[10];</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   depot = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">##   central = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">##   peri = __zzStateVar__[__DDT2__]*((double)(_ON[__DDT2__]));</span></span>
<span><span class="co">##   eff = __zzStateVar__[__DDT3__]*((double)(_ON[__DDT3__]));</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   KA =TKA;</span></span>
<span><span class="co">##   CL =TCL*Rx_pow((WT/_div0(70)),0.75);</span></span>
<span><span class="co">##   V2 =TV2;</span></span>
<span><span class="co">##   Q =TQ;</span></span>
<span><span class="co">##   V3 =TV3;</span></span>
<span><span class="co">##   Kin =TKin;</span></span>
<span><span class="co">##   Kout =TKout;</span></span>
<span><span class="co">##   EC50 =TEC50;</span></span>
<span><span class="co">##   C2 =central/_div0(V2);</span></span>
<span><span class="co">##   C3 =peri/_div0(V3);</span></span>
<span><span class="co">##   __DDtStateVar__[__DDT0__] = ((double)(_ON[__DDT0__]))*(_IR[__DDT0__] -KA*depot);</span></span>
<span><span class="co">##   __DDtStateVar__[__DDT1__] = ((double)(_ON[__DDT1__]))*(_IR[__DDT1__] + KA*depot-CL*C2-Q*C2+Q*C3);</span></span>
<span><span class="co">##   __DDtStateVar__[__DDT2__] = ((double)(_ON[__DDT2__]))*(_IR[__DDT2__] + Q*C2-Q*C3);</span></span>
<span><span class="co">##   __DDtStateVar__[__DDT3__] = ((double)(_ON[__DDT3__]))*(_IR[__DDT3__] + Kin-Kout*(1-C2/_div0((EC50+C2)))*eff);</span></span>
<span><span class="co">##   (&amp;_solveData-&gt;subjects[_cSub])-&gt;dadt_counter[0]++;</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## // Jacobian derived vars</span></span>
<span><span class="co">## void rx_67629c27e5da09d61f2b9775c5c9bf2f__calc_jac(int *_neq, double __t, double *__zzStateVar__, double *__PDStateVar__, unsigned int __NROWPD__) {</span></span>
<span><span class="co">##   int _itwhile = 0;</span></span>
<span><span class="co">##   (void)_itwhile;</span></span>
<span><span class="co">##     int _cSub=_neq[1];</span></span>
<span><span class="co">##   double t = __t + _solveData-&gt;subjects[_neq[1]].curShift;</span></span>
<span><span class="co">##   (void)t;</span></span>
<span><span class="co">##   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">##   _ind-&gt;_rxFlag=2;</span></span>
<span><span class="co">##   (&amp;_solveData-&gt;subjects[_cSub])-&gt;jac_counter[0]++;</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## // Functional based initial conditions.</span></span>
<span><span class="co">## void rx_67629c27e5da09d61f2b9775c5c9bf2f__inis(int _cSub, double *__zzStateVar__){</span></span>
<span><span class="co">##   int _itwhile = 0;</span></span>
<span><span class="co">##   (void)_itwhile;</span></span>
<span><span class="co">##   </span></span>
<span><span class="co">##   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">##  _ind-&gt;_rxFlag=3;</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## // prj-specific derived vars</span></span>
<span><span class="co">## void rx_67629c27e5da09d61f2b9775c5c9bf2f__calc_lhs(int _cSub, double __t, double *__zzStateVar__, double *_lhs) {</span></span>
<span><span class="co">##     int _itwhile = 0;</span></span>
<span><span class="co">##   (void)_itwhile;</span></span>
<span><span class="co">##   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">##   (void)t;</span></span>
<span><span class="co">##   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">##   _ind-&gt;_rxFlag=11;</span></span>
<span><span class="co">##   double  __DDtStateVar_0__;</span></span>
<span><span class="co">##   double  __DDtStateVar_1__;</span></span>
<span><span class="co">##   double  __DDtStateVar_2__;</span></span>
<span><span class="co">##   double  __DDtStateVar_3__;</span></span>
<span><span class="co">##   double TKA = NA_REAL;</span></span>
<span><span class="co">##   double TCL = NA_REAL;</span></span>
<span><span class="co">##   double TV2 = NA_REAL;</span></span>
<span><span class="co">##   double TQ = NA_REAL;</span></span>
<span><span class="co">##   double TV3 = NA_REAL;</span></span>
<span><span class="co">##   double TKin = NA_REAL;</span></span>
<span><span class="co">##   double TKout = NA_REAL;</span></span>
<span><span class="co">##   double TEC50 = NA_REAL;</span></span>
<span><span class="co">##   double WT = NA_REAL;</span></span>
<span><span class="co">##   double KA = NA_REAL;</span></span>
<span><span class="co">##   double CL = NA_REAL;</span></span>
<span><span class="co">##   double V2 = NA_REAL;</span></span>
<span><span class="co">##   double Q = NA_REAL;</span></span>
<span><span class="co">##   double V3 = NA_REAL;</span></span>
<span><span class="co">##   double Kin = NA_REAL;</span></span>
<span><span class="co">##   double Kout = NA_REAL;</span></span>
<span><span class="co">##   double EC50 = NA_REAL;</span></span>
<span><span class="co">##   double Tz = NA_REAL;</span></span>
<span><span class="co">##   double amp = NA_REAL;</span></span>
<span><span class="co">##   double C2 = NA_REAL;</span></span>
<span><span class="co">##   double central = NA_REAL;</span></span>
<span><span class="co">##   double C3 = NA_REAL;</span></span>
<span><span class="co">##   double peri = NA_REAL;</span></span>
<span><span class="co">##   double depot = NA_REAL;</span></span>
<span><span class="co">##   double eff = NA_REAL;</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   (void)t;</span></span>
<span><span class="co">##   (void)__DDtStateVar_0__;</span></span>
<span><span class="co">##   (void)__DDtStateVar_1__;</span></span>
<span><span class="co">##   (void)__DDtStateVar_2__;</span></span>
<span><span class="co">##   (void)__DDtStateVar_3__;</span></span>
<span><span class="co">##   (void)TKA;</span></span>
<span><span class="co">##   (void)TCL;</span></span>
<span><span class="co">##   (void)TV2;</span></span>
<span><span class="co">##   (void)TQ;</span></span>
<span><span class="co">##   (void)TV3;</span></span>
<span><span class="co">##   (void)TKin;</span></span>
<span><span class="co">##   (void)TKout;</span></span>
<span><span class="co">##   (void)TEC50;</span></span>
<span><span class="co">##   (void)WT;</span></span>
<span><span class="co">##   (void)KA;</span></span>
<span><span class="co">##   (void)CL;</span></span>
<span><span class="co">##   (void)V2;</span></span>
<span><span class="co">##   (void)Q;</span></span>
<span><span class="co">##   (void)V3;</span></span>
<span><span class="co">##   (void)Kin;</span></span>
<span><span class="co">##   (void)Kout;</span></span>
<span><span class="co">##   (void)EC50;</span></span>
<span><span class="co">##   (void)Tz;</span></span>
<span><span class="co">##   (void)amp;</span></span>
<span><span class="co">##   (void)C2;</span></span>
<span><span class="co">##   (void)central;</span></span>
<span><span class="co">##   (void)C3;</span></span>
<span><span class="co">##   (void)peri;</span></span>
<span><span class="co">##   (void)depot;</span></span>
<span><span class="co">##   (void)eff;</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   KA = _PL[0];</span></span>
<span><span class="co">##   CL = _PL[1];</span></span>
<span><span class="co">##   V2 = _PL[2];</span></span>
<span><span class="co">##   Q = _PL[3];</span></span>
<span><span class="co">##   V3 = _PL[4];</span></span>
<span><span class="co">##   Kin = _PL[5];</span></span>
<span><span class="co">##   Kout = _PL[6];</span></span>
<span><span class="co">##   EC50 = _PL[7];</span></span>
<span><span class="co">##   C2 = _PL[8];</span></span>
<span><span class="co">##   C3 = _PL[9];</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   _update_par_ptr(__t, _cSub, _solveData, _idx);</span></span>
<span><span class="co">##   TKA = _PP[0];</span></span>
<span><span class="co">##   TCL = _PP[1];</span></span>
<span><span class="co">##   TV2 = _PP[2];</span></span>
<span><span class="co">##   TQ = _PP[3];</span></span>
<span><span class="co">##   TV3 = _PP[4];</span></span>
<span><span class="co">##   TKin = _PP[5];</span></span>
<span><span class="co">##   TKout = _PP[6];</span></span>
<span><span class="co">##   TEC50 = _PP[7];</span></span>
<span><span class="co">##   WT = _PP[8];</span></span>
<span><span class="co">##   Tz = _PP[9];</span></span>
<span><span class="co">##   amp = _PP[10];</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   depot = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">##   central = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">##   peri = __zzStateVar__[__DDT2__]*((double)(_ON[__DDT2__]));</span></span>
<span><span class="co">##   eff = __zzStateVar__[__DDT3__]*((double)(_ON[__DDT3__]));</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   KA =TKA;</span></span>
<span><span class="co">##   CL =TCL*Rx_pow((WT/_div0(70)),0.75);</span></span>
<span><span class="co">##   V2 =TV2;</span></span>
<span><span class="co">##   Q =TQ;</span></span>
<span><span class="co">##   V3 =TV3;</span></span>
<span><span class="co">##   Kin =TKin;</span></span>
<span><span class="co">##   Kout =TKout;</span></span>
<span><span class="co">##   EC50 =TEC50;</span></span>
<span><span class="co">##   C2 =central/_div0(V2);</span></span>
<span><span class="co">##   C3 =peri/_div0(V3);</span></span>
<span><span class="co">##   __DDtStateVar_0__ = ((double)(_ON[__DDT0__]))*(_IR[__DDT0__] -KA*depot);</span></span>
<span><span class="co">##   __DDtStateVar_1__ = ((double)(_ON[__DDT1__]))*(_IR[__DDT1__] + KA*depot-CL*C2-Q*C2+Q*C3);</span></span>
<span><span class="co">##   __DDtStateVar_2__ = ((double)(_ON[__DDT2__]))*(_IR[__DDT2__] + Q*C2-Q*C3);</span></span>
<span><span class="co">##   __DDtStateVar_3__ = ((double)(_ON[__DDT3__]))*(_IR[__DDT3__] + Kin-Kout*(1-C2/_div0((EC50+C2)))*eff);</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   _lhs[_LHS_0_]=KA;</span></span>
<span><span class="co">##   _lhs[_LHS_1_]=CL;</span></span>
<span><span class="co">##   _lhs[_LHS_2_]=V2;</span></span>
<span><span class="co">##   _lhs[_LHS_3_]=Q;</span></span>
<span><span class="co">##   _lhs[_LHS_4_]=V3;</span></span>
<span><span class="co">##   _lhs[_LHS_5_]=Kin;</span></span>
<span><span class="co">##   _lhs[_LHS_6_]=Kout;</span></span>
<span><span class="co">##   _lhs[_LHS_7_]=EC50;</span></span>
<span><span class="co">##   _lhs[_LHS_8_]=C2;</span></span>
<span><span class="co">##   _lhs[_LHS_9_]=C3;</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## // Functional based bioavailability</span></span>
<span><span class="co">## double rx_67629c27e5da09d61f2b9775c5c9bf2f__F(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">##  return _amt;</span></span>
<span><span class="co">##   }</span></span>
<span><span class="co">## // Functional based absorption lag</span></span>
<span><span class="co">## double rx_67629c27e5da09d61f2b9775c5c9bf2f__Lag(int _cSub,  int _cmt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">##  return __t;</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## // Modeled zero-order rate</span></span>
<span><span class="co">## double rx_67629c27e5da09d61f2b9775c5c9bf2f__Rate(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">##  return 0.0;</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## // Modeled zero-order duration</span></span>
<span><span class="co">## double rx_67629c27e5da09d61f2b9775c5c9bf2f__Dur(int _cSub,  int _cmt, double _amt, double __t){</span></span>
<span><span class="co">##  return 0.0;</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## // Model Times</span></span>
<span><span class="co">## void rx_67629c27e5da09d61f2b9775c5c9bf2f__mtime(int _cSub, double *_mtime){</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## // Matrix Exponential (0)</span></span>
<span><span class="co">## void rx_67629c27e5da09d61f2b9775c5c9bf2f__ME(int _cSub, double _t, double __t, double *_mat, const double *__zzStateVar__){</span></span>
<span><span class="co">##   int _itwhile = 0;</span></span>
<span><span class="co">##   (void)_itwhile;</span></span>
<span><span class="co">##   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">##   (void)t;</span></span>
<span><span class="co">##   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">##   _ind-&gt;_rxFlag=9;</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## // Inductive linearization Matf</span></span>
<span><span class="co">## void rx_67629c27e5da09d61f2b9775c5c9bf2f__IndF(int _cSub, double _t, double __t, double *_matf){</span></span>
<span><span class="co">##  int _itwhile = 0;</span></span>
<span><span class="co">##   (void)_itwhile;</span></span>
<span><span class="co">##   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">##   (void)t;</span></span>
<span><span class="co">##   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">##   _ind-&gt;_rxFlag=10;</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## extern SEXP rx_67629c27e5da09d61f2b9775c5c9bf2f__model_vars(void){</span></span>
<span><span class="co">##   int pro=0;</span></span>
<span><span class="co">##   SEXP _mv = PROTECT(_rxGetModelLib("rx_67629c27e5da09d61f2b9775c5c9bf2f__model_vars"));pro++;</span></span>
<span><span class="co">##   if (!_rxIsCurrentC(_mv)){</span></span>
<span><span class="co">##     SEXP hash    = PROTECT(Rf_allocVector(STRSXP, 1));pro++;</span></span>
<span><span class="co">## #define __doBuf__  snprintf(buf, __doBufN__, "un]\"BAAA@QRtHACAAAAAAA*h/AAAv7#aT)c4*RSAS&gt;zk@(/x:(\?TiqniFBD\?/Hvz=LZ&lt;dSlp\?,#G]gpL}yik\?`j]$#X|Aev,^W$2~=/#n}f!l}b&lt;;{{0W8dY%%#{K~kVI\?(:CGA7}j^NQ17&amp;,@:.&gt;DE&amp;NJG{Dx2X2O@LY5{h&gt;+}vmj1%%9yFr,s2I&amp;M.0^#Y0r=rU~BlohUN:0glu#kOy=^5c;y3R=EPE#j%%k&gt;4jMazSJ{G%%G%%;6tyjS7)W~X#)JVF4|x@.)+Z.3.DHe,*Fp@Vxm4~uRM,/qnh\"J`xg/sfX9X)fz&gt;I]tsS*k%%Bh/2K]0!I3:\?OoNeTzQ*#j0lc&gt;*.XCJ_cETd3vzfR:*eEgcz{)HCG%%Hak99IZde))Kylj:q5n|yoQ[iE*r5(c6[Ln^D][jSWM#`vDVMG@&gt;QOIBGMwuZMh{R&gt;r:.${#[uZP{QO=DKhZYgK9H!M*w9Zr)}7*/\?y(d[cj9!2eQbMs}O)co5`RJjY:*&amp;L$4IGh/L!7@K6UacL)#!c^u(dJG58Wt/7ea~m:fcATjU^PJlqRr~D#jifGRYc(\?G[yQI[25b%%]OyxI/:5#CLxArHEby+f&amp;EM1]\?PJPfnVTmS[AlyTx_;p*:Y!84oU6Ax.j1:zq&amp;w\?r9)^F~\?69gi}P6|*=.&amp;63#!/m1I%%k&gt;%%,X&gt;9#4jToNL6j/m5(HqRP$z!z&lt;.|L@GJYG),5eaLFM&lt;;m&lt;,swVSfdNq1Fo+mL9EB.\"3wvO]X_dyRIF:3Pw.i#\"buPpY&amp;9\"dSvi83,HyClc&amp;c0c]D4E)ht]|;cK!4QvQ&gt;kR!a@nBxJWi2B9Lhz{v*tAzcP~P:@.2J,=zLEh@z1N&lt;N@6oU_]MMr(m)mcB@62~$g*&gt;NZQnO{1&gt;c^Q4On4TE^/%%HS%%:D/Ic\"U@%%RLz&lt;P&amp;noz^KPzb6rf_lTjRb[q&lt;5H\"mK4)QnqN^abg.F29;yS=mq(!}c(M[=&lt;@}UGT&lt;Y=Z&gt;m$bD/]cQiGdK!(Wof*tjP,a&lt;(}[)]=,z]NN:(Rn2.MpXpXoX^Q5VFBzWFB+_RtAAdpli8jMP88j%%.q4]F3+583)z^p_mDqJTohuUbn1FuKaSdlAo\?,[1Jwt1\"y%%Z\"oY49FVdi2PZ,hX,7i]Qui^vZ*\"CcEI^S2HH`&gt;#[1E@[xCK67`i`6fzF.16yTkGO&amp;=W6xLbt`wP[taKj%%(;jFWv5Z]0mzuN;,!VY/*H=h`Zs_GP[a0\")3Xs.ty/T@XL~r94R4IpEZ4pmV[.)Rr_JF:/Qt~Izs)}tvn_eM2TX+VWD|;/)]j{e\"hDveQMeLamlkX^2&gt;$&gt;dKs!VcQ`{8u{\"&gt;|6w@u#.v4cgS@&lt;{O_8:r&lt;`&amp;8u]kvdJZ2mU0]&gt;(DACr.!X\"`l:|XrOJ$o*J=;:=T&lt;.#g$\"yOTtpJgJ&lt;H,@rT)[bSk6\"J\"K(6g;aq;a8KCW3cHO{eDFT{N8+}a!EyyLBeB*[rk%%6IG+!Y=*WOE{UV&gt;/4F%%pjg$Z`SYd,R1_&gt;[.REx|6sHnN^*G");</span></span>
<span><span class="co">##     char buf[1496];</span></span>
<span><span class="co">## #define __doBufN__ 1496</span></span>
<span><span class="co">##     __doBuf__</span></span>
<span><span class="co">## #undef __doBuf__</span></span>
<span><span class="co">## #undef __doBufN__</span></span>
<span><span class="co">##     SET_STRING_ELT(hash, 0, Rf_mkChar(buf));</span></span>
<span><span class="co">##     SEXP lst      = PROTECT(_rxQr(hash));pro++;</span></span>
<span><span class="co">##     _assign_ptr(lst);</span></span>
<span><span class="co">##     UNPROTECT(pro);</span></span>
<span><span class="co">##     return lst;</span></span>
<span><span class="co">##   } else {</span></span>
<span><span class="co">##     UNPROTECT(pro);</span></span>
<span><span class="co">##     return _mv;</span></span>
<span><span class="co">##   }</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## extern void rx_67629c27e5da09d61f2b9775c5c9bf2f__dydt_lsoda(int *neq, double *t, double *A, double *DADT)</span></span>
<span><span class="co">## {</span></span>
<span><span class="co">##   rx_67629c27e5da09d61f2b9775c5c9bf2f__dydt(neq, *t, A, DADT);</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## extern int rx_67629c27e5da09d61f2b9775c5c9bf2f__dydt_liblsoda(double __t, double *y, double *ydot, void *data)</span></span>
<span><span class="co">## {</span></span>
<span><span class="co">##   int *neq = (int*)(data);</span></span>
<span><span class="co">##   rx_67629c27e5da09d61f2b9775c5c9bf2f__dydt(neq, __t, y, ydot);</span></span>
<span><span class="co">##   return(0);</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## extern void rx_67629c27e5da09d61f2b9775c5c9bf2f__calc_jac_lsoda(int *neq, double *t, double *A,int *ml, int *mu, double *JAC, int *nrowpd){</span></span>
<span><span class="co">##   // Update all covariate parameters</span></span>
<span><span class="co">##   rx_67629c27e5da09d61f2b9775c5c9bf2f__calc_jac(neq, *t, A, JAC, *nrowpd);</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## //Create function to call from R's main thread that assigns the required functions. Sometimes they don't get assigned.</span></span>
<span><span class="co">## extern void rx_67629c27e5da09d61f2b9775c5c9bf2f__assignFuns(void){</span></span>
<span><span class="co">##   _assignFuns();</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## //Initialize the dll to match rxode2's calls</span></span>
<span><span class="co">## void R_init0_rx_67629c27e5da09d61f2b9775c5c9bf2f_(void){</span></span>
<span><span class="co">##   // Get C callables on load; Otherwise it isn't thread safe</span></span>
<span><span class="co">##   R_RegisterCCallable("rx_67629c27e5da09d61f2b9775c5c9bf2f_","rx_67629c27e5da09d61f2b9775c5c9bf2f__assignFuns2", (DL_FUNC) __assignFuns2);</span></span>
<span><span class="co">##   R_RegisterCCallable("rx_67629c27e5da09d61f2b9775c5c9bf2f_","rx_67629c27e5da09d61f2b9775c5c9bf2f__assignFuns", (DL_FUNC) rx_67629c27e5da09d61f2b9775c5c9bf2f__assignFuns);</span></span>
<span><span class="co">##   R_RegisterCCallable("rx_67629c27e5da09d61f2b9775c5c9bf2f_","rx_67629c27e5da09d61f2b9775c5c9bf2f__inis",(DL_FUNC) rx_67629c27e5da09d61f2b9775c5c9bf2f__inis);</span></span>
<span><span class="co">##   R_RegisterCCallable("rx_67629c27e5da09d61f2b9775c5c9bf2f_","rx_67629c27e5da09d61f2b9775c5c9bf2f__dydt",(DL_FUNC) rx_67629c27e5da09d61f2b9775c5c9bf2f__dydt);</span></span>
<span><span class="co">##   R_RegisterCCallable("rx_67629c27e5da09d61f2b9775c5c9bf2f_","rx_67629c27e5da09d61f2b9775c5c9bf2f__calc_lhs",(DL_FUNC) rx_67629c27e5da09d61f2b9775c5c9bf2f__calc_lhs);</span></span>
<span><span class="co">##   R_RegisterCCallable("rx_67629c27e5da09d61f2b9775c5c9bf2f_","rx_67629c27e5da09d61f2b9775c5c9bf2f__calc_jac",(DL_FUNC) rx_67629c27e5da09d61f2b9775c5c9bf2f__calc_jac);</span></span>
<span><span class="co">##   R_RegisterCCallable("rx_67629c27e5da09d61f2b9775c5c9bf2f_","rx_67629c27e5da09d61f2b9775c5c9bf2f__dydt_lsoda", (DL_FUNC) rx_67629c27e5da09d61f2b9775c5c9bf2f__dydt_lsoda);</span></span>
<span><span class="co">##   R_RegisterCCallable("rx_67629c27e5da09d61f2b9775c5c9bf2f_","rx_67629c27e5da09d61f2b9775c5c9bf2f__calc_jac_lsoda", (DL_FUNC) rx_67629c27e5da09d61f2b9775c5c9bf2f__calc_jac_lsoda);</span></span>
<span><span class="co">##   R_RegisterCCallable("rx_67629c27e5da09d61f2b9775c5c9bf2f_","rx_67629c27e5da09d61f2b9775c5c9bf2f__ode_solver_solvedata", (DL_FUNC) rx_67629c27e5da09d61f2b9775c5c9bf2f__ode_solver_solvedata);</span></span>
<span><span class="co">##   R_RegisterCCallable("rx_67629c27e5da09d61f2b9775c5c9bf2f_","rx_67629c27e5da09d61f2b9775c5c9bf2f__ode_solver_get_solvedata", (DL_FUNC) rx_67629c27e5da09d61f2b9775c5c9bf2f__ode_solver_get_solvedata);</span></span>
<span><span class="co">##   R_RegisterCCallable("rx_67629c27e5da09d61f2b9775c5c9bf2f_","rx_67629c27e5da09d61f2b9775c5c9bf2f__F", (DL_FUNC) rx_67629c27e5da09d61f2b9775c5c9bf2f__F);</span></span>
<span><span class="co">##   R_RegisterCCallable("rx_67629c27e5da09d61f2b9775c5c9bf2f_","rx_67629c27e5da09d61f2b9775c5c9bf2f__Lag", (DL_FUNC) rx_67629c27e5da09d61f2b9775c5c9bf2f__Lag);</span></span>
<span><span class="co">##   R_RegisterCCallable("rx_67629c27e5da09d61f2b9775c5c9bf2f_","rx_67629c27e5da09d61f2b9775c5c9bf2f__Rate", (DL_FUNC) rx_67629c27e5da09d61f2b9775c5c9bf2f__Rate);</span></span>
<span><span class="co">##   R_RegisterCCallable("rx_67629c27e5da09d61f2b9775c5c9bf2f_","rx_67629c27e5da09d61f2b9775c5c9bf2f__Dur", (DL_FUNC) rx_67629c27e5da09d61f2b9775c5c9bf2f__Dur);</span></span>
<span><span class="co">##   R_RegisterCCallable("rx_67629c27e5da09d61f2b9775c5c9bf2f_","rx_67629c27e5da09d61f2b9775c5c9bf2f__mtime", (DL_FUNC) rx_67629c27e5da09d61f2b9775c5c9bf2f__mtime);</span></span>
<span><span class="co">##   R_RegisterCCallable("rx_67629c27e5da09d61f2b9775c5c9bf2f_","rx_67629c27e5da09d61f2b9775c5c9bf2f__ME", (DL_FUNC) rx_67629c27e5da09d61f2b9775c5c9bf2f__ME);</span></span>
<span><span class="co">##   R_RegisterCCallable("rx_67629c27e5da09d61f2b9775c5c9bf2f_","rx_67629c27e5da09d61f2b9775c5c9bf2f__IndF", (DL_FUNC) rx_67629c27e5da09d61f2b9775c5c9bf2f__IndF);</span></span>
<span><span class="co">##   R_RegisterCCallable("rx_67629c27e5da09d61f2b9775c5c9bf2f_","rx_67629c27e5da09d61f2b9775c5c9bf2f__dydt_liblsoda", (DL_FUNC) rx_67629c27e5da09d61f2b9775c5c9bf2f__dydt_liblsoda);</span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## //Initialize the dll to match rxode2's calls</span></span>
<span><span class="co">## void R_init_rx_67629c27e5da09d61f2b9775c5c9bf2f_(DllInfo *info){</span></span>
<span><span class="co">##   // Get C callables on load; Otherwise it isn't thread safe</span></span>
<span><span class="co">##   R_init0_rx_67629c27e5da09d61f2b9775c5c9bf2f_();</span></span>
<span><span class="co">##   static const R_CallMethodDef callMethods[]  = {</span></span>
<span><span class="co">##     {"rx_67629c27e5da09d61f2b9775c5c9bf2f__model_vars", (DL_FUNC) &amp;rx_67629c27e5da09d61f2b9775c5c9bf2f__model_vars, 0},</span></span>
<span><span class="co">##     {NULL, NULL, 0}</span></span>
<span><span class="co">##   };</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   R_registerRoutines(info, NULL, callMethods, NULL, NULL);</span></span>
<span><span class="co">##   R_useDynamicSymbols(info,FALSE);</span></span>
<span><span class="co">##   _assignFuns0();</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## }</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## void R_unload_rx_67629c27e5da09d61f2b9775c5c9bf2f_ (DllInfo *info){</span></span>
<span><span class="co">##   // Free resources required for single subject solve.</span></span>
<span><span class="co">##   SEXP _mv = PROTECT(_rxGetModelLib("rx_67629c27e5da09d61f2b9775c5c9bf2f__model_vars"));</span></span>
<span><span class="co">##   if (!Rf_isNull(_mv)){</span></span>
<span><span class="co">##     _rxRmModelLib("rx_67629c27e5da09d61f2b9775c5c9bf2f__model_vars");</span></span>
<span><span class="co">##   }</span></span>
<span><span class="co">##   UNPROTECT(1);</span></span>
<span><span class="co">## }</span></span></code></pre>
<pre><code><span><span class="co">## using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">r1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="font-weight: bold;">── Solved rxode2 object ──</span></span></span>
<span><span class="co">## <span style="font-weight: bold;">── Parameters (</span><span style="color: #0000BB; font-weight: bold;">$params</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">##     TKA     TCL     TV2      TQ     TV3    TKin   TKout   TEC50      Tz     amp </span></span>
<span><span class="co">##   0.294  18.600  40.200  10.500 297.000   1.000   1.000 200.000   8.000   0.100 </span></span>
<span><span class="co">## <span style="font-weight: bold;">── Initial Conditions (</span><span style="color: #0000BB; font-weight: bold;">$inits</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">##   depot central    peri     eff </span></span>
<span><span class="co">##       0       0       0       1 </span></span>
<span><span class="co">## <span style="font-weight: bold;">── First part of data (object): ──</span></span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 400 × 17</span></span></span>
<span><span class="co">##      id  time    KA    CL    V2     Q    V3   Kin  Kout  EC50    C2    C3  depot</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494;">[h]</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>     1 0     0.294  18.6  40.2  10.5   297     1     1   200   0   0     <span style="text-decoration: underline;">10</span>000 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>     1 0.485 0.294  18.6  40.2  10.5   297     1     1   200  27.8 0.257  <span style="text-decoration: underline;">8</span>671.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>     1 0.970 0.294  18.6  40.2  10.5   297     1     1   200  43.7 0.873  <span style="text-decoration: underline;">7</span>519.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>     1 1.45  0.294  18.6  40.2  10.5   297     1     1   200  51.7 1.68   <span style="text-decoration: underline;">6</span>520.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>     1 1.94  0.294  18.6  40.2  10.5   297     1     1   200  54.7 2.56   <span style="text-decoration: underline;">5</span>654.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span>     1 2.42  0.294  18.6  40.2  10.5   297     1     1   200  54.5 3.45   <span style="text-decoration: underline;">4</span>903.</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 394 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 4 more variables: central &lt;dbl&gt;, peri &lt;dbl&gt;, eff &lt;dbl&gt;, WT &lt;dbl&gt;</span></span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r1</span>, <span class="va">C2</span>, log<span class="op">=</span><span class="st">"y"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in ggplot2::scale_y_log10(..., breaks = breaks, minor_breaks =</span></span>
<span><span class="co">## minor_breaks, : <span style="color: #00BB00;">log-10</span> transformation introduced infinite</span></span>
<span><span class="co">## values.</span></span></code></pre>
<p><img src="rxode2-covariates_files/figure-html/individual-covariates-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="time-varying-covariates">Time Varying Covariates<a class="anchor" aria-label="anchor" href="#time-varying-covariates"></a>
</h2>
<p>Covariates are easy to specify in rxode2, you can specify them as a
variable. Time-varying covariates, like clock time in a circadian rhythm
model, can also be used. Extending the indirect response model already
discussed, we have:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlmixr2.github.io/rxode2/">rxode2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-quantities.github.io/units/" class="external-link">units</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod4</span> <span class="op">&lt;-</span> <span class="va">mod3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/model.html">model</a></span><span class="op">(</span><span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">eff</span><span class="op">)</span> <span class="op">&lt;-</span>  <span class="va">Kin</span> <span class="op">-</span> <span class="va">Kout</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">C2</span><span class="op">/</span><span class="op">(</span><span class="va">EC50</span><span class="op">+</span><span class="va">C2</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="va">eff</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/model.html">model</a></span><span class="op">(</span><span class="op">-</span><span class="va">Kin</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/model.html">model</a></span><span class="op">(</span><span class="va">Kin</span> <span class="op">&lt;-</span> <span class="va">TKin</span> <span class="op">+</span> <span class="va">amp</span> <span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="op">(</span><span class="va">ctime</span><span class="op">-</span><span class="va">Tz</span><span class="op">)</span><span class="op">/</span><span class="fl">24</span><span class="op">)</span>, append<span class="op">=</span><span class="va">C2</span>, cov<span class="op">=</span><span class="st">"ctime"</span><span class="op">)</span></span>
<span> </span>
<span><span class="va">ev</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>amountUnits<span class="op">=</span><span class="st">"mg"</span>, timeUnits<span class="op">=</span><span class="st">"hours"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>amt<span class="op">=</span><span class="fl">10000</span>, cmt<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">48</span>,length.out<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## Create data frame of 8 am dosing for the first dose This is done</span></span>
<span><span class="co">## with base R but it can be done with dplyr or data.table</span></span>
<span><span class="va">ev</span><span class="op">$</span><span class="va">ctime</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ev</span><span class="op">$</span><span class="va">time</span><span class="op">+</span><span class="fu"><a href="https://r-quantities.github.io/units/reference/units.html" class="external-link">set_units</a></span><span class="op">(</span><span class="fl">8</span>,<span class="va">hr</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">24</span></span>
<span><span class="va">ev</span><span class="op">$</span><span class="va">WT</span> <span class="op">&lt;-</span> <span class="fl">70</span></span></code></pre></div>
<p>Now there is a covariate present in the event dataset, the system can
be solved by combining the dataset and the model:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/symengine/man/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">mod4</span>, <span class="va">ev</span>, covsInterpolation<span class="op">=</span><span class="st">"linear"</span><span class="op">)</span></span>
<span><span class="co">#&gt; C model:</span></span>
<span><span class="co">#&gt; // Define translation state order for 4 states</span></span>
<span><span class="co">#&gt; #define __DDT0__ 0 // depot</span></span>
<span><span class="co">#&gt; #define _DEPOT_ 0 // depot</span></span>
<span><span class="co">#&gt; #define __DDT1__ 1 // central</span></span>
<span><span class="co">#&gt; #define _CENTRAL_ 1 // central</span></span>
<span><span class="co">#&gt; #define __DDT2__ 2 // peri</span></span>
<span><span class="co">#&gt; #define __DDT3__ 3 // eff</span></span>
<span><span class="co">#&gt; // Define 10 LHS values</span></span>
<span><span class="co">#&gt; #define _LHS_0_ 0 // KA</span></span>
<span><span class="co">#&gt; #define _LHS_1_ 1 // CL</span></span>
<span><span class="co">#&gt; #define _LHS_2_ 2 // V2</span></span>
<span><span class="co">#&gt; #define _LHS_3_ 3 // Q</span></span>
<span><span class="co">#&gt; #define _LHS_4_ 4 // V3</span></span>
<span><span class="co">#&gt; #define _LHS_5_ 5 // Kout</span></span>
<span><span class="co">#&gt; #define _LHS_6_ 6 // EC50</span></span>
<span><span class="co">#&gt; #define _LHS_7_ 7 // C2</span></span>
<span><span class="co">#&gt; #define _LHS_8_ 8 // Kin</span></span>
<span><span class="co">#&gt; #define _LHS_9_ 9 // C3</span></span>
<span><span class="co">#&gt; #define _getRxSolve_ _rx754880ff820a62fcebdd327b738d56a5143__getRxSolve__7aMQ</span></span>
<span><span class="co">#&gt; #define _evalUdf _rx754880ff820a62fcebdd327b738d56a5144__evalUdf_3GOp</span></span>
<span><span class="co">#&gt; #define _solveData _rx754880ff820a62fcebdd327b738d56a5145__solveData_rcmM</span></span>
<span><span class="co">#&gt; #define _assign_ptr _rx754880ff820a62fcebdd327b738d56a5146__assign_ptr_PhpE</span></span>
<span><span class="co">#&gt; #define _rxRmModelLib _rx754880ff820a62fcebdd327b738d56a5147__rxRmModelLib_lMX5</span></span>
<span><span class="co">#&gt; #define _rxGetModelLib _rx754880ff820a62fcebdd327b738d56a5148__rxGetModelLib_AtQk</span></span>
<span><span class="co">#&gt; #define _old_c _rx754880ff820a62fcebdd327b738d56a5149__old_c_pxgV</span></span>
<span><span class="co">#&gt; #define _ptrid _rx754880ff820a62fcebdd327b738d56a5150__ptrid_HE0j</span></span>
<span><span class="co">#&gt; #define _rxIsCurrentC _rx754880ff820a62fcebdd327b738d56a5151__rxIsCurrentC_F91U</span></span>
<span><span class="co">#&gt; #define _sumPS _rx754880ff820a62fcebdd327b738d56a5152__sumPS_6nLw</span></span>
<span><span class="co">#&gt; #define _prodPS _rx754880ff820a62fcebdd327b738d56a5153__prodPS_FTBa</span></span>
<span><span class="co">#&gt; #define _prodType _rx754880ff820a62fcebdd327b738d56a5154__prodType_SSOV</span></span>
<span><span class="co">#&gt; #define _sumType _rx754880ff820a62fcebdd327b738d56a5155__sumType_17TO</span></span>
<span><span class="co">#&gt; #define _update_par_ptr _rx754880ff820a62fcebdd327b738d56a5156__update_par_ptr_plZR</span></span>
<span><span class="co">#&gt; #define _getParCov _rx754880ff820a62fcebdd327b738d56a5157__getParCov_5D4X</span></span>
<span><span class="co">#&gt; #define _rxode2_rxAssignPtr _rx754880ff820a62fcebdd327b738d56a5158__rxode2_rxAssignPtr_dW2X</span></span>
<span><span class="co">#&gt; #define _rxQr _rx754880ff820a62fcebdd327b738d56a5159__rxQr_NxFC</span></span>
<span><span class="co">#&gt; #define _compareFactorVal _rx754880ff820a62fcebdd327b738d56a5160__compareFactorVal_rSDc</span></span>
<span><span class="co">#&gt; #define _sum _rx754880ff820a62fcebdd327b738d56a5161__sum_C1nH</span></span>
<span><span class="co">#&gt; #define _udf _rx754880ff820a62fcebdd327b738d56a5162__udf_AAUi</span></span>
<span><span class="co">#&gt; #define _sign _rx754880ff820a62fcebdd327b738d56a5163__sign_aWNp</span></span>
<span><span class="co">#&gt; #define _prod _rx754880ff820a62fcebdd327b738d56a5164__prod_FXk1</span></span>
<span><span class="co">#&gt; #define _max _rx754880ff820a62fcebdd327b738d56a5165__max_L3MP</span></span>
<span><span class="co">#&gt; #define _min _rx754880ff820a62fcebdd327b738d56a5166__min_utyT</span></span>
<span><span class="co">#&gt; #define _transit4P _rx754880ff820a62fcebdd327b738d56a5167__transit4P_gQmq</span></span>
<span><span class="co">#&gt; #define _transit3P _rx754880ff820a62fcebdd327b738d56a5168__transit3P_BWhu</span></span>
<span><span class="co">#&gt; #define _assignFuns0 _rx754880ff820a62fcebdd327b738d56a5169__assignFuns0_Gnch</span></span>
<span><span class="co">#&gt; #define _assignFuns _rx754880ff820a62fcebdd327b738d56a5170__assignFuns_6KKZ</span></span>
<span><span class="co">#&gt; #define _rxord _rx754880ff820a62fcebdd327b738d56a5171__rxord_CDdL</span></span>
<span><span class="co">#&gt; #define __assignFuns2 _rx754880ff820a62fcebdd327b738d56a5172___assignFuns2_rwt2</span></span>
<span><span class="co">#&gt; #define _llikCauchyDscale _rx754880ff820a62fcebdd327b738d56a5173__llikCauchyDscale_lEJH</span></span>
<span><span class="co">#&gt; #define _llikCauchyDlocation _rx754880ff820a62fcebdd327b738d56a5174__llikCauchyDlocation_ir6Y</span></span>
<span><span class="co">#&gt; #define _llikCauchy _rx754880ff820a62fcebdd327b738d56a5175__llikCauchy_eE4v</span></span>
<span><span class="co">#&gt; #define _llikGammaDrate _rx754880ff820a62fcebdd327b738d56a5176__llikGammaDrate_9oPb</span></span>
<span><span class="co">#&gt; #define _llikGammaDshape _rx754880ff820a62fcebdd327b738d56a5177__llikGammaDshape_4usC</span></span>
<span><span class="co">#&gt; #define _llikGamma _rx754880ff820a62fcebdd327b738d56a5178__llikGamma_49KB</span></span>
<span><span class="co">#&gt; #define _llikWeibullDscale _rx754880ff820a62fcebdd327b738d56a5179__llikWeibullDscale_9Iw6</span></span>
<span><span class="co">#&gt; #define _llikWeibullDshape _rx754880ff820a62fcebdd327b738d56a5180__llikWeibullDshape_iWPP</span></span>
<span><span class="co">#&gt; #define _llikWeibull _rx754880ff820a62fcebdd327b738d56a5181__llikWeibull_lGly</span></span>
<span><span class="co">#&gt; #define _llikUnifDbeta _rx754880ff820a62fcebdd327b738d56a5182__llikUnifDbeta_faYl</span></span>
<span><span class="co">#&gt; #define _llikUnifDalpha _rx754880ff820a62fcebdd327b738d56a5183__llikUnifDalpha_khzS</span></span>
<span><span class="co">#&gt; #define _llikUnif _rx754880ff820a62fcebdd327b738d56a5184__llikUnif_7ETL</span></span>
<span><span class="co">#&gt; #define _llikGeomDp _rx754880ff820a62fcebdd327b738d56a5185__llikGeomDp_K7QT</span></span>
<span><span class="co">#&gt; #define _llikGeom _rx754880ff820a62fcebdd327b738d56a5186__llikGeom_Wcsg</span></span>
<span><span class="co">#&gt; #define _llikFDdf2 _rx754880ff820a62fcebdd327b738d56a5187__llikFDdf2_iB44</span></span>
<span><span class="co">#&gt; #define _llikFDdf1 _rx754880ff820a62fcebdd327b738d56a5188__llikFDdf1_3WoR</span></span>
<span><span class="co">#&gt; #define _llikF _rx754880ff820a62fcebdd327b738d56a5189__llikF_YHti</span></span>
<span><span class="co">#&gt; #define _llikExpDrate _rx754880ff820a62fcebdd327b738d56a5190__llikExpDrate_DXfq</span></span>
<span><span class="co">#&gt; #define _llikExp _rx754880ff820a62fcebdd327b738d56a5191__llikExp_9flz</span></span>
<span><span class="co">#&gt; #define _llikChisqDdf _rx754880ff820a62fcebdd327b738d56a5192__llikChisqDdf_Gsif</span></span>
<span><span class="co">#&gt; #define _llikChisq _rx754880ff820a62fcebdd327b738d56a5193__llikChisq_kP3l</span></span>
<span><span class="co">#&gt; #define _llikTDsd _rx754880ff820a62fcebdd327b738d56a5194__llikTDsd_qWr7</span></span>
<span><span class="co">#&gt; #define _llikTDmean _rx754880ff820a62fcebdd327b738d56a5195__llikTDmean_6grl</span></span>
<span><span class="co">#&gt; #define _llikTDdf _rx754880ff820a62fcebdd327b738d56a5196__llikTDdf_JENn</span></span>
<span><span class="co">#&gt; #define _llikT _rx754880ff820a62fcebdd327b738d56a5197__llikT_oOWS</span></span>
<span><span class="co">#&gt; #define _llikBetaDshape2 _rx754880ff820a62fcebdd327b738d56a5198__llikBetaDshape2_qDlH</span></span>
<span><span class="co">#&gt; #define _llikBetaDshape1 _rx754880ff820a62fcebdd327b738d56a5199__llikBetaDshape1_tWpj</span></span>
<span><span class="co">#&gt; #define _llikBeta _rx754880ff820a62fcebdd327b738d56a5200__llikBeta_JXZ3</span></span>
<span><span class="co">#&gt; #define _llikNbinomMuDmu _rx754880ff820a62fcebdd327b738d56a5201__llikNbinomMuDmu_Uh7t</span></span>
<span><span class="co">#&gt; #define _llikNbinomMu _rx754880ff820a62fcebdd327b738d56a5202__llikNbinomMu_jjBs</span></span>
<span><span class="co">#&gt; #define _llikNbinomDprob _rx754880ff820a62fcebdd327b738d56a5203__llikNbinomDprob_bD8o</span></span>
<span><span class="co">#&gt; #define _llikNbinom _rx754880ff820a62fcebdd327b738d56a5204__llikNbinom_MR7p</span></span>
<span><span class="co">#&gt; #define _llikBinomDprob _rx754880ff820a62fcebdd327b738d56a5205__llikBinomDprob_vIjP</span></span>
<span><span class="co">#&gt; #define _llikBinom _rx754880ff820a62fcebdd327b738d56a5206__llikBinom_1OFS</span></span>
<span><span class="co">#&gt; #define _llikPoisDlambda _rx754880ff820a62fcebdd327b738d56a5207__llikPoisDlambda_KsAz</span></span>
<span><span class="co">#&gt; #define _llikPois _rx754880ff820a62fcebdd327b738d56a5208__llikPois_gElz</span></span>
<span><span class="co">#&gt; #define _llikNormDsd _rx754880ff820a62fcebdd327b738d56a5209__llikNormDsd_kjp1</span></span>
<span><span class="co">#&gt; #define _llikNormDmean _rx754880ff820a62fcebdd327b738d56a5210__llikNormDmean_2z7v</span></span>
<span><span class="co">#&gt; #define _llikNorm _rx754880ff820a62fcebdd327b738d56a5211__llikNorm_1yvY</span></span>
<span><span class="co">#&gt; #define simeps _rx754880ff820a62fcebdd327b738d56a5212_simeps_esry</span></span>
<span><span class="co">#&gt; #define simeta _rx754880ff820a62fcebdd327b738d56a5213_simeta_hzXR</span></span>
<span><span class="co">#&gt; #define expit _rx754880ff820a62fcebdd327b738d56a5214_expit_u5XA</span></span>
<span><span class="co">#&gt; #define logit _rx754880ff820a62fcebdd327b738d56a5215_logit_L0Oa</span></span>
<span><span class="co">#&gt; #define gammapDer _rx754880ff820a62fcebdd327b738d56a5216_gammapDer_shCN</span></span>
<span><span class="co">#&gt; #define lowergamma _rx754880ff820a62fcebdd327b738d56a5217_lowergamma_Bo0M</span></span>
<span><span class="co">#&gt; #define uppergamma _rx754880ff820a62fcebdd327b738d56a5218_uppergamma_jOs8</span></span>
<span><span class="co">#&gt; #define gammaqInva _rx754880ff820a62fcebdd327b738d56a5219_gammaqInva_7C3a</span></span>
<span><span class="co">#&gt; #define gammaqInv _rx754880ff820a62fcebdd327b738d56a5220_gammaqInv_kaIz</span></span>
<span><span class="co">#&gt; #define gammapInva _rx754880ff820a62fcebdd327b738d56a5221_gammapInva_hGFN</span></span>
<span><span class="co">#&gt; #define gammapInv _rx754880ff820a62fcebdd327b738d56a5222_gammapInv_KxFa</span></span>
<span><span class="co">#&gt; #define gammaq _rx754880ff820a62fcebdd327b738d56a5223_gammaq_pC4k</span></span>
<span><span class="co">#&gt; #define gammap _rx754880ff820a62fcebdd327b738d56a5224_gammap_Zj4v</span></span>
<span><span class="co">#&gt; #define phi _rx754880ff820a62fcebdd327b738d56a5225_phi_7lL7</span></span>
<span><span class="co">#&gt; #define d2ELUa _rx754880ff820a62fcebdd327b738d56a5226_d2ELUa_Y8rq</span></span>
<span><span class="co">#&gt; #define dELUa _rx754880ff820a62fcebdd327b738d56a5227_dELUa_Hoty</span></span>
<span><span class="co">#&gt; #define d2aELU _rx754880ff820a62fcebdd327b738d56a5228_d2aELU_aeNT</span></span>
<span><span class="co">#&gt; #define d2ELU _rx754880ff820a62fcebdd327b738d56a5229_d2ELU_pohj</span></span>
<span><span class="co">#&gt; #define dELU _rx754880ff820a62fcebdd327b738d56a5230_dELU_fHjH</span></span>
<span><span class="co">#&gt; #define ELU _rx754880ff820a62fcebdd327b738d56a5231_ELU_5dQM</span></span>
<span><span class="co">#&gt; #define dPReLUa1 _rx754880ff820a62fcebdd327b738d56a5232_dPReLUa1_jxyM</span></span>
<span><span class="co">#&gt; #define dPReLUa _rx754880ff820a62fcebdd327b738d56a5233_dPReLUa_N5bT</span></span>
<span><span class="co">#&gt; #define dPReLU _rx754880ff820a62fcebdd327b738d56a5234_dPReLU_kJW4</span></span>
<span><span class="co">#&gt; #define PReLU _rx754880ff820a62fcebdd327b738d56a5235_PReLU_XOqp</span></span>
<span><span class="co">#&gt; #define dSwish _rx754880ff820a62fcebdd327b738d56a5236_dSwish_FP6W</span></span>
<span><span class="co">#&gt; #define Swish _rx754880ff820a62fcebdd327b738d56a5237_Swish_4DNf</span></span>
<span><span class="co">#&gt; #define dlReLU _rx754880ff820a62fcebdd327b738d56a5238_dlReLU_2g5j</span></span>
<span><span class="co">#&gt; #define lReLU _rx754880ff820a62fcebdd327b738d56a5239_lReLU_8c8u</span></span>
<span><span class="co">#&gt; #define dSELU _rx754880ff820a62fcebdd327b738d56a5240_dSELU_tgdk</span></span>
<span><span class="co">#&gt; #define SELU _rx754880ff820a62fcebdd327b738d56a5241_SELU_uMoD</span></span>
<span><span class="co">#&gt; #define d4softplus _rx754880ff820a62fcebdd327b738d56a5242_d4softplus_8Igg</span></span>
<span><span class="co">#&gt; #define d3softplus _rx754880ff820a62fcebdd327b738d56a5243_d3softplus_qa61</span></span>
<span><span class="co">#&gt; #define d2softplus _rx754880ff820a62fcebdd327b738d56a5244_d2softplus_Q86S</span></span>
<span><span class="co">#&gt; #define dsoftplus _rx754880ff820a62fcebdd327b738d56a5245_dsoftplus_Yctr</span></span>
<span><span class="co">#&gt; #define softplus _rx754880ff820a62fcebdd327b738d56a5246_softplus_Kx2z</span></span>
<span><span class="co">#&gt; #define d4GELU _rx754880ff820a62fcebdd327b738d56a5247_d4GELU_df55</span></span>
<span><span class="co">#&gt; #define d3GELU _rx754880ff820a62fcebdd327b738d56a5248_d3GELU_lBL3</span></span>
<span><span class="co">#&gt; #define d2GELU _rx754880ff820a62fcebdd327b738d56a5249_d2GELU_KI9t</span></span>
<span><span class="co">#&gt; #define dGELU _rx754880ff820a62fcebdd327b738d56a5250_dGELU_NzO8</span></span>
<span><span class="co">#&gt; #define GELU _rx754880ff820a62fcebdd327b738d56a5251_GELU_faNu</span></span>
<span><span class="co">#&gt; #define dReLU _rx754880ff820a62fcebdd327b738d56a5252_dReLU_TDlv</span></span>
<span><span class="co">#&gt; #define ReLU _rx754880ff820a62fcebdd327b738d56a5253_ReLU_X2wM</span></span>
<span><span class="co">#&gt; #define riweibull _rx754880ff820a62fcebdd327b738d56a5254_riweibull_iHu0</span></span>
<span><span class="co">#&gt; #define riunif _rx754880ff820a62fcebdd327b738d56a5255_riunif_OE6M</span></span>
<span><span class="co">#&gt; #define rit_ _rx754880ff820a62fcebdd327b738d56a5256_rit__OKVz</span></span>
<span><span class="co">#&gt; #define ripois _rx754880ff820a62fcebdd327b738d56a5257_ripois_eamr</span></span>
<span><span class="co">#&gt; #define ribeta _rx754880ff820a62fcebdd327b738d56a5258_ribeta_CO0h</span></span>
<span><span class="co">#&gt; #define rigamma _rx754880ff820a62fcebdd327b738d56a5259_rigamma_8M52</span></span>
<span><span class="co">#&gt; #define rigeom _rx754880ff820a62fcebdd327b738d56a5260_rigeom_w8lE</span></span>
<span><span class="co">#&gt; #define rif _rx754880ff820a62fcebdd327b738d56a5261_rif_nvee</span></span>
<span><span class="co">#&gt; #define riexp _rx754880ff820a62fcebdd327b738d56a5262_riexp_hHRF</span></span>
<span><span class="co">#&gt; #define richisq _rx754880ff820a62fcebdd327b738d56a5263_richisq_XFMT</span></span>
<span><span class="co">#&gt; #define ricauchy _rx754880ff820a62fcebdd327b738d56a5264_ricauchy_MJqN</span></span>
<span><span class="co">#&gt; #define rinbinomMu _rx754880ff820a62fcebdd327b738d56a5265_rinbinomMu_rzpI</span></span>
<span><span class="co">#&gt; #define rinbinom _rx754880ff820a62fcebdd327b738d56a5266_rinbinom_4YB5</span></span>
<span><span class="co">#&gt; #define ribinom _rx754880ff820a62fcebdd327b738d56a5267_ribinom_Furm</span></span>
<span><span class="co">#&gt; #define rinorm _rx754880ff820a62fcebdd327b738d56a5268_rinorm_FJ7v</span></span>
<span><span class="co">#&gt; #define rxweibull _rx754880ff820a62fcebdd327b738d56a5269_rxweibull_8a9d</span></span>
<span><span class="co">#&gt; #define rxunif _rx754880ff820a62fcebdd327b738d56a5270_rxunif_eygz</span></span>
<span><span class="co">#&gt; #define rxt_ _rx754880ff820a62fcebdd327b738d56a5271_rxt__0bVb</span></span>
<span><span class="co">#&gt; #define rxpois _rx754880ff820a62fcebdd327b738d56a5272_rxpois_pzmx</span></span>
<span><span class="co">#&gt; #define rxbeta _rx754880ff820a62fcebdd327b738d56a5273_rxbeta_Xm0k</span></span>
<span><span class="co">#&gt; #define rxgamma _rx754880ff820a62fcebdd327b738d56a5274_rxgamma_V0Mz</span></span>
<span><span class="co">#&gt; #define rxgeom _rx754880ff820a62fcebdd327b738d56a5275_rxgeom_OBMR</span></span>
<span><span class="co">#&gt; #define rxf _rx754880ff820a62fcebdd327b738d56a5276_rxf_J0aj</span></span>
<span><span class="co">#&gt; #define rxexp _rx754880ff820a62fcebdd327b738d56a5277_rxexp_zPvV</span></span>
<span><span class="co">#&gt; #define rxchisq _rx754880ff820a62fcebdd327b738d56a5278_rxchisq_ECJJ</span></span>
<span><span class="co">#&gt; #define rxcauchy _rx754880ff820a62fcebdd327b738d56a5279_rxcauchy_kkzi</span></span>
<span><span class="co">#&gt; #define rxnbinomMu _rx754880ff820a62fcebdd327b738d56a5280_rxnbinomMu_cNW8</span></span>
<span><span class="co">#&gt; #define rxnbinom _rx754880ff820a62fcebdd327b738d56a5281_rxnbinom_7Ns1</span></span>
<span><span class="co">#&gt; #define rxbinom _rx754880ff820a62fcebdd327b738d56a5282_rxbinom_Wg6Z</span></span>
<span><span class="co">#&gt; #define rxnorm _rx754880ff820a62fcebdd327b738d56a5283_rxnorm_WGOj</span></span>
<span><span class="co">#&gt; #define linCmtB _rx754880ff820a62fcebdd327b738d56a5284_linCmtB_bOuz</span></span>
<span><span class="co">#&gt; #define linCmtA _rx754880ff820a62fcebdd327b738d56a5285_linCmtA_Z9iM</span></span>
<span><span class="co">#&gt; #include &lt;rxode2_model_shared.h&gt;</span></span>
<span><span class="co">#&gt; #define __MAX_PROD__ 0</span></span>
<span><span class="co">#&gt; #define _CMT CMT</span></span>
<span><span class="co">#&gt; #define _SYNC_simeps_ for (int _svari=_solveData-&gt;neps; _svari--;){  if (_solveData-&gt;svar[_svari] == 0) {TKA = _PP[0];};   if (_solveData-&gt;svar[_svari] == 1) {TCL = _PP[1];};   if (_solveData-&gt;svar[_svari] == 2) {TV2 = _PP[2];};   if (_solveData-&gt;svar[_svari] == 3) {TQ = _PP[3];};   if (_solveData-&gt;svar[_svari] == 4) {TV3 = _PP[4];};   if (_solveData-&gt;svar[_svari] == 5) {TKout = _PP[5];};   if (_solveData-&gt;svar[_svari] == 6) {TEC50 = _PP[6];};   if (_solveData-&gt;svar[_svari] == 7) {TKin = _PP[7];};   if (_solveData-&gt;svar[_svari] == 8) {WT = _PP[8];};   if (_solveData-&gt;svar[_svari] == 9) {ctime = _PP[9];};   if (_solveData-&gt;svar[_svari] == 10) {Tz = _PP[10];};   if (_solveData-&gt;svar[_svari] == 11) {amp = _PP[11];};   if (_solveData-&gt;svar[_svari] == 12) {pi = _PP[12];}; }</span></span>
<span><span class="co">#&gt; #define _SYNC_simeta_ for (int _ovari=_solveData-&gt;neta; _ovari--;){  if (_solveData-&gt;ovar[_ovari] == 0) {TKA = _PP[0];};   if (_solveData-&gt;ovar[_ovari] == 1) {TCL = _PP[1];};   if (_solveData-&gt;ovar[_ovari] == 2) {TV2 = _PP[2];};   if (_solveData-&gt;ovar[_ovari] == 3) {TQ = _PP[3];};   if (_solveData-&gt;ovar[_ovari] == 4) {TV3 = _PP[4];};   if (_solveData-&gt;ovar[_ovari] == 5) {TKout = _PP[5];};   if (_solveData-&gt;ovar[_ovari] == 6) {TEC50 = _PP[6];};   if (_solveData-&gt;ovar[_ovari] == 7) {TKin = _PP[7];};   if (_solveData-&gt;ovar[_ovari] == 8) {WT = _PP[8];};   if (_solveData-&gt;ovar[_ovari] == 9) {ctime = _PP[9];};   if (_solveData-&gt;ovar[_ovari] == 10) {Tz = _PP[10];};   if (_solveData-&gt;ovar[_ovari] == 11) {amp = _PP[11];};   if (_solveData-&gt;ovar[_ovari] == 12) {pi = _PP[12];}; }</span></span>
<span><span class="co">#&gt; _getRxSolve_t _getRxSolve_;</span></span>
<span><span class="co">#&gt; _simfun simeps;</span></span>
<span><span class="co">#&gt; _simfun simeta;</span></span>
<span><span class="co">#&gt; _udf_type _evalUdf=NULL;</span></span>
<span><span class="co">#&gt; rx_solve *_solveData=NULL;</span></span>
<span><span class="co">#&gt; rxode2_assign_ptr _assign_ptr=NULL;</span></span>
<span><span class="co">#&gt; _rxRmModelLibType _rxRmModelLib=NULL;</span></span>
<span><span class="co">#&gt; _rxGetModelLibType _rxGetModelLib=NULL;</span></span>
<span><span class="co">#&gt; rxode2_ode_solver_old_c _old_c=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _ptrid=NULL;</span></span>
<span><span class="co">#&gt; _rxIsCurrentC_type _rxIsCurrentC=NULL;</span></span>
<span><span class="co">#&gt; _rxSumType _sumPS=NULL;</span></span>
<span><span class="co">#&gt; _rxProdType _prodPS=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _prodType=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _sumType=NULL;</span></span>
<span><span class="co">#&gt; _update_par_ptr_p _update_par_ptr=NULL;</span></span>
<span><span class="co">#&gt; _getParCov_p _getParCov=NULL;</span></span>
<span><span class="co">#&gt; linCmtA_p linCmtA;</span></span>
<span><span class="co">#&gt; linCmtB_p linCmtB;</span></span>
<span><span class="co">#&gt; _rx_asgn _rxode2_rxAssignPtr=NULL;</span></span>
<span><span class="co">#&gt; _rx_asgn _rxQr=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn phi;</span></span>
<span><span class="co">#&gt; rxode2_fn ReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn dReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn dGELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d2GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d3GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d4GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn dsoftplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d2softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d3softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d4softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn SELU;</span></span>
<span><span class="co">#&gt; rxode2_fn dSELU;</span></span>
<span><span class="co">#&gt; rxode2_fn lReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn dlReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn Swish;</span></span>
<span><span class="co">#&gt; rxode2_fn dSwish;</span></span>
<span><span class="co">#&gt; rxode2_fn2 PReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLUa;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLUa1;</span></span>
<span><span class="co">#&gt; rxode2_fn2 ELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2ELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2aELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dELUa;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2ELUa;</span></span>
<span><span class="co">#&gt; rxode2_fn3 logit;</span></span>
<span><span class="co">#&gt; rxode2_fn3 expit;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammap;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaq;</span></span>
<span><span class="co">#&gt; rxode2_fn2 lowergamma;</span></span>
<span><span class="co">#&gt; rxode2_fn2 uppergamma;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapInv;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapDer;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapInva;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaqInv;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaqInva;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxnorm;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxbinom;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxnbinom;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxnbinomMu;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxcauchy;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxchisq;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxexp;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxf;</span></span>
<span><span class="co">#&gt; rxode2i_ifn rxgeom;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxgamma;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxbeta;</span></span>
<span><span class="co">#&gt; rxode2i_ifn rxpois;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxt_;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxunif;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxweibull;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rinorm;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom ribinom;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom rinbinom;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom rinbinomMu;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 ricauchy;</span></span>
<span><span class="co">#&gt; rxode2i2_fn richisq;</span></span>
<span><span class="co">#&gt; rxode2i2_fn riexp;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rif;</span></span>
<span><span class="co">#&gt; rxode2i2_ifn rigeom;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rigamma;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 ribeta;</span></span>
<span><span class="co">#&gt; rxode2i2_ifn ripois;</span></span>
<span><span class="co">#&gt; rxode2i2_fn rit_;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 riunif;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 riweibull;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNorm;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNormDmean;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNormDsd;</span></span>
<span><span class="co">#&gt; rxode2_llikPoisFun _llikPois;</span></span>
<span><span class="co">#&gt; rxode2_llikPoisFun _llikPoisDlambda;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikBinom;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikBinomDprob;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinom;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomDprob;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomMu;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomMuDmu;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBeta;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBetaDshape1;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBetaDshape2;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikT;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDdf;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDmean;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDsd;</span></span>
<span><span class="co">#&gt; rxode2_llikChisqFun _llikChisq;</span></span>
<span><span class="co">#&gt; rxode2_llikChisqFun _llikChisqDdf;</span></span>
<span><span class="co">#&gt; rxode2_llikExpFun _llikExp;</span></span>
<span><span class="co">#&gt; rxode2_llikExpFun _llikExpDrate;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikF;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikFDdf1;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikFDdf2;</span></span>
<span><span class="co">#&gt; rxode2_llikGeomFun _llikGeom;</span></span>
<span><span class="co">#&gt; rxode2_llikGeomFun _llikGeomDp;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnif;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnifDalpha;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnifDbeta;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibull;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibullDshape;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibullDscale;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGamma;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGammaDshape;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGammaDrate;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchy;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchyDlocation;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchyDscale;</span></span>
<span><span class="co">#&gt; rxode2_compareFactorVal_fn _compareFactorVal;</span></span>
<span><span class="co">#&gt; #include "extraC.h"</span></span>
<span><span class="co">#&gt; double _prod(double *input, double *p, int type, int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return _prodPS(input, p, n, type);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _udf(const char *funName, double *input, int n, ...) {</span></span>
<span><span class="co">#&gt;   if (n == -42) Rf_error("%s", "this has a ui user function that cannot be called directly");</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return _evalUdf(funName, n, input);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _sum(double *input, double *pld, int m, int type, int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   double ret = _sumPS(input, n, pld, m, type);</span></span>
<span><span class="co">#&gt;   if (type == 2 &amp;&amp; m &lt; 0){</span></span>
<span><span class="co">#&gt;     for (int i = -m; i--;){</span></span>
<span><span class="co">#&gt;       pld[i] = 0.0;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return ret;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _sign(unsigned int n, ...) {</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double s = 1;</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;     s = sign(va_arg(valist, double))*s;</span></span>
<span><span class="co">#&gt;     if (s == 0){</span></span>
<span><span class="co">#&gt;       break;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return s;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _rxord(int _cSub, unsigned int n,  ...) {</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind* ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   if (!ind-&gt;inLhs) {</span></span>
<span><span class="co">#&gt;     return 1.0;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double ret = 1.0;</span></span>
<span><span class="co">#&gt;   double p = 0.0;</span></span>
<span><span class="co">#&gt;   double u = rxunif(ind, 0.0, 1.0);</span></span>
<span><span class="co">#&gt;   int found = 0;</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;     p += va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     if (!found) {</span></span>
<span><span class="co">#&gt;       if (u &lt; p) {</span></span>
<span><span class="co">#&gt;         ret = (double)(i+1);</span></span>
<span><span class="co">#&gt;         found = 1;</span></span>
<span><span class="co">#&gt;       }</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   if (!found) ret =(double)(n+1);</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return ret;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _max(unsigned int n, ...) {</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double mx = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tmp = 0;</span></span>
<span><span class="co">#&gt;   if (n &gt;= 1){</span></span>
<span><span class="co">#&gt;     mx = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     for (unsigned int i = 1; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;       tmp = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;       if (tmp&gt;mx) mx=tmp;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     va_end(valist);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return mx;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _min(unsigned int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double mn = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tmp = 0;</span></span>
<span><span class="co">#&gt;   if (n &gt;= 1){</span></span>
<span><span class="co">#&gt;     mn = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     for (unsigned int i = 1; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;       tmp = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;       if (tmp&lt;mn) mn=tmp;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     va_end(valist);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return mn;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _transit4P(int cmt, double t, unsigned int id, double n, double mtt, double bio){</span></span>
<span><span class="co">#&gt;   double nd = (double) n;</span></span>
<span><span class="co">#&gt;   double ktr = (nd+1)/mtt;</span></span>
<span><span class="co">#&gt;   double lktr = _safe_log(nd+1)-_safe_log(mtt);</span></span>
<span><span class="co">#&gt;   double tlast = _solveData-&gt;subjects[id].tlastS[cmt];</span></span>
<span><span class="co">#&gt;   double dose = _solveData-&gt;subjects[id].curDoseS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(dose)) dose = 0.0;</span></span>
<span><span class="co">#&gt;   if (ISNA(tlast)) tlast = 0.0;</span></span>
<span><span class="co">#&gt;   double tad = (t-tlast);</span></span>
<span><span class="co">#&gt;   return exp(_safe_log(bio*dose)+lktr+n*(lktr+_safe_log(tad))-ktr*(tad)-lgamma1p(nd));</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _transit3P(int cmt, double t, unsigned int id, double n, double mtt){</span></span>
<span><span class="co">#&gt;   double nd = (double) n;</span></span>
<span><span class="co">#&gt;   double ktr = (nd+1)/mtt;</span></span>
<span><span class="co">#&gt;   double lktr = _safe_log(nd+1)-_safe_log(mtt);</span></span>
<span><span class="co">#&gt;   double tlast = _solveData-&gt;subjects[id].tlastS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(tlast)) tlast = 0.0;</span></span>
<span><span class="co">#&gt;   double tad = t-tlast;</span></span>
<span><span class="co">#&gt;   double podo = _solveData-&gt;subjects[id].curDoseS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(podo)) podo = 0.0;</span></span>
<span><span class="co">#&gt;   return exp(_safe_log(podo)+lktr+n*(lktr+_safe_log(tad))-ktr*(tad)-lgamma1p(nd));</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void _assignFuns0(void) {</span></span>
<span><span class="co">#&gt;   _evalUdf = (_udf_type) R_GetCCallable("rxode2", "_rxode2_evalUdf");</span></span>
<span><span class="co">#&gt;   _getRxSolve_ = (_getRxSolve_t) R_GetCCallable("rxode2","getRxSolve_");</span></span>
<span><span class="co">#&gt;   _assign_ptr=(rxode2_assign_ptr) R_GetCCallable("rxode2","rxode2_assign_fn_pointers");</span></span>
<span><span class="co">#&gt;   _rxRmModelLib=(_rxRmModelLibType) R_GetCCallable("rxode2","rxRmModelLib");</span></span>
<span><span class="co">#&gt;   _rxGetModelLib=(_rxGetModelLibType) R_GetCCallable("rxode2","rxGetModelLib");</span></span>
<span><span class="co">#&gt;   _rxode2_rxAssignPtr=(_rx_asgn)R_GetCCallable("rxode2","_rxode2_rxAssignPtr");</span></span>
<span><span class="co">#&gt;   _rxQr=(_rx_asgn)R_GetCCallable("rxode2","_rxode2_rxQr");</span></span>
<span><span class="co">#&gt;   _rxIsCurrentC = (_rxIsCurrentC_type)R_GetCCallable("rxode2","rxIsCurrentC");</span></span>
<span><span class="co">#&gt;   _sumPS  = (_rxSumType) R_GetCCallable("PreciseSums","PreciseSums_sum_r");</span></span>
<span><span class="co">#&gt;   _prodPS = (_rxProdType) R_GetCCallable("PreciseSums","PreciseSums_prod_r");</span></span>
<span><span class="co">#&gt;   _prodType=(rxode2_fn0i)R_GetCCallable("PreciseSums", "PreciseSums_prod_get");</span></span>
<span><span class="co">#&gt;   _sumType=(rxode2_fn0i)R_GetCCallable("PreciseSums", "PreciseSums_sum_get");</span></span>
<span><span class="co">#&gt;   _ptrid=(rxode2_fn0i)R_GetCCallable("rxode2", "rxode2_current_fn_pointer_id");</span></span>
<span><span class="co">#&gt;   _compareFactorVal=(rxode2_compareFactorVal_fn) R_GetCCallable("rxode2", "compareFactorVal");</span></span>
<span><span class="co">#&gt;   _update_par_ptr = (_update_par_ptr_p) R_GetCCallable("rxode2","_update_par_ptr");</span></span>
<span><span class="co">#&gt;   _getParCov = (_getParCov_p) R_GetCCallable("rxode2","_getParCov");</span></span>
<span><span class="co">#&gt;   // dynamic start</span></span>
<span><span class="co">#&gt;   _llikCauchyDscale = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchyDscale");</span></span>
<span><span class="co">#&gt;   _llikCauchyDlocation = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchyDlocation");</span></span>
<span><span class="co">#&gt;   _llikCauchy = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchy");</span></span>
<span><span class="co">#&gt;   _llikGammaDrate = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGammaDrate");</span></span>
<span><span class="co">#&gt;   _llikGammaDshape = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGammaDshape");</span></span>
<span><span class="co">#&gt;   _llikGamma = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGamma");</span></span>
<span><span class="co">#&gt;   _llikWeibullDscale = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibullDscale");</span></span>
<span><span class="co">#&gt;   _llikWeibullDshape = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibullDshape");</span></span>
<span><span class="co">#&gt;   _llikWeibull = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibull");</span></span>
<span><span class="co">#&gt;   _llikUnifDbeta = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnifDbeta");</span></span>
<span><span class="co">#&gt;   _llikUnifDalpha = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnifDalpha");</span></span>
<span><span class="co">#&gt;   _llikUnif = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnif");</span></span>
<span><span class="co">#&gt;   _llikGeomDp = (rxode2_llikGeomFun) R_GetCCallable("rxode2ll", "rxLlikGeomDp");</span></span>
<span><span class="co">#&gt;   _llikGeom = (rxode2_llikGeomFun) R_GetCCallable("rxode2ll", "rxLlikGeom");</span></span>
<span><span class="co">#&gt;   _llikFDdf2 = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikFDdf2");</span></span>
<span><span class="co">#&gt;   _llikFDdf1 = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikFDdf1");</span></span>
<span><span class="co">#&gt;   _llikF = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikF");</span></span>
<span><span class="co">#&gt;   _llikExpDrate = (rxode2_llikExpFun) R_GetCCallable("rxode2ll", "rxLlikExpDrate");</span></span>
<span><span class="co">#&gt;   _llikExp = (rxode2_llikExpFun) R_GetCCallable("rxode2ll", "rxLlikExp");</span></span>
<span><span class="co">#&gt;   _llikChisqDdf = (rxode2_llikChisqFun) R_GetCCallable("rxode2ll", "rxLlikChisqDdf");</span></span>
<span><span class="co">#&gt;   _llikChisq = (rxode2_llikChisqFun) R_GetCCallable("rxode2ll", "rxLlikChisq");</span></span>
<span><span class="co">#&gt;   _llikTDsd = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDsd");</span></span>
<span><span class="co">#&gt;   _llikTDmean = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDmean");</span></span>
<span><span class="co">#&gt;   _llikTDdf = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDdf");</span></span>
<span><span class="co">#&gt;   _llikT = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikT");</span></span>
<span><span class="co">#&gt;   _llikBetaDshape2 = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBetaDshape2");</span></span>
<span><span class="co">#&gt;   _llikBetaDshape1 = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBetaDshape1");</span></span>
<span><span class="co">#&gt;   _llikBeta = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBeta");</span></span>
<span><span class="co">#&gt;   _llikNbinomMuDmu = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomMuDmu");</span></span>
<span><span class="co">#&gt;   _llikNbinomMu = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomMu");</span></span>
<span><span class="co">#&gt;   _llikNbinomDprob = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomDprob");</span></span>
<span><span class="co">#&gt;   _llikNbinom = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinom");</span></span>
<span><span class="co">#&gt;   _llikBinomDprob = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikBinomDprob");</span></span>
<span><span class="co">#&gt;   _llikBinom = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikBinom");</span></span>
<span><span class="co">#&gt;   _llikPoisDlambda = (rxode2_llikPoisFun) R_GetCCallable("rxode2ll", "rxLlikPoisDlambda");</span></span>
<span><span class="co">#&gt;   _llikPois = (rxode2_llikPoisFun) R_GetCCallable("rxode2ll", "rxLlikPois");</span></span>
<span><span class="co">#&gt;   _llikNormDsd = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNormDsd");</span></span>
<span><span class="co">#&gt;   _llikNormDmean = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNormDmean");</span></span>
<span><span class="co">#&gt;   _llikNorm = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNorm");</span></span>
<span><span class="co">#&gt;   simeps = (_simfun) R_GetCCallable("rxode2", "simeps");</span></span>
<span><span class="co">#&gt;   simeta = (_simfun) R_GetCCallable("rxode2", "simeta");</span></span>
<span><span class="co">#&gt;   expit = (rxode2_fn3) R_GetCCallable("rxode2", "expit");</span></span>
<span><span class="co">#&gt;   logit = (rxode2_fn3) R_GetCCallable("rxode2", "logit");</span></span>
<span><span class="co">#&gt;   gammapDer = (rxode2_fn2) R_GetCCallable("rxode2", "gammapDer");</span></span>
<span><span class="co">#&gt;   lowergamma = (rxode2_fn2) R_GetCCallable("rxode2", "lowergamma");</span></span>
<span><span class="co">#&gt;   uppergamma = (rxode2_fn2) R_GetCCallable("rxode2", "uppergamma");</span></span>
<span><span class="co">#&gt;   gammaqInva = (rxode2_fn2) R_GetCCallable("rxode2", "gammaqInva");</span></span>
<span><span class="co">#&gt;   gammaqInv = (rxode2_fn2) R_GetCCallable("rxode2", "gammaqInv");</span></span>
<span><span class="co">#&gt;   gammapInva = (rxode2_fn2) R_GetCCallable("rxode2", "gammapInva");</span></span>
<span><span class="co">#&gt;   gammapInv = (rxode2_fn2) R_GetCCallable("rxode2", "gammapInv");</span></span>
<span><span class="co">#&gt;   gammaq = (rxode2_fn2) R_GetCCallable("rxode2", "gammaq");</span></span>
<span><span class="co">#&gt;   gammap = (rxode2_fn2) R_GetCCallable("rxode2", "gammap");</span></span>
<span><span class="co">#&gt;   phi = (rxode2_fn) R_GetCCallable("rxode2", "phi");</span></span>
<span><span class="co">#&gt;   d2ELUa = (rxode2_fn2) R_GetCCallable("rxode2", "d2ELUa");</span></span>
<span><span class="co">#&gt;   dELUa = (rxode2_fn2) R_GetCCallable("rxode2", "dELUa");</span></span>
<span><span class="co">#&gt;   d2aELU = (rxode2_fn2) R_GetCCallable("rxode2", "d2aELU");</span></span>
<span><span class="co">#&gt;   d2ELU = (rxode2_fn2) R_GetCCallable("rxode2", "d2ELU");</span></span>
<span><span class="co">#&gt;   dELU = (rxode2_fn2) R_GetCCallable("rxode2", "dELU");</span></span>
<span><span class="co">#&gt;   ELU = (rxode2_fn2) R_GetCCallable("rxode2", "ELU");</span></span>
<span><span class="co">#&gt;   dPReLUa1 = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLUa1");</span></span>
<span><span class="co">#&gt;   dPReLUa = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLUa");</span></span>
<span><span class="co">#&gt;   dPReLU = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLU");</span></span>
<span><span class="co">#&gt;   PReLU = (rxode2_fn2) R_GetCCallable("rxode2", "PReLU");</span></span>
<span><span class="co">#&gt;   dSwish = (rxode2_fn) R_GetCCallable("rxode2", "dSwish");</span></span>
<span><span class="co">#&gt;   Swish = (rxode2_fn) R_GetCCallable("rxode2", "Swish");</span></span>
<span><span class="co">#&gt;   dlReLU = (rxode2_fn) R_GetCCallable("rxode2", "dlReLU");</span></span>
<span><span class="co">#&gt;   lReLU = (rxode2_fn) R_GetCCallable("rxode2", "lReLU");</span></span>
<span><span class="co">#&gt;   dSELU = (rxode2_fn) R_GetCCallable("rxode2", "dSELU");</span></span>
<span><span class="co">#&gt;   SELU = (rxode2_fn) R_GetCCallable("rxode2", "SELU");</span></span>
<span><span class="co">#&gt;   d4softplus = (rxode2_fn) R_GetCCallable("rxode2", "d4softplus");</span></span>
<span><span class="co">#&gt;   d3softplus = (rxode2_fn) R_GetCCallable("rxode2", "d3softplus");</span></span>
<span><span class="co">#&gt;   d2softplus = (rxode2_fn) R_GetCCallable("rxode2", "d2softplus");</span></span>
<span><span class="co">#&gt;   dsoftplus = (rxode2_fn) R_GetCCallable("rxode2", "dsoftplus");</span></span>
<span><span class="co">#&gt;   softplus = (rxode2_fn) R_GetCCallable("rxode2", "softplus");</span></span>
<span><span class="co">#&gt;   d4GELU = (rxode2_fn) R_GetCCallable("rxode2", "d4GELU");</span></span>
<span><span class="co">#&gt;   d3GELU = (rxode2_fn) R_GetCCallable("rxode2", "d3GELU");</span></span>
<span><span class="co">#&gt;   d2GELU = (rxode2_fn) R_GetCCallable("rxode2", "d2GELU");</span></span>
<span><span class="co">#&gt;   dGELU = (rxode2_fn) R_GetCCallable("rxode2", "dGELU");</span></span>
<span><span class="co">#&gt;   GELU = (rxode2_fn) R_GetCCallable("rxode2", "GELU");</span></span>
<span><span class="co">#&gt;   dReLU = (rxode2_fn) R_GetCCallable("rxode2", "dReLU");</span></span>
<span><span class="co">#&gt;   ReLU = (rxode2_fn) R_GetCCallable("rxode2", "ReLU");</span></span>
<span><span class="co">#&gt;   riweibull = (rxode2i2_fn2) R_GetCCallable("rxode2", "riweibull");</span></span>
<span><span class="co">#&gt;   riunif = (rxode2i2_fn2) R_GetCCallable("rxode2", "riunif");</span></span>
<span><span class="co">#&gt;   rit_ = (rxode2i2_fn) R_GetCCallable("rxode2", "rit_");</span></span>
<span><span class="co">#&gt;   ripois = (rxode2i2_ifn) R_GetCCallable("rxode2", "ripois");</span></span>
<span><span class="co">#&gt;   ribeta = (rxode2i2_fn2) R_GetCCallable("rxode2", "ribeta");</span></span>
<span><span class="co">#&gt;   rigamma = (rxode2i2_fn2) R_GetCCallable("rxode2", "rigamma");</span></span>
<span><span class="co">#&gt;   rigeom = (rxode2i2_ifn) R_GetCCallable("rxode2", "rigeom");</span></span>
<span><span class="co">#&gt;   rif = (rxode2i2_fn2) R_GetCCallable("rxode2", "rif");</span></span>
<span><span class="co">#&gt;   riexp = (rxode2i2_fn) R_GetCCallable("rxode2", "riexp");</span></span>
<span><span class="co">#&gt;   richisq = (rxode2i2_fn) R_GetCCallable("rxode2", "richisq");</span></span>
<span><span class="co">#&gt;   ricauchy = (rxode2i2_fn2) R_GetCCallable("rxode2", "ricauchy");</span></span>
<span><span class="co">#&gt;   rinbinomMu = (rxode2i2_ribinom) R_GetCCallable("rxode2", "rinbinomMu");</span></span>
<span><span class="co">#&gt;   rinbinom = (rxode2i2_ribinom) R_GetCCallable("rxode2", "rinbinom");</span></span>
<span><span class="co">#&gt;   ribinom = (rxode2i2_ribinom) R_GetCCallable("rxode2", "ribinom");</span></span>
<span><span class="co">#&gt;   rinorm = (rxode2i2_fn2) R_GetCCallable("rxode2", "rinorm");</span></span>
<span><span class="co">#&gt;   rxweibull = (rxode2i_fn2) R_GetCCallable("rxode2", "rxweibull");</span></span>
<span><span class="co">#&gt;   rxunif = (rxode2i_fn2) R_GetCCallable("rxode2", "rxunif");</span></span>
<span><span class="co">#&gt;   rxt_ = (rxode2i_fn) R_GetCCallable("rxode2", "rxt_");</span></span>
<span><span class="co">#&gt;   rxpois = (rxode2i_ifn) R_GetCCallable("rxode2", "rxpois");</span></span>
<span><span class="co">#&gt;   rxbeta = (rxode2i_fn2) R_GetCCallable("rxode2", "rxbeta");</span></span>
<span><span class="co">#&gt;   rxgamma = (rxode2i_fn2) R_GetCCallable("rxode2", "rxgamma");</span></span>
<span><span class="co">#&gt;   rxgeom = (rxode2i_ifn) R_GetCCallable("rxode2", "rxgeom");</span></span>
<span><span class="co">#&gt;   rxf = (rxode2i_fn2) R_GetCCallable("rxode2", "rxf");</span></span>
<span><span class="co">#&gt;   rxexp = (rxode2i_fn) R_GetCCallable("rxode2", "rxexp");</span></span>
<span><span class="co">#&gt;   rxchisq = (rxode2i_fn) R_GetCCallable("rxode2", "rxchisq");</span></span>
<span><span class="co">#&gt;   rxcauchy = (rxode2i_fn2) R_GetCCallable("rxode2", "rxcauchy");</span></span>
<span><span class="co">#&gt;   rxnbinomMu = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxnbinomMu");</span></span>
<span><span class="co">#&gt;   rxnbinom = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxnbinom");</span></span>
<span><span class="co">#&gt;   rxbinom = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxbinom");</span></span>
<span><span class="co">#&gt;   rxnorm = (rxode2i_fn2) R_GetCCallable("rxode2", "rxnorm");</span></span>
<span><span class="co">#&gt;   linCmtB = (linCmtB_p) R_GetCCallable("rxode2", "linCmtB");</span></span>
<span><span class="co">#&gt;   linCmtA = (linCmtA_p) R_GetCCallable("rxode2", "linCmtA");</span></span>
<span><span class="co">#&gt;   // dynamic stop</span></span>
<span><span class="co">#&gt;   _solveData = _getRxSolve_();</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void _assignFuns(void) {</span></span>
<span><span class="co">#&gt;   if (_assign_ptr == NULL){</span></span>
<span><span class="co">#&gt;     _assignFuns0();</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void __assignFuns2(rx_solve rx,</span></span>
<span><span class="co">#&gt;                    rx_solving_options op,</span></span>
<span><span class="co">#&gt;                    t_F f,</span></span>
<span><span class="co">#&gt;                    t_LAG lag,</span></span>
<span><span class="co">#&gt;                    t_RATE rate,</span></span>
<span><span class="co">#&gt;                    t_DUR dur,</span></span>
<span><span class="co">#&gt;                    t_calc_mtime mtime,</span></span>
<span><span class="co">#&gt;                    t_ME me,</span></span>
<span><span class="co">#&gt;                    t_IndF indf,</span></span>
<span><span class="co">#&gt;                    t_getTime gettime,</span></span>
<span><span class="co">#&gt;                    t_locateTimeIndex timeindex,</span></span>
<span><span class="co">#&gt;                    t_handle_evidL handleEvid,</span></span>
<span><span class="co">#&gt;                    t_getDur getdur) {</span></span>
<span><span class="co">#&gt;   // assign start</span></span>
<span><span class="co">#&gt;     static rxode2_assignFuns2_t rxode2_assignFuns2 = NULL;</span></span>
<span><span class="co">#&gt;     if (rxode2_assignFuns2 == NULL) rxode2_assignFuns2 = (rxode2_assignFuns2_t)(R_GetCCallable("rxode2", "_rxode2_assignFuns2"));</span></span>
<span><span class="co">#&gt;     rxode2_assignFuns2(rx, op, f, lag, rate, dur, mtime, me, indf, gettime, timeindex, handleEvid, getdur);</span></span>
<span><span class="co">#&gt;   // assign stop</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void  rx_03c98f16c15dbcc98edca239083bfffa__ode_solver_solvedata (rx_solve *solve){</span></span>
<span><span class="co">#&gt;   _solveData = solve;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern rx_solve *rx_03c98f16c15dbcc98edca239083bfffa__ode_solver_get_solvedata(void){</span></span>
<span><span class="co">#&gt;   return _solveData;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; SEXP rx_03c98f16c15dbcc98edca239083bfffa__model_vars(void);</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; // prj-specific differential eqns</span></span>
<span><span class="co">#&gt; void rx_03c98f16c15dbcc98edca239083bfffa__dydt(int *_neq, double __t, double *__zzStateVar__, double *__DDtStateVar__)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   int _cSub = _neq[1];</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_neq[1]].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=1;</span></span>
<span><span class="co">#&gt;   double TKA = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TCL = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TV2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TQ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TV3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TKout = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TEC50 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TKin = NA_REAL;</span></span>
<span><span class="co">#&gt;   double WT = NA_REAL;</span></span>
<span><span class="co">#&gt;   double ctime = NA_REAL;</span></span>
<span><span class="co">#&gt;   double KA = NA_REAL;</span></span>
<span><span class="co">#&gt;   double CL = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Q = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kout = NA_REAL;</span></span>
<span><span class="co">#&gt;   double EC50 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Tz = NA_REAL;</span></span>
<span><span class="co">#&gt;   double amp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double central = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kin = NA_REAL;</span></span>
<span><span class="co">#&gt;   double pi = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double peri = NA_REAL;</span></span>
<span><span class="co">#&gt;   double depot = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eff = NA_REAL;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   (void)TKA;</span></span>
<span><span class="co">#&gt;   (void)TCL;</span></span>
<span><span class="co">#&gt;   (void)TV2;</span></span>
<span><span class="co">#&gt;   (void)TQ;</span></span>
<span><span class="co">#&gt;   (void)TV3;</span></span>
<span><span class="co">#&gt;   (void)TKout;</span></span>
<span><span class="co">#&gt;   (void)TEC50;</span></span>
<span><span class="co">#&gt;   (void)TKin;</span></span>
<span><span class="co">#&gt;   (void)WT;</span></span>
<span><span class="co">#&gt;   (void)ctime;</span></span>
<span><span class="co">#&gt;   (void)KA;</span></span>
<span><span class="co">#&gt;   (void)CL;</span></span>
<span><span class="co">#&gt;   (void)V2;</span></span>
<span><span class="co">#&gt;   (void)Q;</span></span>
<span><span class="co">#&gt;   (void)V3;</span></span>
<span><span class="co">#&gt;   (void)Kout;</span></span>
<span><span class="co">#&gt;   (void)EC50;</span></span>
<span><span class="co">#&gt;   (void)Tz;</span></span>
<span><span class="co">#&gt;   (void)amp;</span></span>
<span><span class="co">#&gt;   (void)C2;</span></span>
<span><span class="co">#&gt;   (void)central;</span></span>
<span><span class="co">#&gt;   (void)Kin;</span></span>
<span><span class="co">#&gt;   (void)pi;</span></span>
<span><span class="co">#&gt;   (void)C3;</span></span>
<span><span class="co">#&gt;   (void)peri;</span></span>
<span><span class="co">#&gt;   (void)depot;</span></span>
<span><span class="co">#&gt;   (void)eff;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   KA = _PL[0];</span></span>
<span><span class="co">#&gt;   CL = _PL[1];</span></span>
<span><span class="co">#&gt;   V2 = _PL[2];</span></span>
<span><span class="co">#&gt;   Q = _PL[3];</span></span>
<span><span class="co">#&gt;   V3 = _PL[4];</span></span>
<span><span class="co">#&gt;   Kout = _PL[5];</span></span>
<span><span class="co">#&gt;   EC50 = _PL[6];</span></span>
<span><span class="co">#&gt;   C2 = _PL[7];</span></span>
<span><span class="co">#&gt;   Kin = _PL[8];</span></span>
<span><span class="co">#&gt;   C3 = _PL[9];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _update_par_ptr(__t, _cSub, _solveData, _idx);</span></span>
<span><span class="co">#&gt;   TKA = _PP[0];</span></span>
<span><span class="co">#&gt;   TCL = _PP[1];</span></span>
<span><span class="co">#&gt;   TV2 = _PP[2];</span></span>
<span><span class="co">#&gt;   TQ = _PP[3];</span></span>
<span><span class="co">#&gt;   TV3 = _PP[4];</span></span>
<span><span class="co">#&gt;   TKout = _PP[5];</span></span>
<span><span class="co">#&gt;   TEC50 = _PP[6];</span></span>
<span><span class="co">#&gt;   TKin = _PP[7];</span></span>
<span><span class="co">#&gt;   WT = _PP[8];</span></span>
<span><span class="co">#&gt;   ctime = _PP[9];</span></span>
<span><span class="co">#&gt;   Tz = _PP[10];</span></span>
<span><span class="co">#&gt;   amp = _PP[11];</span></span>
<span><span class="co">#&gt;   pi = _PP[12];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   depot = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">#&gt;   central = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">#&gt;   peri = __zzStateVar__[__DDT2__]*((double)(_ON[__DDT2__]));</span></span>
<span><span class="co">#&gt;   eff = __zzStateVar__[__DDT3__]*((double)(_ON[__DDT3__]));</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   KA =TKA;</span></span>
<span><span class="co">#&gt;   CL =TCL*Rx_pow((WT/_div0(70)),0.75);</span></span>
<span><span class="co">#&gt;   V2 =TV2;</span></span>
<span><span class="co">#&gt;   Q =TQ;</span></span>
<span><span class="co">#&gt;   V3 =TV3;</span></span>
<span><span class="co">#&gt;   Kout =TKout;</span></span>
<span><span class="co">#&gt;   EC50 =TEC50;</span></span>
<span><span class="co">#&gt;   C2 =central/_div0(V2);</span></span>
<span><span class="co">#&gt;   Kin =TKin+amp*cos(2*pi*(ctime-Tz)/_div0(24));</span></span>
<span><span class="co">#&gt;   C3 =peri/_div0(V3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT0__] = ((double)(_ON[__DDT0__]))*(_IR[__DDT0__] -KA*depot);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT1__] = ((double)(_ON[__DDT1__]))*(_IR[__DDT1__] + KA*depot-CL*C2-Q*C2+Q*C3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT2__] = ((double)(_ON[__DDT2__]))*(_IR[__DDT2__] + Q*C2-Q*C3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT3__] = ((double)(_ON[__DDT3__]))*(_IR[__DDT3__] + Kin-Kout*(1-C2/_div0((EC50+C2)))*eff);</span></span>
<span><span class="co">#&gt;   (&amp;_solveData-&gt;subjects[_cSub])-&gt;dadt_counter[0]++;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; // Jacobian derived vars</span></span>
<span><span class="co">#&gt; void rx_03c98f16c15dbcc98edca239083bfffa__calc_jac(int *_neq, double __t, double *__zzStateVar__, double *__PDStateVar__, unsigned int __NROWPD__) {</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;     int _cSub=_neq[1];</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_neq[1]].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=2;</span></span>
<span><span class="co">#&gt;   (&amp;_solveData-&gt;subjects[_cSub])-&gt;jac_counter[0]++;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Functional based initial conditions.</span></span>
<span><span class="co">#&gt; void rx_03c98f16c15dbcc98edca239083bfffa__inis(int _cSub, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;  _ind-&gt;_rxFlag=3;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // prj-specific derived vars</span></span>
<span><span class="co">#&gt; void rx_03c98f16c15dbcc98edca239083bfffa__calc_lhs(int _cSub, double __t, double *__zzStateVar__, double *_lhs) {</span></span>
<span><span class="co">#&gt;     int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=11;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_0__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_1__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_2__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_3__;</span></span>
<span><span class="co">#&gt;   double TKA = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TCL = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TV2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TQ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TV3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TKout = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TEC50 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TKin = NA_REAL;</span></span>
<span><span class="co">#&gt;   double WT = NA_REAL;</span></span>
<span><span class="co">#&gt;   double ctime = NA_REAL;</span></span>
<span><span class="co">#&gt;   double KA = NA_REAL;</span></span>
<span><span class="co">#&gt;   double CL = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Q = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kout = NA_REAL;</span></span>
<span><span class="co">#&gt;   double EC50 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Tz = NA_REAL;</span></span>
<span><span class="co">#&gt;   double amp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double central = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kin = NA_REAL;</span></span>
<span><span class="co">#&gt;   double pi = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double peri = NA_REAL;</span></span>
<span><span class="co">#&gt;   double depot = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eff = NA_REAL;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_0__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_1__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_2__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_3__;</span></span>
<span><span class="co">#&gt;   (void)TKA;</span></span>
<span><span class="co">#&gt;   (void)TCL;</span></span>
<span><span class="co">#&gt;   (void)TV2;</span></span>
<span><span class="co">#&gt;   (void)TQ;</span></span>
<span><span class="co">#&gt;   (void)TV3;</span></span>
<span><span class="co">#&gt;   (void)TKout;</span></span>
<span><span class="co">#&gt;   (void)TEC50;</span></span>
<span><span class="co">#&gt;   (void)TKin;</span></span>
<span><span class="co">#&gt;   (void)WT;</span></span>
<span><span class="co">#&gt;   (void)ctime;</span></span>
<span><span class="co">#&gt;   (void)KA;</span></span>
<span><span class="co">#&gt;   (void)CL;</span></span>
<span><span class="co">#&gt;   (void)V2;</span></span>
<span><span class="co">#&gt;   (void)Q;</span></span>
<span><span class="co">#&gt;   (void)V3;</span></span>
<span><span class="co">#&gt;   (void)Kout;</span></span>
<span><span class="co">#&gt;   (void)EC50;</span></span>
<span><span class="co">#&gt;   (void)Tz;</span></span>
<span><span class="co">#&gt;   (void)amp;</span></span>
<span><span class="co">#&gt;   (void)C2;</span></span>
<span><span class="co">#&gt;   (void)central;</span></span>
<span><span class="co">#&gt;   (void)Kin;</span></span>
<span><span class="co">#&gt;   (void)pi;</span></span>
<span><span class="co">#&gt;   (void)C3;</span></span>
<span><span class="co">#&gt;   (void)peri;</span></span>
<span><span class="co">#&gt;   (void)depot;</span></span>
<span><span class="co">#&gt;   (void)eff;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   KA = _PL[0];</span></span>
<span><span class="co">#&gt;   CL = _PL[1];</span></span>
<span><span class="co">#&gt;   V2 = _PL[2];</span></span>
<span><span class="co">#&gt;   Q = _PL[3];</span></span>
<span><span class="co">#&gt;   V3 = _PL[4];</span></span>
<span><span class="co">#&gt;   Kout = _PL[5];</span></span>
<span><span class="co">#&gt;   EC50 = _PL[6];</span></span>
<span><span class="co">#&gt;   C2 = _PL[7];</span></span>
<span><span class="co">#&gt;   Kin = _PL[8];</span></span>
<span><span class="co">#&gt;   C3 = _PL[9];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _update_par_ptr(__t, _cSub, _solveData, _idx);</span></span>
<span><span class="co">#&gt;   TKA = _PP[0];</span></span>
<span><span class="co">#&gt;   TCL = _PP[1];</span></span>
<span><span class="co">#&gt;   TV2 = _PP[2];</span></span>
<span><span class="co">#&gt;   TQ = _PP[3];</span></span>
<span><span class="co">#&gt;   TV3 = _PP[4];</span></span>
<span><span class="co">#&gt;   TKout = _PP[5];</span></span>
<span><span class="co">#&gt;   TEC50 = _PP[6];</span></span>
<span><span class="co">#&gt;   TKin = _PP[7];</span></span>
<span><span class="co">#&gt;   WT = _PP[8];</span></span>
<span><span class="co">#&gt;   ctime = _PP[9];</span></span>
<span><span class="co">#&gt;   Tz = _PP[10];</span></span>
<span><span class="co">#&gt;   amp = _PP[11];</span></span>
<span><span class="co">#&gt;   pi = _PP[12];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   depot = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">#&gt;   central = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">#&gt;   peri = __zzStateVar__[__DDT2__]*((double)(_ON[__DDT2__]));</span></span>
<span><span class="co">#&gt;   eff = __zzStateVar__[__DDT3__]*((double)(_ON[__DDT3__]));</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   KA =TKA;</span></span>
<span><span class="co">#&gt;   CL =TCL*Rx_pow((WT/_div0(70)),0.75);</span></span>
<span><span class="co">#&gt;   V2 =TV2;</span></span>
<span><span class="co">#&gt;   Q =TQ;</span></span>
<span><span class="co">#&gt;   V3 =TV3;</span></span>
<span><span class="co">#&gt;   Kout =TKout;</span></span>
<span><span class="co">#&gt;   EC50 =TEC50;</span></span>
<span><span class="co">#&gt;   C2 =central/_div0(V2);</span></span>
<span><span class="co">#&gt;   Kin =TKin+amp*cos(2*pi*(ctime-Tz)/_div0(24));</span></span>
<span><span class="co">#&gt;   C3 =peri/_div0(V3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_0__ = ((double)(_ON[__DDT0__]))*(_IR[__DDT0__] -KA*depot);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_1__ = ((double)(_ON[__DDT1__]))*(_IR[__DDT1__] + KA*depot-CL*C2-Q*C2+Q*C3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_2__ = ((double)(_ON[__DDT2__]))*(_IR[__DDT2__] + Q*C2-Q*C3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_3__ = ((double)(_ON[__DDT3__]))*(_IR[__DDT3__] + Kin-Kout*(1-C2/_div0((EC50+C2)))*eff);</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _lhs[_LHS_0_]=KA;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_1_]=CL;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_2_]=V2;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_3_]=Q;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_4_]=V3;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_5_]=Kout;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_6_]=EC50;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_7_]=C2;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_8_]=Kin;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_9_]=C3;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Functional based bioavailability</span></span>
<span><span class="co">#&gt; double rx_03c98f16c15dbcc98edca239083bfffa__F(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return _amt;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; // Functional based absorption lag</span></span>
<span><span class="co">#&gt; double rx_03c98f16c15dbcc98edca239083bfffa__Lag(int _cSub,  int _cmt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return __t;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Modeled zero-order rate</span></span>
<span><span class="co">#&gt; double rx_03c98f16c15dbcc98edca239083bfffa__Rate(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return 0.0;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Modeled zero-order duration</span></span>
<span><span class="co">#&gt; double rx_03c98f16c15dbcc98edca239083bfffa__Dur(int _cSub,  int _cmt, double _amt, double __t){</span></span>
<span><span class="co">#&gt;  return 0.0;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Model Times</span></span>
<span><span class="co">#&gt; void rx_03c98f16c15dbcc98edca239083bfffa__mtime(int _cSub, double *_mtime){</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Matrix Exponential (0)</span></span>
<span><span class="co">#&gt; void rx_03c98f16c15dbcc98edca239083bfffa__ME(int _cSub, double _t, double __t, double *_mat, const double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=9;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Inductive linearization Matf</span></span>
<span><span class="co">#&gt; void rx_03c98f16c15dbcc98edca239083bfffa__IndF(int _cSub, double _t, double __t, double *_matf){</span></span>
<span><span class="co">#&gt;  int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=10;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern SEXP rx_03c98f16c15dbcc98edca239083bfffa__model_vars(void){</span></span>
<span><span class="co">#&gt;   int pro=0;</span></span>
<span><span class="co">#&gt;   SEXP _mv = PROTECT(_rxGetModelLib("rx_03c98f16c15dbcc98edca239083bfffa__model_vars"));pro++;</span></span>
<span><span class="co">#&gt;   if (!_rxIsCurrentC(_mv)){</span></span>
<span><span class="co">#&gt;     SEXP hash    = PROTECT(Rf_allocVector(STRSXP, 1));pro++;</span></span>
<span><span class="co">#&gt; #define __doBuf__  snprintf(buf, __doBufN__, "un]\"BAAA@QRtHACAAAAAAAY4&lt;AAAv7#aT)\?5]\"JAJDblpuS:)mJFWB.;NCHt#mYc*&lt;}oTFI)EjFF=y8zEUr&gt;VH0C2bUx&lt;Qo#Xy&lt;0\?a}kPwIS58GVqaJM_aE$`tF1wE`kNtKBFJSKK3$TPX%%@FcI\?~kSn5{STf(zu9P{2Py/MF}za=Pen^Uk+Q]b)Lkf4crF}cz9;NLJ{4fE&gt;Rj/xX.6IR&gt;bb`fIwc$\?Pz~Qv(.3Zh{n{MWWd8!dU4B7`aB=faIl:!Z\"o`+J*pNl:QD;J^:ufDzy.%%1M+C#O=jU(Z4T6\?#Ez(5IBU=0EHrG|B/kP/ow\"3BYA4G3@PqE^GNdD00]+am{%%S7$3+}7V4os)SN51P4UkH#i1x!1\"3ImeSKM:&amp;]@L^\?]G+unl/`0;T]HL~N&lt;ZkBx{mcIEC][UjTK!t%%fxpnVafxp5~`@eM\?J`u3S91{I`PlVv:z@jbY&gt;L:xX7;Ji[/,eA.}3T#!&amp;Ko^jy&amp;ywqX,eUc\"OFH&lt;D:71XqX2cyZq%%$m`n\?e&amp;=rEm]nn&lt;WP8V/jPp[~O(`8Hi87bK6Uad4(#ec^u7dt\"d;TV@dQ6t$]PKA1Z]IQV:_i{ST#jgfG!Jfs)G[yQI[,2b%%SOyxI/:5\"BUIA{DZ0Ky#|f}5Z,aw_K}Fx.j1@%%q&amp;s\?r9)^D~P69gi}P68uz.&gt;2E:LZ8he@xr;Q~qd:K0;+1sQ0S%%v\"P_6{jNgN83FY4HB8E!u0+Z`L,%%JQ\"1:n.*mlZyUX(CJL_c4R7.|wgz8.QF)5=aDStLqUBJ5S2GOHt2Vp$kJa4=*1zNNE:NC(dD*aV|@~qj[wn`a5#{o7$eAMv[bL&amp;WQJtnmOdX]w%%L+d(D\"d[u@&lt;rHV,}OnHzdocpMW9m%%TrQZ|mEqCz;DRGXsko_&gt;M9P7TxVCU~%%$HktuL~&lt;tQl4`@sD_K+#gy,}NNN5m*qT$E[%%!2fS;F%%}TZ~v5:~Si$Kd=uTQ\?&lt;i=^wm\"(!N&lt;ZQdm[GWOv]rMl(xy`c$}l!&gt;1rT&gt;/xcn/nNs$V7mx,1_!._Ya!s!U&lt;ko\?jU0wDjhHRAbbi;cWoc+~Yab&amp;M&gt;Y,RPudS5VFBzWFBlfRtAAdppi$#nO&gt;5j%%.q4]EK+583)z^p_mE|ITohdXbn*F+&amp;(2B6T&gt;Q)c=&amp;adlAoeEIzJwsIxIoz~[v(9F4O{8&lt;Wa4A8(iIO3X^vZ*\"C&amp;y0M/YW*l4SO1E,D2Gay5(0=,w{~cH=CPk%%~T|/4#Ltq`wbq[8l.^WG=fKx4/eE%%&amp;cE:VuBf@t{`9@c=@Nt697hNboqgOLG,Mx08N_/Iouq5HTEC,,}gr9yv$7R844+yTJ$CVz`_Id.&amp;e]i%%e|8APGJuqYO/)TFuY65Tj\?10DKJ$K7SMc^EtM%%J!h{F%%(.0QD6+FKs#)0LF~oIyT^/`vrgv\?=\?@QcA)XaOZBH:onrY7wcFQ&lt;.Mxz,a=oYy[ngY5|Q{ngqY,FL[#YD`_mV=Dm9~z\"sCpXCijdP&amp;9&amp;$ZP:\?}Ce15G&lt;hw\?Zs*+OHmHyf@dL:2n&amp;Oy/BO!:imMLH5;.,~kcR^*1HWoU3(.eCNkAyl3,gFapsXa=U&lt;iE");</span></span>
<span><span class="co">#&gt;     char buf[1562];</span></span>
<span><span class="co">#&gt; #define __doBufN__ 1562</span></span>
<span><span class="co">#&gt;     __doBuf__</span></span>
<span><span class="co">#&gt; #undef __doBuf__</span></span>
<span><span class="co">#&gt; #undef __doBufN__</span></span>
<span><span class="co">#&gt;     SET_STRING_ELT(hash, 0, Rf_mkChar(buf));</span></span>
<span><span class="co">#&gt;     SEXP lst      = PROTECT(_rxQr(hash));pro++;</span></span>
<span><span class="co">#&gt;     _assign_ptr(lst);</span></span>
<span><span class="co">#&gt;     UNPROTECT(pro);</span></span>
<span><span class="co">#&gt;     return lst;</span></span>
<span><span class="co">#&gt;   } else {</span></span>
<span><span class="co">#&gt;     UNPROTECT(pro);</span></span>
<span><span class="co">#&gt;     return _mv;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void rx_03c98f16c15dbcc98edca239083bfffa__dydt_lsoda(int *neq, double *t, double *A, double *DADT)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   rx_03c98f16c15dbcc98edca239083bfffa__dydt(neq, *t, A, DADT);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern int rx_03c98f16c15dbcc98edca239083bfffa__dydt_liblsoda(double __t, double *y, double *ydot, void *data)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   int *neq = (int*)(data);</span></span>
<span><span class="co">#&gt;   rx_03c98f16c15dbcc98edca239083bfffa__dydt(neq, __t, y, ydot);</span></span>
<span><span class="co">#&gt;   return(0);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void rx_03c98f16c15dbcc98edca239083bfffa__calc_jac_lsoda(int *neq, double *t, double *A,int *ml, int *mu, double *JAC, int *nrowpd){</span></span>
<span><span class="co">#&gt;   // Update all covariate parameters</span></span>
<span><span class="co">#&gt;   rx_03c98f16c15dbcc98edca239083bfffa__calc_jac(neq, *t, A, JAC, *nrowpd);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; //Create function to call from R's main thread that assigns the required functions. Sometimes they don't get assigned.</span></span>
<span><span class="co">#&gt; extern void rx_03c98f16c15dbcc98edca239083bfffa__assignFuns(void){</span></span>
<span><span class="co">#&gt;   _assignFuns();</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; //Initialize the dll to match rxode2's calls</span></span>
<span><span class="co">#&gt; void R_init0_rx_03c98f16c15dbcc98edca239083bfffa_(void){</span></span>
<span><span class="co">#&gt;   // Get C callables on load; Otherwise it isn't thread safe</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_03c98f16c15dbcc98edca239083bfffa_","rx_03c98f16c15dbcc98edca239083bfffa__assignFuns2", (DL_FUNC) __assignFuns2);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_03c98f16c15dbcc98edca239083bfffa_","rx_03c98f16c15dbcc98edca239083bfffa__assignFuns", (DL_FUNC) rx_03c98f16c15dbcc98edca239083bfffa__assignFuns);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_03c98f16c15dbcc98edca239083bfffa_","rx_03c98f16c15dbcc98edca239083bfffa__inis",(DL_FUNC) rx_03c98f16c15dbcc98edca239083bfffa__inis);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_03c98f16c15dbcc98edca239083bfffa_","rx_03c98f16c15dbcc98edca239083bfffa__dydt",(DL_FUNC) rx_03c98f16c15dbcc98edca239083bfffa__dydt);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_03c98f16c15dbcc98edca239083bfffa_","rx_03c98f16c15dbcc98edca239083bfffa__calc_lhs",(DL_FUNC) rx_03c98f16c15dbcc98edca239083bfffa__calc_lhs);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_03c98f16c15dbcc98edca239083bfffa_","rx_03c98f16c15dbcc98edca239083bfffa__calc_jac",(DL_FUNC) rx_03c98f16c15dbcc98edca239083bfffa__calc_jac);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_03c98f16c15dbcc98edca239083bfffa_","rx_03c98f16c15dbcc98edca239083bfffa__dydt_lsoda", (DL_FUNC) rx_03c98f16c15dbcc98edca239083bfffa__dydt_lsoda);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_03c98f16c15dbcc98edca239083bfffa_","rx_03c98f16c15dbcc98edca239083bfffa__calc_jac_lsoda", (DL_FUNC) rx_03c98f16c15dbcc98edca239083bfffa__calc_jac_lsoda);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_03c98f16c15dbcc98edca239083bfffa_","rx_03c98f16c15dbcc98edca239083bfffa__ode_solver_solvedata", (DL_FUNC) rx_03c98f16c15dbcc98edca239083bfffa__ode_solver_solvedata);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_03c98f16c15dbcc98edca239083bfffa_","rx_03c98f16c15dbcc98edca239083bfffa__ode_solver_get_solvedata", (DL_FUNC) rx_03c98f16c15dbcc98edca239083bfffa__ode_solver_get_solvedata);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_03c98f16c15dbcc98edca239083bfffa_","rx_03c98f16c15dbcc98edca239083bfffa__F", (DL_FUNC) rx_03c98f16c15dbcc98edca239083bfffa__F);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_03c98f16c15dbcc98edca239083bfffa_","rx_03c98f16c15dbcc98edca239083bfffa__Lag", (DL_FUNC) rx_03c98f16c15dbcc98edca239083bfffa__Lag);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_03c98f16c15dbcc98edca239083bfffa_","rx_03c98f16c15dbcc98edca239083bfffa__Rate", (DL_FUNC) rx_03c98f16c15dbcc98edca239083bfffa__Rate);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_03c98f16c15dbcc98edca239083bfffa_","rx_03c98f16c15dbcc98edca239083bfffa__Dur", (DL_FUNC) rx_03c98f16c15dbcc98edca239083bfffa__Dur);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_03c98f16c15dbcc98edca239083bfffa_","rx_03c98f16c15dbcc98edca239083bfffa__mtime", (DL_FUNC) rx_03c98f16c15dbcc98edca239083bfffa__mtime);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_03c98f16c15dbcc98edca239083bfffa_","rx_03c98f16c15dbcc98edca239083bfffa__ME", (DL_FUNC) rx_03c98f16c15dbcc98edca239083bfffa__ME);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_03c98f16c15dbcc98edca239083bfffa_","rx_03c98f16c15dbcc98edca239083bfffa__IndF", (DL_FUNC) rx_03c98f16c15dbcc98edca239083bfffa__IndF);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_03c98f16c15dbcc98edca239083bfffa_","rx_03c98f16c15dbcc98edca239083bfffa__dydt_liblsoda", (DL_FUNC) rx_03c98f16c15dbcc98edca239083bfffa__dydt_liblsoda);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; //Initialize the dll to match rxode2's calls</span></span>
<span><span class="co">#&gt; void R_init_rx_03c98f16c15dbcc98edca239083bfffa_(DllInfo *info){</span></span>
<span><span class="co">#&gt;   // Get C callables on load; Otherwise it isn't thread safe</span></span>
<span><span class="co">#&gt;   R_init0_rx_03c98f16c15dbcc98edca239083bfffa_();</span></span>
<span><span class="co">#&gt;   static const R_CallMethodDef callMethods[]  = {</span></span>
<span><span class="co">#&gt;     {"rx_03c98f16c15dbcc98edca239083bfffa__model_vars", (DL_FUNC) &amp;rx_03c98f16c15dbcc98edca239083bfffa__model_vars, 0},</span></span>
<span><span class="co">#&gt;     {NULL, NULL, 0}</span></span>
<span><span class="co">#&gt;   };</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   R_registerRoutines(info, NULL, callMethods, NULL, NULL);</span></span>
<span><span class="co">#&gt;   R_useDynamicSymbols(info,FALSE);</span></span>
<span><span class="co">#&gt;   _assignFuns0();</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; void R_unload_rx_03c98f16c15dbcc98edca239083bfffa_ (DllInfo *info){</span></span>
<span><span class="co">#&gt;   // Free resources required for single subject solve.</span></span>
<span><span class="co">#&gt;   SEXP _mv = PROTECT(_rxGetModelLib("rx_03c98f16c15dbcc98edca239083bfffa__model_vars"));</span></span>
<span><span class="co">#&gt;   if (!Rf_isNull(_mv)){</span></span>
<span><span class="co">#&gt;     _rxRmModelLib("rx_03c98f16c15dbcc98edca239083bfffa__model_vars");</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   UNPROTECT(1);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">r1</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Solved rxode2 object ──</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Parameters (</span><span style="color: #0000BB; font-weight: bold;">$params</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt;        TKA        TCL        TV2         TQ        TV3      TKout      TEC50 </span></span>
<span><span class="co">#&gt;   0.294000  18.600000  40.200000  10.500000 297.000000   1.000000 200.000000 </span></span>
<span><span class="co">#&gt;       TKin         Tz        amp         pi </span></span>
<span><span class="co">#&gt;   1.000000   8.000000   0.100000   3.141593 </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Initial Conditions (</span><span style="color: #0000BB; font-weight: bold;">$inits</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt;   depot central    peri     eff </span></span>
<span><span class="co">#&gt;       0       0       0       1 </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── First part of data (object): ──</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 100 × 17</span></span></span>
<span><span class="co">#&gt;    time    KA    CL    V2     Q    V3  Kout  EC50    C2   Kin    C3  depot</span></span>
<span><span class="co">#&gt;     <span style="color: #949494;">[h]</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 0     0.294  18.6  40.2  10.5   297     1   200   0    1.1  0     <span style="text-decoration: underline;">10</span>000 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 0.485 0.294  18.6  40.2  10.5   297     1   200  27.8  1.10 0.257  <span style="text-decoration: underline;">8</span>671.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 0.970 0.294  18.6  40.2  10.5   297     1   200  43.7  1.10 0.874  <span style="text-decoration: underline;">7</span>519.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 1.45  0.294  18.6  40.2  10.5   297     1   200  51.8  1.09 1.68   <span style="text-decoration: underline;">6</span>520.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 1.94  0.294  18.6  40.2  10.5   297     1   200  54.8  1.09 2.56   <span style="text-decoration: underline;">5</span>654.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 2.42  0.294  18.6  40.2  10.5   297     1   200  54.6  1.08 3.45   <span style="text-decoration: underline;">4</span>903.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 94 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 5 more variables: central &lt;dbl&gt;, peri &lt;dbl&gt;, eff &lt;dbl&gt;, ctime [h], WT &lt;dbl&gt;</span></span></span></code></pre></div>
<p>When solving ODE equations, the solver may sample times outside of
the data. When this happens, this ODE solver can use linear
interpolation between the covariate values. It is equivalent to R’s
<code>approxfun</code> with <code>method="linear"</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r1</span>,<span class="va">C2</span>, ylab<span class="op">=</span><span class="st">"Central Concentration"</span><span class="op">)</span></span></code></pre></div>
<p><img src="rxode2-covariates_files/figure-html/time-varying-linear-central-1.png" width="100%"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r1</span>,<span class="va">eff</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Effect"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time"</span><span class="op">)</span></span></code></pre></div>
<p><img src="rxode2-covariates_files/figure-html/time-varying-linear-effect-1.png" width="100%"></p>
<p>Note that the linear approximation in this case leads to some kinks
in the solved system at 24-hours where the covariate has a linear
interpolation between near 24 and near 0. While linear seems reasonable,
cases like clock time make other interpolation methods more
attractive.</p>
<p>In rxode2 the default covariate interpolation is be the last
observation carried forward (<code>locf</code>), or constant
approximation. This is equivalent to R’s <code>approxfun</code> with
<code>method="constant"</code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/symengine/man/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">mod4</span>, <span class="va">ev</span>,covsInterpolation<span class="op">=</span><span class="st">"locf"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">r1</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Solved rxode2 object ──</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Parameters (</span><span style="color: #0000BB; font-weight: bold;">$params</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt;        TKA        TCL        TV2         TQ        TV3      TKout      TEC50 </span></span>
<span><span class="co">#&gt;   0.294000  18.600000  40.200000  10.500000 297.000000   1.000000 200.000000 </span></span>
<span><span class="co">#&gt;       TKin         Tz        amp         pi </span></span>
<span><span class="co">#&gt;   1.000000   8.000000   0.100000   3.141593 </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Initial Conditions (</span><span style="color: #0000BB; font-weight: bold;">$inits</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt;   depot central    peri     eff </span></span>
<span><span class="co">#&gt;       0       0       0       1 </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── First part of data (object): ──</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 100 × 17</span></span></span>
<span><span class="co">#&gt;    time    KA    CL    V2     Q    V3  Kout  EC50    C2   Kin    C3  depot</span></span>
<span><span class="co">#&gt;     <span style="color: #949494;">[h]</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 0     0.294  18.6  40.2  10.5   297     1   200   0    1.1  0     <span style="text-decoration: underline;">10</span>000 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 0.485 0.294  18.6  40.2  10.5   297     1   200  27.8  1.10 0.257  <span style="text-decoration: underline;">8</span>671.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 0.970 0.294  18.6  40.2  10.5   297     1   200  43.7  1.10 0.874  <span style="text-decoration: underline;">7</span>519.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 1.45  0.294  18.6  40.2  10.5   297     1   200  51.8  1.09 1.68   <span style="text-decoration: underline;">6</span>520.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 1.94  0.294  18.6  40.2  10.5   297     1   200  54.8  1.09 2.56   <span style="text-decoration: underline;">5</span>654.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 2.42  0.294  18.6  40.2  10.5   297     1   200  54.6  1.08 3.45   <span style="text-decoration: underline;">4</span>903.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 94 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 5 more variables: central &lt;dbl&gt;, peri &lt;dbl&gt;, eff &lt;dbl&gt;, ctime [h], WT &lt;dbl&gt;</span></span></span></code></pre></div>
<p>which gives the following plots:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r1</span>,<span class="va">C2</span>, ylab<span class="op">=</span><span class="st">"Central Concentration"</span>, xlab<span class="op">=</span><span class="st">"Time"</span><span class="op">)</span></span></code></pre></div>
<p><img src="rxode2-covariates_files/figure-html/time-varying-constant-central-1.png" width="100%"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r1</span>,<span class="va">eff</span>, ylab<span class="op">=</span><span class="st">"Effect"</span>, xlab<span class="op">=</span><span class="st">"Time"</span><span class="op">)</span></span></code></pre></div>
<p><img src="rxode2-covariates_files/figure-html/time-varying-constant-effect-1.png" width="100%"></p>
<p>In this case, the plots seem to be smoother.</p>
<p>You can also use NONMEM’s preferred interpolation style of next
observation carried backward (NOCB):</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/symengine/man/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">mod4</span>, <span class="va">ev</span>,covsInterpolation<span class="op">=</span><span class="st">"nocb"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">r1</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Solved rxode2 object ──</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Parameters (</span><span style="color: #0000BB; font-weight: bold;">$params</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt;        TKA        TCL        TV2         TQ        TV3      TKout      TEC50 </span></span>
<span><span class="co">#&gt;   0.294000  18.600000  40.200000  10.500000 297.000000   1.000000 200.000000 </span></span>
<span><span class="co">#&gt;       TKin         Tz        amp         pi </span></span>
<span><span class="co">#&gt;   1.000000   8.000000   0.100000   3.141593 </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Initial Conditions (</span><span style="color: #0000BB; font-weight: bold;">$inits</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt;   depot central    peri     eff </span></span>
<span><span class="co">#&gt;       0       0       0       1 </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── First part of data (object): ──</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 100 × 17</span></span></span>
<span><span class="co">#&gt;    time    KA    CL    V2     Q    V3  Kout  EC50    C2   Kin    C3  depot</span></span>
<span><span class="co">#&gt;     <span style="color: #949494;">[h]</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 0     0.294  18.6  40.2  10.5   297     1   200   0    1.1  0     <span style="text-decoration: underline;">10</span>000 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 0.485 0.294  18.6  40.2  10.5   297     1   200  27.8  1.10 0.257  <span style="text-decoration: underline;">8</span>671.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 0.970 0.294  18.6  40.2  10.5   297     1   200  43.7  1.10 0.874  <span style="text-decoration: underline;">7</span>519.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 1.45  0.294  18.6  40.2  10.5   297     1   200  51.8  1.09 1.68   <span style="text-decoration: underline;">6</span>520.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 1.94  0.294  18.6  40.2  10.5   297     1   200  54.8  1.09 2.56   <span style="text-decoration: underline;">5</span>654.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 2.42  0.294  18.6  40.2  10.5   297     1   200  54.6  1.08 3.45   <span style="text-decoration: underline;">4</span>903.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 94 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 5 more variables: central &lt;dbl&gt;, peri &lt;dbl&gt;, eff &lt;dbl&gt;, ctime [h], WT &lt;dbl&gt;</span></span></span></code></pre></div>
<p>which gives the following plots:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r1</span>,<span class="va">C2</span>, ylab<span class="op">=</span><span class="st">"Central Concentration"</span>, xlab<span class="op">=</span><span class="st">"Time"</span><span class="op">)</span></span></code></pre></div>
<p><img src="rxode2-covariates_files/figure-html/time-varying-nocb-central-1.png" width="100%"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r1</span>,<span class="va">eff</span>, ylab<span class="op">=</span><span class="st">"Effect"</span>, xlab<span class="op">=</span><span class="st">"Time"</span><span class="op">)</span></span></code></pre></div>
<p><img src="rxode2-covariates_files/figure-html/time-varying-nocb-effect-1.png" width="100%"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthew L. Fidler, Wenping Wang, Melissa Hallow.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
