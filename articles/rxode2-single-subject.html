<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Single Subject ODE solving -- differences from multiple subject • rxode2</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Single Subject ODE solving -- differences from multiple subject">
<meta name="google-site-verification" content="fp9A3qPrCar1DKeVQg4Mfrf6-An5keP9OwhIxUkntbU">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rxode2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-book"></span> Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Getting started</h6></li>
    <li><a class="dropdown-item" href="../articles/rxode2-syntax.html">rxode2 mini language syntax</a></li>
    <li><a class="dropdown-item" href="../articles/Modifying-Models.html">rxode2 model modification %&gt;%</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-pipeline.html">rxode2 pipeline ie %&gt;%</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-speed.html">Speeding up rxode2 ODE solving</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-data-frame.html">Adaptive Data Frames with rxode2</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-plot.html">Plotting with rxode2</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced Features, Model Types, Technical Details</h6></li>
    <li><a class="dropdown-item" href="../articles/rxode2-model-types.html">rxode2 model types</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-cmt.html">Chainging rxode2 compartment numbers</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-transit-compartments.html">rxode2 transit compartment models</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-shiny.html">Using Shiny with rxode2</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-covariates.html">rxode2 covariates</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-stiff.html">Stiff Systems and Jacobian specification</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-rxUse.html">Adding compiled rxode2 models to your package</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-dosing-events" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-stethoscope"></span> Dosing/Events</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-dosing-events">
<li><a class="dropdown-item" href="../articles/rxode2-datasets.html">nlmixr/rxode2 dataset overview</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-event-types.html">Supported Event Types</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-event-table.html">Easy rxode2 Event Tables</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-events-classic.html">Classic rxode2 events explained</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-simulations" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-desktop"></span> Simulations</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-simulations">
<li><a class="dropdown-item" href="../articles/rxode2-single-subject.html">Single Subject ODE solving</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-sim-var.html">Multiple Subject rxode2 Simulation</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-prior-data.html">Using Prior Data for ODE solving</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-help" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-life-ring"></span> Help</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-help">
<li><a class="dropdown-item" href="../articles/rxode2-tutorials.html">Running the interactive tutorials</a></li>
    <li><a class="external-link dropdown-item" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4728294/pdf/PSP4-5-03.pdf">2015 CPT tutorial</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/rxode2-covariates.html">Adding Circadian Rythmn (time-varying covariates)</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-wt.html">Weight Based Dosing</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-nesting.html">Simulating Multiple levels of nesting (iov, between study etc)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changes/News</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="https://nlmixr2.github.io/rxode2/reference/index.html"><span class="fa fa-file-code-o"></span> Functions</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-archive"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-">
<li><a class="dropdown-item" href="https://nlmixr2.github.io/rxode2-manual/">rxode2 User Guide</a></li>
    <li><a class="external-link dropdown-item" href="https://nlmixr2.org/">nlmixr2</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nlmixr2/rxode2"><span class="fa fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nlmixr2/rxode2/releases"><span class="fa fa-download"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Single Subject ODE solving -- differences from multiple subject</h1>
            
            <h4 data-toc-skip class="date">2025-07-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nlmixr2/rxode2/blob/main/vignettes/rxode2-single-subject.Rmd" class="external-link"><code>vignettes/rxode2-single-subject.Rmd</code></a></small>
      <div class="d-none name"><code>rxode2-single-subject.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="single-subject-solving">Single Subject solving<a class="anchor" aria-label="anchor" href="#single-subject-solving"></a>
</h2>
<p>Originally, rxode2 was only created to solve ODEs for one individual.
That is a single system without any changes in individual
parameters.</p>
<p>Of course this is still supported, the classic examples are found in
<a href="https://nlmixr2.github.io/rxode2/articles/rxode2-intro.html">rxode2
intro</a>.</p>
<p>This article discusses the differences between multiple subject and
single subject solving. There are three differences:</p>
<ul>
<li>Single solving does not solve each ID in parallel</li>
<li>Single solving lacks the <code>id</code> column in
parameters(<code>$params</code>) as well as in the actual dataset.</li>
<li>Single solving allows parameter exploration easier because each
parameter can be modified. With multiple subject solves, you have to
make sure to update each individual parameter.</li>
</ul>
<p>The first obvious difference is in speed; With multiple subjects you
can run each subject ID in parallel. For more information and examples
of the speed gains with multiple subject solving see the <a href="rxode2-speed.html">Speeding up rxode2</a> vignette.</p>
<p>The next difference is the amount of information output in the final
data.</p>
<p>Taking the 2 compartment indirect response model originally in the
tutorial:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlmixr2.github.io/rxode2/">rxode2</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; rxode2 4.0.0 using 2 threads (see ?getRxThreads)</span></span>
<span><span class="co">#&gt;   no cache: create with `rxCreateCache()`</span></span>
<span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/ini.html">ini</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">KA</span><span class="op">=</span><span class="fl">2.94E-01</span></span>
<span>    <span class="va">CL</span><span class="op">=</span><span class="fl">1.86E+01</span></span>
<span>    <span class="va">V2</span><span class="op">=</span><span class="fl">4.02E+01</span></span>
<span>    <span class="va">Q</span><span class="op">=</span><span class="fl">1.05E+01</span></span>
<span>    <span class="va">V3</span><span class="op">=</span><span class="fl">2.97E+02</span></span>
<span>    <span class="va">Kin</span><span class="op">=</span><span class="fl">1</span></span>
<span>    <span class="va">Kout</span><span class="op">=</span><span class="fl">1</span></span>
<span>    <span class="va">EC50</span><span class="op">=</span><span class="fl">200</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/model.html">model</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">C2</span> <span class="op">=</span> <span class="va">centr</span><span class="op">/</span><span class="va">V2</span></span>
<span>    <span class="va">C3</span> <span class="op">=</span> <span class="va">peri</span><span class="op">/</span><span class="va">V3</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">depot</span><span class="op">)</span> <span class="op">=</span><span class="op">-</span><span class="va">KA</span><span class="op">*</span><span class="va">depot</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">centr</span><span class="op">)</span> <span class="op">=</span> <span class="va">KA</span><span class="op">*</span><span class="va">depot</span> <span class="op">-</span> <span class="va">CL</span><span class="op">*</span><span class="va">C2</span> <span class="op">-</span> <span class="va">Q</span><span class="op">*</span><span class="va">C2</span> <span class="op">+</span> <span class="va">Q</span><span class="op">*</span><span class="va">C3</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">peri</span><span class="op">)</span>  <span class="op">=</span>                    <span class="va">Q</span><span class="op">*</span><span class="va">C2</span> <span class="op">-</span> <span class="va">Q</span><span class="op">*</span><span class="va">C3</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">eff</span><span class="op">)</span>  <span class="op">=</span> <span class="va">Kin</span> <span class="op">-</span> <span class="va">Kout</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">C2</span><span class="op">/</span><span class="op">(</span><span class="va">EC50</span><span class="op">+</span><span class="va">C2</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="va">eff</span></span>
<span>    <span class="fu">eff</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span> <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span>  </span>
<span><span class="va">et</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>amount.units<span class="op">=</span><span class="st">'mg'</span>, time.units<span class="op">=</span><span class="st">'hours'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>dose<span class="op">=</span><span class="fl">10000</span>, addl<span class="op">=</span><span class="fl">9</span>, ii<span class="op">=</span><span class="fl">12</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>amt<span class="op">=</span><span class="fl">20000</span>, nbr.doses<span class="op">=</span><span class="fl">5</span>, start.time<span class="op">=</span><span class="fl">120</span>, dosing.interval<span class="op">=</span><span class="fl">24</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">240</span><span class="op">)</span> <span class="co"># sampling</span></span></code></pre></div>
<p>Now a simple solve</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rxSolve.html">rxSolve</a></span><span class="op">(</span><span class="va">mod1</span>, <span class="va">et</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> parameter labels from comments are typically ignored in non-interactive mode</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Need to run with the source intact to parse comments</span></span>
<span><span class="va">x</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Solved rxode2 object ──</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Parameters (</span><span style="color: #BBBB00; font-weight: bold;">x</span><span style="color: #0000BB; font-weight: bold;">$params</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt;      KA      CL      V2       Q      V3     Kin    Kout    EC50 </span></span>
<span><span class="co">#&gt;   0.294  18.600  40.200  10.500 297.000   1.000   1.000 200.000 </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Initial Conditions (</span><span style="color: #BBBB00; font-weight: bold;">x</span><span style="color: #0000BB; font-weight: bold;">$inits</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt; depot centr  peri   eff </span></span>
<span><span class="co">#&gt;     0     0     0     1 </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── First part of data (object): ──</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 241 × 7</span></span></span>
<span><span class="co">#&gt;   time    C2    C3  depot centr  peri   eff</span></span>
<span><span class="co">#&gt;    <span style="color: #949494;">[h]</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>    0   0   0     <span style="text-decoration: underline;">10</span>000     0     0   1   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>    1  44.4 0.920  <span style="text-decoration: underline;">7</span>453. <span style="text-decoration: underline;">1</span>784.  273.  1.08</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>    2  54.9 2.67   <span style="text-decoration: underline;">5</span>554. <span style="text-decoration: underline;">2</span>206.  794.  1.18</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>    3  51.9 4.46   <span style="text-decoration: underline;">4</span>140. <span style="text-decoration: underline;">2</span>087. <span style="text-decoration: underline;">1</span>324.  1.23</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>    4  44.5 5.98   <span style="text-decoration: underline;">3</span>085. <span style="text-decoration: underline;">1</span>789. <span style="text-decoration: underline;">1</span>776.  1.23</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>    5  36.5 7.18   <span style="text-decoration: underline;">2</span>299. <span style="text-decoration: underline;">1</span>467. <span style="text-decoration: underline;">2</span>132.  1.21</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 235 more rows</span></span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Solved rxode2 object ──</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Parameters (</span><span style="color: #0000BB; font-weight: bold;">$params</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt;      KA      CL      V2       Q      V3     Kin    Kout    EC50 </span></span>
<span><span class="co">#&gt;   0.294  18.600  40.200  10.500 297.000   1.000   1.000 200.000 </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Initial Conditions (</span><span style="color: #0000BB; font-weight: bold;">$inits</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt; depot centr  peri   eff </span></span>
<span><span class="co">#&gt;     0     0     0     1 </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── First part of data (object): ──</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 241 × 7</span></span></span>
<span><span class="co">#&gt;   time    C2    C3  depot centr  peri   eff</span></span>
<span><span class="co">#&gt;    <span style="color: #949494;">[h]</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>    0   0   0     <span style="text-decoration: underline;">10</span>000     0     0   1   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>    1  44.4 0.920  <span style="text-decoration: underline;">7</span>453. <span style="text-decoration: underline;">1</span>784.  273.  1.08</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>    2  54.9 2.67   <span style="text-decoration: underline;">5</span>554. <span style="text-decoration: underline;">2</span>206.  794.  1.18</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>    3  51.9 4.46   <span style="text-decoration: underline;">4</span>140. <span style="text-decoration: underline;">2</span>087. <span style="text-decoration: underline;">1</span>324.  1.23</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>    4  44.5 5.98   <span style="text-decoration: underline;">3</span>085. <span style="text-decoration: underline;">1</span>789. <span style="text-decoration: underline;">1</span>776.  1.23</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>    5  36.5 7.18   <span style="text-decoration: underline;">2</span>299. <span style="text-decoration: underline;">1</span>467. <span style="text-decoration: underline;">2</span>132.  1.21</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 235 more rows</span></span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">C2</span>, <span class="va">eff</span><span class="op">)</span></span></code></pre></div>
<p><img src="rxode2-single-subject_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>To better see the differences between the single solve, you can solve
for 2 individuals</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rxSolve.html">rxSolve</a></span><span class="op">(</span><span class="va">mod1</span>, <span class="va">et</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>id<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, params<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>CL<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">18.6</span>, <span class="fl">7.6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> parameter labels from comments are typically ignored in non-interactive mode</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Need to run with the source intact to parse comments</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Solved rxode2 object ──</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Parameters (</span><span style="color: #0000BB; font-weight: bold;">$params</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 9</span></span></span>
<span><span class="co">#&gt;   id       KA    CL    V2     Q    V3   Kin  Kout  EC50</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1     0.294  18.6  40.2  10.5   297     1     1   200</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 2     0.294   7.6  40.2  10.5   297     1     1   200</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Initial Conditions (</span><span style="color: #0000BB; font-weight: bold;">$inits</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt; depot centr  peri   eff </span></span>
<span><span class="co">#&gt;     0     0     0     1 </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── First part of data (object): ──</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 482 × 8</span></span></span>
<span><span class="co">#&gt;      id time    C2    C3  depot centr  peri   eff</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494;">[h]</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1    0   0   0     <span style="text-decoration: underline;">10</span>000     0     0   1   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1    1  44.4 0.920  <span style="text-decoration: underline;">7</span>453. <span style="text-decoration: underline;">1</span>784.  273.  1.08</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     1    2  54.9 2.67   <span style="text-decoration: underline;">5</span>554. <span style="text-decoration: underline;">2</span>206.  794.  1.18</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     1    3  51.9 4.46   <span style="text-decoration: underline;">4</span>140. <span style="text-decoration: underline;">2</span>087. <span style="text-decoration: underline;">1</span>324.  1.23</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>     1    4  44.5 5.98   <span style="text-decoration: underline;">3</span>085. <span style="text-decoration: underline;">1</span>789. <span style="text-decoration: underline;">1</span>776.  1.23</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>     1    5  36.5 7.18   <span style="text-decoration: underline;">2</span>299. <span style="text-decoration: underline;">1</span>467. <span style="text-decoration: underline;">2</span>132.  1.21</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 476 more rows</span></span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x2</span>, <span class="va">C2</span>, <span class="va">eff</span><span class="op">)</span></span></code></pre></div>
<p><img src="rxode2-single-subject_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>By observing the two solves, you can see:</p>
<ul>
<li>A multiple subject solve contains the <code>id</code> column both in
the data frame and then data frame of parameters for each subject.</li>
</ul>
<p>The last feature that is not as obvious, modifying the individual
parameters. For single subject data, you can modify the rxode2 data
frame changing initial conditions and parameter values as if they were
part of the data frame, as described in the <a href="https://nlmixr2.github.io/rxode2/articles/rxode2-data-frame.html">rxode2
Data Frames</a>.</p>
<p>For multiple subject solving, this feature still works, but requires
care when supplying each individual’s parameter value, otherwise you may
change the solve and drop parameter for key individuals.</p>
<div class="section level3">
<h3 id="summary-of-single-solve-vs-multiple-subject-solving">Summary of Single solve vs Multiple subject solving<a class="anchor" aria-label="anchor" href="#summary-of-single-solve-vs-multiple-subject-solving"></a>
</h3>
<table class="table">
<colgroup>
<col width="10%">
<col width="40%">
<col width="49%">
</colgroup>
<thead><tr class="header">
<th>Feature</th>
<th>Single Subject Solve</th>
<th>Multiple Subject Solve</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Parallel</td>
<td>None</td>
<td>Each Subject</td>
</tr>
<tr class="even">
<td>$params</td>
<td>data.frame with one parameter value</td>
<td>data.frame with one parameter per subject (w/ID column)</td>
</tr>
<tr class="odd">
<td>solved data</td>
<td>Can modify individual parameters with $ syntax</td>
<td>Have to modify all the parameters to update solved object</td>
</tr>
</tbody>
</table>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthew L. Fidler, Wenping Wang, Melissa Hallow.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
