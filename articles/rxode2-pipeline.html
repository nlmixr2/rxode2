<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>rxode2 in a pipeline • rxode2</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="rxode2 in a pipeline">
<meta name="google-site-verification" content="fp9A3qPrCar1DKeVQg4Mfrf6-An5keP9OwhIxUkntbU">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rxode2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-book"></span> Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Getting started</h6></li>
    <li><a class="dropdown-item" href="../articles/rxode2-syntax.html">rxode2 mini language syntax</a></li>
    <li><a class="dropdown-item" href="../articles/Modifying-Models.html">rxode2 model modification %&gt;%</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-pipeline.html">rxode2 pipeline ie %&gt;%</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-speed.html">Speeding up rxode2 ODE solving</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-data-frame.html">Adaptive Data Frames with rxode2</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-plot.html">Plotting with rxode2</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced Features, Model Types, Technical Details</h6></li>
    <li><a class="dropdown-item" href="../articles/rxode2-model-types.html">rxode2 model types</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-cmt.html">Chainging rxode2 compartment numbers</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-transit-compartments.html">rxode2 transit compartment models</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-shiny.html">Using Shiny with rxode2</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-covariates.html">rxode2 covariates</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-stiff.html">Stiff Systems and Jacobian specification</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-rxUse.html">Adding compiled rxode2 models to your package</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-dosing-events" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-stethoscope"></span> Dosing/Events</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-dosing-events">
<li><a class="dropdown-item" href="../articles/rxode2-datasets.html">nlmixr/rxode2 dataset overview</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-event-types.html">Supported Event Types</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-event-table.html">Easy rxode2 Event Tables</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-events-classic.html">Classic rxode2 events explained</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-simulations" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-desktop"></span> Simulations</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-simulations">
<li><a class="dropdown-item" href="../articles/rxode2-single-subject.html">Single Subject ODE solving</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-sim-var.html">Multiple Subject rxode2 Simulation</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-prior-data.html">Using Prior Data for ODE solving</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-help" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-life-ring"></span> Help</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-help">
<li><a class="dropdown-item" href="../articles/rxode2-tutorials.html">Running the interactive tutorials</a></li>
    <li><a class="external-link dropdown-item" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4728294/pdf/PSP4-5-03.pdf">2015 CPT tutorial</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/rxode2-covariates.html">Adding Circadian Rythmn (time-varying covariates)</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-wt.html">Weight Based Dosing</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-nesting.html">Simulating Multiple levels of nesting (iov, between study etc)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changes/News</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="https://nlmixr2.github.io/rxode2/reference/index.html"><span class="fa fa-file-code-o"></span> Functions</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-archive"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-">
<li><a class="dropdown-item" href="https://nlmixr2.github.io/rxode2-manual/">rxode2 User Guide</a></li>
    <li><a class="external-link dropdown-item" href="https://nlmixr2.org/">nlmixr2</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nlmixr2/rxode2"><span class="fa fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nlmixr2/rxode2/releases"><span class="fa fa-download"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>rxode2 in a pipeline</h1>
            
            <h4 data-toc-skip class="date">2025-07-23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nlmixr2/rxode2/blob/main/vignettes/rxode2-pipeline.Rmd" class="external-link"><code>vignettes/rxode2-pipeline.Rmd</code></a></small>
      <div class="d-none name"><code>rxode2-pipeline.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="setting-up-the-rxode2-model-for-the-pipeline">Setting up the rxode2 model for the pipeline<a class="anchor" aria-label="anchor" href="#setting-up-the-rxode2-model-for-the-pipeline"></a>
</h2>
<p>In this example we will show how to use rxode2 in a simple
pipeline.</p>
<p>We can start with a model that can be used for the different
simulation workflows that rxode2 can handle:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlmixr2.github.io/rxode2/">rxode2</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; rxode2 4.0.2 using 2 threads (see ?getRxThreads)</span></span>
<span><span class="co">#&gt;   no cache: create with `rxCreateCache()`</span></span>
<span></span>
<span><span class="va">Ribba2012</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/ini.html">ini</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">k</span> <span class="op">=</span> <span class="fl">100</span></span>
<span>    <span class="va">tkde</span> <span class="op">=</span> <span class="fl">0.24</span></span>
<span>    <span class="va">eta.tkde</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="va">tkpq</span> <span class="op">=</span> <span class="fl">0.0295</span></span>
<span>    <span class="va">eta.kpq</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="va">tkqpp</span> <span class="op">=</span> <span class="fl">0.0031</span></span>
<span>    <span class="va">eta.kqpp</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="va">tlambdap</span> <span class="op">=</span> <span class="fl">0.121</span></span>
<span>    <span class="va">eta.lambdap</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="va">tgamma</span> <span class="op">=</span> <span class="fl">0.729</span></span>
<span>    <span class="va">eta.gamma</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="va">tdeltaqp</span> <span class="op">=</span> <span class="fl">0.00867</span></span>
<span>    <span class="va">eta.deltaqp</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="va">prop.sd</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>    <span class="va">tpt0</span> <span class="op">=</span> <span class="fl">7.13</span></span>
<span>    <span class="va">eta.pt0</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>    <span class="va">tq0</span> <span class="op">=</span> <span class="fl">41.2</span></span>
<span>    <span class="va">eta.q0</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/model.html">model</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">kde</span> <span class="op">~</span> <span class="va">tkde</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">eta.tkde</span><span class="op">)</span></span>
<span>    <span class="va">kpq</span> <span class="op">~</span> <span class="va">tkpq</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">eta.kpq</span><span class="op">)</span></span>
<span>    <span class="va">kqpp</span> <span class="op">~</span> <span class="va">tkqpp</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">eta.kqpp</span><span class="op">)</span></span>
<span>    <span class="va">lambdap</span> <span class="op">~</span> <span class="va">tlambdap</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">eta.lambdap</span><span class="op">)</span></span>
<span>    <span class="va">gamma</span> <span class="op">~</span> <span class="va">tgamma</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">eta.gamma</span><span class="op">)</span></span>
<span>    <span class="va">deltaqp</span> <span class="op">~</span> <span class="va">tdeltaqp</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">eta.deltaqp</span><span class="op">)</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">c</span><span class="op">)</span> <span class="op">=</span> <span class="op">-</span><span class="va">kde</span> <span class="op">*</span> <span class="va">c</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">pt</span><span class="op">)</span> <span class="op">=</span> <span class="va">lambdap</span> <span class="op">*</span> <span class="va">pt</span> <span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">pstar</span><span class="op">/</span><span class="va">k</span><span class="op">)</span> <span class="op">+</span> <span class="va">kqpp</span><span class="op">*</span><span class="va">qp</span> <span class="op">-</span></span>
<span>      <span class="va">kpq</span><span class="op">*</span><span class="va">pt</span> <span class="op">-</span> <span class="va">gamma</span><span class="op">*</span><span class="va">c</span><span class="op">*</span><span class="va">kde</span><span class="op">*</span><span class="va">pt</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">q</span><span class="op">)</span> <span class="op">=</span> <span class="va">kpq</span><span class="op">*</span><span class="va">pt</span> <span class="op">-</span><span class="va">gamma</span><span class="op">*</span><span class="va">c</span><span class="op">*</span><span class="va">kde</span><span class="op">*</span><span class="va">q</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">qp</span><span class="op">)</span> <span class="op">=</span> <span class="va">gamma</span><span class="op">*</span><span class="va">c</span><span class="op">*</span><span class="va">kde</span><span class="op">*</span><span class="va">q</span> <span class="op">-</span> <span class="va">kqpp</span><span class="op">*</span><span class="va">qp</span> <span class="op">-</span> <span class="va">deltaqp</span><span class="op">*</span><span class="va">qp</span></span>
<span>    <span class="co">## initial conditions</span></span>
<span>    <span class="va">pt0</span> <span class="op">~</span> <span class="va">tpt0</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">eta.pt0</span><span class="op">)</span></span>
<span>    <span class="va">q0</span> <span class="op">~</span> <span class="va">tq0</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">eta.q0</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">pt</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span> <span class="op">=</span> <span class="va">pt0</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/quit.html" class="external-link">q</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span> <span class="op">=</span> <span class="va">q0</span></span>
<span>    <span class="va">pstar</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">pt</span><span class="op">+</span><span class="va">q</span><span class="op">+</span><span class="va">qp</span><span class="op">)</span></span>
<span>    <span class="va">pstar</span> <span class="op">~</span>  <span class="fu">prop</span><span class="op">(</span><span class="va">prop.sd</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>This is a tumor growth model described in Ribba 2012. In this case,
we compiled the model into an R object <code>Ribba2012</code>, though in
an rxode2 simulation pipeline, you do not <em>have</em> to assign the
compiled model to any object, though I think it makes sense.</p>
</div>
<div class="section level2">
<h2 id="simulating-one-event-table">Simulating one event table<a class="anchor" aria-label="anchor" href="#simulating-one-event-table"></a>
</h2>
<p>Simulating a single event table is quite simple:</p>
<ul>
<li>You pipe the rxode2 simulation object into an event table object by
<code><a href="../reference/et.html">et()</a></code>.<br>
</li>
<li>When the events are completely specified, you simply solve the ODE
system with <code><a href="../reference/rxSolve.html">rxSolve()</a></code>.</li>
<li>In this case you can pipe the output to <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> to
conveniently view the results.</li>
<li>Note for the plot we are only selecting the selecting following:
<ul>
<li>
<code>pt</code> (Proliferative Tissue),</li>
<li>
<code>q</code> (quiescent tissue)</li>
<li>
<code>qp</code> (DNA-Damaged quiescent tissue) and</li>
<li>
<code>pstar</code> (total tumor tissue)</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Ribba2012</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Use rxode2</span></span>
<span>    <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>time.units<span class="op">=</span><span class="st">"months"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Pipe to a new event table</span></span>
<span>    <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>amt<span class="op">=</span><span class="fl">1</span>, time<span class="op">=</span><span class="fl">50</span>, until<span class="op">=</span><span class="fl">58</span>, ii<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Add dosing every 1.5 months</span></span>
<span>    <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">250</span>, by<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Add some sampling times (not required)</span></span>
<span>    <span class="fu"><a href="../reference/rxSolve.html">rxSolve</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Solve the simulation</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pt</span>, <span class="va">q</span>, <span class="va">qp</span>, <span class="va">pstar</span><span class="op">)</span> <span class="co"># Plot it, plotting the variables of interest</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> parameter labels from comments are typically ignored in non-interactive mode</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Need to run with the source intact to parse comments</span></span>
<span><span class="co">#&gt; C model:</span></span>
<span><span class="co">#&gt; // Define translation state order for 5 states</span></span>
<span><span class="co">#&gt; #define __DDT0__ 0 // c</span></span>
<span><span class="co">#&gt; #define __DDT1__ 1 // pt</span></span>
<span><span class="co">#&gt; #define __DDT2__ 2 // q</span></span>
<span><span class="co">#&gt; #define __DDT3__ 3 // qp</span></span>
<span><span class="co">#&gt; #define __DDT4__ 4 // NA</span></span>
<span><span class="co">#&gt; // Define 3 LHS values</span></span>
<span><span class="co">#&gt; #define _LHS_0_ 0 // pstar</span></span>
<span><span class="co">#&gt; #define _LHS_1_ 1 // ipredSim</span></span>
<span><span class="co">#&gt; #define _LHS_2_ 2 // sim</span></span>
<span><span class="co">#&gt; #define _getRxSolve_ _rxa1f40e9099a491a7b42f45f941d64dbc0__getRxSolve__5pb9</span></span>
<span><span class="co">#&gt; #define _evalUdf _rxa1f40e9099a491a7b42f45f941d64dbc1__evalUdf_0SUH</span></span>
<span><span class="co">#&gt; #define _solveData _rxa1f40e9099a491a7b42f45f941d64dbc2__solveData_jlsA</span></span>
<span><span class="co">#&gt; #define _assign_ptr _rxa1f40e9099a491a7b42f45f941d64dbc3__assign_ptr_2JOC</span></span>
<span><span class="co">#&gt; #define _rxRmModelLib _rxa1f40e9099a491a7b42f45f941d64dbc4__rxRmModelLib_P3Oy</span></span>
<span><span class="co">#&gt; #define _rxGetModelLib _rxa1f40e9099a491a7b42f45f941d64dbc5__rxGetModelLib_HgjC</span></span>
<span><span class="co">#&gt; #define _old_c _rxa1f40e9099a491a7b42f45f941d64dbc6__old_c_yj3W</span></span>
<span><span class="co">#&gt; #define _ptrid _rxa1f40e9099a491a7b42f45f941d64dbc7__ptrid_hg1D</span></span>
<span><span class="co">#&gt; #define _rxIsCurrentC _rxa1f40e9099a491a7b42f45f941d64dbc8__rxIsCurrentC_IdTQ</span></span>
<span><span class="co">#&gt; #define _sumPS _rxa1f40e9099a491a7b42f45f941d64dbc9__sumPS_hwBD</span></span>
<span><span class="co">#&gt; #define _prodPS _rxa1f40e9099a491a7b42f45f941d64dbc10__prodPS_gUde</span></span>
<span><span class="co">#&gt; #define _prodType _rxa1f40e9099a491a7b42f45f941d64dbc11__prodType_5llz</span></span>
<span><span class="co">#&gt; #define _sumType _rxa1f40e9099a491a7b42f45f941d64dbc12__sumType_yOSJ</span></span>
<span><span class="co">#&gt; #define _update_par_ptr _rxa1f40e9099a491a7b42f45f941d64dbc13__update_par_ptr_AWUm</span></span>
<span><span class="co">#&gt; #define _getParCov _rxa1f40e9099a491a7b42f45f941d64dbc14__getParCov_Ci4L</span></span>
<span><span class="co">#&gt; #define _rxode2_rxAssignPtr _rxa1f40e9099a491a7b42f45f941d64dbc15__rxode2_rxAssignPtr_pGZK</span></span>
<span><span class="co">#&gt; #define _rxQr _rxa1f40e9099a491a7b42f45f941d64dbc16__rxQr_aBwX</span></span>
<span><span class="co">#&gt; #define _compareFactorVal _rxa1f40e9099a491a7b42f45f941d64dbc17__compareFactorVal_XHRN</span></span>
<span><span class="co">#&gt; #define _sum _rxa1f40e9099a491a7b42f45f941d64dbc18__sum_1SO1</span></span>
<span><span class="co">#&gt; #define _udf _rxa1f40e9099a491a7b42f45f941d64dbc19__udf_NYrN</span></span>
<span><span class="co">#&gt; #define _sign _rxa1f40e9099a491a7b42f45f941d64dbc20__sign_WbGH</span></span>
<span><span class="co">#&gt; #define _prod _rxa1f40e9099a491a7b42f45f941d64dbc21__prod_TvOD</span></span>
<span><span class="co">#&gt; #define _max _rxa1f40e9099a491a7b42f45f941d64dbc22__max_f3z9</span></span>
<span><span class="co">#&gt; #define _min _rxa1f40e9099a491a7b42f45f941d64dbc23__min_WqiE</span></span>
<span><span class="co">#&gt; #define _transit4P _rxa1f40e9099a491a7b42f45f941d64dbc24__transit4P_Xp1T</span></span>
<span><span class="co">#&gt; #define _transit3P _rxa1f40e9099a491a7b42f45f941d64dbc25__transit3P_noPD</span></span>
<span><span class="co">#&gt; #define _assignFuns0 _rxa1f40e9099a491a7b42f45f941d64dbc26__assignFuns0_PfVe</span></span>
<span><span class="co">#&gt; #define _assignFuns _rxa1f40e9099a491a7b42f45f941d64dbc27__assignFuns_Vphs</span></span>
<span><span class="co">#&gt; #define _rxord _rxa1f40e9099a491a7b42f45f941d64dbc28__rxord_0tzV</span></span>
<span><span class="co">#&gt; #define __assignFuns2 _rxa1f40e9099a491a7b42f45f941d64dbc29___assignFuns2_Mmad</span></span>
<span><span class="co">#&gt; #define _llikCauchyDscale _rxa1f40e9099a491a7b42f45f941d64dbc30__llikCauchyDscale_rZFu</span></span>
<span><span class="co">#&gt; #define _llikCauchyDlocation _rxa1f40e9099a491a7b42f45f941d64dbc31__llikCauchyDlocation_rFOl</span></span>
<span><span class="co">#&gt; #define _llikCauchy _rxa1f40e9099a491a7b42f45f941d64dbc32__llikCauchy_7CAf</span></span>
<span><span class="co">#&gt; #define _llikGammaDrate _rxa1f40e9099a491a7b42f45f941d64dbc33__llikGammaDrate_rvYZ</span></span>
<span><span class="co">#&gt; #define _llikGammaDshape _rxa1f40e9099a491a7b42f45f941d64dbc34__llikGammaDshape_gF2u</span></span>
<span><span class="co">#&gt; #define _llikGamma _rxa1f40e9099a491a7b42f45f941d64dbc35__llikGamma_4zbA</span></span>
<span><span class="co">#&gt; #define _llikWeibullDscale _rxa1f40e9099a491a7b42f45f941d64dbc36__llikWeibullDscale_u2aE</span></span>
<span><span class="co">#&gt; #define _llikWeibullDshape _rxa1f40e9099a491a7b42f45f941d64dbc37__llikWeibullDshape_uohD</span></span>
<span><span class="co">#&gt; #define _llikWeibull _rxa1f40e9099a491a7b42f45f941d64dbc38__llikWeibull_jDSK</span></span>
<span><span class="co">#&gt; #define _llikUnifDbeta _rxa1f40e9099a491a7b42f45f941d64dbc39__llikUnifDbeta_ZFSu</span></span>
<span><span class="co">#&gt; #define _llikUnifDalpha _rxa1f40e9099a491a7b42f45f941d64dbc40__llikUnifDalpha_yota</span></span>
<span><span class="co">#&gt; #define _llikUnif _rxa1f40e9099a491a7b42f45f941d64dbc41__llikUnif_lziD</span></span>
<span><span class="co">#&gt; #define _llikGeomDp _rxa1f40e9099a491a7b42f45f941d64dbc42__llikGeomDp_IirE</span></span>
<span><span class="co">#&gt; #define _llikGeom _rxa1f40e9099a491a7b42f45f941d64dbc43__llikGeom_0wRk</span></span>
<span><span class="co">#&gt; #define _llikFDdf2 _rxa1f40e9099a491a7b42f45f941d64dbc44__llikFDdf2_fPLj</span></span>
<span><span class="co">#&gt; #define _llikFDdf1 _rxa1f40e9099a491a7b42f45f941d64dbc45__llikFDdf1_f5r4</span></span>
<span><span class="co">#&gt; #define _llikF _rxa1f40e9099a491a7b42f45f941d64dbc46__llikF_q6UF</span></span>
<span><span class="co">#&gt; #define _llikExpDrate _rxa1f40e9099a491a7b42f45f941d64dbc47__llikExpDrate_gAxJ</span></span>
<span><span class="co">#&gt; #define _llikExp _rxa1f40e9099a491a7b42f45f941d64dbc48__llikExp_Mtp6</span></span>
<span><span class="co">#&gt; #define _llikChisqDdf _rxa1f40e9099a491a7b42f45f941d64dbc49__llikChisqDdf_ulNz</span></span>
<span><span class="co">#&gt; #define _llikChisq _rxa1f40e9099a491a7b42f45f941d64dbc50__llikChisq_LwD1</span></span>
<span><span class="co">#&gt; #define _llikTDsd _rxa1f40e9099a491a7b42f45f941d64dbc51__llikTDsd_9qDD</span></span>
<span><span class="co">#&gt; #define _llikTDmean _rxa1f40e9099a491a7b42f45f941d64dbc52__llikTDmean_2wFm</span></span>
<span><span class="co">#&gt; #define _llikTDdf _rxa1f40e9099a491a7b42f45f941d64dbc53__llikTDdf_HsIy</span></span>
<span><span class="co">#&gt; #define _llikT _rxa1f40e9099a491a7b42f45f941d64dbc54__llikT_alpl</span></span>
<span><span class="co">#&gt; #define _llikBetaDshape2 _rxa1f40e9099a491a7b42f45f941d64dbc55__llikBetaDshape2_P85e</span></span>
<span><span class="co">#&gt; #define _llikBetaDshape1 _rxa1f40e9099a491a7b42f45f941d64dbc56__llikBetaDshape1_beKy</span></span>
<span><span class="co">#&gt; #define _llikBeta _rxa1f40e9099a491a7b42f45f941d64dbc57__llikBeta_isyD</span></span>
<span><span class="co">#&gt; #define _llikNbinomMuDmu _rxa1f40e9099a491a7b42f45f941d64dbc58__llikNbinomMuDmu_fO2c</span></span>
<span><span class="co">#&gt; #define _llikNbinomMu _rxa1f40e9099a491a7b42f45f941d64dbc59__llikNbinomMu_bPrW</span></span>
<span><span class="co">#&gt; #define _llikNbinomDprob _rxa1f40e9099a491a7b42f45f941d64dbc60__llikNbinomDprob_y1fN</span></span>
<span><span class="co">#&gt; #define _llikNbinom _rxa1f40e9099a491a7b42f45f941d64dbc61__llikNbinom_ugfk</span></span>
<span><span class="co">#&gt; #define _llikBinomDprob _rxa1f40e9099a491a7b42f45f941d64dbc62__llikBinomDprob_XEVP</span></span>
<span><span class="co">#&gt; #define _llikBinom _rxa1f40e9099a491a7b42f45f941d64dbc63__llikBinom_jdOx</span></span>
<span><span class="co">#&gt; #define _llikPoisDlambda _rxa1f40e9099a491a7b42f45f941d64dbc64__llikPoisDlambda_I3ZD</span></span>
<span><span class="co">#&gt; #define _llikPois _rxa1f40e9099a491a7b42f45f941d64dbc65__llikPois_7wnk</span></span>
<span><span class="co">#&gt; #define _llikNormDsd _rxa1f40e9099a491a7b42f45f941d64dbc66__llikNormDsd_XX5O</span></span>
<span><span class="co">#&gt; #define _llikNormDmean _rxa1f40e9099a491a7b42f45f941d64dbc67__llikNormDmean_Agfw</span></span>
<span><span class="co">#&gt; #define _llikNorm _rxa1f40e9099a491a7b42f45f941d64dbc68__llikNorm_CyNe</span></span>
<span><span class="co">#&gt; #define simeps _rxa1f40e9099a491a7b42f45f941d64dbc69_simeps_o4Wl</span></span>
<span><span class="co">#&gt; #define simeta _rxa1f40e9099a491a7b42f45f941d64dbc70_simeta_QYC1</span></span>
<span><span class="co">#&gt; #define expit _rxa1f40e9099a491a7b42f45f941d64dbc71_expit_yBms</span></span>
<span><span class="co">#&gt; #define logit _rxa1f40e9099a491a7b42f45f941d64dbc72_logit_pbu2</span></span>
<span><span class="co">#&gt; #define gammapDer _rxa1f40e9099a491a7b42f45f941d64dbc73_gammapDer_85hP</span></span>
<span><span class="co">#&gt; #define lowergamma _rxa1f40e9099a491a7b42f45f941d64dbc74_lowergamma_47wD</span></span>
<span><span class="co">#&gt; #define uppergamma _rxa1f40e9099a491a7b42f45f941d64dbc75_uppergamma_fCYp</span></span>
<span><span class="co">#&gt; #define gammaqInva _rxa1f40e9099a491a7b42f45f941d64dbc76_gammaqInva_7GH0</span></span>
<span><span class="co">#&gt; #define gammaqInv _rxa1f40e9099a491a7b42f45f941d64dbc77_gammaqInv_qPki</span></span>
<span><span class="co">#&gt; #define gammapInva _rxa1f40e9099a491a7b42f45f941d64dbc78_gammapInva_VyMA</span></span>
<span><span class="co">#&gt; #define gammapInv _rxa1f40e9099a491a7b42f45f941d64dbc79_gammapInv_m1mA</span></span>
<span><span class="co">#&gt; #define gammaq _rxa1f40e9099a491a7b42f45f941d64dbc80_gammaq_1mpx</span></span>
<span><span class="co">#&gt; #define gammap _rxa1f40e9099a491a7b42f45f941d64dbc81_gammap_NAbn</span></span>
<span><span class="co">#&gt; #define phi _rxa1f40e9099a491a7b42f45f941d64dbc82_phi_2jD0</span></span>
<span><span class="co">#&gt; #define d2ELUa _rxa1f40e9099a491a7b42f45f941d64dbc83_d2ELUa_7gdK</span></span>
<span><span class="co">#&gt; #define dELUa _rxa1f40e9099a491a7b42f45f941d64dbc84_dELUa_Ohhv</span></span>
<span><span class="co">#&gt; #define d2aELU _rxa1f40e9099a491a7b42f45f941d64dbc85_d2aELU_SaAZ</span></span>
<span><span class="co">#&gt; #define d2ELU _rxa1f40e9099a491a7b42f45f941d64dbc86_d2ELU_tapa</span></span>
<span><span class="co">#&gt; #define dELU _rxa1f40e9099a491a7b42f45f941d64dbc87_dELU_mOqj</span></span>
<span><span class="co">#&gt; #define ELU _rxa1f40e9099a491a7b42f45f941d64dbc88_ELU_J66n</span></span>
<span><span class="co">#&gt; #define dPReLUa1 _rxa1f40e9099a491a7b42f45f941d64dbc89_dPReLUa1_N3zb</span></span>
<span><span class="co">#&gt; #define dPReLUa _rxa1f40e9099a491a7b42f45f941d64dbc90_dPReLUa_9X7x</span></span>
<span><span class="co">#&gt; #define dPReLU _rxa1f40e9099a491a7b42f45f941d64dbc91_dPReLU_2Awy</span></span>
<span><span class="co">#&gt; #define PReLU _rxa1f40e9099a491a7b42f45f941d64dbc92_PReLU_isy2</span></span>
<span><span class="co">#&gt; #define dSwish _rxa1f40e9099a491a7b42f45f941d64dbc93_dSwish_RdzJ</span></span>
<span><span class="co">#&gt; #define Swish _rxa1f40e9099a491a7b42f45f941d64dbc94_Swish_rXsV</span></span>
<span><span class="co">#&gt; #define dlReLU _rxa1f40e9099a491a7b42f45f941d64dbc95_dlReLU_rrL0</span></span>
<span><span class="co">#&gt; #define lReLU _rxa1f40e9099a491a7b42f45f941d64dbc96_lReLU_CwHs</span></span>
<span><span class="co">#&gt; #define dSELU _rxa1f40e9099a491a7b42f45f941d64dbc97_dSELU_x0YD</span></span>
<span><span class="co">#&gt; #define SELU _rxa1f40e9099a491a7b42f45f941d64dbc98_SELU_ejsN</span></span>
<span><span class="co">#&gt; #define d4softplus _rxa1f40e9099a491a7b42f45f941d64dbc99_d4softplus_tqj2</span></span>
<span><span class="co">#&gt; #define d3softplus _rxa1f40e9099a491a7b42f45f941d64dbc100_d3softplus_KkuC</span></span>
<span><span class="co">#&gt; #define d2softplus _rxa1f40e9099a491a7b42f45f941d64dbc101_d2softplus_TNOD</span></span>
<span><span class="co">#&gt; #define dsoftplus _rxa1f40e9099a491a7b42f45f941d64dbc102_dsoftplus_0MWq</span></span>
<span><span class="co">#&gt; #define softplus _rxa1f40e9099a491a7b42f45f941d64dbc103_softplus_8NGU</span></span>
<span><span class="co">#&gt; #define d4GELU _rxa1f40e9099a491a7b42f45f941d64dbc104_d4GELU_15zw</span></span>
<span><span class="co">#&gt; #define d3GELU _rxa1f40e9099a491a7b42f45f941d64dbc105_d3GELU_77MT</span></span>
<span><span class="co">#&gt; #define d2GELU _rxa1f40e9099a491a7b42f45f941d64dbc106_d2GELU_mU6w</span></span>
<span><span class="co">#&gt; #define dGELU _rxa1f40e9099a491a7b42f45f941d64dbc107_dGELU_hVWG</span></span>
<span><span class="co">#&gt; #define GELU _rxa1f40e9099a491a7b42f45f941d64dbc108_GELU_iyen</span></span>
<span><span class="co">#&gt; #define dReLU _rxa1f40e9099a491a7b42f45f941d64dbc109_dReLU_4spi</span></span>
<span><span class="co">#&gt; #define ReLU _rxa1f40e9099a491a7b42f45f941d64dbc110_ReLU_MWT6</span></span>
<span><span class="co">#&gt; #define riweibull _rxa1f40e9099a491a7b42f45f941d64dbc111_riweibull_VRYe</span></span>
<span><span class="co">#&gt; #define riunif _rxa1f40e9099a491a7b42f45f941d64dbc112_riunif_9Ita</span></span>
<span><span class="co">#&gt; #define rit_ _rxa1f40e9099a491a7b42f45f941d64dbc113_rit__dGJL</span></span>
<span><span class="co">#&gt; #define ripois _rxa1f40e9099a491a7b42f45f941d64dbc114_ripois_l03G</span></span>
<span><span class="co">#&gt; #define ribeta _rxa1f40e9099a491a7b42f45f941d64dbc115_ribeta_aI5l</span></span>
<span><span class="co">#&gt; #define rigamma _rxa1f40e9099a491a7b42f45f941d64dbc116_rigamma_lO3k</span></span>
<span><span class="co">#&gt; #define rigeom _rxa1f40e9099a491a7b42f45f941d64dbc117_rigeom_WHGX</span></span>
<span><span class="co">#&gt; #define rif _rxa1f40e9099a491a7b42f45f941d64dbc118_rif_CdkG</span></span>
<span><span class="co">#&gt; #define riexp _rxa1f40e9099a491a7b42f45f941d64dbc119_riexp_sq2N</span></span>
<span><span class="co">#&gt; #define richisq _rxa1f40e9099a491a7b42f45f941d64dbc120_richisq_BvuB</span></span>
<span><span class="co">#&gt; #define ricauchy _rxa1f40e9099a491a7b42f45f941d64dbc121_ricauchy_r0sO</span></span>
<span><span class="co">#&gt; #define rinbinomMu _rxa1f40e9099a491a7b42f45f941d64dbc122_rinbinomMu_4eup</span></span>
<span><span class="co">#&gt; #define rinbinom _rxa1f40e9099a491a7b42f45f941d64dbc123_rinbinom_VbTs</span></span>
<span><span class="co">#&gt; #define ribinom _rxa1f40e9099a491a7b42f45f941d64dbc124_ribinom_fOYF</span></span>
<span><span class="co">#&gt; #define rinorm _rxa1f40e9099a491a7b42f45f941d64dbc125_rinorm_C4Jz</span></span>
<span><span class="co">#&gt; #define rxweibull _rxa1f40e9099a491a7b42f45f941d64dbc126_rxweibull_7iE8</span></span>
<span><span class="co">#&gt; #define rxunif _rxa1f40e9099a491a7b42f45f941d64dbc127_rxunif_vtCF</span></span>
<span><span class="co">#&gt; #define rxt_ _rxa1f40e9099a491a7b42f45f941d64dbc128_rxt__cRJ6</span></span>
<span><span class="co">#&gt; #define rxpois _rxa1f40e9099a491a7b42f45f941d64dbc129_rxpois_Gev1</span></span>
<span><span class="co">#&gt; #define rxbeta _rxa1f40e9099a491a7b42f45f941d64dbc130_rxbeta_Yq4C</span></span>
<span><span class="co">#&gt; #define rxgamma _rxa1f40e9099a491a7b42f45f941d64dbc131_rxgamma_UGPR</span></span>
<span><span class="co">#&gt; #define rxgeom _rxa1f40e9099a491a7b42f45f941d64dbc132_rxgeom_B41j</span></span>
<span><span class="co">#&gt; #define rxf _rxa1f40e9099a491a7b42f45f941d64dbc133_rxf_yXA3</span></span>
<span><span class="co">#&gt; #define rxexp _rxa1f40e9099a491a7b42f45f941d64dbc134_rxexp_Scak</span></span>
<span><span class="co">#&gt; #define rxchisq _rxa1f40e9099a491a7b42f45f941d64dbc135_rxchisq_WU0x</span></span>
<span><span class="co">#&gt; #define rxcauchy _rxa1f40e9099a491a7b42f45f941d64dbc136_rxcauchy_SyXM</span></span>
<span><span class="co">#&gt; #define rxnbinomMu _rxa1f40e9099a491a7b42f45f941d64dbc137_rxnbinomMu_V4ye</span></span>
<span><span class="co">#&gt; #define rxnbinom _rxa1f40e9099a491a7b42f45f941d64dbc138_rxnbinom_zXlY</span></span>
<span><span class="co">#&gt; #define rxbinom _rxa1f40e9099a491a7b42f45f941d64dbc139_rxbinom_mdNM</span></span>
<span><span class="co">#&gt; #define rxnorm _rxa1f40e9099a491a7b42f45f941d64dbc140_rxnorm_qSBx</span></span>
<span><span class="co">#&gt; #define linCmtB _rxa1f40e9099a491a7b42f45f941d64dbc141_linCmtB_i1cp</span></span>
<span><span class="co">#&gt; #define linCmtA _rxa1f40e9099a491a7b42f45f941d64dbc142_linCmtA_dhrH</span></span>
<span><span class="co">#&gt; #include &lt;rxode2_model_shared.h&gt;</span></span>
<span><span class="co">#&gt; #define __MAX_PROD__ 0</span></span>
<span><span class="co">#&gt; #define _CMT CMT</span></span>
<span><span class="co">#&gt; #define _SYNC_simeps_ for (int _svari=_solveData-&gt;neps; _svari--;){  if (_solveData-&gt;svar[_svari] == 0) {k = _PP[0];};   if (_solveData-&gt;svar[_svari] == 1) {tkde = _PP[1];};   if (_solveData-&gt;svar[_svari] == 2) {eta_DoT_tkde = _PP[2];};   if (_solveData-&gt;svar[_svari] == 3) {tkpq = _PP[3];};   if (_solveData-&gt;svar[_svari] == 4) {eta_DoT_kpq = _PP[4];};   if (_solveData-&gt;svar[_svari] == 5) {tkqpp = _PP[5];};   if (_solveData-&gt;svar[_svari] == 6) {eta_DoT_kqpp = _PP[6];};   if (_solveData-&gt;svar[_svari] == 7) {tlambdap = _PP[7];};   if (_solveData-&gt;svar[_svari] == 8) {eta_DoT_lambdap = _PP[8];};   if (_solveData-&gt;svar[_svari] == 9) {tgamma = _PP[9];};   if (_solveData-&gt;svar[_svari] == 10) {eta_DoT_gamma = _PP[10];};   if (_solveData-&gt;svar[_svari] == 11) {tdeltaqp = _PP[11];};   if (_solveData-&gt;svar[_svari] == 12) {eta_DoT_deltaqp = _PP[12];};   if (_solveData-&gt;svar[_svari] == 13) {prop_DoT_sd = _PP[13];};   if (_solveData-&gt;svar[_svari] == 14) {tpt0 = _PP[14];};   if (_solveData-&gt;svar[_svari] == 15) {eta_DoT_pt0 = _PP[15];};   if (_solveData-&gt;svar[_svari] == 16) {tq0 = _PP[16];};   if (_solveData-&gt;svar[_svari] == 17) {eta_DoT_q0 = _PP[17];};   if (_solveData-&gt;svar[_svari] == 18) {rxerr_DoT_pstar = _PP[18];}; }</span></span>
<span><span class="co">#&gt; #define _SYNC_simeta_ for (int _ovari=_solveData-&gt;neta; _ovari--;){  if (_solveData-&gt;ovar[_ovari] == 0) {k = _PP[0];};   if (_solveData-&gt;ovar[_ovari] == 1) {tkde = _PP[1];};   if (_solveData-&gt;ovar[_ovari] == 2) {eta_DoT_tkde = _PP[2];};   if (_solveData-&gt;ovar[_ovari] == 3) {tkpq = _PP[3];};   if (_solveData-&gt;ovar[_ovari] == 4) {eta_DoT_kpq = _PP[4];};   if (_solveData-&gt;ovar[_ovari] == 5) {tkqpp = _PP[5];};   if (_solveData-&gt;ovar[_ovari] == 6) {eta_DoT_kqpp = _PP[6];};   if (_solveData-&gt;ovar[_ovari] == 7) {tlambdap = _PP[7];};   if (_solveData-&gt;ovar[_ovari] == 8) {eta_DoT_lambdap = _PP[8];};   if (_solveData-&gt;ovar[_ovari] == 9) {tgamma = _PP[9];};   if (_solveData-&gt;ovar[_ovari] == 10) {eta_DoT_gamma = _PP[10];};   if (_solveData-&gt;ovar[_ovari] == 11) {tdeltaqp = _PP[11];};   if (_solveData-&gt;ovar[_ovari] == 12) {eta_DoT_deltaqp = _PP[12];};   if (_solveData-&gt;ovar[_ovari] == 13) {prop_DoT_sd = _PP[13];};   if (_solveData-&gt;ovar[_ovari] == 14) {tpt0 = _PP[14];};   if (_solveData-&gt;ovar[_ovari] == 15) {eta_DoT_pt0 = _PP[15];};   if (_solveData-&gt;ovar[_ovari] == 16) {tq0 = _PP[16];};   if (_solveData-&gt;ovar[_ovari] == 17) {eta_DoT_q0 = _PP[17];};   if (_solveData-&gt;ovar[_ovari] == 18) {rxerr_DoT_pstar = _PP[18];}; }</span></span>
<span><span class="co">#&gt; _getRxSolve_t _getRxSolve_;</span></span>
<span><span class="co">#&gt; _simfun simeps;</span></span>
<span><span class="co">#&gt; _simfun simeta;</span></span>
<span><span class="co">#&gt; _udf_type _evalUdf=NULL;</span></span>
<span><span class="co">#&gt; rx_solve *_solveData=NULL;</span></span>
<span><span class="co">#&gt; rxode2_assign_ptr _assign_ptr=NULL;</span></span>
<span><span class="co">#&gt; _rxRmModelLibType _rxRmModelLib=NULL;</span></span>
<span><span class="co">#&gt; _rxGetModelLibType _rxGetModelLib=NULL;</span></span>
<span><span class="co">#&gt; rxode2_ode_solver_old_c _old_c=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _ptrid=NULL;</span></span>
<span><span class="co">#&gt; _rxIsCurrentC_type _rxIsCurrentC=NULL;</span></span>
<span><span class="co">#&gt; _rxSumType _sumPS=NULL;</span></span>
<span><span class="co">#&gt; _rxProdType _prodPS=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _prodType=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _sumType=NULL;</span></span>
<span><span class="co">#&gt; _update_par_ptr_p _update_par_ptr=NULL;</span></span>
<span><span class="co">#&gt; _getParCov_p _getParCov=NULL;</span></span>
<span><span class="co">#&gt; linCmtA_p linCmtA;</span></span>
<span><span class="co">#&gt; linCmtB_p linCmtB;</span></span>
<span><span class="co">#&gt; _rx_asgn _rxode2_rxAssignPtr=NULL;</span></span>
<span><span class="co">#&gt; _rx_asgn _rxQr=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn phi;</span></span>
<span><span class="co">#&gt; rxode2_fn ReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn dReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn dGELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d2GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d3GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d4GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn dsoftplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d2softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d3softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d4softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn SELU;</span></span>
<span><span class="co">#&gt; rxode2_fn dSELU;</span></span>
<span><span class="co">#&gt; rxode2_fn lReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn dlReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn Swish;</span></span>
<span><span class="co">#&gt; rxode2_fn dSwish;</span></span>
<span><span class="co">#&gt; rxode2_fn2 PReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLUa;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLUa1;</span></span>
<span><span class="co">#&gt; rxode2_fn2 ELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2ELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2aELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dELUa;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2ELUa;</span></span>
<span><span class="co">#&gt; rxode2_fn3 logit;</span></span>
<span><span class="co">#&gt; rxode2_fn3 expit;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammap;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaq;</span></span>
<span><span class="co">#&gt; rxode2_fn2 lowergamma;</span></span>
<span><span class="co">#&gt; rxode2_fn2 uppergamma;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapInv;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapDer;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapInva;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaqInv;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaqInva;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxnorm;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxbinom;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxnbinom;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxnbinomMu;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxcauchy;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxchisq;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxexp;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxf;</span></span>
<span><span class="co">#&gt; rxode2i_ifn rxgeom;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxgamma;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxbeta;</span></span>
<span><span class="co">#&gt; rxode2i_ifn rxpois;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxt_;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxunif;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxweibull;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rinorm;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom ribinom;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom rinbinom;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom rinbinomMu;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 ricauchy;</span></span>
<span><span class="co">#&gt; rxode2i2_fn richisq;</span></span>
<span><span class="co">#&gt; rxode2i2_fn riexp;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rif;</span></span>
<span><span class="co">#&gt; rxode2i2_ifn rigeom;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rigamma;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 ribeta;</span></span>
<span><span class="co">#&gt; rxode2i2_ifn ripois;</span></span>
<span><span class="co">#&gt; rxode2i2_fn rit_;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 riunif;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 riweibull;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNorm;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNormDmean;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNormDsd;</span></span>
<span><span class="co">#&gt; rxode2_llikPoisFun _llikPois;</span></span>
<span><span class="co">#&gt; rxode2_llikPoisFun _llikPoisDlambda;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikBinom;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikBinomDprob;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinom;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomDprob;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomMu;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomMuDmu;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBeta;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBetaDshape1;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBetaDshape2;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikT;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDdf;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDmean;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDsd;</span></span>
<span><span class="co">#&gt; rxode2_llikChisqFun _llikChisq;</span></span>
<span><span class="co">#&gt; rxode2_llikChisqFun _llikChisqDdf;</span></span>
<span><span class="co">#&gt; rxode2_llikExpFun _llikExp;</span></span>
<span><span class="co">#&gt; rxode2_llikExpFun _llikExpDrate;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikF;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikFDdf1;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikFDdf2;</span></span>
<span><span class="co">#&gt; rxode2_llikGeomFun _llikGeom;</span></span>
<span><span class="co">#&gt; rxode2_llikGeomFun _llikGeomDp;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnif;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnifDalpha;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnifDbeta;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibull;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibullDshape;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibullDscale;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGamma;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGammaDshape;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGammaDrate;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchy;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchyDlocation;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchyDscale;</span></span>
<span><span class="co">#&gt; rxode2_compareFactorVal_fn _compareFactorVal;</span></span>
<span><span class="co">#&gt; #include "extraC.h"</span></span>
<span><span class="co">#&gt; double _prod(double *input, double *p, int type, int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return _prodPS(input, p, n, type);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _udf(const char *funName, double *input, int n, ...) {</span></span>
<span><span class="co">#&gt;   if (n == -42) Rf_error("%s", "this has a ui user function that cannot be called directly");</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return _evalUdf(funName, n, input);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _sum(double *input, double *pld, int m, int type, int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   double ret = _sumPS(input, n, pld, m, type);</span></span>
<span><span class="co">#&gt;   if (type == 2 &amp;&amp; m &lt; 0){</span></span>
<span><span class="co">#&gt;     for (int i = -m; i--;){</span></span>
<span><span class="co">#&gt;       pld[i] = 0.0;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return ret;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _sign(unsigned int n, ...) {</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double s = 1;</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;     s = sign(va_arg(valist, double))*s;</span></span>
<span><span class="co">#&gt;     if (s == 0){</span></span>
<span><span class="co">#&gt;       break;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return s;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _rxord(int _cSub, unsigned int n,  ...) {</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind* ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   if (!ind-&gt;inLhs) {</span></span>
<span><span class="co">#&gt;     return 1.0;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double ret = 1.0;</span></span>
<span><span class="co">#&gt;   double p = 0.0;</span></span>
<span><span class="co">#&gt;   double u = rxunif(ind, 0.0, 1.0);</span></span>
<span><span class="co">#&gt;   int found = 0;</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;     p += va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     if (!found) {</span></span>
<span><span class="co">#&gt;       if (u &lt; p) {</span></span>
<span><span class="co">#&gt;         ret = (double)(i+1);</span></span>
<span><span class="co">#&gt;         found = 1;</span></span>
<span><span class="co">#&gt;       }</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   if (!found) ret =(double)(n+1);</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return ret;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _max(unsigned int n, ...) {</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double mx = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tmp = 0;</span></span>
<span><span class="co">#&gt;   if (n &gt;= 1){</span></span>
<span><span class="co">#&gt;     mx = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     for (unsigned int i = 1; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;       tmp = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;       if (tmp&gt;mx) mx=tmp;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     va_end(valist);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return mx;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _min(unsigned int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double mn = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tmp = 0;</span></span>
<span><span class="co">#&gt;   if (n &gt;= 1){</span></span>
<span><span class="co">#&gt;     mn = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     for (unsigned int i = 1; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;       tmp = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;       if (tmp&lt;mn) mn=tmp;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     va_end(valist);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return mn;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _transit4P(int cmt, double t, unsigned int id, double n, double mtt, double bio){</span></span>
<span><span class="co">#&gt;   double nd = (double) n;</span></span>
<span><span class="co">#&gt;   double ktr = (nd+1)/mtt;</span></span>
<span><span class="co">#&gt;   double lktr = _safe_log(nd+1)-_safe_log(mtt);</span></span>
<span><span class="co">#&gt;   double tlast = _solveData-&gt;subjects[id].tlastS[cmt];</span></span>
<span><span class="co">#&gt;   double dose = _solveData-&gt;subjects[id].curDoseS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(dose)) dose = 0.0;</span></span>
<span><span class="co">#&gt;   if (ISNA(tlast)) tlast = 0.0;</span></span>
<span><span class="co">#&gt;   double tad = (t-tlast);</span></span>
<span><span class="co">#&gt;   return exp(_safe_log(bio*dose)+lktr+n*(lktr+_safe_log(tad))-ktr*(tad)-lgamma1p(nd));</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _transit3P(int cmt, double t, unsigned int id, double n, double mtt){</span></span>
<span><span class="co">#&gt;   double nd = (double) n;</span></span>
<span><span class="co">#&gt;   double ktr = (nd+1)/mtt;</span></span>
<span><span class="co">#&gt;   double lktr = _safe_log(nd+1)-_safe_log(mtt);</span></span>
<span><span class="co">#&gt;   double tlast = _solveData-&gt;subjects[id].tlastS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(tlast)) tlast = 0.0;</span></span>
<span><span class="co">#&gt;   double tad = t-tlast;</span></span>
<span><span class="co">#&gt;   double podo = _solveData-&gt;subjects[id].curDoseS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(podo)) podo = 0.0;</span></span>
<span><span class="co">#&gt;   return exp(_safe_log(podo)+lktr+n*(lktr+_safe_log(tad))-ktr*(tad)-lgamma1p(nd));</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void _assignFuns0(void) {</span></span>
<span><span class="co">#&gt;   _evalUdf = (_udf_type) R_GetCCallable("rxode2", "_rxode2_evalUdf");</span></span>
<span><span class="co">#&gt;   _getRxSolve_ = (_getRxSolve_t) R_GetCCallable("rxode2","getRxSolve_");</span></span>
<span><span class="co">#&gt;   _assign_ptr=(rxode2_assign_ptr) R_GetCCallable("rxode2","rxode2_assign_fn_pointers");</span></span>
<span><span class="co">#&gt;   _rxRmModelLib=(_rxRmModelLibType) R_GetCCallable("rxode2","rxRmModelLib");</span></span>
<span><span class="co">#&gt;   _rxGetModelLib=(_rxGetModelLibType) R_GetCCallable("rxode2","rxGetModelLib");</span></span>
<span><span class="co">#&gt;   _rxode2_rxAssignPtr=(_rx_asgn)R_GetCCallable("rxode2","_rxode2_rxAssignPtr");</span></span>
<span><span class="co">#&gt;   _rxQr=(_rx_asgn)R_GetCCallable("rxode2","_rxode2_rxQr");</span></span>
<span><span class="co">#&gt;   _rxIsCurrentC = (_rxIsCurrentC_type)R_GetCCallable("rxode2","rxIsCurrentC");</span></span>
<span><span class="co">#&gt;   _sumPS  = (_rxSumType) R_GetCCallable("PreciseSums","PreciseSums_sum_r");</span></span>
<span><span class="co">#&gt;   _prodPS = (_rxProdType) R_GetCCallable("PreciseSums","PreciseSums_prod_r");</span></span>
<span><span class="co">#&gt;   _prodType=(rxode2_fn0i)R_GetCCallable("PreciseSums", "PreciseSums_prod_get");</span></span>
<span><span class="co">#&gt;   _sumType=(rxode2_fn0i)R_GetCCallable("PreciseSums", "PreciseSums_sum_get");</span></span>
<span><span class="co">#&gt;   _ptrid=(rxode2_fn0i)R_GetCCallable("rxode2", "rxode2_current_fn_pointer_id");</span></span>
<span><span class="co">#&gt;   _compareFactorVal=(rxode2_compareFactorVal_fn) R_GetCCallable("rxode2", "compareFactorVal");</span></span>
<span><span class="co">#&gt;   _update_par_ptr = (_update_par_ptr_p) R_GetCCallable("rxode2","_update_par_ptr");</span></span>
<span><span class="co">#&gt;   _getParCov = (_getParCov_p) R_GetCCallable("rxode2","_getParCov");</span></span>
<span><span class="co">#&gt;   // dynamic start</span></span>
<span><span class="co">#&gt;   _llikCauchyDscale = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchyDscale");</span></span>
<span><span class="co">#&gt;   _llikCauchyDlocation = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchyDlocation");</span></span>
<span><span class="co">#&gt;   _llikCauchy = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchy");</span></span>
<span><span class="co">#&gt;   _llikGammaDrate = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGammaDrate");</span></span>
<span><span class="co">#&gt;   _llikGammaDshape = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGammaDshape");</span></span>
<span><span class="co">#&gt;   _llikGamma = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGamma");</span></span>
<span><span class="co">#&gt;   _llikWeibullDscale = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibullDscale");</span></span>
<span><span class="co">#&gt;   _llikWeibullDshape = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibullDshape");</span></span>
<span><span class="co">#&gt;   _llikWeibull = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibull");</span></span>
<span><span class="co">#&gt;   _llikUnifDbeta = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnifDbeta");</span></span>
<span><span class="co">#&gt;   _llikUnifDalpha = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnifDalpha");</span></span>
<span><span class="co">#&gt;   _llikUnif = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnif");</span></span>
<span><span class="co">#&gt;   _llikGeomDp = (rxode2_llikGeomFun) R_GetCCallable("rxode2ll", "rxLlikGeomDp");</span></span>
<span><span class="co">#&gt;   _llikGeom = (rxode2_llikGeomFun) R_GetCCallable("rxode2ll", "rxLlikGeom");</span></span>
<span><span class="co">#&gt;   _llikFDdf2 = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikFDdf2");</span></span>
<span><span class="co">#&gt;   _llikFDdf1 = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikFDdf1");</span></span>
<span><span class="co">#&gt;   _llikF = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikF");</span></span>
<span><span class="co">#&gt;   _llikExpDrate = (rxode2_llikExpFun) R_GetCCallable("rxode2ll", "rxLlikExpDrate");</span></span>
<span><span class="co">#&gt;   _llikExp = (rxode2_llikExpFun) R_GetCCallable("rxode2ll", "rxLlikExp");</span></span>
<span><span class="co">#&gt;   _llikChisqDdf = (rxode2_llikChisqFun) R_GetCCallable("rxode2ll", "rxLlikChisqDdf");</span></span>
<span><span class="co">#&gt;   _llikChisq = (rxode2_llikChisqFun) R_GetCCallable("rxode2ll", "rxLlikChisq");</span></span>
<span><span class="co">#&gt;   _llikTDsd = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDsd");</span></span>
<span><span class="co">#&gt;   _llikTDmean = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDmean");</span></span>
<span><span class="co">#&gt;   _llikTDdf = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDdf");</span></span>
<span><span class="co">#&gt;   _llikT = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikT");</span></span>
<span><span class="co">#&gt;   _llikBetaDshape2 = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBetaDshape2");</span></span>
<span><span class="co">#&gt;   _llikBetaDshape1 = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBetaDshape1");</span></span>
<span><span class="co">#&gt;   _llikBeta = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBeta");</span></span>
<span><span class="co">#&gt;   _llikNbinomMuDmu = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomMuDmu");</span></span>
<span><span class="co">#&gt;   _llikNbinomMu = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomMu");</span></span>
<span><span class="co">#&gt;   _llikNbinomDprob = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomDprob");</span></span>
<span><span class="co">#&gt;   _llikNbinom = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinom");</span></span>
<span><span class="co">#&gt;   _llikBinomDprob = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikBinomDprob");</span></span>
<span><span class="co">#&gt;   _llikBinom = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikBinom");</span></span>
<span><span class="co">#&gt;   _llikPoisDlambda = (rxode2_llikPoisFun) R_GetCCallable("rxode2ll", "rxLlikPoisDlambda");</span></span>
<span><span class="co">#&gt;   _llikPois = (rxode2_llikPoisFun) R_GetCCallable("rxode2ll", "rxLlikPois");</span></span>
<span><span class="co">#&gt;   _llikNormDsd = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNormDsd");</span></span>
<span><span class="co">#&gt;   _llikNormDmean = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNormDmean");</span></span>
<span><span class="co">#&gt;   _llikNorm = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNorm");</span></span>
<span><span class="co">#&gt;   simeps = (_simfun) R_GetCCallable("rxode2", "simeps");</span></span>
<span><span class="co">#&gt;   simeta = (_simfun) R_GetCCallable("rxode2", "simeta");</span></span>
<span><span class="co">#&gt;   expit = (rxode2_fn3) R_GetCCallable("rxode2", "expit");</span></span>
<span><span class="co">#&gt;   logit = (rxode2_fn3) R_GetCCallable("rxode2", "logit");</span></span>
<span><span class="co">#&gt;   gammapDer = (rxode2_fn2) R_GetCCallable("rxode2", "gammapDer");</span></span>
<span><span class="co">#&gt;   lowergamma = (rxode2_fn2) R_GetCCallable("rxode2", "lowergamma");</span></span>
<span><span class="co">#&gt;   uppergamma = (rxode2_fn2) R_GetCCallable("rxode2", "uppergamma");</span></span>
<span><span class="co">#&gt;   gammaqInva = (rxode2_fn2) R_GetCCallable("rxode2", "gammaqInva");</span></span>
<span><span class="co">#&gt;   gammaqInv = (rxode2_fn2) R_GetCCallable("rxode2", "gammaqInv");</span></span>
<span><span class="co">#&gt;   gammapInva = (rxode2_fn2) R_GetCCallable("rxode2", "gammapInva");</span></span>
<span><span class="co">#&gt;   gammapInv = (rxode2_fn2) R_GetCCallable("rxode2", "gammapInv");</span></span>
<span><span class="co">#&gt;   gammaq = (rxode2_fn2) R_GetCCallable("rxode2", "gammaq");</span></span>
<span><span class="co">#&gt;   gammap = (rxode2_fn2) R_GetCCallable("rxode2", "gammap");</span></span>
<span><span class="co">#&gt;   phi = (rxode2_fn) R_GetCCallable("rxode2", "phi");</span></span>
<span><span class="co">#&gt;   d2ELUa = (rxode2_fn2) R_GetCCallable("rxode2", "d2ELUa");</span></span>
<span><span class="co">#&gt;   dELUa = (rxode2_fn2) R_GetCCallable("rxode2", "dELUa");</span></span>
<span><span class="co">#&gt;   d2aELU = (rxode2_fn2) R_GetCCallable("rxode2", "d2aELU");</span></span>
<span><span class="co">#&gt;   d2ELU = (rxode2_fn2) R_GetCCallable("rxode2", "d2ELU");</span></span>
<span><span class="co">#&gt;   dELU = (rxode2_fn2) R_GetCCallable("rxode2", "dELU");</span></span>
<span><span class="co">#&gt;   ELU = (rxode2_fn2) R_GetCCallable("rxode2", "ELU");</span></span>
<span><span class="co">#&gt;   dPReLUa1 = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLUa1");</span></span>
<span><span class="co">#&gt;   dPReLUa = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLUa");</span></span>
<span><span class="co">#&gt;   dPReLU = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLU");</span></span>
<span><span class="co">#&gt;   PReLU = (rxode2_fn2) R_GetCCallable("rxode2", "PReLU");</span></span>
<span><span class="co">#&gt;   dSwish = (rxode2_fn) R_GetCCallable("rxode2", "dSwish");</span></span>
<span><span class="co">#&gt;   Swish = (rxode2_fn) R_GetCCallable("rxode2", "Swish");</span></span>
<span><span class="co">#&gt;   dlReLU = (rxode2_fn) R_GetCCallable("rxode2", "dlReLU");</span></span>
<span><span class="co">#&gt;   lReLU = (rxode2_fn) R_GetCCallable("rxode2", "lReLU");</span></span>
<span><span class="co">#&gt;   dSELU = (rxode2_fn) R_GetCCallable("rxode2", "dSELU");</span></span>
<span><span class="co">#&gt;   SELU = (rxode2_fn) R_GetCCallable("rxode2", "SELU");</span></span>
<span><span class="co">#&gt;   d4softplus = (rxode2_fn) R_GetCCallable("rxode2", "d4softplus");</span></span>
<span><span class="co">#&gt;   d3softplus = (rxode2_fn) R_GetCCallable("rxode2", "d3softplus");</span></span>
<span><span class="co">#&gt;   d2softplus = (rxode2_fn) R_GetCCallable("rxode2", "d2softplus");</span></span>
<span><span class="co">#&gt;   dsoftplus = (rxode2_fn) R_GetCCallable("rxode2", "dsoftplus");</span></span>
<span><span class="co">#&gt;   softplus = (rxode2_fn) R_GetCCallable("rxode2", "softplus");</span></span>
<span><span class="co">#&gt;   d4GELU = (rxode2_fn) R_GetCCallable("rxode2", "d4GELU");</span></span>
<span><span class="co">#&gt;   d3GELU = (rxode2_fn) R_GetCCallable("rxode2", "d3GELU");</span></span>
<span><span class="co">#&gt;   d2GELU = (rxode2_fn) R_GetCCallable("rxode2", "d2GELU");</span></span>
<span><span class="co">#&gt;   dGELU = (rxode2_fn) R_GetCCallable("rxode2", "dGELU");</span></span>
<span><span class="co">#&gt;   GELU = (rxode2_fn) R_GetCCallable("rxode2", "GELU");</span></span>
<span><span class="co">#&gt;   dReLU = (rxode2_fn) R_GetCCallable("rxode2", "dReLU");</span></span>
<span><span class="co">#&gt;   ReLU = (rxode2_fn) R_GetCCallable("rxode2", "ReLU");</span></span>
<span><span class="co">#&gt;   riweibull = (rxode2i2_fn2) R_GetCCallable("rxode2", "riweibull");</span></span>
<span><span class="co">#&gt;   riunif = (rxode2i2_fn2) R_GetCCallable("rxode2", "riunif");</span></span>
<span><span class="co">#&gt;   rit_ = (rxode2i2_fn) R_GetCCallable("rxode2", "rit_");</span></span>
<span><span class="co">#&gt;   ripois = (rxode2i2_ifn) R_GetCCallable("rxode2", "ripois");</span></span>
<span><span class="co">#&gt;   ribeta = (rxode2i2_fn2) R_GetCCallable("rxode2", "ribeta");</span></span>
<span><span class="co">#&gt;   rigamma = (rxode2i2_fn2) R_GetCCallable("rxode2", "rigamma");</span></span>
<span><span class="co">#&gt;   rigeom = (rxode2i2_ifn) R_GetCCallable("rxode2", "rigeom");</span></span>
<span><span class="co">#&gt;   rif = (rxode2i2_fn2) R_GetCCallable("rxode2", "rif");</span></span>
<span><span class="co">#&gt;   riexp = (rxode2i2_fn) R_GetCCallable("rxode2", "riexp");</span></span>
<span><span class="co">#&gt;   richisq = (rxode2i2_fn) R_GetCCallable("rxode2", "richisq");</span></span>
<span><span class="co">#&gt;   ricauchy = (rxode2i2_fn2) R_GetCCallable("rxode2", "ricauchy");</span></span>
<span><span class="co">#&gt;   rinbinomMu = (rxode2i2_ribinom) R_GetCCallable("rxode2", "rinbinomMu");</span></span>
<span><span class="co">#&gt;   rinbinom = (rxode2i2_ribinom) R_GetCCallable("rxode2", "rinbinom");</span></span>
<span><span class="co">#&gt;   ribinom = (rxode2i2_ribinom) R_GetCCallable("rxode2", "ribinom");</span></span>
<span><span class="co">#&gt;   rinorm = (rxode2i2_fn2) R_GetCCallable("rxode2", "rinorm");</span></span>
<span><span class="co">#&gt;   rxweibull = (rxode2i_fn2) R_GetCCallable("rxode2", "rxweibull");</span></span>
<span><span class="co">#&gt;   rxunif = (rxode2i_fn2) R_GetCCallable("rxode2", "rxunif");</span></span>
<span><span class="co">#&gt;   rxt_ = (rxode2i_fn) R_GetCCallable("rxode2", "rxt_");</span></span>
<span><span class="co">#&gt;   rxpois = (rxode2i_ifn) R_GetCCallable("rxode2", "rxpois");</span></span>
<span><span class="co">#&gt;   rxbeta = (rxode2i_fn2) R_GetCCallable("rxode2", "rxbeta");</span></span>
<span><span class="co">#&gt;   rxgamma = (rxode2i_fn2) R_GetCCallable("rxode2", "rxgamma");</span></span>
<span><span class="co">#&gt;   rxgeom = (rxode2i_ifn) R_GetCCallable("rxode2", "rxgeom");</span></span>
<span><span class="co">#&gt;   rxf = (rxode2i_fn2) R_GetCCallable("rxode2", "rxf");</span></span>
<span><span class="co">#&gt;   rxexp = (rxode2i_fn) R_GetCCallable("rxode2", "rxexp");</span></span>
<span><span class="co">#&gt;   rxchisq = (rxode2i_fn) R_GetCCallable("rxode2", "rxchisq");</span></span>
<span><span class="co">#&gt;   rxcauchy = (rxode2i_fn2) R_GetCCallable("rxode2", "rxcauchy");</span></span>
<span><span class="co">#&gt;   rxnbinomMu = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxnbinomMu");</span></span>
<span><span class="co">#&gt;   rxnbinom = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxnbinom");</span></span>
<span><span class="co">#&gt;   rxbinom = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxbinom");</span></span>
<span><span class="co">#&gt;   rxnorm = (rxode2i_fn2) R_GetCCallable("rxode2", "rxnorm");</span></span>
<span><span class="co">#&gt;   linCmtB = (linCmtB_p) R_GetCCallable("rxode2", "linCmtB");</span></span>
<span><span class="co">#&gt;   linCmtA = (linCmtA_p) R_GetCCallable("rxode2", "linCmtA");</span></span>
<span><span class="co">#&gt;   // dynamic stop</span></span>
<span><span class="co">#&gt;   _solveData = _getRxSolve_();</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void _assignFuns(void) {</span></span>
<span><span class="co">#&gt;   if (_assign_ptr == NULL){</span></span>
<span><span class="co">#&gt;     _assignFuns0();</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void __assignFuns2(rx_solve rx,</span></span>
<span><span class="co">#&gt;                    rx_solving_options op,</span></span>
<span><span class="co">#&gt;                    t_F f,</span></span>
<span><span class="co">#&gt;                    t_LAG lag,</span></span>
<span><span class="co">#&gt;                    t_RATE rate,</span></span>
<span><span class="co">#&gt;                    t_DUR dur,</span></span>
<span><span class="co">#&gt;                    t_calc_mtime mtime,</span></span>
<span><span class="co">#&gt;                    t_ME me,</span></span>
<span><span class="co">#&gt;                    t_IndF indf,</span></span>
<span><span class="co">#&gt;                    t_getTime gettime,</span></span>
<span><span class="co">#&gt;                    t_locateTimeIndex timeindex,</span></span>
<span><span class="co">#&gt;                    t_handle_evidL handleEvid,</span></span>
<span><span class="co">#&gt;                    t_getDur getdur) {</span></span>
<span><span class="co">#&gt;   // assign start</span></span>
<span><span class="co">#&gt;     static rxode2_assignFuns2_t rxode2_assignFuns2 = NULL;</span></span>
<span><span class="co">#&gt;     if (rxode2_assignFuns2 == NULL) rxode2_assignFuns2 = (rxode2_assignFuns2_t)(R_GetCCallable("rxode2", "_rxode2_assignFuns2"));</span></span>
<span><span class="co">#&gt;     rxode2_assignFuns2(rx, op, f, lag, rate, dur, mtime, me, indf, gettime, timeindex, handleEvid, getdur);</span></span>
<span><span class="co">#&gt;   // assign stop</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void  rx_3b99e704ad485e28af0a8f4b4c34d40c__ode_solver_solvedata (rx_solve *solve){</span></span>
<span><span class="co">#&gt;   _solveData = solve;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern rx_solve *rx_3b99e704ad485e28af0a8f4b4c34d40c__ode_solver_get_solvedata(void){</span></span>
<span><span class="co">#&gt;   return _solveData;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; SEXP rx_3b99e704ad485e28af0a8f4b4c34d40c__model_vars(void);</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; // prj-specific differential eqns</span></span>
<span><span class="co">#&gt; void rx_3b99e704ad485e28af0a8f4b4c34d40c__dydt(int *_neq, double __t, double *__zzStateVar__, double *__DDtStateVar__)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   int _cSub = _neq[1];</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_neq[1]].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=1;</span></span>
<span><span class="co">#&gt;   double k = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tkde = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_tkde = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tkpq = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_kpq = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tkqpp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_kqpp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tlambdap = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_lambdap = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tgamma = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_gamma = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tdeltaqp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_deltaqp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double prop_DoT_sd = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tpt0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_pt0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tq0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_q0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double pstar = NA_REAL;</span></span>
<span><span class="co">#&gt;   double kde = NA_REAL;</span></span>
<span><span class="co">#&gt;   double kpq = NA_REAL;</span></span>
<span><span class="co">#&gt;   double kqpp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double lambdap = NA_REAL;</span></span>
<span><span class="co">#&gt;   double _rxNotFun_gamma = NA_REAL;</span></span>
<span><span class="co">#&gt;   double deltaqp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double c = NA_REAL;</span></span>
<span><span class="co">#&gt;   double pt = NA_REAL;</span></span>
<span><span class="co">#&gt;   double qp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double q = NA_REAL;</span></span>
<span><span class="co">#&gt;   double pt0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double q0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_yj___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_lambda___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_low___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_hi___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_f_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_r_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double ipredSim = NA_REAL;</span></span>
<span><span class="co">#&gt;   double sim = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rxerr_DoT_pstar = NA_REAL;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   (void)k;</span></span>
<span><span class="co">#&gt;   (void)tkde;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_tkde;</span></span>
<span><span class="co">#&gt;   (void)tkpq;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_kpq;</span></span>
<span><span class="co">#&gt;   (void)tkqpp;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_kqpp;</span></span>
<span><span class="co">#&gt;   (void)tlambdap;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_lambdap;</span></span>
<span><span class="co">#&gt;   (void)tgamma;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_gamma;</span></span>
<span><span class="co">#&gt;   (void)tdeltaqp;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_deltaqp;</span></span>
<span><span class="co">#&gt;   (void)prop_DoT_sd;</span></span>
<span><span class="co">#&gt;   (void)tpt0;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_pt0;</span></span>
<span><span class="co">#&gt;   (void)tq0;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_q0;</span></span>
<span><span class="co">#&gt;   (void)pstar;</span></span>
<span><span class="co">#&gt;   (void)kde;</span></span>
<span><span class="co">#&gt;   (void)kpq;</span></span>
<span><span class="co">#&gt;   (void)kqpp;</span></span>
<span><span class="co">#&gt;   (void)lambdap;</span></span>
<span><span class="co">#&gt;   (void)_rxNotFun_gamma;</span></span>
<span><span class="co">#&gt;   (void)deltaqp;</span></span>
<span><span class="co">#&gt;   (void)c;</span></span>
<span><span class="co">#&gt;   (void)pt;</span></span>
<span><span class="co">#&gt;   (void)qp;</span></span>
<span><span class="co">#&gt;   (void)q;</span></span>
<span><span class="co">#&gt;   (void)pt0;</span></span>
<span><span class="co">#&gt;   (void)q0;</span></span>
<span><span class="co">#&gt;   (void)rx_yj___;</span></span>
<span><span class="co">#&gt;   (void)rx_lambda___;</span></span>
<span><span class="co">#&gt;   (void)rx_low___;</span></span>
<span><span class="co">#&gt;   (void)rx_hi___;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_f_;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_;</span></span>
<span><span class="co">#&gt;   (void)rx_r_;</span></span>
<span><span class="co">#&gt;   (void)ipredSim;</span></span>
<span><span class="co">#&gt;   (void)sim;</span></span>
<span><span class="co">#&gt;   (void)rxerr_DoT_pstar;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   pstar = _PL[0];</span></span>
<span><span class="co">#&gt;   ipredSim = _PL[1];</span></span>
<span><span class="co">#&gt;   sim = _PL[2];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _update_par_ptr(__t, _cSub, _solveData, _idx);</span></span>
<span><span class="co">#&gt;   k = _PP[0];</span></span>
<span><span class="co">#&gt;   tkde = _PP[1];</span></span>
<span><span class="co">#&gt;   eta_DoT_tkde = _PP[2];</span></span>
<span><span class="co">#&gt;   tkpq = _PP[3];</span></span>
<span><span class="co">#&gt;   eta_DoT_kpq = _PP[4];</span></span>
<span><span class="co">#&gt;   tkqpp = _PP[5];</span></span>
<span><span class="co">#&gt;   eta_DoT_kqpp = _PP[6];</span></span>
<span><span class="co">#&gt;   tlambdap = _PP[7];</span></span>
<span><span class="co">#&gt;   eta_DoT_lambdap = _PP[8];</span></span>
<span><span class="co">#&gt;   tgamma = _PP[9];</span></span>
<span><span class="co">#&gt;   eta_DoT_gamma = _PP[10];</span></span>
<span><span class="co">#&gt;   tdeltaqp = _PP[11];</span></span>
<span><span class="co">#&gt;   eta_DoT_deltaqp = _PP[12];</span></span>
<span><span class="co">#&gt;   prop_DoT_sd = _PP[13];</span></span>
<span><span class="co">#&gt;   tpt0 = _PP[14];</span></span>
<span><span class="co">#&gt;   eta_DoT_pt0 = _PP[15];</span></span>
<span><span class="co">#&gt;   tq0 = _PP[16];</span></span>
<span><span class="co">#&gt;   eta_DoT_q0 = _PP[17];</span></span>
<span><span class="co">#&gt;   rxerr_DoT_pstar = _PP[18];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   c = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">#&gt;   pt = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">#&gt;   q = __zzStateVar__[__DDT2__]*((double)(_ON[__DDT2__]));</span></span>
<span><span class="co">#&gt;   qp = __zzStateVar__[__DDT3__]*((double)(_ON[__DDT3__]));</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   kde =tkde*exp(eta_DoT_tkde);</span></span>
<span><span class="co">#&gt;   kpq =tkpq*exp(eta_DoT_kpq);</span></span>
<span><span class="co">#&gt;   kqpp =tkqpp*exp(eta_DoT_kqpp);</span></span>
<span><span class="co">#&gt;   lambdap =tlambdap*exp(eta_DoT_lambdap);</span></span>
<span><span class="co">#&gt;   _rxNotFun_gamma =tgamma*exp(eta_DoT_gamma);</span></span>
<span><span class="co">#&gt;   deltaqp =tdeltaqp*exp(eta_DoT_deltaqp);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT0__] = ((double)(_ON[__DDT0__]))*(_IR[__DDT0__] -kde*c);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT1__] = ((double)(_ON[__DDT1__]))*(_IR[__DDT1__] + lambdap*pt*(1-pstar/_div0(k))+kqpp*qp-kpq*pt-_rxNotFun_gamma*c*kde*pt);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT2__] = ((double)(_ON[__DDT2__]))*(_IR[__DDT2__] + kpq*pt-_rxNotFun_gamma*c*kde*q);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT3__] = ((double)(_ON[__DDT3__]))*(_IR[__DDT3__] + _rxNotFun_gamma*c*kde*q-kqpp*qp-deltaqp*qp);</span></span>
<span><span class="co">#&gt;   pt0 =tpt0*exp(eta_DoT_pt0);</span></span>
<span><span class="co">#&gt;   q0 =tq0*exp(eta_DoT_q0);</span></span>
<span><span class="co">#&gt;   pstar =(pt+q+qp);</span></span>
<span><span class="co">#&gt;   rx_yj_ =2;</span></span>
<span><span class="co">#&gt;   rx_lambda_ =1;</span></span>
<span><span class="co">#&gt;   rx_low_ =0;</span></span>
<span><span class="co">#&gt;   rx_hi_ =1;</span></span>
<span><span class="co">#&gt;   rx_pred_f_ =pstar;</span></span>
<span><span class="co">#&gt;   rx_pred_ =rx_pred_f_;</span></span>
<span><span class="co">#&gt;   rx_r_ =Rx_pow((rx_pred_f_*prop_DoT_sd),2);</span></span>
<span><span class="co">#&gt;   ipredSim =rxTBSi(rx_pred_,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   sim =rxTBSi(rx_pred_+sqrt(rx_r_)*rxerr_DoT_pstar,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   (&amp;_solveData-&gt;subjects[_cSub])-&gt;dadt_counter[0]++;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; // Jacobian derived vars</span></span>
<span><span class="co">#&gt; void rx_3b99e704ad485e28af0a8f4b4c34d40c__calc_jac(int *_neq, double __t, double *__zzStateVar__, double *__PDStateVar__, unsigned int __NROWPD__) {</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;     int _cSub=_neq[1];</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_neq[1]].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=2;</span></span>
<span><span class="co">#&gt;   (&amp;_solveData-&gt;subjects[_cSub])-&gt;jac_counter[0]++;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Functional based initial conditions.</span></span>
<span><span class="co">#&gt; void rx_3b99e704ad485e28af0a8f4b4c34d40c__inis(int _cSub, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;  _ind-&gt;_rxFlag=3;</span></span>
<span><span class="co">#&gt;   double t=0;</span></span>
<span><span class="co">#&gt;   double k = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tkde = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_tkde = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tkpq = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_kpq = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tkqpp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_kqpp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tlambdap = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_lambdap = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tgamma = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_gamma = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tdeltaqp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_deltaqp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double prop_DoT_sd = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tpt0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_pt0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tq0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_q0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double pstar = NA_REAL;</span></span>
<span><span class="co">#&gt;   double kde = NA_REAL;</span></span>
<span><span class="co">#&gt;   double kpq = NA_REAL;</span></span>
<span><span class="co">#&gt;   double kqpp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double lambdap = NA_REAL;</span></span>
<span><span class="co">#&gt;   double _rxNotFun_gamma = NA_REAL;</span></span>
<span><span class="co">#&gt;   double deltaqp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double c = NA_REAL;</span></span>
<span><span class="co">#&gt;   double pt = NA_REAL;</span></span>
<span><span class="co">#&gt;   double qp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double q = NA_REAL;</span></span>
<span><span class="co">#&gt;   double pt0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double q0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_yj___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_lambda___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_low___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_hi___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_f_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_r_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double ipredSim = NA_REAL;</span></span>
<span><span class="co">#&gt;   double sim = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rxerr_DoT_pstar = NA_REAL;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   (void)k;</span></span>
<span><span class="co">#&gt;   (void)tkde;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_tkde;</span></span>
<span><span class="co">#&gt;   (void)tkpq;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_kpq;</span></span>
<span><span class="co">#&gt;   (void)tkqpp;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_kqpp;</span></span>
<span><span class="co">#&gt;   (void)tlambdap;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_lambdap;</span></span>
<span><span class="co">#&gt;   (void)tgamma;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_gamma;</span></span>
<span><span class="co">#&gt;   (void)tdeltaqp;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_deltaqp;</span></span>
<span><span class="co">#&gt;   (void)prop_DoT_sd;</span></span>
<span><span class="co">#&gt;   (void)tpt0;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_pt0;</span></span>
<span><span class="co">#&gt;   (void)tq0;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_q0;</span></span>
<span><span class="co">#&gt;   (void)pstar;</span></span>
<span><span class="co">#&gt;   (void)kde;</span></span>
<span><span class="co">#&gt;   (void)kpq;</span></span>
<span><span class="co">#&gt;   (void)kqpp;</span></span>
<span><span class="co">#&gt;   (void)lambdap;</span></span>
<span><span class="co">#&gt;   (void)_rxNotFun_gamma;</span></span>
<span><span class="co">#&gt;   (void)deltaqp;</span></span>
<span><span class="co">#&gt;   (void)c;</span></span>
<span><span class="co">#&gt;   (void)pt;</span></span>
<span><span class="co">#&gt;   (void)qp;</span></span>
<span><span class="co">#&gt;   (void)q;</span></span>
<span><span class="co">#&gt;   (void)pt0;</span></span>
<span><span class="co">#&gt;   (void)q0;</span></span>
<span><span class="co">#&gt;   (void)rx_yj___;</span></span>
<span><span class="co">#&gt;   (void)rx_lambda___;</span></span>
<span><span class="co">#&gt;   (void)rx_low___;</span></span>
<span><span class="co">#&gt;   (void)rx_hi___;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_f_;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_;</span></span>
<span><span class="co">#&gt;   (void)rx_r_;</span></span>
<span><span class="co">#&gt;   (void)ipredSim;</span></span>
<span><span class="co">#&gt;   (void)sim;</span></span>
<span><span class="co">#&gt;   (void)rxerr_DoT_pstar;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   pstar = _PL[0];</span></span>
<span><span class="co">#&gt;   ipredSim = _PL[1];</span></span>
<span><span class="co">#&gt;   sim = _PL[2];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _update_par_ptr(0.0, _cSub, _solveData, _idx);</span></span>
<span><span class="co">#&gt;   k = _PP[0];</span></span>
<span><span class="co">#&gt;   tkde = _PP[1];</span></span>
<span><span class="co">#&gt;   eta_DoT_tkde = _PP[2];</span></span>
<span><span class="co">#&gt;   tkpq = _PP[3];</span></span>
<span><span class="co">#&gt;   eta_DoT_kpq = _PP[4];</span></span>
<span><span class="co">#&gt;   tkqpp = _PP[5];</span></span>
<span><span class="co">#&gt;   eta_DoT_kqpp = _PP[6];</span></span>
<span><span class="co">#&gt;   tlambdap = _PP[7];</span></span>
<span><span class="co">#&gt;   eta_DoT_lambdap = _PP[8];</span></span>
<span><span class="co">#&gt;   tgamma = _PP[9];</span></span>
<span><span class="co">#&gt;   eta_DoT_gamma = _PP[10];</span></span>
<span><span class="co">#&gt;   tdeltaqp = _PP[11];</span></span>
<span><span class="co">#&gt;   eta_DoT_deltaqp = _PP[12];</span></span>
<span><span class="co">#&gt;   prop_DoT_sd = _PP[13];</span></span>
<span><span class="co">#&gt;   tpt0 = _PP[14];</span></span>
<span><span class="co">#&gt;   eta_DoT_pt0 = _PP[15];</span></span>
<span><span class="co">#&gt;   tq0 = _PP[16];</span></span>
<span><span class="co">#&gt;   eta_DoT_q0 = _PP[17];</span></span>
<span><span class="co">#&gt;   rxerr_DoT_pstar = _PP[18];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   c = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">#&gt;   pt = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">#&gt;   q = __zzStateVar__[__DDT2__]*((double)(_ON[__DDT2__]));</span></span>
<span><span class="co">#&gt;   qp = __zzStateVar__[__DDT3__]*((double)(_ON[__DDT3__]));</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   kde =tkde*exp(eta_DoT_tkde);</span></span>
<span><span class="co">#&gt;   kpq =tkpq*exp(eta_DoT_kpq);</span></span>
<span><span class="co">#&gt;   kqpp =tkqpp*exp(eta_DoT_kqpp);</span></span>
<span><span class="co">#&gt;   lambdap =tlambdap*exp(eta_DoT_lambdap);</span></span>
<span><span class="co">#&gt;   _rxNotFun_gamma =tgamma*exp(eta_DoT_gamma);</span></span>
<span><span class="co">#&gt;   deltaqp =tdeltaqp*exp(eta_DoT_deltaqp);</span></span>
<span><span class="co">#&gt;   pt0 =tpt0*exp(eta_DoT_pt0);</span></span>
<span><span class="co">#&gt;   q0 =tq0*exp(eta_DoT_q0);</span></span>
<span><span class="co">#&gt;   pt=pt0;</span></span>
<span><span class="co">#&gt;   q=q0;</span></span>
<span><span class="co">#&gt;   pstar =(pt+q+qp);</span></span>
<span><span class="co">#&gt;   rx_yj_ =2;</span></span>
<span><span class="co">#&gt;   rx_lambda_ =1;</span></span>
<span><span class="co">#&gt;   rx_low_ =0;</span></span>
<span><span class="co">#&gt;   rx_hi_ =1;</span></span>
<span><span class="co">#&gt;   rx_pred_f_ =pstar;</span></span>
<span><span class="co">#&gt;   rx_pred_ =rx_pred_f_;</span></span>
<span><span class="co">#&gt;   rx_r_ =Rx_pow((rx_pred_f_*prop_DoT_sd),2);</span></span>
<span><span class="co">#&gt;   ipredSim =rxTBSi(rx_pred_,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   sim =rxTBSi(rx_pred_+sqrt(rx_r_)*rxerr_DoT_pstar,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   __zzStateVar__[__DDT0__]=((double)(_ON[__DDT0__]))*(c);</span></span>
<span><span class="co">#&gt;   __zzStateVar__[__DDT1__]=((double)(_ON[__DDT1__]))*(pt);</span></span>
<span><span class="co">#&gt;   __zzStateVar__[__DDT2__]=((double)(_ON[__DDT2__]))*(q);</span></span>
<span><span class="co">#&gt;   __zzStateVar__[__DDT3__]=((double)(_ON[__DDT3__]))*(qp);</span></span>
<span><span class="co">#&gt;   __zzStateVar__[__DDT4__]=((double)(_ON[__DDT4__]))*(pstar);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // prj-specific derived vars</span></span>
<span><span class="co">#&gt; void rx_3b99e704ad485e28af0a8f4b4c34d40c__calc_lhs(int _cSub, double __t, double *__zzStateVar__, double *_lhs) {</span></span>
<span><span class="co">#&gt;     int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=11;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_0__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_1__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_2__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_3__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_4__;</span></span>
<span><span class="co">#&gt;   double k = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tkde = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_tkde = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tkpq = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_kpq = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tkqpp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_kqpp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tlambdap = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_lambdap = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tgamma = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_gamma = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tdeltaqp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_deltaqp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double prop_DoT_sd = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tpt0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_pt0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tq0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_q0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double pstar = NA_REAL;</span></span>
<span><span class="co">#&gt;   double kde = NA_REAL;</span></span>
<span><span class="co">#&gt;   double kpq = NA_REAL;</span></span>
<span><span class="co">#&gt;   double kqpp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double lambdap = NA_REAL;</span></span>
<span><span class="co">#&gt;   double _rxNotFun_gamma = NA_REAL;</span></span>
<span><span class="co">#&gt;   double deltaqp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double c = NA_REAL;</span></span>
<span><span class="co">#&gt;   double pt = NA_REAL;</span></span>
<span><span class="co">#&gt;   double qp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double q = NA_REAL;</span></span>
<span><span class="co">#&gt;   double pt0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double q0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_yj___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_lambda___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_low___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_hi___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_f_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_r_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double ipredSim = NA_REAL;</span></span>
<span><span class="co">#&gt;   double sim = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rxerr_DoT_pstar = NA_REAL;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_0__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_1__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_2__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_3__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_4__;</span></span>
<span><span class="co">#&gt;   (void)k;</span></span>
<span><span class="co">#&gt;   (void)tkde;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_tkde;</span></span>
<span><span class="co">#&gt;   (void)tkpq;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_kpq;</span></span>
<span><span class="co">#&gt;   (void)tkqpp;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_kqpp;</span></span>
<span><span class="co">#&gt;   (void)tlambdap;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_lambdap;</span></span>
<span><span class="co">#&gt;   (void)tgamma;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_gamma;</span></span>
<span><span class="co">#&gt;   (void)tdeltaqp;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_deltaqp;</span></span>
<span><span class="co">#&gt;   (void)prop_DoT_sd;</span></span>
<span><span class="co">#&gt;   (void)tpt0;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_pt0;</span></span>
<span><span class="co">#&gt;   (void)tq0;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_q0;</span></span>
<span><span class="co">#&gt;   (void)pstar;</span></span>
<span><span class="co">#&gt;   (void)kde;</span></span>
<span><span class="co">#&gt;   (void)kpq;</span></span>
<span><span class="co">#&gt;   (void)kqpp;</span></span>
<span><span class="co">#&gt;   (void)lambdap;</span></span>
<span><span class="co">#&gt;   (void)_rxNotFun_gamma;</span></span>
<span><span class="co">#&gt;   (void)deltaqp;</span></span>
<span><span class="co">#&gt;   (void)c;</span></span>
<span><span class="co">#&gt;   (void)pt;</span></span>
<span><span class="co">#&gt;   (void)qp;</span></span>
<span><span class="co">#&gt;   (void)q;</span></span>
<span><span class="co">#&gt;   (void)pt0;</span></span>
<span><span class="co">#&gt;   (void)q0;</span></span>
<span><span class="co">#&gt;   (void)rx_yj___;</span></span>
<span><span class="co">#&gt;   (void)rx_lambda___;</span></span>
<span><span class="co">#&gt;   (void)rx_low___;</span></span>
<span><span class="co">#&gt;   (void)rx_hi___;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_f_;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_;</span></span>
<span><span class="co">#&gt;   (void)rx_r_;</span></span>
<span><span class="co">#&gt;   (void)ipredSim;</span></span>
<span><span class="co">#&gt;   (void)sim;</span></span>
<span><span class="co">#&gt;   (void)rxerr_DoT_pstar;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   pstar = _PL[0];</span></span>
<span><span class="co">#&gt;   ipredSim = _PL[1];</span></span>
<span><span class="co">#&gt;   sim = _PL[2];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _update_par_ptr(__t, _cSub, _solveData, _idx);</span></span>
<span><span class="co">#&gt;   k = _PP[0];</span></span>
<span><span class="co">#&gt;   tkde = _PP[1];</span></span>
<span><span class="co">#&gt;   eta_DoT_tkde = _PP[2];</span></span>
<span><span class="co">#&gt;   tkpq = _PP[3];</span></span>
<span><span class="co">#&gt;   eta_DoT_kpq = _PP[4];</span></span>
<span><span class="co">#&gt;   tkqpp = _PP[5];</span></span>
<span><span class="co">#&gt;   eta_DoT_kqpp = _PP[6];</span></span>
<span><span class="co">#&gt;   tlambdap = _PP[7];</span></span>
<span><span class="co">#&gt;   eta_DoT_lambdap = _PP[8];</span></span>
<span><span class="co">#&gt;   tgamma = _PP[9];</span></span>
<span><span class="co">#&gt;   eta_DoT_gamma = _PP[10];</span></span>
<span><span class="co">#&gt;   tdeltaqp = _PP[11];</span></span>
<span><span class="co">#&gt;   eta_DoT_deltaqp = _PP[12];</span></span>
<span><span class="co">#&gt;   prop_DoT_sd = _PP[13];</span></span>
<span><span class="co">#&gt;   tpt0 = _PP[14];</span></span>
<span><span class="co">#&gt;   eta_DoT_pt0 = _PP[15];</span></span>
<span><span class="co">#&gt;   tq0 = _PP[16];</span></span>
<span><span class="co">#&gt;   eta_DoT_q0 = _PP[17];</span></span>
<span><span class="co">#&gt;   rxerr_DoT_pstar = _PP[18];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   c = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">#&gt;   pt = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">#&gt;   q = __zzStateVar__[__DDT2__]*((double)(_ON[__DDT2__]));</span></span>
<span><span class="co">#&gt;   qp = __zzStateVar__[__DDT3__]*((double)(_ON[__DDT3__]));</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   kde =tkde*exp(eta_DoT_tkde);</span></span>
<span><span class="co">#&gt;   kpq =tkpq*exp(eta_DoT_kpq);</span></span>
<span><span class="co">#&gt;   kqpp =tkqpp*exp(eta_DoT_kqpp);</span></span>
<span><span class="co">#&gt;   lambdap =tlambdap*exp(eta_DoT_lambdap);</span></span>
<span><span class="co">#&gt;   _rxNotFun_gamma =tgamma*exp(eta_DoT_gamma);</span></span>
<span><span class="co">#&gt;   deltaqp =tdeltaqp*exp(eta_DoT_deltaqp);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_0__ = ((double)(_ON[__DDT0__]))*(_IR[__DDT0__] -kde*c);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_1__ = ((double)(_ON[__DDT1__]))*(_IR[__DDT1__] + lambdap*pt*(1-pstar/_div0(k))+kqpp*qp-kpq*pt-_rxNotFun_gamma*c*kde*pt);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_2__ = ((double)(_ON[__DDT2__]))*(_IR[__DDT2__] + kpq*pt-_rxNotFun_gamma*c*kde*q);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_3__ = ((double)(_ON[__DDT3__]))*(_IR[__DDT3__] + _rxNotFun_gamma*c*kde*q-kqpp*qp-deltaqp*qp);</span></span>
<span><span class="co">#&gt;   pt0 =tpt0*exp(eta_DoT_pt0);</span></span>
<span><span class="co">#&gt;   q0 =tq0*exp(eta_DoT_q0);</span></span>
<span><span class="co">#&gt;   pstar =(pt+q+qp);</span></span>
<span><span class="co">#&gt;   rx_yj_ =2;</span></span>
<span><span class="co">#&gt;   rx_lambda_ =1;</span></span>
<span><span class="co">#&gt;   rx_low_ =0;</span></span>
<span><span class="co">#&gt;   rx_hi_ =1;</span></span>
<span><span class="co">#&gt;   rx_pred_f_ =pstar;</span></span>
<span><span class="co">#&gt;   rx_pred_ =rx_pred_f_;</span></span>
<span><span class="co">#&gt;   rx_r_ =Rx_pow((rx_pred_f_*prop_DoT_sd),2);</span></span>
<span><span class="co">#&gt;   ipredSim =rxTBSi(rx_pred_,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   sim =rxTBSi(rx_pred_+sqrt(rx_r_)*rxerr_DoT_pstar,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _lhs[_LHS_0_]=pstar;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_1_]=ipredSim;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_2_]=sim;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Functional based bioavailability</span></span>
<span><span class="co">#&gt; double rx_3b99e704ad485e28af0a8f4b4c34d40c__F(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return _amt;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; // Functional based absorption lag</span></span>
<span><span class="co">#&gt; double rx_3b99e704ad485e28af0a8f4b4c34d40c__Lag(int _cSub,  int _cmt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return __t;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Modeled zero-order rate</span></span>
<span><span class="co">#&gt; double rx_3b99e704ad485e28af0a8f4b4c34d40c__Rate(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return 0.0;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Modeled zero-order duration</span></span>
<span><span class="co">#&gt; double rx_3b99e704ad485e28af0a8f4b4c34d40c__Dur(int _cSub,  int _cmt, double _amt, double __t){</span></span>
<span><span class="co">#&gt;  return 0.0;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Model Times</span></span>
<span><span class="co">#&gt; void rx_3b99e704ad485e28af0a8f4b4c34d40c__mtime(int _cSub, double *_mtime){</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Matrix Exponential (0)</span></span>
<span><span class="co">#&gt; void rx_3b99e704ad485e28af0a8f4b4c34d40c__ME(int _cSub, double _t, double __t, double *_mat, const double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=9;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Inductive linearization Matf</span></span>
<span><span class="co">#&gt; void rx_3b99e704ad485e28af0a8f4b4c34d40c__IndF(int _cSub, double _t, double __t, double *_matf){</span></span>
<span><span class="co">#&gt;  int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=10;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern SEXP rx_3b99e704ad485e28af0a8f4b4c34d40c__model_vars(void){</span></span>
<span><span class="co">#&gt;   int pro=0;</span></span>
<span><span class="co">#&gt;   SEXP _mv = PROTECT(_rxGetModelLib("rx_3b99e704ad485e28af0a8f4b4c34d40c__model_vars"));pro++;</span></span>
<span><span class="co">#&gt;   if (!_rxIsCurrentC(_mv)){</span></span>
<span><span class="co">#&gt;     SEXP hash    = PROTECT(Rf_allocVector(STRSXP, 1));pro++;</span></span>
<span><span class="co">#&gt; #define __doBuf__  snprintf(buf, __doBufN__, "un]\"BAAA@QRtHACAAAAAAA5F`AAAv7#aT){+&amp;KVA3H%%5@CI772rIaEGCCe8og&lt;[]G29IL+T7DKgu5zXHJQ7!`!WgF=ITbm6o6=n&gt;068DW}bsE9XmN$M=B_rs,1}K7&gt;JXXAJB.IXrC7BsI~\"tM|s_BVkYj7]4^}#vx+vQpk\?7~=Pa!JCMaH@l~qG~{(QNx;}ybp6wE21Ja{zLn&amp;}{ewPdN`8:%%wn1t;}VuU}1t71)q;#{%%)Ps^xBkFT[ZA1$(c$buKFtVjG:F}&amp;I$I@dq;[iaYND}FUqRtYXu^~#*&amp;](yXNc9&amp;@b0FoU+Ba}ioY\?a3{i3Vnlo*]`r_D5,68G(ax,)r0)X#Rh|IRW446f|mXxuxtvZ2DAu%%F{hLLgLYL1.l=JHEezpK@|^IZ@j,U)FCJ5mzp~FzCS$Ega&lt;WkSQz.2n;K7oA#CU)~(Pj)g,wq6{{G=Tz)EvXUg`5eBhx|@2S%%[j7/E8xR!;ar6n9jtb=x2n@*/$zIhy|T]\?\"iQCjetb8n%%^+0a[Sv1)aiNR0IaEOv@Dof)pMARH_FT*yKe7C::PqSJ@|yii0,gS]Oa7JTxl\?\"X(!x9q,Fy1&amp;kWNZrS}e*zqctKVYwa__J/KEiTY2d:6Yp~F=0Ozz!zDI,pxFa.R5Bo&gt;=O27r#G@xz*7ds&lt;bxk{pW=J1/bD+1$tn&amp;l1$A!Hi#y{fW4F%%x0J19b&amp;_FnD&gt;ALKMKY#ZC&lt;{ODzEMR903`kVwpd0%%|[/354WurE23=bDQ&lt;l]]v,0mwMmT\?k)IW&lt;=L]a,8j#d0@WI2nS6:c&gt;48hF7.=&gt;Kr@+((j~7k*k*abx2wWXw+mxc@TXy#M`oeU!*\?}#kH2n&lt;R/Z^F(]3&amp;b9G}!`*jj)g,){L\"EQ+ES{~eV5suD}1!Y;_C@sz)(`IlBc6MJ@DWTusr.{]]glIuQ&gt;rtZWa:Q+b{*\?X@m&amp;LRPyml.;zwB$k[\"M1|wbd1H5,9ZW.|)&gt;TTDP(e6Ln$G@#RimyfXWuHb&amp;;56E!x1^WvZn\?8(ALkI[b$N=u6v:jPgm]CGCeLK1MML*#kJVEAGOJb.DLi8k84h6Y!##6UX*V]_N9bIWZWhn{cmi#.^,ca&amp;rs~H:6&amp;U;ENMHMci7{B@WTj)M:IiZ)y5xCt$WTHLm#CKty67EroAYiG$Ylt!yeGXwb;r#H{&lt;P)WrR+AP7Yres9u4Ft1eZXi^D*Hg@h+nR{RbTvm]}l~0e&gt;/VUQo\"&amp;sBrbbhS&gt;)\?V/T0R!aL$ZI)0EjfHy*#0VM6J&amp;]KkiM|y]ik1+h,r!n$_JQW;*MJQ7&amp;@GU2UBEmD}/)B;&gt;dvUenq;.:/q\?IAwbS9O+(i#=(:vLE22;(VG&lt;6n9FaG%%[bx_5x|@G@w~tc\?;q&amp;t|jn5&lt;&amp;(FC&amp;nyj_[AmE#LT0tp#_~JnNd11e,4|UPODeMSs;zGTR8gt8Wh&gt;Em&lt;WEIYrzHbkp~JI&amp;Jev84`+S#)+zP0FT}9t7f!OEDp1Uz\?2P|A!C&lt;,kO(+x]Vr}J!owU@i{rVJ]x[WJH}fSeAHQb{i3T9UH\?&lt;)l$uYRZW51@_PrW#=:38s5bVI`+@Mpk3K*(AM4u~EBws4CCMi0G7W#yX3_uaoJarc,M!zxFH41|G97a\"`M9Yp;Q_&gt;IR3nhtYE%%oOw}=T&amp;qcvg{t&amp;VG]UOlQNaT@Q}*}l\";A/5^]ENN}M&gt;%%YyB;ubp$^D{AC9HG(~+_H#dF6@l@\?&lt;we4[CuB(K\?/#pfEHWOO&gt;LN!y13uX{Z4Pb1P");</span></span>
<span><span class="co">#&gt;     char buf[1718];</span></span>
<span><span class="co">#&gt; #define __doBufN__ 1718</span></span>
<span><span class="co">#&gt;     __doBuf__</span></span>
<span><span class="co">#&gt; #undef __doBuf__</span></span>
<span><span class="co">#&gt; #undef __doBufN__</span></span>
<span><span class="co">#&gt;     SET_STRING_ELT(hash, 0, Rf_mkChar(buf));</span></span>
<span><span class="co">#&gt;     SEXP lst      = PROTECT(_rxQr(hash));pro++;</span></span>
<span><span class="co">#&gt;     _assign_ptr(lst);</span></span>
<span><span class="co">#&gt;     UNPROTECT(pro);</span></span>
<span><span class="co">#&gt;     return lst;</span></span>
<span><span class="co">#&gt;   } else {</span></span>
<span><span class="co">#&gt;     UNPROTECT(pro);</span></span>
<span><span class="co">#&gt;     return _mv;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void rx_3b99e704ad485e28af0a8f4b4c34d40c__dydt_lsoda(int *neq, double *t, double *A, double *DADT)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   rx_3b99e704ad485e28af0a8f4b4c34d40c__dydt(neq, *t, A, DADT);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern int rx_3b99e704ad485e28af0a8f4b4c34d40c__dydt_liblsoda(double __t, double *y, double *ydot, void *data)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   int *neq = (int*)(data);</span></span>
<span><span class="co">#&gt;   rx_3b99e704ad485e28af0a8f4b4c34d40c__dydt(neq, __t, y, ydot);</span></span>
<span><span class="co">#&gt;   return(0);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void rx_3b99e704ad485e28af0a8f4b4c34d40c__calc_jac_lsoda(int *neq, double *t, double *A,int *ml, int *mu, double *JAC, int *nrowpd){</span></span>
<span><span class="co">#&gt;   // Update all covariate parameters</span></span>
<span><span class="co">#&gt;   rx_3b99e704ad485e28af0a8f4b4c34d40c__calc_jac(neq, *t, A, JAC, *nrowpd);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; //Create function to call from R's main thread that assigns the required functions. Sometimes they don't get assigned.</span></span>
<span><span class="co">#&gt; extern void rx_3b99e704ad485e28af0a8f4b4c34d40c__assignFuns(void){</span></span>
<span><span class="co">#&gt;   _assignFuns();</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; //Initialize the dll to match rxode2's calls</span></span>
<span><span class="co">#&gt; void R_init0_rx_3b99e704ad485e28af0a8f4b4c34d40c_(void){</span></span>
<span><span class="co">#&gt;   // Get C callables on load; Otherwise it isn't thread safe</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_3b99e704ad485e28af0a8f4b4c34d40c_","rx_3b99e704ad485e28af0a8f4b4c34d40c__assignFuns2", (DL_FUNC) __assignFuns2);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_3b99e704ad485e28af0a8f4b4c34d40c_","rx_3b99e704ad485e28af0a8f4b4c34d40c__assignFuns", (DL_FUNC) rx_3b99e704ad485e28af0a8f4b4c34d40c__assignFuns);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_3b99e704ad485e28af0a8f4b4c34d40c_","rx_3b99e704ad485e28af0a8f4b4c34d40c__inis",(DL_FUNC) rx_3b99e704ad485e28af0a8f4b4c34d40c__inis);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_3b99e704ad485e28af0a8f4b4c34d40c_","rx_3b99e704ad485e28af0a8f4b4c34d40c__dydt",(DL_FUNC) rx_3b99e704ad485e28af0a8f4b4c34d40c__dydt);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_3b99e704ad485e28af0a8f4b4c34d40c_","rx_3b99e704ad485e28af0a8f4b4c34d40c__calc_lhs",(DL_FUNC) rx_3b99e704ad485e28af0a8f4b4c34d40c__calc_lhs);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_3b99e704ad485e28af0a8f4b4c34d40c_","rx_3b99e704ad485e28af0a8f4b4c34d40c__calc_jac",(DL_FUNC) rx_3b99e704ad485e28af0a8f4b4c34d40c__calc_jac);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_3b99e704ad485e28af0a8f4b4c34d40c_","rx_3b99e704ad485e28af0a8f4b4c34d40c__dydt_lsoda", (DL_FUNC) rx_3b99e704ad485e28af0a8f4b4c34d40c__dydt_lsoda);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_3b99e704ad485e28af0a8f4b4c34d40c_","rx_3b99e704ad485e28af0a8f4b4c34d40c__calc_jac_lsoda", (DL_FUNC) rx_3b99e704ad485e28af0a8f4b4c34d40c__calc_jac_lsoda);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_3b99e704ad485e28af0a8f4b4c34d40c_","rx_3b99e704ad485e28af0a8f4b4c34d40c__ode_solver_solvedata", (DL_FUNC) rx_3b99e704ad485e28af0a8f4b4c34d40c__ode_solver_solvedata);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_3b99e704ad485e28af0a8f4b4c34d40c_","rx_3b99e704ad485e28af0a8f4b4c34d40c__ode_solver_get_solvedata", (DL_FUNC) rx_3b99e704ad485e28af0a8f4b4c34d40c__ode_solver_get_solvedata);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_3b99e704ad485e28af0a8f4b4c34d40c_","rx_3b99e704ad485e28af0a8f4b4c34d40c__F", (DL_FUNC) rx_3b99e704ad485e28af0a8f4b4c34d40c__F);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_3b99e704ad485e28af0a8f4b4c34d40c_","rx_3b99e704ad485e28af0a8f4b4c34d40c__Lag", (DL_FUNC) rx_3b99e704ad485e28af0a8f4b4c34d40c__Lag);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_3b99e704ad485e28af0a8f4b4c34d40c_","rx_3b99e704ad485e28af0a8f4b4c34d40c__Rate", (DL_FUNC) rx_3b99e704ad485e28af0a8f4b4c34d40c__Rate);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_3b99e704ad485e28af0a8f4b4c34d40c_","rx_3b99e704ad485e28af0a8f4b4c34d40c__Dur", (DL_FUNC) rx_3b99e704ad485e28af0a8f4b4c34d40c__Dur);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_3b99e704ad485e28af0a8f4b4c34d40c_","rx_3b99e704ad485e28af0a8f4b4c34d40c__mtime", (DL_FUNC) rx_3b99e704ad485e28af0a8f4b4c34d40c__mtime);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_3b99e704ad485e28af0a8f4b4c34d40c_","rx_3b99e704ad485e28af0a8f4b4c34d40c__ME", (DL_FUNC) rx_3b99e704ad485e28af0a8f4b4c34d40c__ME);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_3b99e704ad485e28af0a8f4b4c34d40c_","rx_3b99e704ad485e28af0a8f4b4c34d40c__IndF", (DL_FUNC) rx_3b99e704ad485e28af0a8f4b4c34d40c__IndF);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_3b99e704ad485e28af0a8f4b4c34d40c_","rx_3b99e704ad485e28af0a8f4b4c34d40c__dydt_liblsoda", (DL_FUNC) rx_3b99e704ad485e28af0a8f4b4c34d40c__dydt_liblsoda);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; //Initialize the dll to match rxode2's calls</span></span>
<span><span class="co">#&gt; void R_init_rx_3b99e704ad485e28af0a8f4b4c34d40c_(DllInfo *info){</span></span>
<span><span class="co">#&gt;   // Get C callables on load; Otherwise it isn't thread safe</span></span>
<span><span class="co">#&gt;   R_init0_rx_3b99e704ad485e28af0a8f4b4c34d40c_();</span></span>
<span><span class="co">#&gt;   static const R_CallMethodDef callMethods[]  = {</span></span>
<span><span class="co">#&gt;     {"rx_3b99e704ad485e28af0a8f4b4c34d40c__model_vars", (DL_FUNC) &amp;rx_3b99e704ad485e28af0a8f4b4c34d40c__model_vars, 0},</span></span>
<span><span class="co">#&gt;     {NULL, NULL, 0}</span></span>
<span><span class="co">#&gt;   };</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   R_registerRoutines(info, NULL, callMethods, NULL, NULL);</span></span>
<span><span class="co">#&gt;   R_useDynamicSymbols(info,FALSE);</span></span>
<span><span class="co">#&gt;   _assignFuns0();</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; void R_unload_rx_3b99e704ad485e28af0a8f4b4c34d40c_ (DllInfo *info){</span></span>
<span><span class="co">#&gt;   // Free resources required for single subject solve.</span></span>
<span><span class="co">#&gt;   SEXP _mv = PROTECT(_rxGetModelLib("rx_3b99e704ad485e28af0a8f4b4c34d40c__model_vars"));</span></span>
<span><span class="co">#&gt;   if (!Rf_isNull(_mv)){</span></span>
<span><span class="co">#&gt;     _rxRmModelLib("rx_3b99e704ad485e28af0a8f4b4c34d40c__model_vars");</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   UNPROTECT(1);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’</span></span></code></pre></div>
<p><img src="rxode2-pipeline_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="simulating-multiple-subjects-from-a-single-event-table">Simulating multiple subjects from a single event table<a class="anchor" aria-label="anchor" href="#simulating-multiple-subjects-from-a-single-event-table"></a>
</h2>
<div class="section level3">
<h3 id="simulating-with-between-subject-variability">Simulating with between subject variability<a class="anchor" aria-label="anchor" href="#simulating-with-between-subject-variability"></a>
</h3>
<p>The next sort of simulation that may be useful is simulating multiple
patients with the same treatments. In this case, we will use the
<code>omega</code> matrix specified by the paper:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Add CVs from paper for individual simulation</span></span>
<span><span class="co">## Uses exact formula:</span></span>
<span></span>
<span><span class="va">lognCv</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">}</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlmixr2.github.io/lotri/" class="external-link">lotri</a></span><span class="op">)</span></span>
<span><span class="co">## Now create omega matrix</span></span>
<span><span class="co">## I'm using lotri to quickly specify names/diagonals</span></span>
<span><span class="va">omega</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://nlmixr2.github.io/lotri/reference/lotri.html" class="external-link">lotri</a></span><span class="op">(</span><span class="va">eta.pt0</span> <span class="op">~</span> <span class="fu">lognCv</span><span class="op">(</span><span class="fl">94</span><span class="op">)</span>,</span>
<span>               <span class="va">eta.q0</span> <span class="op">~</span> <span class="fu">lognCv</span><span class="op">(</span><span class="fl">54</span><span class="op">)</span>,</span>
<span>               <span class="va">eta.lambdap</span> <span class="op">~</span> <span class="fu">lognCv</span><span class="op">(</span><span class="fl">72</span><span class="op">)</span>,</span>
<span>               <span class="va">eta.kqp</span> <span class="op">~</span> <span class="fu">lognCv</span><span class="op">(</span><span class="fl">76</span><span class="op">)</span>,</span>
<span>               <span class="va">eta.kqpp</span> <span class="op">~</span> <span class="fu">lognCv</span><span class="op">(</span><span class="fl">97</span><span class="op">)</span>,</span>
<span>               <span class="va">eta.deltaqp</span> <span class="op">~</span> <span class="fu">lognCv</span><span class="op">(</span><span class="fl">115</span><span class="op">)</span>,</span>
<span>               <span class="va">eta.tkde</span> <span class="op">~</span> <span class="fu">lognCv</span><span class="op">(</span><span class="fl">70</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">omega</span></span>
<span><span class="co">#&gt;               eta.pt0    eta.q0 eta.lambdap   eta.kqp  eta.kqpp eta.deltaqp</span></span>
<span><span class="co">#&gt; eta.pt0     0.6331848 0.0000000   0.0000000 0.0000000 0.0000000   0.0000000</span></span>
<span><span class="co">#&gt; eta.q0      0.0000000 0.2558818   0.0000000 0.0000000 0.0000000   0.0000000</span></span>
<span><span class="co">#&gt; eta.lambdap 0.0000000 0.0000000   0.4176571 0.0000000 0.0000000   0.0000000</span></span>
<span><span class="co">#&gt; eta.kqp     0.0000000 0.0000000   0.0000000 0.4559047 0.0000000   0.0000000</span></span>
<span><span class="co">#&gt; eta.kqpp    0.0000000 0.0000000   0.0000000 0.0000000 0.6631518   0.0000000</span></span>
<span><span class="co">#&gt; eta.deltaqp 0.0000000 0.0000000   0.0000000 0.0000000 0.0000000   0.8426442</span></span>
<span><span class="co">#&gt; eta.tkde    0.0000000 0.0000000   0.0000000 0.0000000 0.0000000   0.0000000</span></span>
<span><span class="co">#&gt;              eta.tkde</span></span>
<span><span class="co">#&gt; eta.pt0     0.0000000</span></span>
<span><span class="co">#&gt; eta.q0      0.0000000</span></span>
<span><span class="co">#&gt; eta.lambdap 0.0000000</span></span>
<span><span class="co">#&gt; eta.kqp     0.0000000</span></span>
<span><span class="co">#&gt; eta.kqpp    0.0000000</span></span>
<span><span class="co">#&gt; eta.deltaqp 0.0000000</span></span>
<span><span class="co">#&gt; eta.tkde    0.3987761</span></span></code></pre></div>
<p>With this information, it is easy to simulate 3 subjects from the
model-based parameters:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1089</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/rxSetSeed.html">rxSetSeed</a></span><span class="op">(</span><span class="fl">1089</span><span class="op">)</span></span>
<span><span class="va">Ribba2012</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Use rxode2</span></span>
<span>    <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>time.units<span class="op">=</span><span class="st">"months"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Pipe to a new event table</span></span>
<span>    <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>amt<span class="op">=</span><span class="fl">1</span>, time<span class="op">=</span><span class="fl">50</span>, until<span class="op">=</span><span class="fl">58</span>, ii<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Add dosing every 1.5 months</span></span>
<span>    <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">250</span>, by<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Add some sampling times (not required)</span></span>
<span>    <span class="fu"><a href="../reference/rxSolve.html">rxSolve</a></span><span class="op">(</span>nSub<span class="op">=</span><span class="fl">3</span>, omega<span class="op">=</span><span class="va">omega</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Solve the simulation</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pt</span>, <span class="va">q</span>, <span class="va">qp</span>, <span class="va">pstar</span><span class="op">)</span> <span class="co"># Plot it, plotting the variables of interest</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> parameter labels from comments are typically ignored in non-interactive mode</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Need to run with the source intact to parse comments</span></span>
<span><span class="co">#&gt; C model:</span></span>
<span><span class="co">#&gt; // Define translation state order for 5 states</span></span>
<span><span class="co">#&gt; #define __DDT0__ 0 // c</span></span>
<span><span class="co">#&gt; #define __DDT1__ 1 // pt</span></span>
<span><span class="co">#&gt; #define __DDT2__ 2 // q</span></span>
<span><span class="co">#&gt; #define __DDT3__ 3 // qp</span></span>
<span><span class="co">#&gt; #define __DDT4__ 4 // NA</span></span>
<span><span class="co">#&gt; // Define 3 LHS values</span></span>
<span><span class="co">#&gt; #define _LHS_0_ 0 // pstar</span></span>
<span><span class="co">#&gt; #define _LHS_1_ 1 // ipredSim</span></span>
<span><span class="co">#&gt; #define _LHS_2_ 2 // sim</span></span>
<span><span class="co">#&gt; #define _getRxSolve_ _rx2dad12da46c7b4405a36d3bb84fc2e7c143__getRxSolve__PtVr</span></span>
<span><span class="co">#&gt; #define _evalUdf _rx2dad12da46c7b4405a36d3bb84fc2e7c144__evalUdf_Qt1y</span></span>
<span><span class="co">#&gt; #define _solveData _rx2dad12da46c7b4405a36d3bb84fc2e7c145__solveData_0fG3</span></span>
<span><span class="co">#&gt; #define _assign_ptr _rx2dad12da46c7b4405a36d3bb84fc2e7c146__assign_ptr_uwgI</span></span>
<span><span class="co">#&gt; #define _rxRmModelLib _rx2dad12da46c7b4405a36d3bb84fc2e7c147__rxRmModelLib_SCRR</span></span>
<span><span class="co">#&gt; #define _rxGetModelLib _rx2dad12da46c7b4405a36d3bb84fc2e7c148__rxGetModelLib_uvgp</span></span>
<span><span class="co">#&gt; #define _old_c _rx2dad12da46c7b4405a36d3bb84fc2e7c149__old_c_N7Nk</span></span>
<span><span class="co">#&gt; #define _ptrid _rx2dad12da46c7b4405a36d3bb84fc2e7c150__ptrid_HXeN</span></span>
<span><span class="co">#&gt; #define _rxIsCurrentC _rx2dad12da46c7b4405a36d3bb84fc2e7c151__rxIsCurrentC_cQco</span></span>
<span><span class="co">#&gt; #define _sumPS _rx2dad12da46c7b4405a36d3bb84fc2e7c152__sumPS_Fd0T</span></span>
<span><span class="co">#&gt; #define _prodPS _rx2dad12da46c7b4405a36d3bb84fc2e7c153__prodPS_JjUv</span></span>
<span><span class="co">#&gt; #define _prodType _rx2dad12da46c7b4405a36d3bb84fc2e7c154__prodType_8TjL</span></span>
<span><span class="co">#&gt; #define _sumType _rx2dad12da46c7b4405a36d3bb84fc2e7c155__sumType_cKNd</span></span>
<span><span class="co">#&gt; #define _update_par_ptr _rx2dad12da46c7b4405a36d3bb84fc2e7c156__update_par_ptr_tFTb</span></span>
<span><span class="co">#&gt; #define _getParCov _rx2dad12da46c7b4405a36d3bb84fc2e7c157__getParCov_qntF</span></span>
<span><span class="co">#&gt; #define _rxode2_rxAssignPtr _rx2dad12da46c7b4405a36d3bb84fc2e7c158__rxode2_rxAssignPtr_vGHM</span></span>
<span><span class="co">#&gt; #define _rxQr _rx2dad12da46c7b4405a36d3bb84fc2e7c159__rxQr_NOlZ</span></span>
<span><span class="co">#&gt; #define _compareFactorVal _rx2dad12da46c7b4405a36d3bb84fc2e7c160__compareFactorVal_DXZc</span></span>
<span><span class="co">#&gt; #define _sum _rx2dad12da46c7b4405a36d3bb84fc2e7c161__sum_fkj5</span></span>
<span><span class="co">#&gt; #define _udf _rx2dad12da46c7b4405a36d3bb84fc2e7c162__udf_TGXh</span></span>
<span><span class="co">#&gt; #define _sign _rx2dad12da46c7b4405a36d3bb84fc2e7c163__sign_bKjj</span></span>
<span><span class="co">#&gt; #define _prod _rx2dad12da46c7b4405a36d3bb84fc2e7c164__prod_GEjR</span></span>
<span><span class="co">#&gt; #define _max _rx2dad12da46c7b4405a36d3bb84fc2e7c165__max_kUH1</span></span>
<span><span class="co">#&gt; #define _min _rx2dad12da46c7b4405a36d3bb84fc2e7c166__min_s7he</span></span>
<span><span class="co">#&gt; #define _transit4P _rx2dad12da46c7b4405a36d3bb84fc2e7c167__transit4P_xLYF</span></span>
<span><span class="co">#&gt; #define _transit3P _rx2dad12da46c7b4405a36d3bb84fc2e7c168__transit3P_8KXs</span></span>
<span><span class="co">#&gt; #define _assignFuns0 _rx2dad12da46c7b4405a36d3bb84fc2e7c169__assignFuns0_URHw</span></span>
<span><span class="co">#&gt; #define _assignFuns _rx2dad12da46c7b4405a36d3bb84fc2e7c170__assignFuns_qJRZ</span></span>
<span><span class="co">#&gt; #define _rxord _rx2dad12da46c7b4405a36d3bb84fc2e7c171__rxord_HqO3</span></span>
<span><span class="co">#&gt; #define __assignFuns2 _rx2dad12da46c7b4405a36d3bb84fc2e7c172___assignFuns2_Vofw</span></span>
<span><span class="co">#&gt; #define _llikCauchyDscale _rx2dad12da46c7b4405a36d3bb84fc2e7c173__llikCauchyDscale_R1KH</span></span>
<span><span class="co">#&gt; #define _llikCauchyDlocation _rx2dad12da46c7b4405a36d3bb84fc2e7c174__llikCauchyDlocation_Eocy</span></span>
<span><span class="co">#&gt; #define _llikCauchy _rx2dad12da46c7b4405a36d3bb84fc2e7c175__llikCauchy_KZc2</span></span>
<span><span class="co">#&gt; #define _llikGammaDrate _rx2dad12da46c7b4405a36d3bb84fc2e7c176__llikGammaDrate_L56Z</span></span>
<span><span class="co">#&gt; #define _llikGammaDshape _rx2dad12da46c7b4405a36d3bb84fc2e7c177__llikGammaDshape_KHWD</span></span>
<span><span class="co">#&gt; #define _llikGamma _rx2dad12da46c7b4405a36d3bb84fc2e7c178__llikGamma_Azol</span></span>
<span><span class="co">#&gt; #define _llikWeibullDscale _rx2dad12da46c7b4405a36d3bb84fc2e7c179__llikWeibullDscale_EkJD</span></span>
<span><span class="co">#&gt; #define _llikWeibullDshape _rx2dad12da46c7b4405a36d3bb84fc2e7c180__llikWeibullDshape_3mpP</span></span>
<span><span class="co">#&gt; #define _llikWeibull _rx2dad12da46c7b4405a36d3bb84fc2e7c181__llikWeibull_BQ9P</span></span>
<span><span class="co">#&gt; #define _llikUnifDbeta _rx2dad12da46c7b4405a36d3bb84fc2e7c182__llikUnifDbeta_u43V</span></span>
<span><span class="co">#&gt; #define _llikUnifDalpha _rx2dad12da46c7b4405a36d3bb84fc2e7c183__llikUnifDalpha_wHEX</span></span>
<span><span class="co">#&gt; #define _llikUnif _rx2dad12da46c7b4405a36d3bb84fc2e7c184__llikUnif_0UpU</span></span>
<span><span class="co">#&gt; #define _llikGeomDp _rx2dad12da46c7b4405a36d3bb84fc2e7c185__llikGeomDp_PVJb</span></span>
<span><span class="co">#&gt; #define _llikGeom _rx2dad12da46c7b4405a36d3bb84fc2e7c186__llikGeom_ZPrL</span></span>
<span><span class="co">#&gt; #define _llikFDdf2 _rx2dad12da46c7b4405a36d3bb84fc2e7c187__llikFDdf2_rWLj</span></span>
<span><span class="co">#&gt; #define _llikFDdf1 _rx2dad12da46c7b4405a36d3bb84fc2e7c188__llikFDdf1_nE8l</span></span>
<span><span class="co">#&gt; #define _llikF _rx2dad12da46c7b4405a36d3bb84fc2e7c189__llikF_zcVb</span></span>
<span><span class="co">#&gt; #define _llikExpDrate _rx2dad12da46c7b4405a36d3bb84fc2e7c190__llikExpDrate_bWuC</span></span>
<span><span class="co">#&gt; #define _llikExp _rx2dad12da46c7b4405a36d3bb84fc2e7c191__llikExp_pJEN</span></span>
<span><span class="co">#&gt; #define _llikChisqDdf _rx2dad12da46c7b4405a36d3bb84fc2e7c192__llikChisqDdf_hIaI</span></span>
<span><span class="co">#&gt; #define _llikChisq _rx2dad12da46c7b4405a36d3bb84fc2e7c193__llikChisq_XKPO</span></span>
<span><span class="co">#&gt; #define _llikTDsd _rx2dad12da46c7b4405a36d3bb84fc2e7c194__llikTDsd_hyq6</span></span>
<span><span class="co">#&gt; #define _llikTDmean _rx2dad12da46c7b4405a36d3bb84fc2e7c195__llikTDmean_3fhF</span></span>
<span><span class="co">#&gt; #define _llikTDdf _rx2dad12da46c7b4405a36d3bb84fc2e7c196__llikTDdf_6sOB</span></span>
<span><span class="co">#&gt; #define _llikT _rx2dad12da46c7b4405a36d3bb84fc2e7c197__llikT_vZl6</span></span>
<span><span class="co">#&gt; #define _llikBetaDshape2 _rx2dad12da46c7b4405a36d3bb84fc2e7c198__llikBetaDshape2_VCxm</span></span>
<span><span class="co">#&gt; #define _llikBetaDshape1 _rx2dad12da46c7b4405a36d3bb84fc2e7c199__llikBetaDshape1_gT0P</span></span>
<span><span class="co">#&gt; #define _llikBeta _rx2dad12da46c7b4405a36d3bb84fc2e7c200__llikBeta_JOTH</span></span>
<span><span class="co">#&gt; #define _llikNbinomMuDmu _rx2dad12da46c7b4405a36d3bb84fc2e7c201__llikNbinomMuDmu_dSfb</span></span>
<span><span class="co">#&gt; #define _llikNbinomMu _rx2dad12da46c7b4405a36d3bb84fc2e7c202__llikNbinomMu_Ejko</span></span>
<span><span class="co">#&gt; #define _llikNbinomDprob _rx2dad12da46c7b4405a36d3bb84fc2e7c203__llikNbinomDprob_cvAt</span></span>
<span><span class="co">#&gt; #define _llikNbinom _rx2dad12da46c7b4405a36d3bb84fc2e7c204__llikNbinom_NKjQ</span></span>
<span><span class="co">#&gt; #define _llikBinomDprob _rx2dad12da46c7b4405a36d3bb84fc2e7c205__llikBinomDprob_UtM6</span></span>
<span><span class="co">#&gt; #define _llikBinom _rx2dad12da46c7b4405a36d3bb84fc2e7c206__llikBinom_Aoah</span></span>
<span><span class="co">#&gt; #define _llikPoisDlambda _rx2dad12da46c7b4405a36d3bb84fc2e7c207__llikPoisDlambda_y3UQ</span></span>
<span><span class="co">#&gt; #define _llikPois _rx2dad12da46c7b4405a36d3bb84fc2e7c208__llikPois_LHyQ</span></span>
<span><span class="co">#&gt; #define _llikNormDsd _rx2dad12da46c7b4405a36d3bb84fc2e7c209__llikNormDsd_yudK</span></span>
<span><span class="co">#&gt; #define _llikNormDmean _rx2dad12da46c7b4405a36d3bb84fc2e7c210__llikNormDmean_vMv7</span></span>
<span><span class="co">#&gt; #define _llikNorm _rx2dad12da46c7b4405a36d3bb84fc2e7c211__llikNorm_Nqea</span></span>
<span><span class="co">#&gt; #define simeps _rx2dad12da46c7b4405a36d3bb84fc2e7c212_simeps_GSpX</span></span>
<span><span class="co">#&gt; #define simeta _rx2dad12da46c7b4405a36d3bb84fc2e7c213_simeta_lUSO</span></span>
<span><span class="co">#&gt; #define expit _rx2dad12da46c7b4405a36d3bb84fc2e7c214_expit_SAMi</span></span>
<span><span class="co">#&gt; #define logit _rx2dad12da46c7b4405a36d3bb84fc2e7c215_logit_X55i</span></span>
<span><span class="co">#&gt; #define gammapDer _rx2dad12da46c7b4405a36d3bb84fc2e7c216_gammapDer_TuFv</span></span>
<span><span class="co">#&gt; #define lowergamma _rx2dad12da46c7b4405a36d3bb84fc2e7c217_lowergamma_OUmq</span></span>
<span><span class="co">#&gt; #define uppergamma _rx2dad12da46c7b4405a36d3bb84fc2e7c218_uppergamma_iOQ5</span></span>
<span><span class="co">#&gt; #define gammaqInva _rx2dad12da46c7b4405a36d3bb84fc2e7c219_gammaqInva_avto</span></span>
<span><span class="co">#&gt; #define gammaqInv _rx2dad12da46c7b4405a36d3bb84fc2e7c220_gammaqInv_Xyll</span></span>
<span><span class="co">#&gt; #define gammapInva _rx2dad12da46c7b4405a36d3bb84fc2e7c221_gammapInva_KxRL</span></span>
<span><span class="co">#&gt; #define gammapInv _rx2dad12da46c7b4405a36d3bb84fc2e7c222_gammapInv_62I1</span></span>
<span><span class="co">#&gt; #define gammaq _rx2dad12da46c7b4405a36d3bb84fc2e7c223_gammaq_Ps9r</span></span>
<span><span class="co">#&gt; #define gammap _rx2dad12da46c7b4405a36d3bb84fc2e7c224_gammap_VKX1</span></span>
<span><span class="co">#&gt; #define phi _rx2dad12da46c7b4405a36d3bb84fc2e7c225_phi_TyhY</span></span>
<span><span class="co">#&gt; #define d2ELUa _rx2dad12da46c7b4405a36d3bb84fc2e7c226_d2ELUa_KFvn</span></span>
<span><span class="co">#&gt; #define dELUa _rx2dad12da46c7b4405a36d3bb84fc2e7c227_dELUa_SBnS</span></span>
<span><span class="co">#&gt; #define d2aELU _rx2dad12da46c7b4405a36d3bb84fc2e7c228_d2aELU_RNPm</span></span>
<span><span class="co">#&gt; #define d2ELU _rx2dad12da46c7b4405a36d3bb84fc2e7c229_d2ELU_C4iD</span></span>
<span><span class="co">#&gt; #define dELU _rx2dad12da46c7b4405a36d3bb84fc2e7c230_dELU_SX0F</span></span>
<span><span class="co">#&gt; #define ELU _rx2dad12da46c7b4405a36d3bb84fc2e7c231_ELU_onv5</span></span>
<span><span class="co">#&gt; #define dPReLUa1 _rx2dad12da46c7b4405a36d3bb84fc2e7c232_dPReLUa1_tNho</span></span>
<span><span class="co">#&gt; #define dPReLUa _rx2dad12da46c7b4405a36d3bb84fc2e7c233_dPReLUa_Is7E</span></span>
<span><span class="co">#&gt; #define dPReLU _rx2dad12da46c7b4405a36d3bb84fc2e7c234_dPReLU_pCoy</span></span>
<span><span class="co">#&gt; #define PReLU _rx2dad12da46c7b4405a36d3bb84fc2e7c235_PReLU_jBsh</span></span>
<span><span class="co">#&gt; #define dSwish _rx2dad12da46c7b4405a36d3bb84fc2e7c236_dSwish_DDFN</span></span>
<span><span class="co">#&gt; #define Swish _rx2dad12da46c7b4405a36d3bb84fc2e7c237_Swish_HRxB</span></span>
<span><span class="co">#&gt; #define dlReLU _rx2dad12da46c7b4405a36d3bb84fc2e7c238_dlReLU_okJH</span></span>
<span><span class="co">#&gt; #define lReLU _rx2dad12da46c7b4405a36d3bb84fc2e7c239_lReLU_Rnle</span></span>
<span><span class="co">#&gt; #define dSELU _rx2dad12da46c7b4405a36d3bb84fc2e7c240_dSELU_eU9x</span></span>
<span><span class="co">#&gt; #define SELU _rx2dad12da46c7b4405a36d3bb84fc2e7c241_SELU_kHso</span></span>
<span><span class="co">#&gt; #define d4softplus _rx2dad12da46c7b4405a36d3bb84fc2e7c242_d4softplus_tWb7</span></span>
<span><span class="co">#&gt; #define d3softplus _rx2dad12da46c7b4405a36d3bb84fc2e7c243_d3softplus_Lggc</span></span>
<span><span class="co">#&gt; #define d2softplus _rx2dad12da46c7b4405a36d3bb84fc2e7c244_d2softplus_qJ2j</span></span>
<span><span class="co">#&gt; #define dsoftplus _rx2dad12da46c7b4405a36d3bb84fc2e7c245_dsoftplus_uubC</span></span>
<span><span class="co">#&gt; #define softplus _rx2dad12da46c7b4405a36d3bb84fc2e7c246_softplus_2myJ</span></span>
<span><span class="co">#&gt; #define d4GELU _rx2dad12da46c7b4405a36d3bb84fc2e7c247_d4GELU_lelS</span></span>
<span><span class="co">#&gt; #define d3GELU _rx2dad12da46c7b4405a36d3bb84fc2e7c248_d3GELU_H51K</span></span>
<span><span class="co">#&gt; #define d2GELU _rx2dad12da46c7b4405a36d3bb84fc2e7c249_d2GELU_iasM</span></span>
<span><span class="co">#&gt; #define dGELU _rx2dad12da46c7b4405a36d3bb84fc2e7c250_dGELU_vaV4</span></span>
<span><span class="co">#&gt; #define GELU _rx2dad12da46c7b4405a36d3bb84fc2e7c251_GELU_E0M9</span></span>
<span><span class="co">#&gt; #define dReLU _rx2dad12da46c7b4405a36d3bb84fc2e7c252_dReLU_4dHo</span></span>
<span><span class="co">#&gt; #define ReLU _rx2dad12da46c7b4405a36d3bb84fc2e7c253_ReLU_lcBE</span></span>
<span><span class="co">#&gt; #define riweibull _rx2dad12da46c7b4405a36d3bb84fc2e7c254_riweibull_3tqq</span></span>
<span><span class="co">#&gt; #define riunif _rx2dad12da46c7b4405a36d3bb84fc2e7c255_riunif_HPy6</span></span>
<span><span class="co">#&gt; #define rit_ _rx2dad12da46c7b4405a36d3bb84fc2e7c256_rit__WfL8</span></span>
<span><span class="co">#&gt; #define ripois _rx2dad12da46c7b4405a36d3bb84fc2e7c257_ripois_GUfZ</span></span>
<span><span class="co">#&gt; #define ribeta _rx2dad12da46c7b4405a36d3bb84fc2e7c258_ribeta_GwK4</span></span>
<span><span class="co">#&gt; #define rigamma _rx2dad12da46c7b4405a36d3bb84fc2e7c259_rigamma_pqPj</span></span>
<span><span class="co">#&gt; #define rigeom _rx2dad12da46c7b4405a36d3bb84fc2e7c260_rigeom_loUS</span></span>
<span><span class="co">#&gt; #define rif _rx2dad12da46c7b4405a36d3bb84fc2e7c261_rif_3m10</span></span>
<span><span class="co">#&gt; #define riexp _rx2dad12da46c7b4405a36d3bb84fc2e7c262_riexp_JhDG</span></span>
<span><span class="co">#&gt; #define richisq _rx2dad12da46c7b4405a36d3bb84fc2e7c263_richisq_qhJW</span></span>
<span><span class="co">#&gt; #define ricauchy _rx2dad12da46c7b4405a36d3bb84fc2e7c264_ricauchy_mJ4L</span></span>
<span><span class="co">#&gt; #define rinbinomMu _rx2dad12da46c7b4405a36d3bb84fc2e7c265_rinbinomMu_DYPi</span></span>
<span><span class="co">#&gt; #define rinbinom _rx2dad12da46c7b4405a36d3bb84fc2e7c266_rinbinom_3eeo</span></span>
<span><span class="co">#&gt; #define ribinom _rx2dad12da46c7b4405a36d3bb84fc2e7c267_ribinom_O0bO</span></span>
<span><span class="co">#&gt; #define rinorm _rx2dad12da46c7b4405a36d3bb84fc2e7c268_rinorm_jsqw</span></span>
<span><span class="co">#&gt; #define rxweibull _rx2dad12da46c7b4405a36d3bb84fc2e7c269_rxweibull_sPQI</span></span>
<span><span class="co">#&gt; #define rxunif _rx2dad12da46c7b4405a36d3bb84fc2e7c270_rxunif_cHxA</span></span>
<span><span class="co">#&gt; #define rxt_ _rx2dad12da46c7b4405a36d3bb84fc2e7c271_rxt__r2me</span></span>
<span><span class="co">#&gt; #define rxpois _rx2dad12da46c7b4405a36d3bb84fc2e7c272_rxpois_iJIb</span></span>
<span><span class="co">#&gt; #define rxbeta _rx2dad12da46c7b4405a36d3bb84fc2e7c273_rxbeta_iwB3</span></span>
<span><span class="co">#&gt; #define rxgamma _rx2dad12da46c7b4405a36d3bb84fc2e7c274_rxgamma_BPxX</span></span>
<span><span class="co">#&gt; #define rxgeom _rx2dad12da46c7b4405a36d3bb84fc2e7c275_rxgeom_FpHG</span></span>
<span><span class="co">#&gt; #define rxf _rx2dad12da46c7b4405a36d3bb84fc2e7c276_rxf_ONzn</span></span>
<span><span class="co">#&gt; #define rxexp _rx2dad12da46c7b4405a36d3bb84fc2e7c277_rxexp_MVZR</span></span>
<span><span class="co">#&gt; #define rxchisq _rx2dad12da46c7b4405a36d3bb84fc2e7c278_rxchisq_AG3C</span></span>
<span><span class="co">#&gt; #define rxcauchy _rx2dad12da46c7b4405a36d3bb84fc2e7c279_rxcauchy_bFJa</span></span>
<span><span class="co">#&gt; #define rxnbinomMu _rx2dad12da46c7b4405a36d3bb84fc2e7c280_rxnbinomMu_NchH</span></span>
<span><span class="co">#&gt; #define rxnbinom _rx2dad12da46c7b4405a36d3bb84fc2e7c281_rxnbinom_j62I</span></span>
<span><span class="co">#&gt; #define rxbinom _rx2dad12da46c7b4405a36d3bb84fc2e7c282_rxbinom_uMnn</span></span>
<span><span class="co">#&gt; #define rxnorm _rx2dad12da46c7b4405a36d3bb84fc2e7c283_rxnorm_J4uF</span></span>
<span><span class="co">#&gt; #define linCmtB _rx2dad12da46c7b4405a36d3bb84fc2e7c284_linCmtB_pmtJ</span></span>
<span><span class="co">#&gt; #define linCmtA _rx2dad12da46c7b4405a36d3bb84fc2e7c285_linCmtA_v96j</span></span>
<span><span class="co">#&gt; #include &lt;rxode2_model_shared.h&gt;</span></span>
<span><span class="co">#&gt; #define __MAX_PROD__ 0</span></span>
<span><span class="co">#&gt; #define _CMT CMT</span></span>
<span><span class="co">#&gt; #define _SYNC_simeps_ for (int _svari=_solveData-&gt;neps; _svari--;){  if (_solveData-&gt;svar[_svari] == 0) {k = _PP[0];};   if (_solveData-&gt;svar[_svari] == 1) {tkde = _PP[1];};   if (_solveData-&gt;svar[_svari] == 2) {eta_DoT_tkde = _PP[2];};   if (_solveData-&gt;svar[_svari] == 3) {tkpq = _PP[3];};   if (_solveData-&gt;svar[_svari] == 4) {eta_DoT_kpq = _PP[4];};   if (_solveData-&gt;svar[_svari] == 5) {tkqpp = _PP[5];};   if (_solveData-&gt;svar[_svari] == 6) {eta_DoT_kqpp = _PP[6];};   if (_solveData-&gt;svar[_svari] == 7) {tlambdap = _PP[7];};   if (_solveData-&gt;svar[_svari] == 8) {eta_DoT_lambdap = _PP[8];};   if (_solveData-&gt;svar[_svari] == 9) {tgamma = _PP[9];};   if (_solveData-&gt;svar[_svari] == 10) {eta_DoT_gamma = _PP[10];};   if (_solveData-&gt;svar[_svari] == 11) {tdeltaqp = _PP[11];};   if (_solveData-&gt;svar[_svari] == 12) {eta_DoT_deltaqp = _PP[12];};   if (_solveData-&gt;svar[_svari] == 13) {prop_DoT_sd = _PP[13];};   if (_solveData-&gt;svar[_svari] == 14) {tpt0 = _PP[14];};   if (_solveData-&gt;svar[_svari] == 15) {eta_DoT_pt0 = _PP[15];};   if (_solveData-&gt;svar[_svari] == 16) {tq0 = _PP[16];};   if (_solveData-&gt;svar[_svari] == 17) {eta_DoT_q0 = _PP[17];};   if (_solveData-&gt;svar[_svari] == 18) {rxerr_DoT_pstar = _PP[18];}; }</span></span>
<span><span class="co">#&gt; #define _SYNC_simeta_ for (int _ovari=_solveData-&gt;neta; _ovari--;){  if (_solveData-&gt;ovar[_ovari] == 0) {k = _PP[0];};   if (_solveData-&gt;ovar[_ovari] == 1) {tkde = _PP[1];};   if (_solveData-&gt;ovar[_ovari] == 2) {eta_DoT_tkde = _PP[2];};   if (_solveData-&gt;ovar[_ovari] == 3) {tkpq = _PP[3];};   if (_solveData-&gt;ovar[_ovari] == 4) {eta_DoT_kpq = _PP[4];};   if (_solveData-&gt;ovar[_ovari] == 5) {tkqpp = _PP[5];};   if (_solveData-&gt;ovar[_ovari] == 6) {eta_DoT_kqpp = _PP[6];};   if (_solveData-&gt;ovar[_ovari] == 7) {tlambdap = _PP[7];};   if (_solveData-&gt;ovar[_ovari] == 8) {eta_DoT_lambdap = _PP[8];};   if (_solveData-&gt;ovar[_ovari] == 9) {tgamma = _PP[9];};   if (_solveData-&gt;ovar[_ovari] == 10) {eta_DoT_gamma = _PP[10];};   if (_solveData-&gt;ovar[_ovari] == 11) {tdeltaqp = _PP[11];};   if (_solveData-&gt;ovar[_ovari] == 12) {eta_DoT_deltaqp = _PP[12];};   if (_solveData-&gt;ovar[_ovari] == 13) {prop_DoT_sd = _PP[13];};   if (_solveData-&gt;ovar[_ovari] == 14) {tpt0 = _PP[14];};   if (_solveData-&gt;ovar[_ovari] == 15) {eta_DoT_pt0 = _PP[15];};   if (_solveData-&gt;ovar[_ovari] == 16) {tq0 = _PP[16];};   if (_solveData-&gt;ovar[_ovari] == 17) {eta_DoT_q0 = _PP[17];};   if (_solveData-&gt;ovar[_ovari] == 18) {rxerr_DoT_pstar = _PP[18];}; }</span></span>
<span><span class="co">#&gt; _getRxSolve_t _getRxSolve_;</span></span>
<span><span class="co">#&gt; _simfun simeps;</span></span>
<span><span class="co">#&gt; _simfun simeta;</span></span>
<span><span class="co">#&gt; _udf_type _evalUdf=NULL;</span></span>
<span><span class="co">#&gt; rx_solve *_solveData=NULL;</span></span>
<span><span class="co">#&gt; rxode2_assign_ptr _assign_ptr=NULL;</span></span>
<span><span class="co">#&gt; _rxRmModelLibType _rxRmModelLib=NULL;</span></span>
<span><span class="co">#&gt; _rxGetModelLibType _rxGetModelLib=NULL;</span></span>
<span><span class="co">#&gt; rxode2_ode_solver_old_c _old_c=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _ptrid=NULL;</span></span>
<span><span class="co">#&gt; _rxIsCurrentC_type _rxIsCurrentC=NULL;</span></span>
<span><span class="co">#&gt; _rxSumType _sumPS=NULL;</span></span>
<span><span class="co">#&gt; _rxProdType _prodPS=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _prodType=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _sumType=NULL;</span></span>
<span><span class="co">#&gt; _update_par_ptr_p _update_par_ptr=NULL;</span></span>
<span><span class="co">#&gt; _getParCov_p _getParCov=NULL;</span></span>
<span><span class="co">#&gt; linCmtA_p linCmtA;</span></span>
<span><span class="co">#&gt; linCmtB_p linCmtB;</span></span>
<span><span class="co">#&gt; _rx_asgn _rxode2_rxAssignPtr=NULL;</span></span>
<span><span class="co">#&gt; _rx_asgn _rxQr=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn phi;</span></span>
<span><span class="co">#&gt; rxode2_fn ReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn dReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn dGELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d2GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d3GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d4GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn dsoftplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d2softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d3softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d4softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn SELU;</span></span>
<span><span class="co">#&gt; rxode2_fn dSELU;</span></span>
<span><span class="co">#&gt; rxode2_fn lReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn dlReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn Swish;</span></span>
<span><span class="co">#&gt; rxode2_fn dSwish;</span></span>
<span><span class="co">#&gt; rxode2_fn2 PReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLUa;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLUa1;</span></span>
<span><span class="co">#&gt; rxode2_fn2 ELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2ELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2aELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dELUa;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2ELUa;</span></span>
<span><span class="co">#&gt; rxode2_fn3 logit;</span></span>
<span><span class="co">#&gt; rxode2_fn3 expit;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammap;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaq;</span></span>
<span><span class="co">#&gt; rxode2_fn2 lowergamma;</span></span>
<span><span class="co">#&gt; rxode2_fn2 uppergamma;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapInv;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapDer;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapInva;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaqInv;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaqInva;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxnorm;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxbinom;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxnbinom;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxnbinomMu;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxcauchy;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxchisq;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxexp;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxf;</span></span>
<span><span class="co">#&gt; rxode2i_ifn rxgeom;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxgamma;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxbeta;</span></span>
<span><span class="co">#&gt; rxode2i_ifn rxpois;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxt_;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxunif;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxweibull;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rinorm;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom ribinom;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom rinbinom;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom rinbinomMu;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 ricauchy;</span></span>
<span><span class="co">#&gt; rxode2i2_fn richisq;</span></span>
<span><span class="co">#&gt; rxode2i2_fn riexp;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rif;</span></span>
<span><span class="co">#&gt; rxode2i2_ifn rigeom;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rigamma;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 ribeta;</span></span>
<span><span class="co">#&gt; rxode2i2_ifn ripois;</span></span>
<span><span class="co">#&gt; rxode2i2_fn rit_;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 riunif;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 riweibull;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNorm;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNormDmean;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNormDsd;</span></span>
<span><span class="co">#&gt; rxode2_llikPoisFun _llikPois;</span></span>
<span><span class="co">#&gt; rxode2_llikPoisFun _llikPoisDlambda;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikBinom;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikBinomDprob;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinom;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomDprob;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomMu;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomMuDmu;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBeta;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBetaDshape1;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBetaDshape2;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikT;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDdf;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDmean;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDsd;</span></span>
<span><span class="co">#&gt; rxode2_llikChisqFun _llikChisq;</span></span>
<span><span class="co">#&gt; rxode2_llikChisqFun _llikChisqDdf;</span></span>
<span><span class="co">#&gt; rxode2_llikExpFun _llikExp;</span></span>
<span><span class="co">#&gt; rxode2_llikExpFun _llikExpDrate;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikF;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikFDdf1;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikFDdf2;</span></span>
<span><span class="co">#&gt; rxode2_llikGeomFun _llikGeom;</span></span>
<span><span class="co">#&gt; rxode2_llikGeomFun _llikGeomDp;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnif;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnifDalpha;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnifDbeta;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibull;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibullDshape;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibullDscale;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGamma;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGammaDshape;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGammaDrate;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchy;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchyDlocation;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchyDscale;</span></span>
<span><span class="co">#&gt; rxode2_compareFactorVal_fn _compareFactorVal;</span></span>
<span><span class="co">#&gt; #include "extraC.h"</span></span>
<span><span class="co">#&gt; double _prod(double *input, double *p, int type, int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return _prodPS(input, p, n, type);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _udf(const char *funName, double *input, int n, ...) {</span></span>
<span><span class="co">#&gt;   if (n == -42) Rf_error("%s", "this has a ui user function that cannot be called directly");</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return _evalUdf(funName, n, input);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _sum(double *input, double *pld, int m, int type, int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   double ret = _sumPS(input, n, pld, m, type);</span></span>
<span><span class="co">#&gt;   if (type == 2 &amp;&amp; m &lt; 0){</span></span>
<span><span class="co">#&gt;     for (int i = -m; i--;){</span></span>
<span><span class="co">#&gt;       pld[i] = 0.0;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return ret;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _sign(unsigned int n, ...) {</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double s = 1;</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;     s = sign(va_arg(valist, double))*s;</span></span>
<span><span class="co">#&gt;     if (s == 0){</span></span>
<span><span class="co">#&gt;       break;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return s;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _rxord(int _cSub, unsigned int n,  ...) {</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind* ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   if (!ind-&gt;inLhs) {</span></span>
<span><span class="co">#&gt;     return 1.0;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double ret = 1.0;</span></span>
<span><span class="co">#&gt;   double p = 0.0;</span></span>
<span><span class="co">#&gt;   double u = rxunif(ind, 0.0, 1.0);</span></span>
<span><span class="co">#&gt;   int found = 0;</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;     p += va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     if (!found) {</span></span>
<span><span class="co">#&gt;       if (u &lt; p) {</span></span>
<span><span class="co">#&gt;         ret = (double)(i+1);</span></span>
<span><span class="co">#&gt;         found = 1;</span></span>
<span><span class="co">#&gt;       }</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   if (!found) ret =(double)(n+1);</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return ret;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _max(unsigned int n, ...) {</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double mx = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tmp = 0;</span></span>
<span><span class="co">#&gt;   if (n &gt;= 1){</span></span>
<span><span class="co">#&gt;     mx = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     for (unsigned int i = 1; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;       tmp = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;       if (tmp&gt;mx) mx=tmp;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     va_end(valist);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return mx;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _min(unsigned int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double mn = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tmp = 0;</span></span>
<span><span class="co">#&gt;   if (n &gt;= 1){</span></span>
<span><span class="co">#&gt;     mn = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     for (unsigned int i = 1; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;       tmp = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;       if (tmp&lt;mn) mn=tmp;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     va_end(valist);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return mn;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _transit4P(int cmt, double t, unsigned int id, double n, double mtt, double bio){</span></span>
<span><span class="co">#&gt;   double nd = (double) n;</span></span>
<span><span class="co">#&gt;   double ktr = (nd+1)/mtt;</span></span>
<span><span class="co">#&gt;   double lktr = _safe_log(nd+1)-_safe_log(mtt);</span></span>
<span><span class="co">#&gt;   double tlast = _solveData-&gt;subjects[id].tlastS[cmt];</span></span>
<span><span class="co">#&gt;   double dose = _solveData-&gt;subjects[id].curDoseS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(dose)) dose = 0.0;</span></span>
<span><span class="co">#&gt;   if (ISNA(tlast)) tlast = 0.0;</span></span>
<span><span class="co">#&gt;   double tad = (t-tlast);</span></span>
<span><span class="co">#&gt;   return exp(_safe_log(bio*dose)+lktr+n*(lktr+_safe_log(tad))-ktr*(tad)-lgamma1p(nd));</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _transit3P(int cmt, double t, unsigned int id, double n, double mtt){</span></span>
<span><span class="co">#&gt;   double nd = (double) n;</span></span>
<span><span class="co">#&gt;   double ktr = (nd+1)/mtt;</span></span>
<span><span class="co">#&gt;   double lktr = _safe_log(nd+1)-_safe_log(mtt);</span></span>
<span><span class="co">#&gt;   double tlast = _solveData-&gt;subjects[id].tlastS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(tlast)) tlast = 0.0;</span></span>
<span><span class="co">#&gt;   double tad = t-tlast;</span></span>
<span><span class="co">#&gt;   double podo = _solveData-&gt;subjects[id].curDoseS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(podo)) podo = 0.0;</span></span>
<span><span class="co">#&gt;   return exp(_safe_log(podo)+lktr+n*(lktr+_safe_log(tad))-ktr*(tad)-lgamma1p(nd));</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void _assignFuns0(void) {</span></span>
<span><span class="co">#&gt;   _evalUdf = (_udf_type) R_GetCCallable("rxode2", "_rxode2_evalUdf");</span></span>
<span><span class="co">#&gt;   _getRxSolve_ = (_getRxSolve_t) R_GetCCallable("rxode2","getRxSolve_");</span></span>
<span><span class="co">#&gt;   _assign_ptr=(rxode2_assign_ptr) R_GetCCallable("rxode2","rxode2_assign_fn_pointers");</span></span>
<span><span class="co">#&gt;   _rxRmModelLib=(_rxRmModelLibType) R_GetCCallable("rxode2","rxRmModelLib");</span></span>
<span><span class="co">#&gt;   _rxGetModelLib=(_rxGetModelLibType) R_GetCCallable("rxode2","rxGetModelLib");</span></span>
<span><span class="co">#&gt;   _rxode2_rxAssignPtr=(_rx_asgn)R_GetCCallable("rxode2","_rxode2_rxAssignPtr");</span></span>
<span><span class="co">#&gt;   _rxQr=(_rx_asgn)R_GetCCallable("rxode2","_rxode2_rxQr");</span></span>
<span><span class="co">#&gt;   _rxIsCurrentC = (_rxIsCurrentC_type)R_GetCCallable("rxode2","rxIsCurrentC");</span></span>
<span><span class="co">#&gt;   _sumPS  = (_rxSumType) R_GetCCallable("PreciseSums","PreciseSums_sum_r");</span></span>
<span><span class="co">#&gt;   _prodPS = (_rxProdType) R_GetCCallable("PreciseSums","PreciseSums_prod_r");</span></span>
<span><span class="co">#&gt;   _prodType=(rxode2_fn0i)R_GetCCallable("PreciseSums", "PreciseSums_prod_get");</span></span>
<span><span class="co">#&gt;   _sumType=(rxode2_fn0i)R_GetCCallable("PreciseSums", "PreciseSums_sum_get");</span></span>
<span><span class="co">#&gt;   _ptrid=(rxode2_fn0i)R_GetCCallable("rxode2", "rxode2_current_fn_pointer_id");</span></span>
<span><span class="co">#&gt;   _compareFactorVal=(rxode2_compareFactorVal_fn) R_GetCCallable("rxode2", "compareFactorVal");</span></span>
<span><span class="co">#&gt;   _update_par_ptr = (_update_par_ptr_p) R_GetCCallable("rxode2","_update_par_ptr");</span></span>
<span><span class="co">#&gt;   _getParCov = (_getParCov_p) R_GetCCallable("rxode2","_getParCov");</span></span>
<span><span class="co">#&gt;   // dynamic start</span></span>
<span><span class="co">#&gt;   _llikCauchyDscale = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchyDscale");</span></span>
<span><span class="co">#&gt;   _llikCauchyDlocation = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchyDlocation");</span></span>
<span><span class="co">#&gt;   _llikCauchy = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchy");</span></span>
<span><span class="co">#&gt;   _llikGammaDrate = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGammaDrate");</span></span>
<span><span class="co">#&gt;   _llikGammaDshape = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGammaDshape");</span></span>
<span><span class="co">#&gt;   _llikGamma = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGamma");</span></span>
<span><span class="co">#&gt;   _llikWeibullDscale = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibullDscale");</span></span>
<span><span class="co">#&gt;   _llikWeibullDshape = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibullDshape");</span></span>
<span><span class="co">#&gt;   _llikWeibull = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibull");</span></span>
<span><span class="co">#&gt;   _llikUnifDbeta = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnifDbeta");</span></span>
<span><span class="co">#&gt;   _llikUnifDalpha = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnifDalpha");</span></span>
<span><span class="co">#&gt;   _llikUnif = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnif");</span></span>
<span><span class="co">#&gt;   _llikGeomDp = (rxode2_llikGeomFun) R_GetCCallable("rxode2ll", "rxLlikGeomDp");</span></span>
<span><span class="co">#&gt;   _llikGeom = (rxode2_llikGeomFun) R_GetCCallable("rxode2ll", "rxLlikGeom");</span></span>
<span><span class="co">#&gt;   _llikFDdf2 = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikFDdf2");</span></span>
<span><span class="co">#&gt;   _llikFDdf1 = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikFDdf1");</span></span>
<span><span class="co">#&gt;   _llikF = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikF");</span></span>
<span><span class="co">#&gt;   _llikExpDrate = (rxode2_llikExpFun) R_GetCCallable("rxode2ll", "rxLlikExpDrate");</span></span>
<span><span class="co">#&gt;   _llikExp = (rxode2_llikExpFun) R_GetCCallable("rxode2ll", "rxLlikExp");</span></span>
<span><span class="co">#&gt;   _llikChisqDdf = (rxode2_llikChisqFun) R_GetCCallable("rxode2ll", "rxLlikChisqDdf");</span></span>
<span><span class="co">#&gt;   _llikChisq = (rxode2_llikChisqFun) R_GetCCallable("rxode2ll", "rxLlikChisq");</span></span>
<span><span class="co">#&gt;   _llikTDsd = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDsd");</span></span>
<span><span class="co">#&gt;   _llikTDmean = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDmean");</span></span>
<span><span class="co">#&gt;   _llikTDdf = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDdf");</span></span>
<span><span class="co">#&gt;   _llikT = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikT");</span></span>
<span><span class="co">#&gt;   _llikBetaDshape2 = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBetaDshape2");</span></span>
<span><span class="co">#&gt;   _llikBetaDshape1 = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBetaDshape1");</span></span>
<span><span class="co">#&gt;   _llikBeta = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBeta");</span></span>
<span><span class="co">#&gt;   _llikNbinomMuDmu = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomMuDmu");</span></span>
<span><span class="co">#&gt;   _llikNbinomMu = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomMu");</span></span>
<span><span class="co">#&gt;   _llikNbinomDprob = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomDprob");</span></span>
<span><span class="co">#&gt;   _llikNbinom = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinom");</span></span>
<span><span class="co">#&gt;   _llikBinomDprob = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikBinomDprob");</span></span>
<span><span class="co">#&gt;   _llikBinom = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikBinom");</span></span>
<span><span class="co">#&gt;   _llikPoisDlambda = (rxode2_llikPoisFun) R_GetCCallable("rxode2ll", "rxLlikPoisDlambda");</span></span>
<span><span class="co">#&gt;   _llikPois = (rxode2_llikPoisFun) R_GetCCallable("rxode2ll", "rxLlikPois");</span></span>
<span><span class="co">#&gt;   _llikNormDsd = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNormDsd");</span></span>
<span><span class="co">#&gt;   _llikNormDmean = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNormDmean");</span></span>
<span><span class="co">#&gt;   _llikNorm = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNorm");</span></span>
<span><span class="co">#&gt;   simeps = (_simfun) R_GetCCallable("rxode2", "simeps");</span></span>
<span><span class="co">#&gt;   simeta = (_simfun) R_GetCCallable("rxode2", "simeta");</span></span>
<span><span class="co">#&gt;   expit = (rxode2_fn3) R_GetCCallable("rxode2", "expit");</span></span>
<span><span class="co">#&gt;   logit = (rxode2_fn3) R_GetCCallable("rxode2", "logit");</span></span>
<span><span class="co">#&gt;   gammapDer = (rxode2_fn2) R_GetCCallable("rxode2", "gammapDer");</span></span>
<span><span class="co">#&gt;   lowergamma = (rxode2_fn2) R_GetCCallable("rxode2", "lowergamma");</span></span>
<span><span class="co">#&gt;   uppergamma = (rxode2_fn2) R_GetCCallable("rxode2", "uppergamma");</span></span>
<span><span class="co">#&gt;   gammaqInva = (rxode2_fn2) R_GetCCallable("rxode2", "gammaqInva");</span></span>
<span><span class="co">#&gt;   gammaqInv = (rxode2_fn2) R_GetCCallable("rxode2", "gammaqInv");</span></span>
<span><span class="co">#&gt;   gammapInva = (rxode2_fn2) R_GetCCallable("rxode2", "gammapInva");</span></span>
<span><span class="co">#&gt;   gammapInv = (rxode2_fn2) R_GetCCallable("rxode2", "gammapInv");</span></span>
<span><span class="co">#&gt;   gammaq = (rxode2_fn2) R_GetCCallable("rxode2", "gammaq");</span></span>
<span><span class="co">#&gt;   gammap = (rxode2_fn2) R_GetCCallable("rxode2", "gammap");</span></span>
<span><span class="co">#&gt;   phi = (rxode2_fn) R_GetCCallable("rxode2", "phi");</span></span>
<span><span class="co">#&gt;   d2ELUa = (rxode2_fn2) R_GetCCallable("rxode2", "d2ELUa");</span></span>
<span><span class="co">#&gt;   dELUa = (rxode2_fn2) R_GetCCallable("rxode2", "dELUa");</span></span>
<span><span class="co">#&gt;   d2aELU = (rxode2_fn2) R_GetCCallable("rxode2", "d2aELU");</span></span>
<span><span class="co">#&gt;   d2ELU = (rxode2_fn2) R_GetCCallable("rxode2", "d2ELU");</span></span>
<span><span class="co">#&gt;   dELU = (rxode2_fn2) R_GetCCallable("rxode2", "dELU");</span></span>
<span><span class="co">#&gt;   ELU = (rxode2_fn2) R_GetCCallable("rxode2", "ELU");</span></span>
<span><span class="co">#&gt;   dPReLUa1 = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLUa1");</span></span>
<span><span class="co">#&gt;   dPReLUa = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLUa");</span></span>
<span><span class="co">#&gt;   dPReLU = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLU");</span></span>
<span><span class="co">#&gt;   PReLU = (rxode2_fn2) R_GetCCallable("rxode2", "PReLU");</span></span>
<span><span class="co">#&gt;   dSwish = (rxode2_fn) R_GetCCallable("rxode2", "dSwish");</span></span>
<span><span class="co">#&gt;   Swish = (rxode2_fn) R_GetCCallable("rxode2", "Swish");</span></span>
<span><span class="co">#&gt;   dlReLU = (rxode2_fn) R_GetCCallable("rxode2", "dlReLU");</span></span>
<span><span class="co">#&gt;   lReLU = (rxode2_fn) R_GetCCallable("rxode2", "lReLU");</span></span>
<span><span class="co">#&gt;   dSELU = (rxode2_fn) R_GetCCallable("rxode2", "dSELU");</span></span>
<span><span class="co">#&gt;   SELU = (rxode2_fn) R_GetCCallable("rxode2", "SELU");</span></span>
<span><span class="co">#&gt;   d4softplus = (rxode2_fn) R_GetCCallable("rxode2", "d4softplus");</span></span>
<span><span class="co">#&gt;   d3softplus = (rxode2_fn) R_GetCCallable("rxode2", "d3softplus");</span></span>
<span><span class="co">#&gt;   d2softplus = (rxode2_fn) R_GetCCallable("rxode2", "d2softplus");</span></span>
<span><span class="co">#&gt;   dsoftplus = (rxode2_fn) R_GetCCallable("rxode2", "dsoftplus");</span></span>
<span><span class="co">#&gt;   softplus = (rxode2_fn) R_GetCCallable("rxode2", "softplus");</span></span>
<span><span class="co">#&gt;   d4GELU = (rxode2_fn) R_GetCCallable("rxode2", "d4GELU");</span></span>
<span><span class="co">#&gt;   d3GELU = (rxode2_fn) R_GetCCallable("rxode2", "d3GELU");</span></span>
<span><span class="co">#&gt;   d2GELU = (rxode2_fn) R_GetCCallable("rxode2", "d2GELU");</span></span>
<span><span class="co">#&gt;   dGELU = (rxode2_fn) R_GetCCallable("rxode2", "dGELU");</span></span>
<span><span class="co">#&gt;   GELU = (rxode2_fn) R_GetCCallable("rxode2", "GELU");</span></span>
<span><span class="co">#&gt;   dReLU = (rxode2_fn) R_GetCCallable("rxode2", "dReLU");</span></span>
<span><span class="co">#&gt;   ReLU = (rxode2_fn) R_GetCCallable("rxode2", "ReLU");</span></span>
<span><span class="co">#&gt;   riweibull = (rxode2i2_fn2) R_GetCCallable("rxode2", "riweibull");</span></span>
<span><span class="co">#&gt;   riunif = (rxode2i2_fn2) R_GetCCallable("rxode2", "riunif");</span></span>
<span><span class="co">#&gt;   rit_ = (rxode2i2_fn) R_GetCCallable("rxode2", "rit_");</span></span>
<span><span class="co">#&gt;   ripois = (rxode2i2_ifn) R_GetCCallable("rxode2", "ripois");</span></span>
<span><span class="co">#&gt;   ribeta = (rxode2i2_fn2) R_GetCCallable("rxode2", "ribeta");</span></span>
<span><span class="co">#&gt;   rigamma = (rxode2i2_fn2) R_GetCCallable("rxode2", "rigamma");</span></span>
<span><span class="co">#&gt;   rigeom = (rxode2i2_ifn) R_GetCCallable("rxode2", "rigeom");</span></span>
<span><span class="co">#&gt;   rif = (rxode2i2_fn2) R_GetCCallable("rxode2", "rif");</span></span>
<span><span class="co">#&gt;   riexp = (rxode2i2_fn) R_GetCCallable("rxode2", "riexp");</span></span>
<span><span class="co">#&gt;   richisq = (rxode2i2_fn) R_GetCCallable("rxode2", "richisq");</span></span>
<span><span class="co">#&gt;   ricauchy = (rxode2i2_fn2) R_GetCCallable("rxode2", "ricauchy");</span></span>
<span><span class="co">#&gt;   rinbinomMu = (rxode2i2_ribinom) R_GetCCallable("rxode2", "rinbinomMu");</span></span>
<span><span class="co">#&gt;   rinbinom = (rxode2i2_ribinom) R_GetCCallable("rxode2", "rinbinom");</span></span>
<span><span class="co">#&gt;   ribinom = (rxode2i2_ribinom) R_GetCCallable("rxode2", "ribinom");</span></span>
<span><span class="co">#&gt;   rinorm = (rxode2i2_fn2) R_GetCCallable("rxode2", "rinorm");</span></span>
<span><span class="co">#&gt;   rxweibull = (rxode2i_fn2) R_GetCCallable("rxode2", "rxweibull");</span></span>
<span><span class="co">#&gt;   rxunif = (rxode2i_fn2) R_GetCCallable("rxode2", "rxunif");</span></span>
<span><span class="co">#&gt;   rxt_ = (rxode2i_fn) R_GetCCallable("rxode2", "rxt_");</span></span>
<span><span class="co">#&gt;   rxpois = (rxode2i_ifn) R_GetCCallable("rxode2", "rxpois");</span></span>
<span><span class="co">#&gt;   rxbeta = (rxode2i_fn2) R_GetCCallable("rxode2", "rxbeta");</span></span>
<span><span class="co">#&gt;   rxgamma = (rxode2i_fn2) R_GetCCallable("rxode2", "rxgamma");</span></span>
<span><span class="co">#&gt;   rxgeom = (rxode2i_ifn) R_GetCCallable("rxode2", "rxgeom");</span></span>
<span><span class="co">#&gt;   rxf = (rxode2i_fn2) R_GetCCallable("rxode2", "rxf");</span></span>
<span><span class="co">#&gt;   rxexp = (rxode2i_fn) R_GetCCallable("rxode2", "rxexp");</span></span>
<span><span class="co">#&gt;   rxchisq = (rxode2i_fn) R_GetCCallable("rxode2", "rxchisq");</span></span>
<span><span class="co">#&gt;   rxcauchy = (rxode2i_fn2) R_GetCCallable("rxode2", "rxcauchy");</span></span>
<span><span class="co">#&gt;   rxnbinomMu = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxnbinomMu");</span></span>
<span><span class="co">#&gt;   rxnbinom = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxnbinom");</span></span>
<span><span class="co">#&gt;   rxbinom = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxbinom");</span></span>
<span><span class="co">#&gt;   rxnorm = (rxode2i_fn2) R_GetCCallable("rxode2", "rxnorm");</span></span>
<span><span class="co">#&gt;   linCmtB = (linCmtB_p) R_GetCCallable("rxode2", "linCmtB");</span></span>
<span><span class="co">#&gt;   linCmtA = (linCmtA_p) R_GetCCallable("rxode2", "linCmtA");</span></span>
<span><span class="co">#&gt;   // dynamic stop</span></span>
<span><span class="co">#&gt;   _solveData = _getRxSolve_();</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void _assignFuns(void) {</span></span>
<span><span class="co">#&gt;   if (_assign_ptr == NULL){</span></span>
<span><span class="co">#&gt;     _assignFuns0();</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void __assignFuns2(rx_solve rx,</span></span>
<span><span class="co">#&gt;                    rx_solving_options op,</span></span>
<span><span class="co">#&gt;                    t_F f,</span></span>
<span><span class="co">#&gt;                    t_LAG lag,</span></span>
<span><span class="co">#&gt;                    t_RATE rate,</span></span>
<span><span class="co">#&gt;                    t_DUR dur,</span></span>
<span><span class="co">#&gt;                    t_calc_mtime mtime,</span></span>
<span><span class="co">#&gt;                    t_ME me,</span></span>
<span><span class="co">#&gt;                    t_IndF indf,</span></span>
<span><span class="co">#&gt;                    t_getTime gettime,</span></span>
<span><span class="co">#&gt;                    t_locateTimeIndex timeindex,</span></span>
<span><span class="co">#&gt;                    t_handle_evidL handleEvid,</span></span>
<span><span class="co">#&gt;                    t_getDur getdur) {</span></span>
<span><span class="co">#&gt;   // assign start</span></span>
<span><span class="co">#&gt;     static rxode2_assignFuns2_t rxode2_assignFuns2 = NULL;</span></span>
<span><span class="co">#&gt;     if (rxode2_assignFuns2 == NULL) rxode2_assignFuns2 = (rxode2_assignFuns2_t)(R_GetCCallable("rxode2", "_rxode2_assignFuns2"));</span></span>
<span><span class="co">#&gt;     rxode2_assignFuns2(rx, op, f, lag, rate, dur, mtime, me, indf, gettime, timeindex, handleEvid, getdur);</span></span>
<span><span class="co">#&gt;   // assign stop</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void  rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__ode_solver_solvedata (rx_solve *solve){</span></span>
<span><span class="co">#&gt;   _solveData = solve;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern rx_solve *rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__ode_solver_get_solvedata(void){</span></span>
<span><span class="co">#&gt;   return _solveData;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; SEXP rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__model_vars(void);</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; // prj-specific differential eqns</span></span>
<span><span class="co">#&gt; void rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__dydt(int *_neq, double __t, double *__zzStateVar__, double *__DDtStateVar__)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   int _cSub = _neq[1];</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_neq[1]].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=1;</span></span>
<span><span class="co">#&gt;   double k = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tkde = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_tkde = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tkpq = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_kpq = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tkqpp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_kqpp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tlambdap = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_lambdap = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tgamma = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_gamma = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tdeltaqp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_deltaqp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double prop_DoT_sd = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tpt0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_pt0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tq0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_q0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double pstar = NA_REAL;</span></span>
<span><span class="co">#&gt;   double kde = NA_REAL;</span></span>
<span><span class="co">#&gt;   double kpq = NA_REAL;</span></span>
<span><span class="co">#&gt;   double kqpp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double lambdap = NA_REAL;</span></span>
<span><span class="co">#&gt;   double _rxNotFun_gamma = NA_REAL;</span></span>
<span><span class="co">#&gt;   double deltaqp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double c = NA_REAL;</span></span>
<span><span class="co">#&gt;   double pt = NA_REAL;</span></span>
<span><span class="co">#&gt;   double qp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double q = NA_REAL;</span></span>
<span><span class="co">#&gt;   double pt0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double q0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_yj___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_lambda___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_low___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_hi___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_f_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_r_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double ipredSim = NA_REAL;</span></span>
<span><span class="co">#&gt;   double sim = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rxerr_DoT_pstar = NA_REAL;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   (void)k;</span></span>
<span><span class="co">#&gt;   (void)tkde;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_tkde;</span></span>
<span><span class="co">#&gt;   (void)tkpq;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_kpq;</span></span>
<span><span class="co">#&gt;   (void)tkqpp;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_kqpp;</span></span>
<span><span class="co">#&gt;   (void)tlambdap;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_lambdap;</span></span>
<span><span class="co">#&gt;   (void)tgamma;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_gamma;</span></span>
<span><span class="co">#&gt;   (void)tdeltaqp;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_deltaqp;</span></span>
<span><span class="co">#&gt;   (void)prop_DoT_sd;</span></span>
<span><span class="co">#&gt;   (void)tpt0;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_pt0;</span></span>
<span><span class="co">#&gt;   (void)tq0;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_q0;</span></span>
<span><span class="co">#&gt;   (void)pstar;</span></span>
<span><span class="co">#&gt;   (void)kde;</span></span>
<span><span class="co">#&gt;   (void)kpq;</span></span>
<span><span class="co">#&gt;   (void)kqpp;</span></span>
<span><span class="co">#&gt;   (void)lambdap;</span></span>
<span><span class="co">#&gt;   (void)_rxNotFun_gamma;</span></span>
<span><span class="co">#&gt;   (void)deltaqp;</span></span>
<span><span class="co">#&gt;   (void)c;</span></span>
<span><span class="co">#&gt;   (void)pt;</span></span>
<span><span class="co">#&gt;   (void)qp;</span></span>
<span><span class="co">#&gt;   (void)q;</span></span>
<span><span class="co">#&gt;   (void)pt0;</span></span>
<span><span class="co">#&gt;   (void)q0;</span></span>
<span><span class="co">#&gt;   (void)rx_yj___;</span></span>
<span><span class="co">#&gt;   (void)rx_lambda___;</span></span>
<span><span class="co">#&gt;   (void)rx_low___;</span></span>
<span><span class="co">#&gt;   (void)rx_hi___;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_f_;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_;</span></span>
<span><span class="co">#&gt;   (void)rx_r_;</span></span>
<span><span class="co">#&gt;   (void)ipredSim;</span></span>
<span><span class="co">#&gt;   (void)sim;</span></span>
<span><span class="co">#&gt;   (void)rxerr_DoT_pstar;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   pstar = _PL[0];</span></span>
<span><span class="co">#&gt;   ipredSim = _PL[1];</span></span>
<span><span class="co">#&gt;   sim = _PL[2];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _update_par_ptr(__t, _cSub, _solveData, _idx);</span></span>
<span><span class="co">#&gt;   k = _PP[0];</span></span>
<span><span class="co">#&gt;   tkde = _PP[1];</span></span>
<span><span class="co">#&gt;   eta_DoT_tkde = _PP[2];</span></span>
<span><span class="co">#&gt;   tkpq = _PP[3];</span></span>
<span><span class="co">#&gt;   eta_DoT_kpq = _PP[4];</span></span>
<span><span class="co">#&gt;   tkqpp = _PP[5];</span></span>
<span><span class="co">#&gt;   eta_DoT_kqpp = _PP[6];</span></span>
<span><span class="co">#&gt;   tlambdap = _PP[7];</span></span>
<span><span class="co">#&gt;   eta_DoT_lambdap = _PP[8];</span></span>
<span><span class="co">#&gt;   tgamma = _PP[9];</span></span>
<span><span class="co">#&gt;   eta_DoT_gamma = _PP[10];</span></span>
<span><span class="co">#&gt;   tdeltaqp = _PP[11];</span></span>
<span><span class="co">#&gt;   eta_DoT_deltaqp = _PP[12];</span></span>
<span><span class="co">#&gt;   prop_DoT_sd = _PP[13];</span></span>
<span><span class="co">#&gt;   tpt0 = _PP[14];</span></span>
<span><span class="co">#&gt;   eta_DoT_pt0 = _PP[15];</span></span>
<span><span class="co">#&gt;   tq0 = _PP[16];</span></span>
<span><span class="co">#&gt;   eta_DoT_q0 = _PP[17];</span></span>
<span><span class="co">#&gt;   rxerr_DoT_pstar = _PP[18];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   c = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">#&gt;   pt = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">#&gt;   q = __zzStateVar__[__DDT2__]*((double)(_ON[__DDT2__]));</span></span>
<span><span class="co">#&gt;   qp = __zzStateVar__[__DDT3__]*((double)(_ON[__DDT3__]));</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   kde =tkde*exp(eta_DoT_tkde);</span></span>
<span><span class="co">#&gt;   kpq =tkpq*exp(eta_DoT_kpq);</span></span>
<span><span class="co">#&gt;   kqpp =tkqpp*exp(eta_DoT_kqpp);</span></span>
<span><span class="co">#&gt;   lambdap =tlambdap*exp(eta_DoT_lambdap);</span></span>
<span><span class="co">#&gt;   _rxNotFun_gamma =tgamma*exp(eta_DoT_gamma);</span></span>
<span><span class="co">#&gt;   deltaqp =tdeltaqp*exp(eta_DoT_deltaqp);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT0__] = ((double)(_ON[__DDT0__]))*(_IR[__DDT0__] -kde*c);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT1__] = ((double)(_ON[__DDT1__]))*(_IR[__DDT1__] + lambdap*pt*(1-pstar/_div0(k))+kqpp*qp-kpq*pt-_rxNotFun_gamma*c*kde*pt);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT2__] = ((double)(_ON[__DDT2__]))*(_IR[__DDT2__] + kpq*pt-_rxNotFun_gamma*c*kde*q);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT3__] = ((double)(_ON[__DDT3__]))*(_IR[__DDT3__] + _rxNotFun_gamma*c*kde*q-kqpp*qp-deltaqp*qp);</span></span>
<span><span class="co">#&gt;   pt0 =tpt0*exp(eta_DoT_pt0);</span></span>
<span><span class="co">#&gt;   q0 =tq0*exp(eta_DoT_q0);</span></span>
<span><span class="co">#&gt;   pstar =(pt+q+qp);</span></span>
<span><span class="co">#&gt;   rx_yj_ =2;</span></span>
<span><span class="co">#&gt;   rx_lambda_ =1;</span></span>
<span><span class="co">#&gt;   rx_low_ =0;</span></span>
<span><span class="co">#&gt;   rx_hi_ =1;</span></span>
<span><span class="co">#&gt;   rx_pred_f_ =pstar;</span></span>
<span><span class="co">#&gt;   rx_pred_ =rx_pred_f_;</span></span>
<span><span class="co">#&gt;   rx_r_ =Rx_pow((rx_pred_f_*prop_DoT_sd),2);</span></span>
<span><span class="co">#&gt;   ipredSim =rxTBSi(rx_pred_,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   sim =rxTBSi(rx_pred_+sqrt(rx_r_)*rxerr_DoT_pstar,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   (&amp;_solveData-&gt;subjects[_cSub])-&gt;dadt_counter[0]++;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; // Jacobian derived vars</span></span>
<span><span class="co">#&gt; void rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__calc_jac(int *_neq, double __t, double *__zzStateVar__, double *__PDStateVar__, unsigned int __NROWPD__) {</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;     int _cSub=_neq[1];</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_neq[1]].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=2;</span></span>
<span><span class="co">#&gt;   (&amp;_solveData-&gt;subjects[_cSub])-&gt;jac_counter[0]++;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Functional based initial conditions.</span></span>
<span><span class="co">#&gt; void rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__inis(int _cSub, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;  _ind-&gt;_rxFlag=3;</span></span>
<span><span class="co">#&gt;   double t=0;</span></span>
<span><span class="co">#&gt;   double k = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tkde = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_tkde = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tkpq = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_kpq = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tkqpp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_kqpp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tlambdap = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_lambdap = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tgamma = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_gamma = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tdeltaqp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_deltaqp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double prop_DoT_sd = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tpt0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_pt0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tq0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_q0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double pstar = NA_REAL;</span></span>
<span><span class="co">#&gt;   double kde = NA_REAL;</span></span>
<span><span class="co">#&gt;   double kpq = NA_REAL;</span></span>
<span><span class="co">#&gt;   double kqpp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double lambdap = NA_REAL;</span></span>
<span><span class="co">#&gt;   double _rxNotFun_gamma = NA_REAL;</span></span>
<span><span class="co">#&gt;   double deltaqp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double c = NA_REAL;</span></span>
<span><span class="co">#&gt;   double pt = NA_REAL;</span></span>
<span><span class="co">#&gt;   double qp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double q = NA_REAL;</span></span>
<span><span class="co">#&gt;   double pt0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double q0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_yj___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_lambda___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_low___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_hi___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_f_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_r_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double ipredSim = NA_REAL;</span></span>
<span><span class="co">#&gt;   double sim = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rxerr_DoT_pstar = NA_REAL;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   (void)k;</span></span>
<span><span class="co">#&gt;   (void)tkde;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_tkde;</span></span>
<span><span class="co">#&gt;   (void)tkpq;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_kpq;</span></span>
<span><span class="co">#&gt;   (void)tkqpp;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_kqpp;</span></span>
<span><span class="co">#&gt;   (void)tlambdap;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_lambdap;</span></span>
<span><span class="co">#&gt;   (void)tgamma;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_gamma;</span></span>
<span><span class="co">#&gt;   (void)tdeltaqp;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_deltaqp;</span></span>
<span><span class="co">#&gt;   (void)prop_DoT_sd;</span></span>
<span><span class="co">#&gt;   (void)tpt0;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_pt0;</span></span>
<span><span class="co">#&gt;   (void)tq0;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_q0;</span></span>
<span><span class="co">#&gt;   (void)pstar;</span></span>
<span><span class="co">#&gt;   (void)kde;</span></span>
<span><span class="co">#&gt;   (void)kpq;</span></span>
<span><span class="co">#&gt;   (void)kqpp;</span></span>
<span><span class="co">#&gt;   (void)lambdap;</span></span>
<span><span class="co">#&gt;   (void)_rxNotFun_gamma;</span></span>
<span><span class="co">#&gt;   (void)deltaqp;</span></span>
<span><span class="co">#&gt;   (void)c;</span></span>
<span><span class="co">#&gt;   (void)pt;</span></span>
<span><span class="co">#&gt;   (void)qp;</span></span>
<span><span class="co">#&gt;   (void)q;</span></span>
<span><span class="co">#&gt;   (void)pt0;</span></span>
<span><span class="co">#&gt;   (void)q0;</span></span>
<span><span class="co">#&gt;   (void)rx_yj___;</span></span>
<span><span class="co">#&gt;   (void)rx_lambda___;</span></span>
<span><span class="co">#&gt;   (void)rx_low___;</span></span>
<span><span class="co">#&gt;   (void)rx_hi___;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_f_;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_;</span></span>
<span><span class="co">#&gt;   (void)rx_r_;</span></span>
<span><span class="co">#&gt;   (void)ipredSim;</span></span>
<span><span class="co">#&gt;   (void)sim;</span></span>
<span><span class="co">#&gt;   (void)rxerr_DoT_pstar;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   pstar = _PL[0];</span></span>
<span><span class="co">#&gt;   ipredSim = _PL[1];</span></span>
<span><span class="co">#&gt;   sim = _PL[2];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _update_par_ptr(0.0, _cSub, _solveData, _idx);</span></span>
<span><span class="co">#&gt;   k = _PP[0];</span></span>
<span><span class="co">#&gt;   tkde = _PP[1];</span></span>
<span><span class="co">#&gt;   eta_DoT_tkde = _PP[2];</span></span>
<span><span class="co">#&gt;   tkpq = _PP[3];</span></span>
<span><span class="co">#&gt;   eta_DoT_kpq = _PP[4];</span></span>
<span><span class="co">#&gt;   tkqpp = _PP[5];</span></span>
<span><span class="co">#&gt;   eta_DoT_kqpp = _PP[6];</span></span>
<span><span class="co">#&gt;   tlambdap = _PP[7];</span></span>
<span><span class="co">#&gt;   eta_DoT_lambdap = _PP[8];</span></span>
<span><span class="co">#&gt;   tgamma = _PP[9];</span></span>
<span><span class="co">#&gt;   eta_DoT_gamma = _PP[10];</span></span>
<span><span class="co">#&gt;   tdeltaqp = _PP[11];</span></span>
<span><span class="co">#&gt;   eta_DoT_deltaqp = _PP[12];</span></span>
<span><span class="co">#&gt;   prop_DoT_sd = _PP[13];</span></span>
<span><span class="co">#&gt;   tpt0 = _PP[14];</span></span>
<span><span class="co">#&gt;   eta_DoT_pt0 = _PP[15];</span></span>
<span><span class="co">#&gt;   tq0 = _PP[16];</span></span>
<span><span class="co">#&gt;   eta_DoT_q0 = _PP[17];</span></span>
<span><span class="co">#&gt;   rxerr_DoT_pstar = _PP[18];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   c = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">#&gt;   pt = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">#&gt;   q = __zzStateVar__[__DDT2__]*((double)(_ON[__DDT2__]));</span></span>
<span><span class="co">#&gt;   qp = __zzStateVar__[__DDT3__]*((double)(_ON[__DDT3__]));</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   kde =tkde*exp(eta_DoT_tkde);</span></span>
<span><span class="co">#&gt;   kpq =tkpq*exp(eta_DoT_kpq);</span></span>
<span><span class="co">#&gt;   kqpp =tkqpp*exp(eta_DoT_kqpp);</span></span>
<span><span class="co">#&gt;   lambdap =tlambdap*exp(eta_DoT_lambdap);</span></span>
<span><span class="co">#&gt;   _rxNotFun_gamma =tgamma*exp(eta_DoT_gamma);</span></span>
<span><span class="co">#&gt;   deltaqp =tdeltaqp*exp(eta_DoT_deltaqp);</span></span>
<span><span class="co">#&gt;   pt0 =tpt0*exp(eta_DoT_pt0);</span></span>
<span><span class="co">#&gt;   q0 =tq0*exp(eta_DoT_q0);</span></span>
<span><span class="co">#&gt;   pt=pt0;</span></span>
<span><span class="co">#&gt;   q=q0;</span></span>
<span><span class="co">#&gt;   pstar =(pt+q+qp);</span></span>
<span><span class="co">#&gt;   rx_yj_ =2;</span></span>
<span><span class="co">#&gt;   rx_lambda_ =1;</span></span>
<span><span class="co">#&gt;   rx_low_ =0;</span></span>
<span><span class="co">#&gt;   rx_hi_ =1;</span></span>
<span><span class="co">#&gt;   rx_pred_f_ =pstar;</span></span>
<span><span class="co">#&gt;   rx_pred_ =rx_pred_f_;</span></span>
<span><span class="co">#&gt;   rx_r_ =Rx_pow((rx_pred_f_*prop_DoT_sd),2);</span></span>
<span><span class="co">#&gt;   ipredSim =rxTBSi(rx_pred_,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   sim =rxTBSi(rx_pred_+sqrt(rx_r_)*rxerr_DoT_pstar,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   __zzStateVar__[__DDT0__]=((double)(_ON[__DDT0__]))*(c);</span></span>
<span><span class="co">#&gt;   __zzStateVar__[__DDT1__]=((double)(_ON[__DDT1__]))*(pt);</span></span>
<span><span class="co">#&gt;   __zzStateVar__[__DDT2__]=((double)(_ON[__DDT2__]))*(q);</span></span>
<span><span class="co">#&gt;   __zzStateVar__[__DDT3__]=((double)(_ON[__DDT3__]))*(qp);</span></span>
<span><span class="co">#&gt;   __zzStateVar__[__DDT4__]=((double)(_ON[__DDT4__]))*(pstar);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // prj-specific derived vars</span></span>
<span><span class="co">#&gt; void rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__calc_lhs(int _cSub, double __t, double *__zzStateVar__, double *_lhs) {</span></span>
<span><span class="co">#&gt;     int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=11;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_0__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_1__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_2__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_3__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_4__;</span></span>
<span><span class="co">#&gt;   double k = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tkde = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_tkde = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tkpq = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_kpq = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tkqpp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_kqpp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tlambdap = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_lambdap = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tgamma = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_gamma = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tdeltaqp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_deltaqp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double prop_DoT_sd = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tpt0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_pt0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tq0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_q0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double pstar = NA_REAL;</span></span>
<span><span class="co">#&gt;   double kde = NA_REAL;</span></span>
<span><span class="co">#&gt;   double kpq = NA_REAL;</span></span>
<span><span class="co">#&gt;   double kqpp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double lambdap = NA_REAL;</span></span>
<span><span class="co">#&gt;   double _rxNotFun_gamma = NA_REAL;</span></span>
<span><span class="co">#&gt;   double deltaqp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double c = NA_REAL;</span></span>
<span><span class="co">#&gt;   double pt = NA_REAL;</span></span>
<span><span class="co">#&gt;   double qp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double q = NA_REAL;</span></span>
<span><span class="co">#&gt;   double pt0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double q0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_yj___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_lambda___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_low___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_hi___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_f_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_r_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double ipredSim = NA_REAL;</span></span>
<span><span class="co">#&gt;   double sim = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rxerr_DoT_pstar = NA_REAL;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_0__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_1__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_2__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_3__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_4__;</span></span>
<span><span class="co">#&gt;   (void)k;</span></span>
<span><span class="co">#&gt;   (void)tkde;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_tkde;</span></span>
<span><span class="co">#&gt;   (void)tkpq;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_kpq;</span></span>
<span><span class="co">#&gt;   (void)tkqpp;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_kqpp;</span></span>
<span><span class="co">#&gt;   (void)tlambdap;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_lambdap;</span></span>
<span><span class="co">#&gt;   (void)tgamma;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_gamma;</span></span>
<span><span class="co">#&gt;   (void)tdeltaqp;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_deltaqp;</span></span>
<span><span class="co">#&gt;   (void)prop_DoT_sd;</span></span>
<span><span class="co">#&gt;   (void)tpt0;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_pt0;</span></span>
<span><span class="co">#&gt;   (void)tq0;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_q0;</span></span>
<span><span class="co">#&gt;   (void)pstar;</span></span>
<span><span class="co">#&gt;   (void)kde;</span></span>
<span><span class="co">#&gt;   (void)kpq;</span></span>
<span><span class="co">#&gt;   (void)kqpp;</span></span>
<span><span class="co">#&gt;   (void)lambdap;</span></span>
<span><span class="co">#&gt;   (void)_rxNotFun_gamma;</span></span>
<span><span class="co">#&gt;   (void)deltaqp;</span></span>
<span><span class="co">#&gt;   (void)c;</span></span>
<span><span class="co">#&gt;   (void)pt;</span></span>
<span><span class="co">#&gt;   (void)qp;</span></span>
<span><span class="co">#&gt;   (void)q;</span></span>
<span><span class="co">#&gt;   (void)pt0;</span></span>
<span><span class="co">#&gt;   (void)q0;</span></span>
<span><span class="co">#&gt;   (void)rx_yj___;</span></span>
<span><span class="co">#&gt;   (void)rx_lambda___;</span></span>
<span><span class="co">#&gt;   (void)rx_low___;</span></span>
<span><span class="co">#&gt;   (void)rx_hi___;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_f_;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_;</span></span>
<span><span class="co">#&gt;   (void)rx_r_;</span></span>
<span><span class="co">#&gt;   (void)ipredSim;</span></span>
<span><span class="co">#&gt;   (void)sim;</span></span>
<span><span class="co">#&gt;   (void)rxerr_DoT_pstar;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   pstar = _PL[0];</span></span>
<span><span class="co">#&gt;   ipredSim = _PL[1];</span></span>
<span><span class="co">#&gt;   sim = _PL[2];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _update_par_ptr(__t, _cSub, _solveData, _idx);</span></span>
<span><span class="co">#&gt;   k = _PP[0];</span></span>
<span><span class="co">#&gt;   tkde = _PP[1];</span></span>
<span><span class="co">#&gt;   eta_DoT_tkde = _PP[2];</span></span>
<span><span class="co">#&gt;   tkpq = _PP[3];</span></span>
<span><span class="co">#&gt;   eta_DoT_kpq = _PP[4];</span></span>
<span><span class="co">#&gt;   tkqpp = _PP[5];</span></span>
<span><span class="co">#&gt;   eta_DoT_kqpp = _PP[6];</span></span>
<span><span class="co">#&gt;   tlambdap = _PP[7];</span></span>
<span><span class="co">#&gt;   eta_DoT_lambdap = _PP[8];</span></span>
<span><span class="co">#&gt;   tgamma = _PP[9];</span></span>
<span><span class="co">#&gt;   eta_DoT_gamma = _PP[10];</span></span>
<span><span class="co">#&gt;   tdeltaqp = _PP[11];</span></span>
<span><span class="co">#&gt;   eta_DoT_deltaqp = _PP[12];</span></span>
<span><span class="co">#&gt;   prop_DoT_sd = _PP[13];</span></span>
<span><span class="co">#&gt;   tpt0 = _PP[14];</span></span>
<span><span class="co">#&gt;   eta_DoT_pt0 = _PP[15];</span></span>
<span><span class="co">#&gt;   tq0 = _PP[16];</span></span>
<span><span class="co">#&gt;   eta_DoT_q0 = _PP[17];</span></span>
<span><span class="co">#&gt;   rxerr_DoT_pstar = _PP[18];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   c = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">#&gt;   pt = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">#&gt;   q = __zzStateVar__[__DDT2__]*((double)(_ON[__DDT2__]));</span></span>
<span><span class="co">#&gt;   qp = __zzStateVar__[__DDT3__]*((double)(_ON[__DDT3__]));</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   kde =tkde*exp(eta_DoT_tkde);</span></span>
<span><span class="co">#&gt;   kpq =tkpq*exp(eta_DoT_kpq);</span></span>
<span><span class="co">#&gt;   kqpp =tkqpp*exp(eta_DoT_kqpp);</span></span>
<span><span class="co">#&gt;   lambdap =tlambdap*exp(eta_DoT_lambdap);</span></span>
<span><span class="co">#&gt;   _rxNotFun_gamma =tgamma*exp(eta_DoT_gamma);</span></span>
<span><span class="co">#&gt;   deltaqp =tdeltaqp*exp(eta_DoT_deltaqp);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_0__ = ((double)(_ON[__DDT0__]))*(_IR[__DDT0__] -kde*c);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_1__ = ((double)(_ON[__DDT1__]))*(_IR[__DDT1__] + lambdap*pt*(1-pstar/_div0(k))+kqpp*qp-kpq*pt-_rxNotFun_gamma*c*kde*pt);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_2__ = ((double)(_ON[__DDT2__]))*(_IR[__DDT2__] + kpq*pt-_rxNotFun_gamma*c*kde*q);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_3__ = ((double)(_ON[__DDT3__]))*(_IR[__DDT3__] + _rxNotFun_gamma*c*kde*q-kqpp*qp-deltaqp*qp);</span></span>
<span><span class="co">#&gt;   pt0 =tpt0*exp(eta_DoT_pt0);</span></span>
<span><span class="co">#&gt;   q0 =tq0*exp(eta_DoT_q0);</span></span>
<span><span class="co">#&gt;   pstar =(pt+q+qp);</span></span>
<span><span class="co">#&gt;   rx_yj_ =2;</span></span>
<span><span class="co">#&gt;   rx_lambda_ =1;</span></span>
<span><span class="co">#&gt;   rx_low_ =0;</span></span>
<span><span class="co">#&gt;   rx_hi_ =1;</span></span>
<span><span class="co">#&gt;   rx_pred_f_ =pstar;</span></span>
<span><span class="co">#&gt;   rx_pred_ =rx_pred_f_;</span></span>
<span><span class="co">#&gt;   rx_r_ =Rx_pow((rx_pred_f_*prop_DoT_sd),2);</span></span>
<span><span class="co">#&gt;   ipredSim =rxTBSi(rx_pred_,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   sim =rxTBSi(rx_pred_+sqrt(rx_r_)*rxerr_DoT_pstar,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _lhs[_LHS_0_]=pstar;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_1_]=ipredSim;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_2_]=sim;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Functional based bioavailability</span></span>
<span><span class="co">#&gt; double rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__F(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return _amt;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; // Functional based absorption lag</span></span>
<span><span class="co">#&gt; double rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__Lag(int _cSub,  int _cmt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return __t;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Modeled zero-order rate</span></span>
<span><span class="co">#&gt; double rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__Rate(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return 0.0;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Modeled zero-order duration</span></span>
<span><span class="co">#&gt; double rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__Dur(int _cSub,  int _cmt, double _amt, double __t){</span></span>
<span><span class="co">#&gt;  return 0.0;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Model Times</span></span>
<span><span class="co">#&gt; void rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__mtime(int _cSub, double *_mtime){</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Matrix Exponential (0)</span></span>
<span><span class="co">#&gt; void rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__ME(int _cSub, double _t, double __t, double *_mat, const double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=9;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Inductive linearization Matf</span></span>
<span><span class="co">#&gt; void rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__IndF(int _cSub, double _t, double __t, double *_matf){</span></span>
<span><span class="co">#&gt;  int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=10;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern SEXP rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__model_vars(void){</span></span>
<span><span class="co">#&gt;   int pro=0;</span></span>
<span><span class="co">#&gt;   SEXP _mv = PROTECT(_rxGetModelLib("rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__model_vars"));pro++;</span></span>
<span><span class="co">#&gt;   if (!_rxIsCurrentC(_mv)){</span></span>
<span><span class="co">#&gt;     SEXP hash    = PROTECT(Rf_allocVector(STRSXP, 1));pro++;</span></span>
<span><span class="co">#&gt; #define __doBuf__  snprintf(buf, __doBufN__, "un]\"BAAA@QRtHACAAAAAAAXL`AAAv7#aT){+MMVA3Hm6@CI772rIaEGCCeCu~;b_G2e*bYebKB^}]MdYwaQ^(8FIehRv{&amp;2q;n*O+/YRWuAnbd*2hb1NAG[jUQ/:\?v7WXAJB.IXrC7BsI~HuLqt_cUkYi7+cbWX]N`5asD}O2oEdfvFz7w#0t&amp;x~~&gt;xG+l[C7UdY=a.ENr3FThsrOY|I0qw\?gY%%a*]t&gt;[J@VB23+3T6=7Yh#H2K*:6.;Bk=jDb`o:WrdiGM\?RxBx[&amp;kkqFDp%%!+KjdUdP07kinRx/3`[$!HPnsl&lt;Xk,}j@IC9:|z/~$O2;l$`^\?e\"hW^2&amp;OQ\"2&lt;Vqxqb`nQ4]_6#1jQ49fF*\?2K\".BCXZZ}QjFu16yLZZb[uP0E3CUq})cs&lt;,^{))Y:&lt;,^6L:W!0f,Dg6Z*j0fCQL@f9j;Y[TL&amp;jJ$n&lt;dy;K%%!VkvU6nj[ms8wq,Dg4o7edx=IP0+^Tr_.6..,++&amp;cx^gO+p&lt;\?aGY[~J[,w4M,!OFa{g&gt;!_}NR0IaEOv1)aiNR)4#]Uy.hEt}CmlKyXcC]3IW2EorZR!RNx2ROZOJTxl\?\"X(!x9q3FS1p#WM6VK~&gt;&lt;a&amp;b/SKLYO|.xkF]h/uAf&amp;6&gt;nOD=0Ozz!jD^+pxFa.R@Mo&gt;=O27r#C@xz*7ds&lt;bxk{p\?]=p/b{*1$un&amp;l1$B!Hi#y{fW4F%%P6J19b&amp;_FnD&gt;$LOM+MCwC&lt;{OSw5Ro.p.s#KY(7,g~o]b]aQ)t6x$a1/YE+,;lM;YqU$7s,]Sl/mec&lt;B#Bz8O+tpR0S6:bh48M_[^n_yVCi[h$~e#*58z^!x@54Y@EmiC&gt;COds++f/)\"w=e4d!!.\?3zrLp;Sr0gK{g[g,ljS;(pM\"fPLF!S\"eV50uD}z!Y;ZD@sz)(`IlBc6MJ@DWTusr.{]]glPBQ&gt;vtZWa:I+b{X5X@m&amp;mQPyml.;`qB$k[hH1|wbd1H5,9ZW.|)&gt;TTDP(e8Ln$Fj/T{0,8M4*wNh(aT&gt;ebr%%bJdEA3Rmab|A3IA%%}0~o`8uctuqidB3_IAaYHvIA&amp;ABA)k*fOOWX_F#hIG|cX8_N*boVep${R}=sbo7FopRjse*\?)`yHG^!9l7F5AA:xVf~FXX~XBz]t/B{/YA5B#5]i0V.AQ24S\?,\"FuZ.I2B$WfZ}MNf@/Y:i#\"\"{ixB44F^c|7GsW`hdLAv8PDffzmL)*,,R=E$y`2|bgiZ|@!+_||F\?TQr(q|w[W;c&amp;)Pt.MbCdSvjZUB;c{s0i_5rzvr&gt;P8u3ZMmP@*#=%%n$}VJzk84&gt;0b@i]EQ9N/ZCHVtYJ@e$\?WVUZ:vjAIU*$0K|w%%o^cJuMkeg~{Siz)#WNZ.4QR9zK@ybrP[DRvc[\?C;1!xd|}WE_#Vt(2DfjvD25`9mv]\?lRr&amp;8$OE!=cXV8F3)#y07vW[\?h{`@mT,Ai8M%%z4kL9&gt;\?2&gt;/8Ei;2T8mJM2Z5q!6t]Z9wahS69:fG/i8H]qJ*myxzo8#9w**Up6}RD/)5X&gt;WG3Xi9KhDW(:DT9r#8|EXVkoLg{q#PLd@:v~;.|]t_B]%%p#2OaJr%%\?@DIM#Z(\?Aw3Dqg~FRPbC{\"~[fPY0,c*vWMi1gsw}y+tmSh,5CnJ83sWB*u,u=COi73QZ7^5\?$vK@tH;^ja:XWpKdxLe;\"\?ODZNVx+q65`d}*~+9xC6h9C)%%0e$l%%5;AV+/|xn5Gq8j8gbC!CRwt/WXM:Dxd&lt;[CkTMIlDSz37!Ac*(uH");</span></span>
<span><span class="co">#&gt;     char buf[1721];</span></span>
<span><span class="co">#&gt; #define __doBufN__ 1721</span></span>
<span><span class="co">#&gt;     __doBuf__</span></span>
<span><span class="co">#&gt; #undef __doBuf__</span></span>
<span><span class="co">#&gt; #undef __doBufN__</span></span>
<span><span class="co">#&gt;     SET_STRING_ELT(hash, 0, Rf_mkChar(buf));</span></span>
<span><span class="co">#&gt;     SEXP lst      = PROTECT(_rxQr(hash));pro++;</span></span>
<span><span class="co">#&gt;     _assign_ptr(lst);</span></span>
<span><span class="co">#&gt;     UNPROTECT(pro);</span></span>
<span><span class="co">#&gt;     return lst;</span></span>
<span><span class="co">#&gt;   } else {</span></span>
<span><span class="co">#&gt;     UNPROTECT(pro);</span></span>
<span><span class="co">#&gt;     return _mv;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__dydt_lsoda(int *neq, double *t, double *A, double *DADT)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__dydt(neq, *t, A, DADT);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern int rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__dydt_liblsoda(double __t, double *y, double *ydot, void *data)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   int *neq = (int*)(data);</span></span>
<span><span class="co">#&gt;   rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__dydt(neq, __t, y, ydot);</span></span>
<span><span class="co">#&gt;   return(0);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__calc_jac_lsoda(int *neq, double *t, double *A,int *ml, int *mu, double *JAC, int *nrowpd){</span></span>
<span><span class="co">#&gt;   // Update all covariate parameters</span></span>
<span><span class="co">#&gt;   rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__calc_jac(neq, *t, A, JAC, *nrowpd);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; //Create function to call from R's main thread that assigns the required functions. Sometimes they don't get assigned.</span></span>
<span><span class="co">#&gt; extern void rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__assignFuns(void){</span></span>
<span><span class="co">#&gt;   _assignFuns();</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; //Initialize the dll to match rxode2's calls</span></span>
<span><span class="co">#&gt; void R_init0_rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5_(void){</span></span>
<span><span class="co">#&gt;   // Get C callables on load; Otherwise it isn't thread safe</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5_","rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__assignFuns2", (DL_FUNC) __assignFuns2);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5_","rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__assignFuns", (DL_FUNC) rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__assignFuns);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5_","rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__inis",(DL_FUNC) rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__inis);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5_","rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__dydt",(DL_FUNC) rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__dydt);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5_","rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__calc_lhs",(DL_FUNC) rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__calc_lhs);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5_","rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__calc_jac",(DL_FUNC) rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__calc_jac);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5_","rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__dydt_lsoda", (DL_FUNC) rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__dydt_lsoda);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5_","rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__calc_jac_lsoda", (DL_FUNC) rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__calc_jac_lsoda);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5_","rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__ode_solver_solvedata", (DL_FUNC) rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__ode_solver_solvedata);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5_","rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__ode_solver_get_solvedata", (DL_FUNC) rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__ode_solver_get_solvedata);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5_","rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__F", (DL_FUNC) rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__F);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5_","rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__Lag", (DL_FUNC) rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__Lag);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5_","rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__Rate", (DL_FUNC) rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__Rate);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5_","rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__Dur", (DL_FUNC) rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__Dur);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5_","rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__mtime", (DL_FUNC) rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__mtime);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5_","rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__ME", (DL_FUNC) rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__ME);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5_","rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__IndF", (DL_FUNC) rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__IndF);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5_","rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__dydt_liblsoda", (DL_FUNC) rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__dydt_liblsoda);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; //Initialize the dll to match rxode2's calls</span></span>
<span><span class="co">#&gt; void R_init_rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5_(DllInfo *info){</span></span>
<span><span class="co">#&gt;   // Get C callables on load; Otherwise it isn't thread safe</span></span>
<span><span class="co">#&gt;   R_init0_rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5_();</span></span>
<span><span class="co">#&gt;   static const R_CallMethodDef callMethods[]  = {</span></span>
<span><span class="co">#&gt;     {"rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__model_vars", (DL_FUNC) &amp;rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__model_vars, 0},</span></span>
<span><span class="co">#&gt;     {NULL, NULL, 0}</span></span>
<span><span class="co">#&gt;   };</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   R_registerRoutines(info, NULL, callMethods, NULL, NULL);</span></span>
<span><span class="co">#&gt;   R_useDynamicSymbols(info,FALSE);</span></span>
<span><span class="co">#&gt;   _assignFuns0();</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; void R_unload_rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5_ (DllInfo *info){</span></span>
<span><span class="co">#&gt;   // Free resources required for single subject solve.</span></span>
<span><span class="co">#&gt;   SEXP _mv = PROTECT(_rxGetModelLib("rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__model_vars"));</span></span>
<span><span class="co">#&gt;   if (!Rf_isNull(_mv)){</span></span>
<span><span class="co">#&gt;     _rxRmModelLib("rx_b9e50f1ebc3b6d1ee286ca04a18e1ea5__model_vars");</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   UNPROTECT(1);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’</span></span>
<span><span class="co">#&gt; Warning: multi-subject simulation without without 'omega'</span></span></code></pre></div>
<p><img src="rxode2-pipeline_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>Note there are two different things that were added to this
simulation: - <code>nSub</code> to specify how many subjects are in the
model - <code>omega</code> to specify the between subject
variability.</p>
</div>
<div class="section level3">
<h3 id="simulation-with-unexplained-variability">Simulation with unexplained variability<a class="anchor" aria-label="anchor" href="#simulation-with-unexplained-variability"></a>
</h3>
<p>You can even add unexplained variability quite easily:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Ribba2012</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Use rxode2</span></span>
<span>  <span class="fu"><a href="../reference/ini.html">ini</a></span><span class="op">(</span>prop.sd<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># change variability</span></span>
<span>  <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>time.units<span class="op">=</span><span class="st">"months"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Pipe to a new event table</span></span>
<span>  <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>amt<span class="op">=</span><span class="fl">1</span>, time<span class="op">=</span><span class="fl">50</span>, until<span class="op">=</span><span class="fl">58</span>, ii<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Add dosing every 1.5 months</span></span>
<span>  <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">250</span>, by<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Add some sampling times (not required)</span></span>
<span>  <span class="fu"><a href="../reference/rxSolve.html">rxSolve</a></span><span class="op">(</span>nSub<span class="op">=</span><span class="fl">3</span>, omega<span class="op">=</span><span class="va">omega</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pt</span>, <span class="va">q</span>, <span class="va">qp</span>, <span class="va">sim</span><span class="op">)</span> <span class="co"># Plot it, plotting the variables of interest</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> parameter labels from comments are typically ignored in non-interactive mode</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Need to run with the source intact to parse comments</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `prop.sd` to `0.05`</span></span>
<span><span class="co">#&gt; Warning: multi-subject simulation without without 'omega'</span></span></code></pre></div>
<p><img src="rxode2-pipeline_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># note that sim is the simulated pstar since this is simulated from the</span></span>
<span><span class="co"># model with a nlmixr2 endpoint</span></span></code></pre></div>
<p>In this case we only added the <code>sigma</code> matrix to have
unexplained variability on the <code>pstar</code> or total tumor
tissue.</p>
<p>You can even simulate with uncertainty in the <code>theta</code>
<code>omega</code> and <code>sigma</code> values if you wish.</p>
</div>
<div class="section level3">
<h3 id="simulation-with-uncertainty-in-all-the-parameters-by-matrices">Simulation with uncertainty in all the parameters (by matrices)<a class="anchor" aria-label="anchor" href="#simulation-with-uncertainty-in-all-the-parameters-by-matrices"></a>
</h3>
<p>If we assume these parameters came from <code>95</code> subjects with
<code>8</code> observations apiece, the degrees of freedom for the omega
matrix would be <code>95</code>, and the degrees of freedom of the
<code>sigma</code> matrix would be <code>95*8=760</code> because
<code>95</code> items informed the <code>omega</code> matrix, and
<code>760</code> items informed the <code>sigma</code> matrix.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Ribba2012</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Use rxode2</span></span>
<span>  <span class="fu"><a href="../reference/ini.html">ini</a></span><span class="op">(</span>prop.sd <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>time.units<span class="op">=</span><span class="st">"months"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Pipe to a new event table</span></span>
<span>  <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>amt<span class="op">=</span><span class="fl">1</span>, time<span class="op">=</span><span class="fl">50</span>, until<span class="op">=</span><span class="fl">58</span>, ii<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Add dosing every 1.5 months</span></span>
<span>  <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">250</span>, by<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Add some sampling times (not required)</span></span>
<span>  <span class="fu"><a href="../reference/rxSolve.html">rxSolve</a></span><span class="op">(</span>nSub<span class="op">=</span><span class="fl">3</span>, nStud<span class="op">=</span><span class="fl">3</span>, omega<span class="op">=</span><span class="va">omega</span>,</span>
<span>          dfSub<span class="op">=</span><span class="fl">760</span>, dfObs<span class="op">=</span><span class="fl">95</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Solve the simulation</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pt</span>, <span class="va">q</span>, <span class="va">qp</span>, <span class="va">sim</span><span class="op">)</span> <span class="co"># Plot it, plotting the variables of interest</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> parameter labels from comments are typically ignored in non-interactive mode</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Need to run with the source intact to parse comments</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `prop.sd` to `0.05`</span></span>
<span><span class="co">#&gt; Warning: multi-subject simulation without without 'omega'</span></span></code></pre></div>
<p><img src="rxode2-pipeline_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>Often in simulations we have a full covariance matrix for the fixed
effect parameters. In this case, we do not have the matrix, but it could
be specified by <code>thetaMat</code>.</p>
<p>While we do not have a full covariance matrix, we can have
information about the diagonal elements of the covariance matrix from
the model paper. These can be converted as follows:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rseVar</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">est</span>, <span class="va">rse</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">est</span><span class="op">*</span><span class="va">rse</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">thetaMat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://nlmixr2.github.io/lotri/reference/lotri.html" class="external-link">lotri</a></span><span class="op">(</span><span class="va">tpt0</span> <span class="op">~</span> <span class="fu">rseVar</span><span class="op">(</span><span class="fl">7.13</span>,<span class="fl">25</span><span class="op">)</span>,</span>
<span>                  <span class="va">tq0</span> <span class="op">~</span> <span class="fu">rseVar</span><span class="op">(</span><span class="fl">41.2</span>,<span class="fl">7</span><span class="op">)</span>,</span>
<span>                  <span class="va">tlambdap</span> <span class="op">~</span> <span class="fu">rseVar</span><span class="op">(</span><span class="fl">0.121</span>, <span class="fl">16</span><span class="op">)</span>,</span>
<span>                  <span class="va">tkqpp</span> <span class="op">~</span> <span class="fu">rseVar</span><span class="op">(</span><span class="fl">0.0031</span>, <span class="fl">35</span><span class="op">)</span>,</span>
<span>                  <span class="va">tdeltaqp</span> <span class="op">~</span> <span class="fu">rseVar</span><span class="op">(</span><span class="fl">0.00867</span>, <span class="fl">21</span><span class="op">)</span>,</span>
<span>                  <span class="va">tgamma</span> <span class="op">~</span> <span class="fu">rseVar</span><span class="op">(</span><span class="fl">0.729</span>, <span class="fl">37</span><span class="op">)</span>,</span>
<span>                  <span class="va">tkde</span> <span class="op">~</span> <span class="fu">rseVar</span><span class="op">(</span><span class="fl">0.24</span>, <span class="fl">33</span><span class="op">)</span></span>
<span>                  <span class="op">)</span></span>
<span></span>
<span><span class="va">thetaMat</span></span>
<span><span class="co">#&gt;            tpt0   tq0 tlambdap    tkqpp  tdeltaqp  tgamma   tkde</span></span>
<span><span class="co">#&gt; tpt0     1.7825 0.000  0.00000 0.000000 0.0000000 0.00000 0.0000</span></span>
<span><span class="co">#&gt; tq0      0.0000 2.884  0.00000 0.000000 0.0000000 0.00000 0.0000</span></span>
<span><span class="co">#&gt; tlambdap 0.0000 0.000  0.01936 0.000000 0.0000000 0.00000 0.0000</span></span>
<span><span class="co">#&gt; tkqpp    0.0000 0.000  0.00000 0.001085 0.0000000 0.00000 0.0000</span></span>
<span><span class="co">#&gt; tdeltaqp 0.0000 0.000  0.00000 0.000000 0.0018207 0.00000 0.0000</span></span>
<span><span class="co">#&gt; tgamma   0.0000 0.000  0.00000 0.000000 0.0000000 0.26973 0.0000</span></span>
<span><span class="co">#&gt; tkde     0.0000 0.000  0.00000 0.000000 0.0000000 0.00000 0.0792</span></span></code></pre></div>
<p>Now we have a <code>thetaMat</code> to represent the uncertainty in
the <code>theta</code> matrix, as well as the other pieces in the
simulation. Typically you can put this information into your simulation
with the <code>thetaMat</code> matrix.</p>
<p>With such large variability in <code>theta</code> it is easy to
sample a negative rate constant, which does not make sense. For
example:</p>
<pre><code><span><span class="va">Ribba2012</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Use rxode2</span></span>
<span><span class="fu"><a href="../reference/ini.html">ini</a></span><span class="op">(</span>prop.sd <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>time.units<span class="op">=</span><span class="st">"months"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Pipe to a new event table</span></span>
<span><span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>amt<span class="op">=</span><span class="fl">1</span>, time<span class="op">=</span><span class="fl">50</span>, until<span class="op">=</span><span class="fl">58</span>, ii<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Add dosing every 1.5 months</span></span>
<span><span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">250</span>, by<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Add some sampling times (not required)</span></span>
<span><span class="fu"><a href="../reference/rxSolve.html">rxSolve</a></span><span class="op">(</span>nSub<span class="op">=</span><span class="fl">2</span>, nStud<span class="op">=</span><span class="fl">2</span>, omega<span class="op">=</span><span class="va">omega</span>,</span>
<span>thetaMat<span class="op">=</span><span class="va">thetaMat</span>,</span>
<span>dfSub<span class="op">=</span><span class="fl">760</span>, dfObs<span class="op">=</span><span class="fl">95</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Solve the simulation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pt</span>, <span class="va">q</span>, <span class="va">qp</span>, <span class="va">pstar</span><span class="op">)</span> <span class="co"># Plot it, plotting the variables of interest</span></span>
<span></span>
<span><span class="co">#&gt; ℹ change initial estimate of `prop.sd` to `0.05`</span></span>
<span><span class="co">#&gt; unhandled error message: EE:[lsoda] 70000 steps taken before reaching tout</span></span>
<span><span class="co">#&gt; @(lsoda.c:750</span></span>
<span><span class="co">#&gt; Warning message:</span></span>
<span><span class="co">#&gt; In rxSolve_(object, .ctl, .nms, .xtra, params, events, inits, setupOnly = .setupOnly) :</span></span>
<span><span class="co">#&gt;  Some ID(s) could not solve the ODEs correctly; These values are replaced with NA.</span></span></code></pre>
<p>To correct these problems you simply need to use a truncated
multivariate normal and specify the reasonable ranges for the
parameters. For <code>theta</code> this is specified by
<code>thetaLower</code> and <code>thetaUpper</code>. Similar parameters
are there for the other matrices: <code>omegaLower</code>,
<code>omegaUpper</code>, <code>sigmaLower</code> and
<code>sigmaUpper</code>. These may be named vectors, one numeric value,
or a numeric vector matching the number of parameters specified in the
<code>thetaMat</code> matrix.</p>
<p>In this case the simulation simply has to be modified to have
<code>thetaLower=0</code> to make sure all rates are positive:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Ribba2012</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Use rxode2</span></span>
<span>  <span class="fu"><a href="../reference/ini.html">ini</a></span><span class="op">(</span>prop.sd <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>time.units<span class="op">=</span><span class="st">"months"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Pipe to a new event table</span></span>
<span>  <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>amt<span class="op">=</span><span class="fl">1</span>, time<span class="op">=</span><span class="fl">50</span>, until<span class="op">=</span><span class="fl">58</span>, ii<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Add dosing every 1.5 months</span></span>
<span>  <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">250</span>, by<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Add some sampling times (not required)</span></span>
<span>  <span class="fu"><a href="../reference/rxSolve.html">rxSolve</a></span><span class="op">(</span>nSub<span class="op">=</span><span class="fl">2</span>, nStud<span class="op">=</span><span class="fl">2</span>, omega<span class="op">=</span><span class="va">omega</span>,</span>
<span>          thetaMat<span class="op">=</span><span class="va">thetaMat</span>,</span>
<span>          thetaLower<span class="op">=</span><span class="fl">0</span>, <span class="co"># Make sure the rates are reasonable</span></span>
<span>          dfSub<span class="op">=</span><span class="fl">760</span>, dfObs<span class="op">=</span><span class="fl">95</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Solve the simulation</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pt</span>, <span class="va">q</span>, <span class="va">qp</span>, <span class="va">sim</span><span class="op">)</span> <span class="co"># Plot it, plotting the variables of interest</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> parameter labels from comments are typically ignored in non-interactive mode</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Need to run with the source intact to parse comments</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `prop.sd` to `0.05`</span></span>
<span><span class="co">#&gt; Warning: multi-subject simulation without without 'omega'</span></span></code></pre></div>
<p><img src="rxode2-pipeline_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="summarizing-the-simulation-output">Summarizing the simulation output<a class="anchor" aria-label="anchor" href="#summarizing-the-simulation-output"></a>
</h2>
<p>While it is easy to use <code>dplyr</code> and
<code>data.table</code> to perform your own summary of simulations,
<code>rxode2</code> also provides this ability by the
<code>confint</code> function.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## This takes a little more time; Most of the time is the summary</span></span>
<span><span class="co">## time.</span></span>
<span></span>
<span><span class="va">sim0</span> <span class="op">&lt;-</span> <span class="va">Ribba2012</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Use rxode2</span></span>
<span>  <span class="fu"><a href="../reference/ini.html">ini</a></span><span class="op">(</span>prop.sd<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>time.units<span class="op">=</span><span class="st">"months"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Pipe to a new event table</span></span>
<span>  <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>amt<span class="op">=</span><span class="fl">1</span>, time<span class="op">=</span><span class="fl">50</span>, until<span class="op">=</span><span class="fl">58</span>, ii<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Add dosing every 1.5 months</span></span>
<span>  <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">250</span>, by<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Add some sampling times (not required)</span></span>
<span>  <span class="fu"><a href="../reference/rxSolve.html">rxSolve</a></span><span class="op">(</span>nSub<span class="op">=</span><span class="fl">10</span>, nStud<span class="op">=</span><span class="fl">10</span>, omega<span class="op">=</span><span class="va">omega</span>,</span>
<span>          thetaMat<span class="op">=</span><span class="va">thetaMat</span>,</span>
<span>          thetaLower<span class="op">=</span><span class="fl">0</span>, <span class="co"># Make sure the rates are reasonable</span></span>
<span>          dfSub<span class="op">=</span><span class="fl">760</span>, dfObs<span class="op">=</span><span class="fl">95</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Solve the simulation</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pt"</span>,<span class="st">"q"</span>,<span class="st">"qp"</span>,<span class="st">"sim"</span><span class="op">)</span>,level<span class="op">=</span><span class="fl">0.90</span><span class="op">)</span>; <span class="co"># Create Simulation intervals</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> parameter labels from comments are typically ignored in non-interactive mode</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Need to run with the source intact to parse comments</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `prop.sd` to `0.05`</span></span>
<span><span class="co">#&gt; Warning: multi-subject simulation without without 'omega'</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> in order to put confidence bands around the intervals, you need at least 2500 simulations</span></span>
<span><span class="co">#&gt; summarizing data...done</span></span>
<span></span>
<span><span class="va">sim0</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># Plot the simulation intervals</span></span></code></pre></div>
<p><img src="rxode2-pipeline_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<div class="section level3">
<h3 id="simulating-from-a-data-frame-of-parameters">Simulating from a data-frame of parameters<a class="anchor" aria-label="anchor" href="#simulating-from-a-data-frame-of-parameters"></a>
</h3>
<p>While the simulation from matrices can be very useful and a fast way
to simulate information, sometimes you may want to simulate more complex
scenarios. For instance, there may be some reason to believe that
<code>tkde</code> needs to be above <code>tlambdap</code>, therefore
these need to be simulated more carefully. You can generate the data
frame in whatever way you want. The internal method of simulating the
new parameters is exported too.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span></span>
<span><span class="va">Ribba2012</span> <span class="op">&lt;-</span> <span class="fu">Ribba2012</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># Convert to classic rxode2 model with ini attached</span></span>
<span></span>
<span><span class="va">r</span> <span class="op">&lt;-</span> <span class="va">Ribba2012</span><span class="op">$</span><span class="va">simulationIniModel</span></span>
<span><span class="co">#&gt; C model:</span></span>
<span><span class="co">#&gt; // Define translation state order for 5 states</span></span>
<span><span class="co">#&gt; #define __DDT0__ 0 // c</span></span>
<span><span class="co">#&gt; #define __DDT1__ 1 // pt</span></span>
<span><span class="co">#&gt; #define __DDT2__ 2 // q</span></span>
<span><span class="co">#&gt; #define __DDT3__ 3 // qp</span></span>
<span><span class="co">#&gt; #define __DDT4__ 4 // NA</span></span>
<span><span class="co">#&gt; // Define 3 LHS values</span></span>
<span><span class="co">#&gt; #define _LHS_0_ 0 // pstar</span></span>
<span><span class="co">#&gt; #define _LHS_1_ 1 // ipredSim</span></span>
<span><span class="co">#&gt; #define _LHS_2_ 2 // sim</span></span>
<span><span class="co">#&gt; #define _getRxSolve_ _rx2f49fa7b48a2de8f66d1017667f9c860286__getRxSolve__Fd0T</span></span>
<span><span class="co">#&gt; #define _evalUdf _rx2f49fa7b48a2de8f66d1017667f9c860287__evalUdf_JjUv</span></span>
<span><span class="co">#&gt; #define _solveData _rx2f49fa7b48a2de8f66d1017667f9c860288__solveData_8TjL</span></span>
<span><span class="co">#&gt; #define _assign_ptr _rx2f49fa7b48a2de8f66d1017667f9c860289__assign_ptr_cKNd</span></span>
<span><span class="co">#&gt; #define _rxRmModelLib _rx2f49fa7b48a2de8f66d1017667f9c860290__rxRmModelLib_tFTb</span></span>
<span><span class="co">#&gt; #define _rxGetModelLib _rx2f49fa7b48a2de8f66d1017667f9c860291__rxGetModelLib_qntF</span></span>
<span><span class="co">#&gt; #define _old_c _rx2f49fa7b48a2de8f66d1017667f9c860292__old_c_vGHM</span></span>
<span><span class="co">#&gt; #define _ptrid _rx2f49fa7b48a2de8f66d1017667f9c860293__ptrid_NOlZ</span></span>
<span><span class="co">#&gt; #define _rxIsCurrentC _rx2f49fa7b48a2de8f66d1017667f9c860294__rxIsCurrentC_DXZc</span></span>
<span><span class="co">#&gt; #define _sumPS _rx2f49fa7b48a2de8f66d1017667f9c860295__sumPS_fkj5</span></span>
<span><span class="co">#&gt; #define _prodPS _rx2f49fa7b48a2de8f66d1017667f9c860296__prodPS_TGXh</span></span>
<span><span class="co">#&gt; #define _prodType _rx2f49fa7b48a2de8f66d1017667f9c860297__prodType_bKjj</span></span>
<span><span class="co">#&gt; #define _sumType _rx2f49fa7b48a2de8f66d1017667f9c860298__sumType_GEjR</span></span>
<span><span class="co">#&gt; #define _update_par_ptr _rx2f49fa7b48a2de8f66d1017667f9c860299__update_par_ptr_kUH1</span></span>
<span><span class="co">#&gt; #define _getParCov _rx2f49fa7b48a2de8f66d1017667f9c860300__getParCov_s7he</span></span>
<span><span class="co">#&gt; #define _rxode2_rxAssignPtr _rx2f49fa7b48a2de8f66d1017667f9c860301__rxode2_rxAssignPtr_xLYF</span></span>
<span><span class="co">#&gt; #define _rxQr _rx2f49fa7b48a2de8f66d1017667f9c860302__rxQr_8KXs</span></span>
<span><span class="co">#&gt; #define _compareFactorVal _rx2f49fa7b48a2de8f66d1017667f9c860303__compareFactorVal_URHw</span></span>
<span><span class="co">#&gt; #define _sum _rx2f49fa7b48a2de8f66d1017667f9c860304__sum_qJRZ</span></span>
<span><span class="co">#&gt; #define _udf _rx2f49fa7b48a2de8f66d1017667f9c860305__udf_HqO3</span></span>
<span><span class="co">#&gt; #define _sign _rx2f49fa7b48a2de8f66d1017667f9c860306__sign_Vofw</span></span>
<span><span class="co">#&gt; #define _prod _rx2f49fa7b48a2de8f66d1017667f9c860307__prod_R1KH</span></span>
<span><span class="co">#&gt; #define _max _rx2f49fa7b48a2de8f66d1017667f9c860308__max_Eocy</span></span>
<span><span class="co">#&gt; #define _min _rx2f49fa7b48a2de8f66d1017667f9c860309__min_KZc2</span></span>
<span><span class="co">#&gt; #define _transit4P _rx2f49fa7b48a2de8f66d1017667f9c860310__transit4P_L56Z</span></span>
<span><span class="co">#&gt; #define _transit3P _rx2f49fa7b48a2de8f66d1017667f9c860311__transit3P_KHWD</span></span>
<span><span class="co">#&gt; #define _assignFuns0 _rx2f49fa7b48a2de8f66d1017667f9c860312__assignFuns0_Azol</span></span>
<span><span class="co">#&gt; #define _assignFuns _rx2f49fa7b48a2de8f66d1017667f9c860313__assignFuns_EkJD</span></span>
<span><span class="co">#&gt; #define _rxord _rx2f49fa7b48a2de8f66d1017667f9c860314__rxord_3mpP</span></span>
<span><span class="co">#&gt; #define __assignFuns2 _rx2f49fa7b48a2de8f66d1017667f9c860315___assignFuns2_BQ9P</span></span>
<span><span class="co">#&gt; #define _llikCauchyDscale _rx2f49fa7b48a2de8f66d1017667f9c860316__llikCauchyDscale_u43V</span></span>
<span><span class="co">#&gt; #define _llikCauchyDlocation _rx2f49fa7b48a2de8f66d1017667f9c860317__llikCauchyDlocation_wHEX</span></span>
<span><span class="co">#&gt; #define _llikCauchy _rx2f49fa7b48a2de8f66d1017667f9c860318__llikCauchy_0UpU</span></span>
<span><span class="co">#&gt; #define _llikGammaDrate _rx2f49fa7b48a2de8f66d1017667f9c860319__llikGammaDrate_PVJb</span></span>
<span><span class="co">#&gt; #define _llikGammaDshape _rx2f49fa7b48a2de8f66d1017667f9c860320__llikGammaDshape_ZPrL</span></span>
<span><span class="co">#&gt; #define _llikGamma _rx2f49fa7b48a2de8f66d1017667f9c860321__llikGamma_rWLj</span></span>
<span><span class="co">#&gt; #define _llikWeibullDscale _rx2f49fa7b48a2de8f66d1017667f9c860322__llikWeibullDscale_nE8l</span></span>
<span><span class="co">#&gt; #define _llikWeibullDshape _rx2f49fa7b48a2de8f66d1017667f9c860323__llikWeibullDshape_zcVb</span></span>
<span><span class="co">#&gt; #define _llikWeibull _rx2f49fa7b48a2de8f66d1017667f9c860324__llikWeibull_bWuC</span></span>
<span><span class="co">#&gt; #define _llikUnifDbeta _rx2f49fa7b48a2de8f66d1017667f9c860325__llikUnifDbeta_pJEN</span></span>
<span><span class="co">#&gt; #define _llikUnifDalpha _rx2f49fa7b48a2de8f66d1017667f9c860326__llikUnifDalpha_hIaI</span></span>
<span><span class="co">#&gt; #define _llikUnif _rx2f49fa7b48a2de8f66d1017667f9c860327__llikUnif_XKPO</span></span>
<span><span class="co">#&gt; #define _llikGeomDp _rx2f49fa7b48a2de8f66d1017667f9c860328__llikGeomDp_hyq6</span></span>
<span><span class="co">#&gt; #define _llikGeom _rx2f49fa7b48a2de8f66d1017667f9c860329__llikGeom_3fhF</span></span>
<span><span class="co">#&gt; #define _llikFDdf2 _rx2f49fa7b48a2de8f66d1017667f9c860330__llikFDdf2_6sOB</span></span>
<span><span class="co">#&gt; #define _llikFDdf1 _rx2f49fa7b48a2de8f66d1017667f9c860331__llikFDdf1_vZl6</span></span>
<span><span class="co">#&gt; #define _llikF _rx2f49fa7b48a2de8f66d1017667f9c860332__llikF_VCxm</span></span>
<span><span class="co">#&gt; #define _llikExpDrate _rx2f49fa7b48a2de8f66d1017667f9c860333__llikExpDrate_gT0P</span></span>
<span><span class="co">#&gt; #define _llikExp _rx2f49fa7b48a2de8f66d1017667f9c860334__llikExp_JOTH</span></span>
<span><span class="co">#&gt; #define _llikChisqDdf _rx2f49fa7b48a2de8f66d1017667f9c860335__llikChisqDdf_dSfb</span></span>
<span><span class="co">#&gt; #define _llikChisq _rx2f49fa7b48a2de8f66d1017667f9c860336__llikChisq_Ejko</span></span>
<span><span class="co">#&gt; #define _llikTDsd _rx2f49fa7b48a2de8f66d1017667f9c860337__llikTDsd_cvAt</span></span>
<span><span class="co">#&gt; #define _llikTDmean _rx2f49fa7b48a2de8f66d1017667f9c860338__llikTDmean_NKjQ</span></span>
<span><span class="co">#&gt; #define _llikTDdf _rx2f49fa7b48a2de8f66d1017667f9c860339__llikTDdf_UtM6</span></span>
<span><span class="co">#&gt; #define _llikT _rx2f49fa7b48a2de8f66d1017667f9c860340__llikT_Aoah</span></span>
<span><span class="co">#&gt; #define _llikBetaDshape2 _rx2f49fa7b48a2de8f66d1017667f9c860341__llikBetaDshape2_y3UQ</span></span>
<span><span class="co">#&gt; #define _llikBetaDshape1 _rx2f49fa7b48a2de8f66d1017667f9c860342__llikBetaDshape1_LHyQ</span></span>
<span><span class="co">#&gt; #define _llikBeta _rx2f49fa7b48a2de8f66d1017667f9c860343__llikBeta_yudK</span></span>
<span><span class="co">#&gt; #define _llikNbinomMuDmu _rx2f49fa7b48a2de8f66d1017667f9c860344__llikNbinomMuDmu_vMv7</span></span>
<span><span class="co">#&gt; #define _llikNbinomMu _rx2f49fa7b48a2de8f66d1017667f9c860345__llikNbinomMu_Nqea</span></span>
<span><span class="co">#&gt; #define _llikNbinomDprob _rx2f49fa7b48a2de8f66d1017667f9c860346__llikNbinomDprob_GSpX</span></span>
<span><span class="co">#&gt; #define _llikNbinom _rx2f49fa7b48a2de8f66d1017667f9c860347__llikNbinom_lUSO</span></span>
<span><span class="co">#&gt; #define _llikBinomDprob _rx2f49fa7b48a2de8f66d1017667f9c860348__llikBinomDprob_SAMi</span></span>
<span><span class="co">#&gt; #define _llikBinom _rx2f49fa7b48a2de8f66d1017667f9c860349__llikBinom_X55i</span></span>
<span><span class="co">#&gt; #define _llikPoisDlambda _rx2f49fa7b48a2de8f66d1017667f9c860350__llikPoisDlambda_TuFv</span></span>
<span><span class="co">#&gt; #define _llikPois _rx2f49fa7b48a2de8f66d1017667f9c860351__llikPois_OUmq</span></span>
<span><span class="co">#&gt; #define _llikNormDsd _rx2f49fa7b48a2de8f66d1017667f9c860352__llikNormDsd_iOQ5</span></span>
<span><span class="co">#&gt; #define _llikNormDmean _rx2f49fa7b48a2de8f66d1017667f9c860353__llikNormDmean_avto</span></span>
<span><span class="co">#&gt; #define _llikNorm _rx2f49fa7b48a2de8f66d1017667f9c860354__llikNorm_Xyll</span></span>
<span><span class="co">#&gt; #define simeps _rx2f49fa7b48a2de8f66d1017667f9c860355_simeps_KxRL</span></span>
<span><span class="co">#&gt; #define simeta _rx2f49fa7b48a2de8f66d1017667f9c860356_simeta_62I1</span></span>
<span><span class="co">#&gt; #define expit _rx2f49fa7b48a2de8f66d1017667f9c860357_expit_Ps9r</span></span>
<span><span class="co">#&gt; #define logit _rx2f49fa7b48a2de8f66d1017667f9c860358_logit_VKX1</span></span>
<span><span class="co">#&gt; #define gammapDer _rx2f49fa7b48a2de8f66d1017667f9c860359_gammapDer_TyhY</span></span>
<span><span class="co">#&gt; #define lowergamma _rx2f49fa7b48a2de8f66d1017667f9c860360_lowergamma_KFvn</span></span>
<span><span class="co">#&gt; #define uppergamma _rx2f49fa7b48a2de8f66d1017667f9c860361_uppergamma_SBnS</span></span>
<span><span class="co">#&gt; #define gammaqInva _rx2f49fa7b48a2de8f66d1017667f9c860362_gammaqInva_RNPm</span></span>
<span><span class="co">#&gt; #define gammaqInv _rx2f49fa7b48a2de8f66d1017667f9c860363_gammaqInv_C4iD</span></span>
<span><span class="co">#&gt; #define gammapInva _rx2f49fa7b48a2de8f66d1017667f9c860364_gammapInva_SX0F</span></span>
<span><span class="co">#&gt; #define gammapInv _rx2f49fa7b48a2de8f66d1017667f9c860365_gammapInv_onv5</span></span>
<span><span class="co">#&gt; #define gammaq _rx2f49fa7b48a2de8f66d1017667f9c860366_gammaq_tNho</span></span>
<span><span class="co">#&gt; #define gammap _rx2f49fa7b48a2de8f66d1017667f9c860367_gammap_Is7E</span></span>
<span><span class="co">#&gt; #define phi _rx2f49fa7b48a2de8f66d1017667f9c860368_phi_pCoy</span></span>
<span><span class="co">#&gt; #define d2ELUa _rx2f49fa7b48a2de8f66d1017667f9c860369_d2ELUa_jBsh</span></span>
<span><span class="co">#&gt; #define dELUa _rx2f49fa7b48a2de8f66d1017667f9c860370_dELUa_DDFN</span></span>
<span><span class="co">#&gt; #define d2aELU _rx2f49fa7b48a2de8f66d1017667f9c860371_d2aELU_HRxB</span></span>
<span><span class="co">#&gt; #define d2ELU _rx2f49fa7b48a2de8f66d1017667f9c860372_d2ELU_okJH</span></span>
<span><span class="co">#&gt; #define dELU _rx2f49fa7b48a2de8f66d1017667f9c860373_dELU_Rnle</span></span>
<span><span class="co">#&gt; #define ELU _rx2f49fa7b48a2de8f66d1017667f9c860374_ELU_eU9x</span></span>
<span><span class="co">#&gt; #define dPReLUa1 _rx2f49fa7b48a2de8f66d1017667f9c860375_dPReLUa1_kHso</span></span>
<span><span class="co">#&gt; #define dPReLUa _rx2f49fa7b48a2de8f66d1017667f9c860376_dPReLUa_tWb7</span></span>
<span><span class="co">#&gt; #define dPReLU _rx2f49fa7b48a2de8f66d1017667f9c860377_dPReLU_Lggc</span></span>
<span><span class="co">#&gt; #define PReLU _rx2f49fa7b48a2de8f66d1017667f9c860378_PReLU_qJ2j</span></span>
<span><span class="co">#&gt; #define dSwish _rx2f49fa7b48a2de8f66d1017667f9c860379_dSwish_uubC</span></span>
<span><span class="co">#&gt; #define Swish _rx2f49fa7b48a2de8f66d1017667f9c860380_Swish_2myJ</span></span>
<span><span class="co">#&gt; #define dlReLU _rx2f49fa7b48a2de8f66d1017667f9c860381_dlReLU_lelS</span></span>
<span><span class="co">#&gt; #define lReLU _rx2f49fa7b48a2de8f66d1017667f9c860382_lReLU_H51K</span></span>
<span><span class="co">#&gt; #define dSELU _rx2f49fa7b48a2de8f66d1017667f9c860383_dSELU_iasM</span></span>
<span><span class="co">#&gt; #define SELU _rx2f49fa7b48a2de8f66d1017667f9c860384_SELU_vaV4</span></span>
<span><span class="co">#&gt; #define d4softplus _rx2f49fa7b48a2de8f66d1017667f9c860385_d4softplus_E0M9</span></span>
<span><span class="co">#&gt; #define d3softplus _rx2f49fa7b48a2de8f66d1017667f9c860386_d3softplus_4dHo</span></span>
<span><span class="co">#&gt; #define d2softplus _rx2f49fa7b48a2de8f66d1017667f9c860387_d2softplus_lcBE</span></span>
<span><span class="co">#&gt; #define dsoftplus _rx2f49fa7b48a2de8f66d1017667f9c860388_dsoftplus_3tqq</span></span>
<span><span class="co">#&gt; #define softplus _rx2f49fa7b48a2de8f66d1017667f9c860389_softplus_HPy6</span></span>
<span><span class="co">#&gt; #define d4GELU _rx2f49fa7b48a2de8f66d1017667f9c860390_d4GELU_WfL8</span></span>
<span><span class="co">#&gt; #define d3GELU _rx2f49fa7b48a2de8f66d1017667f9c860391_d3GELU_GUfZ</span></span>
<span><span class="co">#&gt; #define d2GELU _rx2f49fa7b48a2de8f66d1017667f9c860392_d2GELU_GwK4</span></span>
<span><span class="co">#&gt; #define dGELU _rx2f49fa7b48a2de8f66d1017667f9c860393_dGELU_pqPj</span></span>
<span><span class="co">#&gt; #define GELU _rx2f49fa7b48a2de8f66d1017667f9c860394_GELU_loUS</span></span>
<span><span class="co">#&gt; #define dReLU _rx2f49fa7b48a2de8f66d1017667f9c860395_dReLU_3m10</span></span>
<span><span class="co">#&gt; #define ReLU _rx2f49fa7b48a2de8f66d1017667f9c860396_ReLU_JhDG</span></span>
<span><span class="co">#&gt; #define riweibull _rx2f49fa7b48a2de8f66d1017667f9c860397_riweibull_qhJW</span></span>
<span><span class="co">#&gt; #define riunif _rx2f49fa7b48a2de8f66d1017667f9c860398_riunif_mJ4L</span></span>
<span><span class="co">#&gt; #define rit_ _rx2f49fa7b48a2de8f66d1017667f9c860399_rit__DYPi</span></span>
<span><span class="co">#&gt; #define ripois _rx2f49fa7b48a2de8f66d1017667f9c860400_ripois_3eeo</span></span>
<span><span class="co">#&gt; #define ribeta _rx2f49fa7b48a2de8f66d1017667f9c860401_ribeta_O0bO</span></span>
<span><span class="co">#&gt; #define rigamma _rx2f49fa7b48a2de8f66d1017667f9c860402_rigamma_jsqw</span></span>
<span><span class="co">#&gt; #define rigeom _rx2f49fa7b48a2de8f66d1017667f9c860403_rigeom_sPQI</span></span>
<span><span class="co">#&gt; #define rif _rx2f49fa7b48a2de8f66d1017667f9c860404_rif_cHxA</span></span>
<span><span class="co">#&gt; #define riexp _rx2f49fa7b48a2de8f66d1017667f9c860405_riexp_r2me</span></span>
<span><span class="co">#&gt; #define richisq _rx2f49fa7b48a2de8f66d1017667f9c860406_richisq_iJIb</span></span>
<span><span class="co">#&gt; #define ricauchy _rx2f49fa7b48a2de8f66d1017667f9c860407_ricauchy_iwB3</span></span>
<span><span class="co">#&gt; #define rinbinomMu _rx2f49fa7b48a2de8f66d1017667f9c860408_rinbinomMu_BPxX</span></span>
<span><span class="co">#&gt; #define rinbinom _rx2f49fa7b48a2de8f66d1017667f9c860409_rinbinom_FpHG</span></span>
<span><span class="co">#&gt; #define ribinom _rx2f49fa7b48a2de8f66d1017667f9c860410_ribinom_ONzn</span></span>
<span><span class="co">#&gt; #define rinorm _rx2f49fa7b48a2de8f66d1017667f9c860411_rinorm_MVZR</span></span>
<span><span class="co">#&gt; #define rxweibull _rx2f49fa7b48a2de8f66d1017667f9c860412_rxweibull_AG3C</span></span>
<span><span class="co">#&gt; #define rxunif _rx2f49fa7b48a2de8f66d1017667f9c860413_rxunif_bFJa</span></span>
<span><span class="co">#&gt; #define rxt_ _rx2f49fa7b48a2de8f66d1017667f9c860414_rxt__NchH</span></span>
<span><span class="co">#&gt; #define rxpois _rx2f49fa7b48a2de8f66d1017667f9c860415_rxpois_j62I</span></span>
<span><span class="co">#&gt; #define rxbeta _rx2f49fa7b48a2de8f66d1017667f9c860416_rxbeta_uMnn</span></span>
<span><span class="co">#&gt; #define rxgamma _rx2f49fa7b48a2de8f66d1017667f9c860417_rxgamma_J4uF</span></span>
<span><span class="co">#&gt; #define rxgeom _rx2f49fa7b48a2de8f66d1017667f9c860418_rxgeom_pmtJ</span></span>
<span><span class="co">#&gt; #define rxf _rx2f49fa7b48a2de8f66d1017667f9c860419_rxf_v96j</span></span>
<span><span class="co">#&gt; #define rxexp _rx2f49fa7b48a2de8f66d1017667f9c860420_rxexp_Pfuj</span></span>
<span><span class="co">#&gt; #define rxchisq _rx2f49fa7b48a2de8f66d1017667f9c860421_rxchisq_cc4u</span></span>
<span><span class="co">#&gt; #define rxcauchy _rx2f49fa7b48a2de8f66d1017667f9c860422_rxcauchy_nJNJ</span></span>
<span><span class="co">#&gt; #define rxnbinomMu _rx2f49fa7b48a2de8f66d1017667f9c860423_rxnbinomMu_cMgZ</span></span>
<span><span class="co">#&gt; #define rxnbinom _rx2f49fa7b48a2de8f66d1017667f9c860424_rxnbinom_IAbN</span></span>
<span><span class="co">#&gt; #define rxbinom _rx2f49fa7b48a2de8f66d1017667f9c860425_rxbinom_Ya50</span></span>
<span><span class="co">#&gt; #define rxnorm _rx2f49fa7b48a2de8f66d1017667f9c860426_rxnorm_Z5ox</span></span>
<span><span class="co">#&gt; #define linCmtB _rx2f49fa7b48a2de8f66d1017667f9c860427_linCmtB_RbCC</span></span>
<span><span class="co">#&gt; #define linCmtA _rx2f49fa7b48a2de8f66d1017667f9c860428_linCmtA_r7Em</span></span>
<span><span class="co">#&gt; #include &lt;rxode2_model_shared.h&gt;</span></span>
<span><span class="co">#&gt; #define __MAX_PROD__ 0</span></span>
<span><span class="co">#&gt; #define _CMT CMT</span></span>
<span><span class="co">#&gt; #define _SYNC_simeps_ for (int _svari=_solveData-&gt;neps; _svari--;){  if (_solveData-&gt;svar[_svari] == 0) {k = _PP[0];};   if (_solveData-&gt;svar[_svari] == 1) {tkde = _PP[1];};   if (_solveData-&gt;svar[_svari] == 2) {eta_DoT_tkde = _PP[2];};   if (_solveData-&gt;svar[_svari] == 3) {tkpq = _PP[3];};   if (_solveData-&gt;svar[_svari] == 4) {eta_DoT_kpq = _PP[4];};   if (_solveData-&gt;svar[_svari] == 5) {tkqpp = _PP[5];};   if (_solveData-&gt;svar[_svari] == 6) {eta_DoT_kqpp = _PP[6];};   if (_solveData-&gt;svar[_svari] == 7) {tlambdap = _PP[7];};   if (_solveData-&gt;svar[_svari] == 8) {eta_DoT_lambdap = _PP[8];};   if (_solveData-&gt;svar[_svari] == 9) {tgamma = _PP[9];};   if (_solveData-&gt;svar[_svari] == 10) {eta_DoT_gamma = _PP[10];};   if (_solveData-&gt;svar[_svari] == 11) {tdeltaqp = _PP[11];};   if (_solveData-&gt;svar[_svari] == 12) {eta_DoT_deltaqp = _PP[12];};   if (_solveData-&gt;svar[_svari] == 13) {prop_DoT_sd = _PP[13];};   if (_solveData-&gt;svar[_svari] == 14) {tpt0 = _PP[14];};   if (_solveData-&gt;svar[_svari] == 15) {eta_DoT_pt0 = _PP[15];};   if (_solveData-&gt;svar[_svari] == 16) {tq0 = _PP[16];};   if (_solveData-&gt;svar[_svari] == 17) {eta_DoT_q0 = _PP[17];};   if (_solveData-&gt;svar[_svari] == 18) {rxerr_DoT_pstar = _PP[18];}; }</span></span>
<span><span class="co">#&gt; #define _SYNC_simeta_ for (int _ovari=_solveData-&gt;neta; _ovari--;){  if (_solveData-&gt;ovar[_ovari] == 0) {k = _PP[0];};   if (_solveData-&gt;ovar[_ovari] == 1) {tkde = _PP[1];};   if (_solveData-&gt;ovar[_ovari] == 2) {eta_DoT_tkde = _PP[2];};   if (_solveData-&gt;ovar[_ovari] == 3) {tkpq = _PP[3];};   if (_solveData-&gt;ovar[_ovari] == 4) {eta_DoT_kpq = _PP[4];};   if (_solveData-&gt;ovar[_ovari] == 5) {tkqpp = _PP[5];};   if (_solveData-&gt;ovar[_ovari] == 6) {eta_DoT_kqpp = _PP[6];};   if (_solveData-&gt;ovar[_ovari] == 7) {tlambdap = _PP[7];};   if (_solveData-&gt;ovar[_ovari] == 8) {eta_DoT_lambdap = _PP[8];};   if (_solveData-&gt;ovar[_ovari] == 9) {tgamma = _PP[9];};   if (_solveData-&gt;ovar[_ovari] == 10) {eta_DoT_gamma = _PP[10];};   if (_solveData-&gt;ovar[_ovari] == 11) {tdeltaqp = _PP[11];};   if (_solveData-&gt;ovar[_ovari] == 12) {eta_DoT_deltaqp = _PP[12];};   if (_solveData-&gt;ovar[_ovari] == 13) {prop_DoT_sd = _PP[13];};   if (_solveData-&gt;ovar[_ovari] == 14) {tpt0 = _PP[14];};   if (_solveData-&gt;ovar[_ovari] == 15) {eta_DoT_pt0 = _PP[15];};   if (_solveData-&gt;ovar[_ovari] == 16) {tq0 = _PP[16];};   if (_solveData-&gt;ovar[_ovari] == 17) {eta_DoT_q0 = _PP[17];};   if (_solveData-&gt;ovar[_ovari] == 18) {rxerr_DoT_pstar = _PP[18];}; }</span></span>
<span><span class="co">#&gt; _getRxSolve_t _getRxSolve_;</span></span>
<span><span class="co">#&gt; _simfun simeps;</span></span>
<span><span class="co">#&gt; _simfun simeta;</span></span>
<span><span class="co">#&gt; _udf_type _evalUdf=NULL;</span></span>
<span><span class="co">#&gt; rx_solve *_solveData=NULL;</span></span>
<span><span class="co">#&gt; rxode2_assign_ptr _assign_ptr=NULL;</span></span>
<span><span class="co">#&gt; _rxRmModelLibType _rxRmModelLib=NULL;</span></span>
<span><span class="co">#&gt; _rxGetModelLibType _rxGetModelLib=NULL;</span></span>
<span><span class="co">#&gt; rxode2_ode_solver_old_c _old_c=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _ptrid=NULL;</span></span>
<span><span class="co">#&gt; _rxIsCurrentC_type _rxIsCurrentC=NULL;</span></span>
<span><span class="co">#&gt; _rxSumType _sumPS=NULL;</span></span>
<span><span class="co">#&gt; _rxProdType _prodPS=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _prodType=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _sumType=NULL;</span></span>
<span><span class="co">#&gt; _update_par_ptr_p _update_par_ptr=NULL;</span></span>
<span><span class="co">#&gt; _getParCov_p _getParCov=NULL;</span></span>
<span><span class="co">#&gt; linCmtA_p linCmtA;</span></span>
<span><span class="co">#&gt; linCmtB_p linCmtB;</span></span>
<span><span class="co">#&gt; _rx_asgn _rxode2_rxAssignPtr=NULL;</span></span>
<span><span class="co">#&gt; _rx_asgn _rxQr=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn phi;</span></span>
<span><span class="co">#&gt; rxode2_fn ReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn dReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn dGELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d2GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d3GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d4GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn dsoftplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d2softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d3softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d4softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn SELU;</span></span>
<span><span class="co">#&gt; rxode2_fn dSELU;</span></span>
<span><span class="co">#&gt; rxode2_fn lReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn dlReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn Swish;</span></span>
<span><span class="co">#&gt; rxode2_fn dSwish;</span></span>
<span><span class="co">#&gt; rxode2_fn2 PReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLUa;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLUa1;</span></span>
<span><span class="co">#&gt; rxode2_fn2 ELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2ELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2aELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dELUa;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2ELUa;</span></span>
<span><span class="co">#&gt; rxode2_fn3 logit;</span></span>
<span><span class="co">#&gt; rxode2_fn3 expit;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammap;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaq;</span></span>
<span><span class="co">#&gt; rxode2_fn2 lowergamma;</span></span>
<span><span class="co">#&gt; rxode2_fn2 uppergamma;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapInv;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapDer;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapInva;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaqInv;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaqInva;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxnorm;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxbinom;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxnbinom;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxnbinomMu;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxcauchy;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxchisq;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxexp;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxf;</span></span>
<span><span class="co">#&gt; rxode2i_ifn rxgeom;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxgamma;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxbeta;</span></span>
<span><span class="co">#&gt; rxode2i_ifn rxpois;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxt_;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxunif;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxweibull;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rinorm;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom ribinom;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom rinbinom;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom rinbinomMu;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 ricauchy;</span></span>
<span><span class="co">#&gt; rxode2i2_fn richisq;</span></span>
<span><span class="co">#&gt; rxode2i2_fn riexp;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rif;</span></span>
<span><span class="co">#&gt; rxode2i2_ifn rigeom;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rigamma;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 ribeta;</span></span>
<span><span class="co">#&gt; rxode2i2_ifn ripois;</span></span>
<span><span class="co">#&gt; rxode2i2_fn rit_;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 riunif;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 riweibull;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNorm;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNormDmean;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNormDsd;</span></span>
<span><span class="co">#&gt; rxode2_llikPoisFun _llikPois;</span></span>
<span><span class="co">#&gt; rxode2_llikPoisFun _llikPoisDlambda;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikBinom;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikBinomDprob;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinom;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomDprob;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomMu;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomMuDmu;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBeta;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBetaDshape1;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBetaDshape2;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikT;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDdf;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDmean;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDsd;</span></span>
<span><span class="co">#&gt; rxode2_llikChisqFun _llikChisq;</span></span>
<span><span class="co">#&gt; rxode2_llikChisqFun _llikChisqDdf;</span></span>
<span><span class="co">#&gt; rxode2_llikExpFun _llikExp;</span></span>
<span><span class="co">#&gt; rxode2_llikExpFun _llikExpDrate;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikF;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikFDdf1;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikFDdf2;</span></span>
<span><span class="co">#&gt; rxode2_llikGeomFun _llikGeom;</span></span>
<span><span class="co">#&gt; rxode2_llikGeomFun _llikGeomDp;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnif;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnifDalpha;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnifDbeta;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibull;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibullDshape;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibullDscale;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGamma;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGammaDshape;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGammaDrate;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchy;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchyDlocation;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchyDscale;</span></span>
<span><span class="co">#&gt; rxode2_compareFactorVal_fn _compareFactorVal;</span></span>
<span><span class="co">#&gt; #include "extraC.h"</span></span>
<span><span class="co">#&gt; double _prod(double *input, double *p, int type, int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return _prodPS(input, p, n, type);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _udf(const char *funName, double *input, int n, ...) {</span></span>
<span><span class="co">#&gt;   if (n == -42) Rf_error("%s", "this has a ui user function that cannot be called directly");</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return _evalUdf(funName, n, input);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _sum(double *input, double *pld, int m, int type, int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   double ret = _sumPS(input, n, pld, m, type);</span></span>
<span><span class="co">#&gt;   if (type == 2 &amp;&amp; m &lt; 0){</span></span>
<span><span class="co">#&gt;     for (int i = -m; i--;){</span></span>
<span><span class="co">#&gt;       pld[i] = 0.0;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return ret;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _sign(unsigned int n, ...) {</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double s = 1;</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;     s = sign(va_arg(valist, double))*s;</span></span>
<span><span class="co">#&gt;     if (s == 0){</span></span>
<span><span class="co">#&gt;       break;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return s;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _rxord(int _cSub, unsigned int n,  ...) {</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind* ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   if (!ind-&gt;inLhs) {</span></span>
<span><span class="co">#&gt;     return 1.0;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double ret = 1.0;</span></span>
<span><span class="co">#&gt;   double p = 0.0;</span></span>
<span><span class="co">#&gt;   double u = rxunif(ind, 0.0, 1.0);</span></span>
<span><span class="co">#&gt;   int found = 0;</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;     p += va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     if (!found) {</span></span>
<span><span class="co">#&gt;       if (u &lt; p) {</span></span>
<span><span class="co">#&gt;         ret = (double)(i+1);</span></span>
<span><span class="co">#&gt;         found = 1;</span></span>
<span><span class="co">#&gt;       }</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   if (!found) ret =(double)(n+1);</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return ret;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _max(unsigned int n, ...) {</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double mx = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tmp = 0;</span></span>
<span><span class="co">#&gt;   if (n &gt;= 1){</span></span>
<span><span class="co">#&gt;     mx = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     for (unsigned int i = 1; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;       tmp = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;       if (tmp&gt;mx) mx=tmp;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     va_end(valist);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return mx;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _min(unsigned int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double mn = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tmp = 0;</span></span>
<span><span class="co">#&gt;   if (n &gt;= 1){</span></span>
<span><span class="co">#&gt;     mn = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     for (unsigned int i = 1; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;       tmp = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;       if (tmp&lt;mn) mn=tmp;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     va_end(valist);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return mn;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _transit4P(int cmt, double t, unsigned int id, double n, double mtt, double bio){</span></span>
<span><span class="co">#&gt;   double nd = (double) n;</span></span>
<span><span class="co">#&gt;   double ktr = (nd+1)/mtt;</span></span>
<span><span class="co">#&gt;   double lktr = _safe_log(nd+1)-_safe_log(mtt);</span></span>
<span><span class="co">#&gt;   double tlast = _solveData-&gt;subjects[id].tlastS[cmt];</span></span>
<span><span class="co">#&gt;   double dose = _solveData-&gt;subjects[id].curDoseS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(dose)) dose = 0.0;</span></span>
<span><span class="co">#&gt;   if (ISNA(tlast)) tlast = 0.0;</span></span>
<span><span class="co">#&gt;   double tad = (t-tlast);</span></span>
<span><span class="co">#&gt;   return exp(_safe_log(bio*dose)+lktr+n*(lktr+_safe_log(tad))-ktr*(tad)-lgamma1p(nd));</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _transit3P(int cmt, double t, unsigned int id, double n, double mtt){</span></span>
<span><span class="co">#&gt;   double nd = (double) n;</span></span>
<span><span class="co">#&gt;   double ktr = (nd+1)/mtt;</span></span>
<span><span class="co">#&gt;   double lktr = _safe_log(nd+1)-_safe_log(mtt);</span></span>
<span><span class="co">#&gt;   double tlast = _solveData-&gt;subjects[id].tlastS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(tlast)) tlast = 0.0;</span></span>
<span><span class="co">#&gt;   double tad = t-tlast;</span></span>
<span><span class="co">#&gt;   double podo = _solveData-&gt;subjects[id].curDoseS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(podo)) podo = 0.0;</span></span>
<span><span class="co">#&gt;   return exp(_safe_log(podo)+lktr+n*(lktr+_safe_log(tad))-ktr*(tad)-lgamma1p(nd));</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void _assignFuns0(void) {</span></span>
<span><span class="co">#&gt;   _evalUdf = (_udf_type) R_GetCCallable("rxode2", "_rxode2_evalUdf");</span></span>
<span><span class="co">#&gt;   _getRxSolve_ = (_getRxSolve_t) R_GetCCallable("rxode2","getRxSolve_");</span></span>
<span><span class="co">#&gt;   _assign_ptr=(rxode2_assign_ptr) R_GetCCallable("rxode2","rxode2_assign_fn_pointers");</span></span>
<span><span class="co">#&gt;   _rxRmModelLib=(_rxRmModelLibType) R_GetCCallable("rxode2","rxRmModelLib");</span></span>
<span><span class="co">#&gt;   _rxGetModelLib=(_rxGetModelLibType) R_GetCCallable("rxode2","rxGetModelLib");</span></span>
<span><span class="co">#&gt;   _rxode2_rxAssignPtr=(_rx_asgn)R_GetCCallable("rxode2","_rxode2_rxAssignPtr");</span></span>
<span><span class="co">#&gt;   _rxQr=(_rx_asgn)R_GetCCallable("rxode2","_rxode2_rxQr");</span></span>
<span><span class="co">#&gt;   _rxIsCurrentC = (_rxIsCurrentC_type)R_GetCCallable("rxode2","rxIsCurrentC");</span></span>
<span><span class="co">#&gt;   _sumPS  = (_rxSumType) R_GetCCallable("PreciseSums","PreciseSums_sum_r");</span></span>
<span><span class="co">#&gt;   _prodPS = (_rxProdType) R_GetCCallable("PreciseSums","PreciseSums_prod_r");</span></span>
<span><span class="co">#&gt;   _prodType=(rxode2_fn0i)R_GetCCallable("PreciseSums", "PreciseSums_prod_get");</span></span>
<span><span class="co">#&gt;   _sumType=(rxode2_fn0i)R_GetCCallable("PreciseSums", "PreciseSums_sum_get");</span></span>
<span><span class="co">#&gt;   _ptrid=(rxode2_fn0i)R_GetCCallable("rxode2", "rxode2_current_fn_pointer_id");</span></span>
<span><span class="co">#&gt;   _compareFactorVal=(rxode2_compareFactorVal_fn) R_GetCCallable("rxode2", "compareFactorVal");</span></span>
<span><span class="co">#&gt;   _update_par_ptr = (_update_par_ptr_p) R_GetCCallable("rxode2","_update_par_ptr");</span></span>
<span><span class="co">#&gt;   _getParCov = (_getParCov_p) R_GetCCallable("rxode2","_getParCov");</span></span>
<span><span class="co">#&gt;   // dynamic start</span></span>
<span><span class="co">#&gt;   _llikCauchyDscale = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchyDscale");</span></span>
<span><span class="co">#&gt;   _llikCauchyDlocation = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchyDlocation");</span></span>
<span><span class="co">#&gt;   _llikCauchy = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchy");</span></span>
<span><span class="co">#&gt;   _llikGammaDrate = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGammaDrate");</span></span>
<span><span class="co">#&gt;   _llikGammaDshape = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGammaDshape");</span></span>
<span><span class="co">#&gt;   _llikGamma = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGamma");</span></span>
<span><span class="co">#&gt;   _llikWeibullDscale = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibullDscale");</span></span>
<span><span class="co">#&gt;   _llikWeibullDshape = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibullDshape");</span></span>
<span><span class="co">#&gt;   _llikWeibull = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibull");</span></span>
<span><span class="co">#&gt;   _llikUnifDbeta = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnifDbeta");</span></span>
<span><span class="co">#&gt;   _llikUnifDalpha = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnifDalpha");</span></span>
<span><span class="co">#&gt;   _llikUnif = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnif");</span></span>
<span><span class="co">#&gt;   _llikGeomDp = (rxode2_llikGeomFun) R_GetCCallable("rxode2ll", "rxLlikGeomDp");</span></span>
<span><span class="co">#&gt;   _llikGeom = (rxode2_llikGeomFun) R_GetCCallable("rxode2ll", "rxLlikGeom");</span></span>
<span><span class="co">#&gt;   _llikFDdf2 = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikFDdf2");</span></span>
<span><span class="co">#&gt;   _llikFDdf1 = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikFDdf1");</span></span>
<span><span class="co">#&gt;   _llikF = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikF");</span></span>
<span><span class="co">#&gt;   _llikExpDrate = (rxode2_llikExpFun) R_GetCCallable("rxode2ll", "rxLlikExpDrate");</span></span>
<span><span class="co">#&gt;   _llikExp = (rxode2_llikExpFun) R_GetCCallable("rxode2ll", "rxLlikExp");</span></span>
<span><span class="co">#&gt;   _llikChisqDdf = (rxode2_llikChisqFun) R_GetCCallable("rxode2ll", "rxLlikChisqDdf");</span></span>
<span><span class="co">#&gt;   _llikChisq = (rxode2_llikChisqFun) R_GetCCallable("rxode2ll", "rxLlikChisq");</span></span>
<span><span class="co">#&gt;   _llikTDsd = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDsd");</span></span>
<span><span class="co">#&gt;   _llikTDmean = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDmean");</span></span>
<span><span class="co">#&gt;   _llikTDdf = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDdf");</span></span>
<span><span class="co">#&gt;   _llikT = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikT");</span></span>
<span><span class="co">#&gt;   _llikBetaDshape2 = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBetaDshape2");</span></span>
<span><span class="co">#&gt;   _llikBetaDshape1 = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBetaDshape1");</span></span>
<span><span class="co">#&gt;   _llikBeta = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBeta");</span></span>
<span><span class="co">#&gt;   _llikNbinomMuDmu = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomMuDmu");</span></span>
<span><span class="co">#&gt;   _llikNbinomMu = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomMu");</span></span>
<span><span class="co">#&gt;   _llikNbinomDprob = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomDprob");</span></span>
<span><span class="co">#&gt;   _llikNbinom = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinom");</span></span>
<span><span class="co">#&gt;   _llikBinomDprob = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikBinomDprob");</span></span>
<span><span class="co">#&gt;   _llikBinom = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikBinom");</span></span>
<span><span class="co">#&gt;   _llikPoisDlambda = (rxode2_llikPoisFun) R_GetCCallable("rxode2ll", "rxLlikPoisDlambda");</span></span>
<span><span class="co">#&gt;   _llikPois = (rxode2_llikPoisFun) R_GetCCallable("rxode2ll", "rxLlikPois");</span></span>
<span><span class="co">#&gt;   _llikNormDsd = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNormDsd");</span></span>
<span><span class="co">#&gt;   _llikNormDmean = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNormDmean");</span></span>
<span><span class="co">#&gt;   _llikNorm = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNorm");</span></span>
<span><span class="co">#&gt;   simeps = (_simfun) R_GetCCallable("rxode2", "simeps");</span></span>
<span><span class="co">#&gt;   simeta = (_simfun) R_GetCCallable("rxode2", "simeta");</span></span>
<span><span class="co">#&gt;   expit = (rxode2_fn3) R_GetCCallable("rxode2", "expit");</span></span>
<span><span class="co">#&gt;   logit = (rxode2_fn3) R_GetCCallable("rxode2", "logit");</span></span>
<span><span class="co">#&gt;   gammapDer = (rxode2_fn2) R_GetCCallable("rxode2", "gammapDer");</span></span>
<span><span class="co">#&gt;   lowergamma = (rxode2_fn2) R_GetCCallable("rxode2", "lowergamma");</span></span>
<span><span class="co">#&gt;   uppergamma = (rxode2_fn2) R_GetCCallable("rxode2", "uppergamma");</span></span>
<span><span class="co">#&gt;   gammaqInva = (rxode2_fn2) R_GetCCallable("rxode2", "gammaqInva");</span></span>
<span><span class="co">#&gt;   gammaqInv = (rxode2_fn2) R_GetCCallable("rxode2", "gammaqInv");</span></span>
<span><span class="co">#&gt;   gammapInva = (rxode2_fn2) R_GetCCallable("rxode2", "gammapInva");</span></span>
<span><span class="co">#&gt;   gammapInv = (rxode2_fn2) R_GetCCallable("rxode2", "gammapInv");</span></span>
<span><span class="co">#&gt;   gammaq = (rxode2_fn2) R_GetCCallable("rxode2", "gammaq");</span></span>
<span><span class="co">#&gt;   gammap = (rxode2_fn2) R_GetCCallable("rxode2", "gammap");</span></span>
<span><span class="co">#&gt;   phi = (rxode2_fn) R_GetCCallable("rxode2", "phi");</span></span>
<span><span class="co">#&gt;   d2ELUa = (rxode2_fn2) R_GetCCallable("rxode2", "d2ELUa");</span></span>
<span><span class="co">#&gt;   dELUa = (rxode2_fn2) R_GetCCallable("rxode2", "dELUa");</span></span>
<span><span class="co">#&gt;   d2aELU = (rxode2_fn2) R_GetCCallable("rxode2", "d2aELU");</span></span>
<span><span class="co">#&gt;   d2ELU = (rxode2_fn2) R_GetCCallable("rxode2", "d2ELU");</span></span>
<span><span class="co">#&gt;   dELU = (rxode2_fn2) R_GetCCallable("rxode2", "dELU");</span></span>
<span><span class="co">#&gt;   ELU = (rxode2_fn2) R_GetCCallable("rxode2", "ELU");</span></span>
<span><span class="co">#&gt;   dPReLUa1 = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLUa1");</span></span>
<span><span class="co">#&gt;   dPReLUa = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLUa");</span></span>
<span><span class="co">#&gt;   dPReLU = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLU");</span></span>
<span><span class="co">#&gt;   PReLU = (rxode2_fn2) R_GetCCallable("rxode2", "PReLU");</span></span>
<span><span class="co">#&gt;   dSwish = (rxode2_fn) R_GetCCallable("rxode2", "dSwish");</span></span>
<span><span class="co">#&gt;   Swish = (rxode2_fn) R_GetCCallable("rxode2", "Swish");</span></span>
<span><span class="co">#&gt;   dlReLU = (rxode2_fn) R_GetCCallable("rxode2", "dlReLU");</span></span>
<span><span class="co">#&gt;   lReLU = (rxode2_fn) R_GetCCallable("rxode2", "lReLU");</span></span>
<span><span class="co">#&gt;   dSELU = (rxode2_fn) R_GetCCallable("rxode2", "dSELU");</span></span>
<span><span class="co">#&gt;   SELU = (rxode2_fn) R_GetCCallable("rxode2", "SELU");</span></span>
<span><span class="co">#&gt;   d4softplus = (rxode2_fn) R_GetCCallable("rxode2", "d4softplus");</span></span>
<span><span class="co">#&gt;   d3softplus = (rxode2_fn) R_GetCCallable("rxode2", "d3softplus");</span></span>
<span><span class="co">#&gt;   d2softplus = (rxode2_fn) R_GetCCallable("rxode2", "d2softplus");</span></span>
<span><span class="co">#&gt;   dsoftplus = (rxode2_fn) R_GetCCallable("rxode2", "dsoftplus");</span></span>
<span><span class="co">#&gt;   softplus = (rxode2_fn) R_GetCCallable("rxode2", "softplus");</span></span>
<span><span class="co">#&gt;   d4GELU = (rxode2_fn) R_GetCCallable("rxode2", "d4GELU");</span></span>
<span><span class="co">#&gt;   d3GELU = (rxode2_fn) R_GetCCallable("rxode2", "d3GELU");</span></span>
<span><span class="co">#&gt;   d2GELU = (rxode2_fn) R_GetCCallable("rxode2", "d2GELU");</span></span>
<span><span class="co">#&gt;   dGELU = (rxode2_fn) R_GetCCallable("rxode2", "dGELU");</span></span>
<span><span class="co">#&gt;   GELU = (rxode2_fn) R_GetCCallable("rxode2", "GELU");</span></span>
<span><span class="co">#&gt;   dReLU = (rxode2_fn) R_GetCCallable("rxode2", "dReLU");</span></span>
<span><span class="co">#&gt;   ReLU = (rxode2_fn) R_GetCCallable("rxode2", "ReLU");</span></span>
<span><span class="co">#&gt;   riweibull = (rxode2i2_fn2) R_GetCCallable("rxode2", "riweibull");</span></span>
<span><span class="co">#&gt;   riunif = (rxode2i2_fn2) R_GetCCallable("rxode2", "riunif");</span></span>
<span><span class="co">#&gt;   rit_ = (rxode2i2_fn) R_GetCCallable("rxode2", "rit_");</span></span>
<span><span class="co">#&gt;   ripois = (rxode2i2_ifn) R_GetCCallable("rxode2", "ripois");</span></span>
<span><span class="co">#&gt;   ribeta = (rxode2i2_fn2) R_GetCCallable("rxode2", "ribeta");</span></span>
<span><span class="co">#&gt;   rigamma = (rxode2i2_fn2) R_GetCCallable("rxode2", "rigamma");</span></span>
<span><span class="co">#&gt;   rigeom = (rxode2i2_ifn) R_GetCCallable("rxode2", "rigeom");</span></span>
<span><span class="co">#&gt;   rif = (rxode2i2_fn2) R_GetCCallable("rxode2", "rif");</span></span>
<span><span class="co">#&gt;   riexp = (rxode2i2_fn) R_GetCCallable("rxode2", "riexp");</span></span>
<span><span class="co">#&gt;   richisq = (rxode2i2_fn) R_GetCCallable("rxode2", "richisq");</span></span>
<span><span class="co">#&gt;   ricauchy = (rxode2i2_fn2) R_GetCCallable("rxode2", "ricauchy");</span></span>
<span><span class="co">#&gt;   rinbinomMu = (rxode2i2_ribinom) R_GetCCallable("rxode2", "rinbinomMu");</span></span>
<span><span class="co">#&gt;   rinbinom = (rxode2i2_ribinom) R_GetCCallable("rxode2", "rinbinom");</span></span>
<span><span class="co">#&gt;   ribinom = (rxode2i2_ribinom) R_GetCCallable("rxode2", "ribinom");</span></span>
<span><span class="co">#&gt;   rinorm = (rxode2i2_fn2) R_GetCCallable("rxode2", "rinorm");</span></span>
<span><span class="co">#&gt;   rxweibull = (rxode2i_fn2) R_GetCCallable("rxode2", "rxweibull");</span></span>
<span><span class="co">#&gt;   rxunif = (rxode2i_fn2) R_GetCCallable("rxode2", "rxunif");</span></span>
<span><span class="co">#&gt;   rxt_ = (rxode2i_fn) R_GetCCallable("rxode2", "rxt_");</span></span>
<span><span class="co">#&gt;   rxpois = (rxode2i_ifn) R_GetCCallable("rxode2", "rxpois");</span></span>
<span><span class="co">#&gt;   rxbeta = (rxode2i_fn2) R_GetCCallable("rxode2", "rxbeta");</span></span>
<span><span class="co">#&gt;   rxgamma = (rxode2i_fn2) R_GetCCallable("rxode2", "rxgamma");</span></span>
<span><span class="co">#&gt;   rxgeom = (rxode2i_ifn) R_GetCCallable("rxode2", "rxgeom");</span></span>
<span><span class="co">#&gt;   rxf = (rxode2i_fn2) R_GetCCallable("rxode2", "rxf");</span></span>
<span><span class="co">#&gt;   rxexp = (rxode2i_fn) R_GetCCallable("rxode2", "rxexp");</span></span>
<span><span class="co">#&gt;   rxchisq = (rxode2i_fn) R_GetCCallable("rxode2", "rxchisq");</span></span>
<span><span class="co">#&gt;   rxcauchy = (rxode2i_fn2) R_GetCCallable("rxode2", "rxcauchy");</span></span>
<span><span class="co">#&gt;   rxnbinomMu = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxnbinomMu");</span></span>
<span><span class="co">#&gt;   rxnbinom = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxnbinom");</span></span>
<span><span class="co">#&gt;   rxbinom = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxbinom");</span></span>
<span><span class="co">#&gt;   rxnorm = (rxode2i_fn2) R_GetCCallable("rxode2", "rxnorm");</span></span>
<span><span class="co">#&gt;   linCmtB = (linCmtB_p) R_GetCCallable("rxode2", "linCmtB");</span></span>
<span><span class="co">#&gt;   linCmtA = (linCmtA_p) R_GetCCallable("rxode2", "linCmtA");</span></span>
<span><span class="co">#&gt;   // dynamic stop</span></span>
<span><span class="co">#&gt;   _solveData = _getRxSolve_();</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void _assignFuns(void) {</span></span>
<span><span class="co">#&gt;   if (_assign_ptr == NULL){</span></span>
<span><span class="co">#&gt;     _assignFuns0();</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void __assignFuns2(rx_solve rx,</span></span>
<span><span class="co">#&gt;                    rx_solving_options op,</span></span>
<span><span class="co">#&gt;                    t_F f,</span></span>
<span><span class="co">#&gt;                    t_LAG lag,</span></span>
<span><span class="co">#&gt;                    t_RATE rate,</span></span>
<span><span class="co">#&gt;                    t_DUR dur,</span></span>
<span><span class="co">#&gt;                    t_calc_mtime mtime,</span></span>
<span><span class="co">#&gt;                    t_ME me,</span></span>
<span><span class="co">#&gt;                    t_IndF indf,</span></span>
<span><span class="co">#&gt;                    t_getTime gettime,</span></span>
<span><span class="co">#&gt;                    t_locateTimeIndex timeindex,</span></span>
<span><span class="co">#&gt;                    t_handle_evidL handleEvid,</span></span>
<span><span class="co">#&gt;                    t_getDur getdur) {</span></span>
<span><span class="co">#&gt;   // assign start</span></span>
<span><span class="co">#&gt;     static rxode2_assignFuns2_t rxode2_assignFuns2 = NULL;</span></span>
<span><span class="co">#&gt;     if (rxode2_assignFuns2 == NULL) rxode2_assignFuns2 = (rxode2_assignFuns2_t)(R_GetCCallable("rxode2", "_rxode2_assignFuns2"));</span></span>
<span><span class="co">#&gt;     rxode2_assignFuns2(rx, op, f, lag, rate, dur, mtime, me, indf, gettime, timeindex, handleEvid, getdur);</span></span>
<span><span class="co">#&gt;   // assign stop</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void  rx_522f70bce2bcfe4059d6290423e02064__ode_solver_solvedata (rx_solve *solve){</span></span>
<span><span class="co">#&gt;   _solveData = solve;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern rx_solve *rx_522f70bce2bcfe4059d6290423e02064__ode_solver_get_solvedata(void){</span></span>
<span><span class="co">#&gt;   return _solveData;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; SEXP rx_522f70bce2bcfe4059d6290423e02064__model_vars(void);</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; // prj-specific differential eqns</span></span>
<span><span class="co">#&gt; void rx_522f70bce2bcfe4059d6290423e02064__dydt(int *_neq, double __t, double *__zzStateVar__, double *__DDtStateVar__)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   int _cSub = _neq[1];</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_neq[1]].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=1;</span></span>
<span><span class="co">#&gt;   double k = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tkde = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_tkde = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tkpq = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_kpq = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tkqpp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_kqpp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tlambdap = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_lambdap = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tgamma = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_gamma = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tdeltaqp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_deltaqp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double prop_DoT_sd = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tpt0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_pt0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tq0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_q0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double pstar = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rxerr_DoT_pstar = NA_REAL;</span></span>
<span><span class="co">#&gt;   double kde = NA_REAL;</span></span>
<span><span class="co">#&gt;   double kpq = NA_REAL;</span></span>
<span><span class="co">#&gt;   double kqpp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double lambdap = NA_REAL;</span></span>
<span><span class="co">#&gt;   double _rxNotFun_gamma = NA_REAL;</span></span>
<span><span class="co">#&gt;   double deltaqp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double c = NA_REAL;</span></span>
<span><span class="co">#&gt;   double pt = NA_REAL;</span></span>
<span><span class="co">#&gt;   double qp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double q = NA_REAL;</span></span>
<span><span class="co">#&gt;   double pt0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double q0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_yj___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_lambda___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_low___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_hi___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_f_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_r_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double ipredSim = NA_REAL;</span></span>
<span><span class="co">#&gt;   double sim = NA_REAL;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   (void)k;</span></span>
<span><span class="co">#&gt;   (void)tkde;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_tkde;</span></span>
<span><span class="co">#&gt;   (void)tkpq;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_kpq;</span></span>
<span><span class="co">#&gt;   (void)tkqpp;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_kqpp;</span></span>
<span><span class="co">#&gt;   (void)tlambdap;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_lambdap;</span></span>
<span><span class="co">#&gt;   (void)tgamma;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_gamma;</span></span>
<span><span class="co">#&gt;   (void)tdeltaqp;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_deltaqp;</span></span>
<span><span class="co">#&gt;   (void)prop_DoT_sd;</span></span>
<span><span class="co">#&gt;   (void)tpt0;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_pt0;</span></span>
<span><span class="co">#&gt;   (void)tq0;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_q0;</span></span>
<span><span class="co">#&gt;   (void)pstar;</span></span>
<span><span class="co">#&gt;   (void)rxerr_DoT_pstar;</span></span>
<span><span class="co">#&gt;   (void)kde;</span></span>
<span><span class="co">#&gt;   (void)kpq;</span></span>
<span><span class="co">#&gt;   (void)kqpp;</span></span>
<span><span class="co">#&gt;   (void)lambdap;</span></span>
<span><span class="co">#&gt;   (void)_rxNotFun_gamma;</span></span>
<span><span class="co">#&gt;   (void)deltaqp;</span></span>
<span><span class="co">#&gt;   (void)c;</span></span>
<span><span class="co">#&gt;   (void)pt;</span></span>
<span><span class="co">#&gt;   (void)qp;</span></span>
<span><span class="co">#&gt;   (void)q;</span></span>
<span><span class="co">#&gt;   (void)pt0;</span></span>
<span><span class="co">#&gt;   (void)q0;</span></span>
<span><span class="co">#&gt;   (void)rx_yj___;</span></span>
<span><span class="co">#&gt;   (void)rx_lambda___;</span></span>
<span><span class="co">#&gt;   (void)rx_low___;</span></span>
<span><span class="co">#&gt;   (void)rx_hi___;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_f_;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_;</span></span>
<span><span class="co">#&gt;   (void)rx_r_;</span></span>
<span><span class="co">#&gt;   (void)ipredSim;</span></span>
<span><span class="co">#&gt;   (void)sim;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   pstar = _PL[0];</span></span>
<span><span class="co">#&gt;   ipredSim = _PL[1];</span></span>
<span><span class="co">#&gt;   sim = _PL[2];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _update_par_ptr(__t, _cSub, _solveData, _idx);</span></span>
<span><span class="co">#&gt;   k = _PP[0];</span></span>
<span><span class="co">#&gt;   tkde = _PP[1];</span></span>
<span><span class="co">#&gt;   eta_DoT_tkde = _PP[2];</span></span>
<span><span class="co">#&gt;   tkpq = _PP[3];</span></span>
<span><span class="co">#&gt;   eta_DoT_kpq = _PP[4];</span></span>
<span><span class="co">#&gt;   tkqpp = _PP[5];</span></span>
<span><span class="co">#&gt;   eta_DoT_kqpp = _PP[6];</span></span>
<span><span class="co">#&gt;   tlambdap = _PP[7];</span></span>
<span><span class="co">#&gt;   eta_DoT_lambdap = _PP[8];</span></span>
<span><span class="co">#&gt;   tgamma = _PP[9];</span></span>
<span><span class="co">#&gt;   eta_DoT_gamma = _PP[10];</span></span>
<span><span class="co">#&gt;   tdeltaqp = _PP[11];</span></span>
<span><span class="co">#&gt;   eta_DoT_deltaqp = _PP[12];</span></span>
<span><span class="co">#&gt;   prop_DoT_sd = _PP[13];</span></span>
<span><span class="co">#&gt;   tpt0 = _PP[14];</span></span>
<span><span class="co">#&gt;   eta_DoT_pt0 = _PP[15];</span></span>
<span><span class="co">#&gt;   tq0 = _PP[16];</span></span>
<span><span class="co">#&gt;   eta_DoT_q0 = _PP[17];</span></span>
<span><span class="co">#&gt;   rxerr_DoT_pstar = _PP[18];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   c = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">#&gt;   pt = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">#&gt;   q = __zzStateVar__[__DDT2__]*((double)(_ON[__DDT2__]));</span></span>
<span><span class="co">#&gt;   qp = __zzStateVar__[__DDT3__]*((double)(_ON[__DDT3__]));</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   kde =tkde*exp(eta_DoT_tkde);</span></span>
<span><span class="co">#&gt;   kpq =tkpq*exp(eta_DoT_kpq);</span></span>
<span><span class="co">#&gt;   kqpp =tkqpp*exp(eta_DoT_kqpp);</span></span>
<span><span class="co">#&gt;   lambdap =tlambdap*exp(eta_DoT_lambdap);</span></span>
<span><span class="co">#&gt;   _rxNotFun_gamma =tgamma*exp(eta_DoT_gamma);</span></span>
<span><span class="co">#&gt;   deltaqp =tdeltaqp*exp(eta_DoT_deltaqp);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT0__] = ((double)(_ON[__DDT0__]))*(_IR[__DDT0__] -kde*c);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT1__] = ((double)(_ON[__DDT1__]))*(_IR[__DDT1__] + lambdap*pt*(1-pstar/_div0(k))+kqpp*qp-kpq*pt-_rxNotFun_gamma*c*kde*pt);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT2__] = ((double)(_ON[__DDT2__]))*(_IR[__DDT2__] + kpq*pt-_rxNotFun_gamma*c*kde*q);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT3__] = ((double)(_ON[__DDT3__]))*(_IR[__DDT3__] + _rxNotFun_gamma*c*kde*q-kqpp*qp-deltaqp*qp);</span></span>
<span><span class="co">#&gt;   pt0 =tpt0*exp(eta_DoT_pt0);</span></span>
<span><span class="co">#&gt;   q0 =tq0*exp(eta_DoT_q0);</span></span>
<span><span class="co">#&gt;   pstar =(pt+q+qp);</span></span>
<span><span class="co">#&gt;   rx_yj_ =2;</span></span>
<span><span class="co">#&gt;   rx_lambda_ =1;</span></span>
<span><span class="co">#&gt;   rx_low_ =0;</span></span>
<span><span class="co">#&gt;   rx_hi_ =1;</span></span>
<span><span class="co">#&gt;   rx_pred_f_ =pstar;</span></span>
<span><span class="co">#&gt;   rx_pred_ =rx_pred_f_;</span></span>
<span><span class="co">#&gt;   rx_r_ =Rx_pow((rx_pred_f_*prop_DoT_sd),2);</span></span>
<span><span class="co">#&gt;   ipredSim =rxTBSi(rx_pred_,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   sim =rxTBSi(rx_pred_+sqrt(rx_r_)*rxerr_DoT_pstar,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   (&amp;_solveData-&gt;subjects[_cSub])-&gt;dadt_counter[0]++;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; // Jacobian derived vars</span></span>
<span><span class="co">#&gt; void rx_522f70bce2bcfe4059d6290423e02064__calc_jac(int *_neq, double __t, double *__zzStateVar__, double *__PDStateVar__, unsigned int __NROWPD__) {</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;     int _cSub=_neq[1];</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_neq[1]].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=2;</span></span>
<span><span class="co">#&gt;   (&amp;_solveData-&gt;subjects[_cSub])-&gt;jac_counter[0]++;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Functional based initial conditions.</span></span>
<span><span class="co">#&gt; void rx_522f70bce2bcfe4059d6290423e02064__inis(int _cSub, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;  _ind-&gt;_rxFlag=3;</span></span>
<span><span class="co">#&gt;   double t=0;</span></span>
<span><span class="co">#&gt;   double k = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tkde = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_tkde = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tkpq = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_kpq = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tkqpp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_kqpp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tlambdap = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_lambdap = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tgamma = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_gamma = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tdeltaqp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_deltaqp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double prop_DoT_sd = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tpt0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_pt0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tq0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_q0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double pstar = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rxerr_DoT_pstar = NA_REAL;</span></span>
<span><span class="co">#&gt;   double kde = NA_REAL;</span></span>
<span><span class="co">#&gt;   double kpq = NA_REAL;</span></span>
<span><span class="co">#&gt;   double kqpp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double lambdap = NA_REAL;</span></span>
<span><span class="co">#&gt;   double _rxNotFun_gamma = NA_REAL;</span></span>
<span><span class="co">#&gt;   double deltaqp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double c = NA_REAL;</span></span>
<span><span class="co">#&gt;   double pt = NA_REAL;</span></span>
<span><span class="co">#&gt;   double qp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double q = NA_REAL;</span></span>
<span><span class="co">#&gt;   double pt0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double q0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_yj___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_lambda___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_low___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_hi___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_f_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_r_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double ipredSim = NA_REAL;</span></span>
<span><span class="co">#&gt;   double sim = NA_REAL;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   (void)k;</span></span>
<span><span class="co">#&gt;   (void)tkde;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_tkde;</span></span>
<span><span class="co">#&gt;   (void)tkpq;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_kpq;</span></span>
<span><span class="co">#&gt;   (void)tkqpp;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_kqpp;</span></span>
<span><span class="co">#&gt;   (void)tlambdap;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_lambdap;</span></span>
<span><span class="co">#&gt;   (void)tgamma;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_gamma;</span></span>
<span><span class="co">#&gt;   (void)tdeltaqp;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_deltaqp;</span></span>
<span><span class="co">#&gt;   (void)prop_DoT_sd;</span></span>
<span><span class="co">#&gt;   (void)tpt0;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_pt0;</span></span>
<span><span class="co">#&gt;   (void)tq0;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_q0;</span></span>
<span><span class="co">#&gt;   (void)pstar;</span></span>
<span><span class="co">#&gt;   (void)rxerr_DoT_pstar;</span></span>
<span><span class="co">#&gt;   (void)kde;</span></span>
<span><span class="co">#&gt;   (void)kpq;</span></span>
<span><span class="co">#&gt;   (void)kqpp;</span></span>
<span><span class="co">#&gt;   (void)lambdap;</span></span>
<span><span class="co">#&gt;   (void)_rxNotFun_gamma;</span></span>
<span><span class="co">#&gt;   (void)deltaqp;</span></span>
<span><span class="co">#&gt;   (void)c;</span></span>
<span><span class="co">#&gt;   (void)pt;</span></span>
<span><span class="co">#&gt;   (void)qp;</span></span>
<span><span class="co">#&gt;   (void)q;</span></span>
<span><span class="co">#&gt;   (void)pt0;</span></span>
<span><span class="co">#&gt;   (void)q0;</span></span>
<span><span class="co">#&gt;   (void)rx_yj___;</span></span>
<span><span class="co">#&gt;   (void)rx_lambda___;</span></span>
<span><span class="co">#&gt;   (void)rx_low___;</span></span>
<span><span class="co">#&gt;   (void)rx_hi___;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_f_;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_;</span></span>
<span><span class="co">#&gt;   (void)rx_r_;</span></span>
<span><span class="co">#&gt;   (void)ipredSim;</span></span>
<span><span class="co">#&gt;   (void)sim;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   pstar = _PL[0];</span></span>
<span><span class="co">#&gt;   ipredSim = _PL[1];</span></span>
<span><span class="co">#&gt;   sim = _PL[2];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _update_par_ptr(0.0, _cSub, _solveData, _idx);</span></span>
<span><span class="co">#&gt;   k = _PP[0];</span></span>
<span><span class="co">#&gt;   tkde = _PP[1];</span></span>
<span><span class="co">#&gt;   eta_DoT_tkde = _PP[2];</span></span>
<span><span class="co">#&gt;   tkpq = _PP[3];</span></span>
<span><span class="co">#&gt;   eta_DoT_kpq = _PP[4];</span></span>
<span><span class="co">#&gt;   tkqpp = _PP[5];</span></span>
<span><span class="co">#&gt;   eta_DoT_kqpp = _PP[6];</span></span>
<span><span class="co">#&gt;   tlambdap = _PP[7];</span></span>
<span><span class="co">#&gt;   eta_DoT_lambdap = _PP[8];</span></span>
<span><span class="co">#&gt;   tgamma = _PP[9];</span></span>
<span><span class="co">#&gt;   eta_DoT_gamma = _PP[10];</span></span>
<span><span class="co">#&gt;   tdeltaqp = _PP[11];</span></span>
<span><span class="co">#&gt;   eta_DoT_deltaqp = _PP[12];</span></span>
<span><span class="co">#&gt;   prop_DoT_sd = _PP[13];</span></span>
<span><span class="co">#&gt;   tpt0 = _PP[14];</span></span>
<span><span class="co">#&gt;   eta_DoT_pt0 = _PP[15];</span></span>
<span><span class="co">#&gt;   tq0 = _PP[16];</span></span>
<span><span class="co">#&gt;   eta_DoT_q0 = _PP[17];</span></span>
<span><span class="co">#&gt;   rxerr_DoT_pstar = _PP[18];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   c = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">#&gt;   pt = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">#&gt;   q = __zzStateVar__[__DDT2__]*((double)(_ON[__DDT2__]));</span></span>
<span><span class="co">#&gt;   qp = __zzStateVar__[__DDT3__]*((double)(_ON[__DDT3__]));</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   kde =tkde*exp(eta_DoT_tkde);</span></span>
<span><span class="co">#&gt;   kpq =tkpq*exp(eta_DoT_kpq);</span></span>
<span><span class="co">#&gt;   kqpp =tkqpp*exp(eta_DoT_kqpp);</span></span>
<span><span class="co">#&gt;   lambdap =tlambdap*exp(eta_DoT_lambdap);</span></span>
<span><span class="co">#&gt;   _rxNotFun_gamma =tgamma*exp(eta_DoT_gamma);</span></span>
<span><span class="co">#&gt;   deltaqp =tdeltaqp*exp(eta_DoT_deltaqp);</span></span>
<span><span class="co">#&gt;   pt0 =tpt0*exp(eta_DoT_pt0);</span></span>
<span><span class="co">#&gt;   q0 =tq0*exp(eta_DoT_q0);</span></span>
<span><span class="co">#&gt;   pt=pt0;</span></span>
<span><span class="co">#&gt;   q=q0;</span></span>
<span><span class="co">#&gt;   pstar =(pt+q+qp);</span></span>
<span><span class="co">#&gt;   rx_yj_ =2;</span></span>
<span><span class="co">#&gt;   rx_lambda_ =1;</span></span>
<span><span class="co">#&gt;   rx_low_ =0;</span></span>
<span><span class="co">#&gt;   rx_hi_ =1;</span></span>
<span><span class="co">#&gt;   rx_pred_f_ =pstar;</span></span>
<span><span class="co">#&gt;   rx_pred_ =rx_pred_f_;</span></span>
<span><span class="co">#&gt;   rx_r_ =Rx_pow((rx_pred_f_*prop_DoT_sd),2);</span></span>
<span><span class="co">#&gt;   ipredSim =rxTBSi(rx_pred_,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   sim =rxTBSi(rx_pred_+sqrt(rx_r_)*rxerr_DoT_pstar,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   __zzStateVar__[__DDT0__]=((double)(_ON[__DDT0__]))*(c);</span></span>
<span><span class="co">#&gt;   __zzStateVar__[__DDT1__]=((double)(_ON[__DDT1__]))*(pt);</span></span>
<span><span class="co">#&gt;   __zzStateVar__[__DDT2__]=((double)(_ON[__DDT2__]))*(q);</span></span>
<span><span class="co">#&gt;   __zzStateVar__[__DDT3__]=((double)(_ON[__DDT3__]))*(qp);</span></span>
<span><span class="co">#&gt;   __zzStateVar__[__DDT4__]=((double)(_ON[__DDT4__]))*(pstar);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // prj-specific derived vars</span></span>
<span><span class="co">#&gt; void rx_522f70bce2bcfe4059d6290423e02064__calc_lhs(int _cSub, double __t, double *__zzStateVar__, double *_lhs) {</span></span>
<span><span class="co">#&gt;     int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=11;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_0__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_1__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_2__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_3__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_4__;</span></span>
<span><span class="co">#&gt;   double k = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tkde = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_tkde = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tkpq = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_kpq = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tkqpp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_kqpp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tlambdap = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_lambdap = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tgamma = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_gamma = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tdeltaqp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_deltaqp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double prop_DoT_sd = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tpt0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_pt0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tq0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_q0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double pstar = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rxerr_DoT_pstar = NA_REAL;</span></span>
<span><span class="co">#&gt;   double kde = NA_REAL;</span></span>
<span><span class="co">#&gt;   double kpq = NA_REAL;</span></span>
<span><span class="co">#&gt;   double kqpp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double lambdap = NA_REAL;</span></span>
<span><span class="co">#&gt;   double _rxNotFun_gamma = NA_REAL;</span></span>
<span><span class="co">#&gt;   double deltaqp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double c = NA_REAL;</span></span>
<span><span class="co">#&gt;   double pt = NA_REAL;</span></span>
<span><span class="co">#&gt;   double qp = NA_REAL;</span></span>
<span><span class="co">#&gt;   double q = NA_REAL;</span></span>
<span><span class="co">#&gt;   double pt0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double q0 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_yj___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_lambda___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_low___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_hi___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_f_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_r_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double ipredSim = NA_REAL;</span></span>
<span><span class="co">#&gt;   double sim = NA_REAL;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_0__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_1__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_2__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_3__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_4__;</span></span>
<span><span class="co">#&gt;   (void)k;</span></span>
<span><span class="co">#&gt;   (void)tkde;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_tkde;</span></span>
<span><span class="co">#&gt;   (void)tkpq;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_kpq;</span></span>
<span><span class="co">#&gt;   (void)tkqpp;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_kqpp;</span></span>
<span><span class="co">#&gt;   (void)tlambdap;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_lambdap;</span></span>
<span><span class="co">#&gt;   (void)tgamma;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_gamma;</span></span>
<span><span class="co">#&gt;   (void)tdeltaqp;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_deltaqp;</span></span>
<span><span class="co">#&gt;   (void)prop_DoT_sd;</span></span>
<span><span class="co">#&gt;   (void)tpt0;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_pt0;</span></span>
<span><span class="co">#&gt;   (void)tq0;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_q0;</span></span>
<span><span class="co">#&gt;   (void)pstar;</span></span>
<span><span class="co">#&gt;   (void)rxerr_DoT_pstar;</span></span>
<span><span class="co">#&gt;   (void)kde;</span></span>
<span><span class="co">#&gt;   (void)kpq;</span></span>
<span><span class="co">#&gt;   (void)kqpp;</span></span>
<span><span class="co">#&gt;   (void)lambdap;</span></span>
<span><span class="co">#&gt;   (void)_rxNotFun_gamma;</span></span>
<span><span class="co">#&gt;   (void)deltaqp;</span></span>
<span><span class="co">#&gt;   (void)c;</span></span>
<span><span class="co">#&gt;   (void)pt;</span></span>
<span><span class="co">#&gt;   (void)qp;</span></span>
<span><span class="co">#&gt;   (void)q;</span></span>
<span><span class="co">#&gt;   (void)pt0;</span></span>
<span><span class="co">#&gt;   (void)q0;</span></span>
<span><span class="co">#&gt;   (void)rx_yj___;</span></span>
<span><span class="co">#&gt;   (void)rx_lambda___;</span></span>
<span><span class="co">#&gt;   (void)rx_low___;</span></span>
<span><span class="co">#&gt;   (void)rx_hi___;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_f_;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_;</span></span>
<span><span class="co">#&gt;   (void)rx_r_;</span></span>
<span><span class="co">#&gt;   (void)ipredSim;</span></span>
<span><span class="co">#&gt;   (void)sim;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   pstar = _PL[0];</span></span>
<span><span class="co">#&gt;   ipredSim = _PL[1];</span></span>
<span><span class="co">#&gt;   sim = _PL[2];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _update_par_ptr(__t, _cSub, _solveData, _idx);</span></span>
<span><span class="co">#&gt;   k = _PP[0];</span></span>
<span><span class="co">#&gt;   tkde = _PP[1];</span></span>
<span><span class="co">#&gt;   eta_DoT_tkde = _PP[2];</span></span>
<span><span class="co">#&gt;   tkpq = _PP[3];</span></span>
<span><span class="co">#&gt;   eta_DoT_kpq = _PP[4];</span></span>
<span><span class="co">#&gt;   tkqpp = _PP[5];</span></span>
<span><span class="co">#&gt;   eta_DoT_kqpp = _PP[6];</span></span>
<span><span class="co">#&gt;   tlambdap = _PP[7];</span></span>
<span><span class="co">#&gt;   eta_DoT_lambdap = _PP[8];</span></span>
<span><span class="co">#&gt;   tgamma = _PP[9];</span></span>
<span><span class="co">#&gt;   eta_DoT_gamma = _PP[10];</span></span>
<span><span class="co">#&gt;   tdeltaqp = _PP[11];</span></span>
<span><span class="co">#&gt;   eta_DoT_deltaqp = _PP[12];</span></span>
<span><span class="co">#&gt;   prop_DoT_sd = _PP[13];</span></span>
<span><span class="co">#&gt;   tpt0 = _PP[14];</span></span>
<span><span class="co">#&gt;   eta_DoT_pt0 = _PP[15];</span></span>
<span><span class="co">#&gt;   tq0 = _PP[16];</span></span>
<span><span class="co">#&gt;   eta_DoT_q0 = _PP[17];</span></span>
<span><span class="co">#&gt;   rxerr_DoT_pstar = _PP[18];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   c = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">#&gt;   pt = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">#&gt;   q = __zzStateVar__[__DDT2__]*((double)(_ON[__DDT2__]));</span></span>
<span><span class="co">#&gt;   qp = __zzStateVar__[__DDT3__]*((double)(_ON[__DDT3__]));</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   kde =tkde*exp(eta_DoT_tkde);</span></span>
<span><span class="co">#&gt;   kpq =tkpq*exp(eta_DoT_kpq);</span></span>
<span><span class="co">#&gt;   kqpp =tkqpp*exp(eta_DoT_kqpp);</span></span>
<span><span class="co">#&gt;   lambdap =tlambdap*exp(eta_DoT_lambdap);</span></span>
<span><span class="co">#&gt;   _rxNotFun_gamma =tgamma*exp(eta_DoT_gamma);</span></span>
<span><span class="co">#&gt;   deltaqp =tdeltaqp*exp(eta_DoT_deltaqp);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_0__ = ((double)(_ON[__DDT0__]))*(_IR[__DDT0__] -kde*c);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_1__ = ((double)(_ON[__DDT1__]))*(_IR[__DDT1__] + lambdap*pt*(1-pstar/_div0(k))+kqpp*qp-kpq*pt-_rxNotFun_gamma*c*kde*pt);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_2__ = ((double)(_ON[__DDT2__]))*(_IR[__DDT2__] + kpq*pt-_rxNotFun_gamma*c*kde*q);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_3__ = ((double)(_ON[__DDT3__]))*(_IR[__DDT3__] + _rxNotFun_gamma*c*kde*q-kqpp*qp-deltaqp*qp);</span></span>
<span><span class="co">#&gt;   pt0 =tpt0*exp(eta_DoT_pt0);</span></span>
<span><span class="co">#&gt;   q0 =tq0*exp(eta_DoT_q0);</span></span>
<span><span class="co">#&gt;   pstar =(pt+q+qp);</span></span>
<span><span class="co">#&gt;   rx_yj_ =2;</span></span>
<span><span class="co">#&gt;   rx_lambda_ =1;</span></span>
<span><span class="co">#&gt;   rx_low_ =0;</span></span>
<span><span class="co">#&gt;   rx_hi_ =1;</span></span>
<span><span class="co">#&gt;   rx_pred_f_ =pstar;</span></span>
<span><span class="co">#&gt;   rx_pred_ =rx_pred_f_;</span></span>
<span><span class="co">#&gt;   rx_r_ =Rx_pow((rx_pred_f_*prop_DoT_sd),2);</span></span>
<span><span class="co">#&gt;   ipredSim =rxTBSi(rx_pred_,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   sim =rxTBSi(rx_pred_+sqrt(rx_r_)*rxerr_DoT_pstar,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _lhs[_LHS_0_]=pstar;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_1_]=ipredSim;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_2_]=sim;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Functional based bioavailability</span></span>
<span><span class="co">#&gt; double rx_522f70bce2bcfe4059d6290423e02064__F(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return _amt;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; // Functional based absorption lag</span></span>
<span><span class="co">#&gt; double rx_522f70bce2bcfe4059d6290423e02064__Lag(int _cSub,  int _cmt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return __t;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Modeled zero-order rate</span></span>
<span><span class="co">#&gt; double rx_522f70bce2bcfe4059d6290423e02064__Rate(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return 0.0;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Modeled zero-order duration</span></span>
<span><span class="co">#&gt; double rx_522f70bce2bcfe4059d6290423e02064__Dur(int _cSub,  int _cmt, double _amt, double __t){</span></span>
<span><span class="co">#&gt;  return 0.0;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Model Times</span></span>
<span><span class="co">#&gt; void rx_522f70bce2bcfe4059d6290423e02064__mtime(int _cSub, double *_mtime){</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Matrix Exponential (0)</span></span>
<span><span class="co">#&gt; void rx_522f70bce2bcfe4059d6290423e02064__ME(int _cSub, double _t, double __t, double *_mat, const double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=9;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Inductive linearization Matf</span></span>
<span><span class="co">#&gt; void rx_522f70bce2bcfe4059d6290423e02064__IndF(int _cSub, double _t, double __t, double *_matf){</span></span>
<span><span class="co">#&gt;  int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=10;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern SEXP rx_522f70bce2bcfe4059d6290423e02064__model_vars(void){</span></span>
<span><span class="co">#&gt;   int pro=0;</span></span>
<span><span class="co">#&gt;   SEXP _mv = PROTECT(_rxGetModelLib("rx_522f70bce2bcfe4059d6290423e02064__model_vars"));pro++;</span></span>
<span><span class="co">#&gt;   if (!_rxIsCurrentC(_mv)){</span></span>
<span><span class="co">#&gt;     SEXP hash    = PROTECT(Rf_allocVector(STRSXP, 1));pro++;</span></span>
<span><span class="co">#&gt; #define __doBuf__  snprintf(buf, __doBufN__, "un]\"BAAA@QRtHACAAAAAAA@QJBAABdk1kuw;J.xA$4uB\?TwWcT2(lIusgLGWnY}Zh7+ySf6BwR$}%%ZOn+@o1Dd/%%{#kRLQD9)wLALBhv(b={p^7{8&gt;5|&gt;9+p+lj}*{1SoQE;\?:5A3CZV@QXVCOfJZHwq#oc!~jk9+an5dsheFKSfRGgANy(m,*n6y1:;5Gg1VSynn8u1vhvf&lt;+e)W}kDKen8M(;LY`,;\"Mi**#LU]FU*S~@:z!KqMbR`=3Wd@_wZHe!4!!CYI;+lrT&amp;LdenwozAJqDhGIr:eKhM0;bma/D&amp;[RHU`n*,[l5KnPi3JrYP8Isgm*3LMT*Ha{&amp;Zw=iBqd;Rl[g=qu$ani}:7#cM(g^0#_p@06,_pLZ)p/;\?l0l\?!&lt;:Pse807NN{#.8r][[9drU`:epS~\?%%d7iE)z=k7y*hVf3&amp;/[BIB|V.q\?G()Luwqb;:))KlEEnm,;&gt;bCT$dh$[7\"i#r^dV@&gt;G`d\?bhc$SSdSLJcm;i{vyqk9Js;&gt;#)er]x&gt;&amp;&lt;Je9VX}&lt;S5(ofk=rrTZGa,Yg;dmK6*BM.+3#m4fzDIQ&lt;7D4%%;eb\?]E1&gt;#OU*]Q0uUQpe=3%%l7~P+&lt;1C_C{:s\"\?x=/`r:JC*&lt;]%%+i7.BLs&lt;WjO]]gZfS%%]\?y//RH8.x9+LhKXq65rLX7CL&gt;&gt;YnAZipF+B@AoAUAKByB+)XUP}p@HZF[9,DoBL3&lt;)&lt;3fuCRt]KTjRwDeXmV#Gv!_@B.}QwR~ow;vUgw}jf6n_rd,d07({&lt;d{12t;aO8b3d1JbhRL*|~bYPem~kB$el9B1O3Lq}R5iasb:}D&amp;dviEM)MFPNfSwL*xzr{9tAeAM+Jcvwa!q*{llg*&amp;bK1M.Y0g*Q6M3w!vO1cz3z}qNg&amp;p#{v{H1&amp;)D/k/Q.Q_s&gt;H2+T)](tW,v6mF`g*MZ!}$B*r!Km~_e}S1\?f@P@]|=r3:`~)}+}^&amp;[&amp;23&gt;OTLM&gt;63@V[&amp;O&gt;33l~y\?^&gt;V@D4=Ve~FO`L\"swQR(mh8s[;W+7jR(m2FJP,v:`*DNG(YPYmm&gt;9I&gt;&lt;b&lt;~9~G)@%%2C$\?Kfs;1F)j[k`9^/n(/CkUdgf`_wZjx&lt;dDyGi{&gt;5Q14B|l9uIufNW=i$9`8ef\"=v:jDH@g.Fy&gt;*p#O!T&amp;sv,8u3U=\?UyvXY&amp;)_=6&amp;G&amp;dr$iWv^Ml7O*lHpY}k5Zx/fL)yyZTz8;m8bDvScK4D{`0iq*;N/ySKuFX;rg$(`CIA{e)pZeW!&amp;w6%%$rGgNd.ZVlvJ43a!Urx.OyX$bIs@N.&gt;1F4,i+1]B49cYU&gt;bF+E_Fikwj9XBcfr$6qbw1+Y1o5c5+|TCgFKJRhIFKSrDc4fQ@gl!qDF/ISw$Y\?59Z&amp;I5B{)/*)m.A(7EUhx\"FuZ.I2B$WfZ}MNf@/RPs#&amp;iO+XTYYe)|&lt;Ql.}9WWt\?H\"Ebcy@l;ks\?L:*&gt;FE4Gz}*Vxoj}i`L}Nxjuoy1x!Zp@M&lt;irXpxx/GuT/7S_7s{BaQ\?mp3IN.%%a:nch=Fe95V&gt;Qb4ZZZjOxr&amp;|qCJR%%_ZvS{\?1hGF4V2TyW$$TI)L^]$Z.LzNx$Gzjgi~U|z5w}+QJ)LknTt=~[g1oe7B^CesaC_O&gt;:iW+Q|T.tq7@S:U#1jD5V#+;GXJZj]8M.%%b6&lt;dW0&gt;D](J5Uv=h/s|^9b\?3Lptzz(v]a~$`YZJEL|2n.OsVUBAuJS%%*g*~_z0^~8Pnio+(g8|s:772y7I5f!}#e&gt;PFO&lt;/0V\?KCGjluS$Aef|QHmv5=Ym%%\?[hzT}Q#W07)P]H`uKo=S2f+`|Ye+5UA{DgF&lt;J0{^]D)BFVRFo#B||4)PZckZz&gt;uOOD[(\"4]Yl;kweA#`U$`oTL9\?#us~o({\?}D2OK@&lt;SCVY+Z;bRtY0MV)^QAD4(wpNZWVUu*U3c8W)TAr$w}o;_ni=l[XQWR~a@cp.fxZE%%e`lr:JUM8g[[_F\"Y0Y0Qih:BxM=d15ZE]\"ztmaDt.1ay4J:#9J.`YZRUi)+~fJj6UcFu,O_L/oigT]BZ;$(Lv&amp;dOY[kSpVZZ\?|Kz0geH5!]H(FItjK`T9cMje&gt;ruE");</span></span>
<span><span class="co">#&gt;     char buf[2021];</span></span>
<span><span class="co">#&gt; #define __doBufN__ 2021</span></span>
<span><span class="co">#&gt;     __doBuf__</span></span>
<span><span class="co">#&gt; #undef __doBuf__</span></span>
<span><span class="co">#&gt; #undef __doBufN__</span></span>
<span><span class="co">#&gt;     SET_STRING_ELT(hash, 0, Rf_mkChar(buf));</span></span>
<span><span class="co">#&gt;     SEXP lst      = PROTECT(_rxQr(hash));pro++;</span></span>
<span><span class="co">#&gt;     _assign_ptr(lst);</span></span>
<span><span class="co">#&gt;     UNPROTECT(pro);</span></span>
<span><span class="co">#&gt;     return lst;</span></span>
<span><span class="co">#&gt;   } else {</span></span>
<span><span class="co">#&gt;     UNPROTECT(pro);</span></span>
<span><span class="co">#&gt;     return _mv;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void rx_522f70bce2bcfe4059d6290423e02064__dydt_lsoda(int *neq, double *t, double *A, double *DADT)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   rx_522f70bce2bcfe4059d6290423e02064__dydt(neq, *t, A, DADT);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern int rx_522f70bce2bcfe4059d6290423e02064__dydt_liblsoda(double __t, double *y, double *ydot, void *data)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   int *neq = (int*)(data);</span></span>
<span><span class="co">#&gt;   rx_522f70bce2bcfe4059d6290423e02064__dydt(neq, __t, y, ydot);</span></span>
<span><span class="co">#&gt;   return(0);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void rx_522f70bce2bcfe4059d6290423e02064__calc_jac_lsoda(int *neq, double *t, double *A,int *ml, int *mu, double *JAC, int *nrowpd){</span></span>
<span><span class="co">#&gt;   // Update all covariate parameters</span></span>
<span><span class="co">#&gt;   rx_522f70bce2bcfe4059d6290423e02064__calc_jac(neq, *t, A, JAC, *nrowpd);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; //Create function to call from R's main thread that assigns the required functions. Sometimes they don't get assigned.</span></span>
<span><span class="co">#&gt; extern void rx_522f70bce2bcfe4059d6290423e02064__assignFuns(void){</span></span>
<span><span class="co">#&gt;   _assignFuns();</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; //Initialize the dll to match rxode2's calls</span></span>
<span><span class="co">#&gt; void R_init0_rx_522f70bce2bcfe4059d6290423e02064_(void){</span></span>
<span><span class="co">#&gt;   // Get C callables on load; Otherwise it isn't thread safe</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_522f70bce2bcfe4059d6290423e02064_","rx_522f70bce2bcfe4059d6290423e02064__assignFuns2", (DL_FUNC) __assignFuns2);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_522f70bce2bcfe4059d6290423e02064_","rx_522f70bce2bcfe4059d6290423e02064__assignFuns", (DL_FUNC) rx_522f70bce2bcfe4059d6290423e02064__assignFuns);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_522f70bce2bcfe4059d6290423e02064_","rx_522f70bce2bcfe4059d6290423e02064__inis",(DL_FUNC) rx_522f70bce2bcfe4059d6290423e02064__inis);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_522f70bce2bcfe4059d6290423e02064_","rx_522f70bce2bcfe4059d6290423e02064__dydt",(DL_FUNC) rx_522f70bce2bcfe4059d6290423e02064__dydt);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_522f70bce2bcfe4059d6290423e02064_","rx_522f70bce2bcfe4059d6290423e02064__calc_lhs",(DL_FUNC) rx_522f70bce2bcfe4059d6290423e02064__calc_lhs);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_522f70bce2bcfe4059d6290423e02064_","rx_522f70bce2bcfe4059d6290423e02064__calc_jac",(DL_FUNC) rx_522f70bce2bcfe4059d6290423e02064__calc_jac);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_522f70bce2bcfe4059d6290423e02064_","rx_522f70bce2bcfe4059d6290423e02064__dydt_lsoda", (DL_FUNC) rx_522f70bce2bcfe4059d6290423e02064__dydt_lsoda);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_522f70bce2bcfe4059d6290423e02064_","rx_522f70bce2bcfe4059d6290423e02064__calc_jac_lsoda", (DL_FUNC) rx_522f70bce2bcfe4059d6290423e02064__calc_jac_lsoda);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_522f70bce2bcfe4059d6290423e02064_","rx_522f70bce2bcfe4059d6290423e02064__ode_solver_solvedata", (DL_FUNC) rx_522f70bce2bcfe4059d6290423e02064__ode_solver_solvedata);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_522f70bce2bcfe4059d6290423e02064_","rx_522f70bce2bcfe4059d6290423e02064__ode_solver_get_solvedata", (DL_FUNC) rx_522f70bce2bcfe4059d6290423e02064__ode_solver_get_solvedata);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_522f70bce2bcfe4059d6290423e02064_","rx_522f70bce2bcfe4059d6290423e02064__F", (DL_FUNC) rx_522f70bce2bcfe4059d6290423e02064__F);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_522f70bce2bcfe4059d6290423e02064_","rx_522f70bce2bcfe4059d6290423e02064__Lag", (DL_FUNC) rx_522f70bce2bcfe4059d6290423e02064__Lag);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_522f70bce2bcfe4059d6290423e02064_","rx_522f70bce2bcfe4059d6290423e02064__Rate", (DL_FUNC) rx_522f70bce2bcfe4059d6290423e02064__Rate);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_522f70bce2bcfe4059d6290423e02064_","rx_522f70bce2bcfe4059d6290423e02064__Dur", (DL_FUNC) rx_522f70bce2bcfe4059d6290423e02064__Dur);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_522f70bce2bcfe4059d6290423e02064_","rx_522f70bce2bcfe4059d6290423e02064__mtime", (DL_FUNC) rx_522f70bce2bcfe4059d6290423e02064__mtime);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_522f70bce2bcfe4059d6290423e02064_","rx_522f70bce2bcfe4059d6290423e02064__ME", (DL_FUNC) rx_522f70bce2bcfe4059d6290423e02064__ME);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_522f70bce2bcfe4059d6290423e02064_","rx_522f70bce2bcfe4059d6290423e02064__IndF", (DL_FUNC) rx_522f70bce2bcfe4059d6290423e02064__IndF);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_522f70bce2bcfe4059d6290423e02064_","rx_522f70bce2bcfe4059d6290423e02064__dydt_liblsoda", (DL_FUNC) rx_522f70bce2bcfe4059d6290423e02064__dydt_liblsoda);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; //Initialize the dll to match rxode2's calls</span></span>
<span><span class="co">#&gt; void R_init_rx_522f70bce2bcfe4059d6290423e02064_(DllInfo *info){</span></span>
<span><span class="co">#&gt;   // Get C callables on load; Otherwise it isn't thread safe</span></span>
<span><span class="co">#&gt;   R_init0_rx_522f70bce2bcfe4059d6290423e02064_();</span></span>
<span><span class="co">#&gt;   static const R_CallMethodDef callMethods[]  = {</span></span>
<span><span class="co">#&gt;     {"rx_522f70bce2bcfe4059d6290423e02064__model_vars", (DL_FUNC) &amp;rx_522f70bce2bcfe4059d6290423e02064__model_vars, 0},</span></span>
<span><span class="co">#&gt;     {NULL, NULL, 0}</span></span>
<span><span class="co">#&gt;   };</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   R_registerRoutines(info, NULL, callMethods, NULL, NULL);</span></span>
<span><span class="co">#&gt;   R_useDynamicSymbols(info,FALSE);</span></span>
<span><span class="co">#&gt;   _assignFuns0();</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; void R_unload_rx_522f70bce2bcfe4059d6290423e02064_ (DllInfo *info){</span></span>
<span><span class="co">#&gt;   // Free resources required for single subject solve.</span></span>
<span><span class="co">#&gt;   SEXP _mv = PROTECT(_rxGetModelLib("rx_522f70bce2bcfe4059d6290423e02064__model_vars"));</span></span>
<span><span class="co">#&gt;   if (!Rf_isNull(_mv)){</span></span>
<span><span class="co">#&gt;     _rxRmModelLib("rx_522f70bce2bcfe4059d6290423e02064__model_vars");</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   UNPROTECT(1);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’</span></span>
<span></span>
<span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rxInits.html">rxInits</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span>
<span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="va">pars</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">regexpr</a></span><span class="op">(</span><span class="st">"(prop|eta)"</span>,<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pars</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">pars</span><span class="op">)</span></span>
<span><span class="co">#&gt;           k        tkde        tkpq       tkqpp    tlambdap      tgamma </span></span>
<span><span class="co">#&gt;    1.00e+02    2.40e-01    2.95e-02    3.10e-03    1.21e-01    7.29e-01 </span></span>
<span><span class="co">#&gt;    tdeltaqp        tpt0         tq0 rxerr.pstar </span></span>
<span><span class="co">#&gt;    8.67e-03    7.13e+00    4.12e+01    1.00e+00</span></span>
<span><span class="co">## This is the exported method for simulation of Theta/Omega internally in rxode2</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rxSimThetaOmega.html">rxSimThetaOmega</a></span><span class="op">(</span>params<span class="op">=</span><span class="va">pars</span>, omega<span class="op">=</span><span class="va">omega</span>,dfSub<span class="op">=</span><span class="fl">760</span>,</span>
<span>                      thetaMat<span class="op">=</span><span class="va">thetaMat</span>, thetaLower<span class="op">=</span><span class="fl">0</span>, nSub<span class="op">=</span><span class="fl">60</span>,nStud<span class="op">=</span><span class="fl">60</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">tkde</span> <span class="op">&gt;</span> <span class="va">tlambdap</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">## You could also simulate more and bind them together to a data frame.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2,100 × 17</span></span></span>
<span><span class="co">#&gt;        k  tkde   tkpq tkqpp tlambdap tgamma tdeltaqp  tpt0   tq0 rxerr.pstar</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>   100 0.468 0.029<span style="text-decoration: underline;">5</span> 0.805    0.288  0.980    0.256  8.54  41.4           1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>   100 0.468 0.029<span style="text-decoration: underline;">5</span> 0.805    0.288  0.980    0.256  8.54  41.4           1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>   100 0.468 0.029<span style="text-decoration: underline;">5</span> 0.805    0.288  0.980    0.256  8.54  41.4           1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>   100 0.468 0.029<span style="text-decoration: underline;">5</span> 0.805    0.288  0.980    0.256  8.54  41.4           1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>   100 0.468 0.029<span style="text-decoration: underline;">5</span> 0.805    0.288  0.980    0.256  8.54  41.4           1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>   100 0.468 0.029<span style="text-decoration: underline;">5</span> 0.805    0.288  0.980    0.256  8.54  41.4           1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>   100 0.468 0.029<span style="text-decoration: underline;">5</span> 0.805    0.288  0.980    0.256  8.54  41.4           1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>   100 0.468 0.029<span style="text-decoration: underline;">5</span> 0.805    0.288  0.980    0.256  8.54  41.4           1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>   100 0.468 0.029<span style="text-decoration: underline;">5</span> 0.805    0.288  0.980    0.256  8.54  41.4           1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>   100 0.468 0.029<span style="text-decoration: underline;">5</span> 0.805    0.288  0.980    0.256  8.54  41.4           1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2,090 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 7 more variables: eta.pt0 &lt;dbl&gt;, eta.q0 &lt;dbl&gt;, eta.lambdap &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   eta.kqp &lt;dbl&gt;, eta.kqpp &lt;dbl&gt;, eta.deltaqp &lt;dbl&gt;, eta.tkde &lt;dbl&gt;</span></span></span>
<span><span class="co">## Quick check to make sure that all the parameters are OK.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">tkde</span><span class="op">&gt;</span><span class="va">df</span><span class="op">$</span><span class="va">tlambdap</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="va">sim1</span> <span class="op">&lt;-</span> <span class="va">r</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Use rxode2</span></span>
<span>    <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>time.units<span class="op">=</span><span class="st">"months"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Pipe to a new event table</span></span>
<span>    <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>amt<span class="op">=</span><span class="fl">1</span>, time<span class="op">=</span><span class="fl">50</span>, until<span class="op">=</span><span class="fl">58</span>, ii<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Add dosing every 1.5 months</span></span>
<span>    <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">250</span>, by<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Add some sampling times (not required)</span></span>
<span>    <span class="fu"><a href="../reference/rxSolve.html">rxSolve</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">## Note this information looses information about which ID is in a</span></span>
<span><span class="co">## "study", so it summarizes the confidence intervals by dividing the</span></span>
<span><span class="co">## subjects into sqrt(#subjects) subjects and then summarizes the</span></span>
<span><span class="co">## confidence intervals</span></span>
<span><span class="va">sim2</span> <span class="op">&lt;-</span> <span class="va">sim1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pt"</span>,<span class="st">"q"</span>,<span class="st">"qp"</span>,<span class="st">"sim"</span><span class="op">)</span>,level<span class="op">=</span><span class="fl">0.90</span><span class="op">)</span>; <span class="co"># Create Simulation intervals</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> in order to put confidence bands around the intervals, you need at least 2500 simulations</span></span>
<span><span class="co">#&gt; summarizing data...done</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">sim2</span>, file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"rxode2"</span><span class="op">)</span>, <span class="st">"pipeline-sim2.rds"</span><span class="op">)</span>, version <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">sim2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="rxode2-pipeline_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthew L. Fidler, Wenping Wang, Melissa Hallow.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
