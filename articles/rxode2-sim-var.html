<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>rxode2 Simulation • rxode2</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="rxode2 Simulation">
<meta name="google-site-verification" content="fp9A3qPrCar1DKeVQg4Mfrf6-An5keP9OwhIxUkntbU">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rxode2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-book"></span> Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Getting started</h6></li>
    <li><a class="dropdown-item" href="../articles/rxode2-syntax.html">rxode2 mini language syntax</a></li>
    <li><a class="dropdown-item" href="../articles/Modifying-Models.html">rxode2 model modification %&gt;%</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-pipeline.html">rxode2 pipeline ie %&gt;%</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-speed.html">Speeding up rxode2 ODE solving</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-data-frame.html">Adaptive Data Frames with rxode2</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-plot.html">Plotting with rxode2</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Advanced Features, Model Types, Technical Details</h6></li>
    <li><a class="dropdown-item" href="../articles/rxode2-model-types.html">rxode2 model types</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-cmt.html">Chainging rxode2 compartment numbers</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-transit-compartments.html">rxode2 transit compartment models</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-shiny.html">Using Shiny with rxode2</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-covariates.html">rxode2 covariates</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-stiff.html">Stiff Systems and Jacobian specification</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-rxUse.html">Adding compiled rxode2 models to your package</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-dosing-events" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-stethoscope"></span> Dosing/Events</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-dosing-events">
<li><a class="dropdown-item" href="../articles/rxode2-datasets.html">nlmixr/rxode2 dataset overview</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-event-types.html">Supported Event Types</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-event-table.html">Easy rxode2 Event Tables</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-events-classic.html">Classic rxode2 events explained</a></li>
  </ul>
</li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-simulations" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-desktop"></span> Simulations</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-simulations">
<li><a class="dropdown-item" href="../articles/rxode2-single-subject.html">Single Subject ODE solving</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-sim-var.html">Multiple Subject rxode2 Simulation</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-prior-data.html">Using Prior Data for ODE solving</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-help" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-life-ring"></span> Help</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-help">
<li><a class="dropdown-item" href="../articles/rxode2-tutorials.html">Running the interactive tutorials</a></li>
    <li><a class="external-link dropdown-item" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4728294/pdf/PSP4-5-03.pdf">2015 CPT tutorial</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/rxode2-covariates.html">Adding Circadian Rythmn (time-varying covariates)</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-wt.html">Weight Based Dosing</a></li>
    <li><a class="dropdown-item" href="../articles/rxode2-nesting.html">Simulating Multiple levels of nesting (iov, between study etc)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changes/News</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="https://nlmixr2.github.io/rxode2/reference/index.html"><span class="fa fa-file-code-o"></span> Functions</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-archive"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-">
<li><a class="dropdown-item" href="https://nlmixr2.github.io/rxode2-manual/">rxode2 User Guide</a></li>
    <li><a class="external-link dropdown-item" href="https://nlmixr2.org/">nlmixr2</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nlmixr2/rxode2"><span class="fa fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nlmixr2/rxode2/releases"><span class="fa fa-download"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>rxode2 Simulation</h1>
            
            <h4 data-toc-skip class="date">2025-07-23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nlmixr2/rxode2/blob/main/vignettes/rxode2-sim-var.Rmd" class="external-link"><code>vignettes/rxode2-sim-var.Rmd</code></a></small>
      <div class="d-none name"><code>rxode2-sim-var.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="population-simulations-with-rxode2">Population Simulations with rxode2<a class="anchor" aria-label="anchor" href="#population-simulations-with-rxode2"></a>
</h2>
<div class="section level3">
<h3 id="simulation-of-variability-with-rxode2">Simulation of Variability with rxode2<a class="anchor" aria-label="anchor" href="#simulation-of-variability-with-rxode2"></a>
</h3>
<p>In pharmacometrics the nonlinear-mixed effect modeling software (like
nlmixr) characterizes the between-subject variability. With this between
subject variability you can simulate new subjects.</p>
<p>Assuming that you have a 2-compartment, indirect response model, you
can set create an rxode2 model describing this system below:</p>
<div class="section level4">
<h4 id="setting-up-the-rxode2-model">Setting up the rxode2 model<a class="anchor" aria-label="anchor" href="#setting-up-the-rxode2-model"></a>
</h4>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nlmixr2.github.io/rxode2/">rxode2</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; rxode2 4.0.2 using 2 threads (see ?getRxThreads)</span></span>
<span><span class="co">#&gt;   no cache: create with `rxCreateCache()`</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">32</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/rxSetSeed.html">rxSetSeed</a></span><span class="op">(</span><span class="fl">32</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/ini.html">ini</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">KA</span> <span class="op">&lt;-</span> <span class="fl">2.94E-01</span></span>
<span>    <span class="va">TCl</span> <span class="op">&lt;-</span> <span class="fl">1.86E+01</span></span>
<span>    <span class="co"># between subject variability</span></span>
<span>    <span class="va">eta.Cl</span> <span class="op">~</span> <span class="fl">0.4</span><span class="op">^</span><span class="fl">2</span></span>
<span>    <span class="va">V2</span> <span class="op">&lt;-</span> <span class="fl">4.02E+01</span></span>
<span>    <span class="va">Q</span> <span class="op">&lt;-</span> <span class="fl">1.05E+01</span></span>
<span>    <span class="va">V3</span> <span class="op">&lt;-</span> <span class="fl">2.97E+02</span></span>
<span>    <span class="va">Kin</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>    <span class="va">Kout</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>    <span class="va">EC50</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/model.html">model</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">C2</span> <span class="op">&lt;-</span> <span class="va">centr</span><span class="op">/</span><span class="va">V2</span></span>
<span>    <span class="va">C3</span> <span class="op">&lt;-</span> <span class="va">peri</span><span class="op">/</span><span class="va">V3</span></span>
<span>    <span class="va">CL</span> <span class="op">&lt;-</span>  <span class="va">TCl</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">eta.Cl</span><span class="op">)</span> <span class="co">## This is coded as a variable in the model</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">depot</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="va">KA</span><span class="op">*</span><span class="va">depot</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">centr</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">KA</span><span class="op">*</span><span class="va">depot</span> <span class="op">-</span> <span class="va">CL</span><span class="op">*</span><span class="va">C2</span> <span class="op">-</span> <span class="va">Q</span><span class="op">*</span><span class="va">C2</span> <span class="op">+</span> <span class="va">Q</span><span class="op">*</span><span class="va">C3</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">peri</span><span class="op">)</span>  <span class="op">&lt;-</span>                    <span class="va">Q</span><span class="op">*</span><span class="va">C2</span> <span class="op">-</span> <span class="va">Q</span><span class="op">*</span><span class="va">C3</span></span>
<span>    <span class="va">d</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">dt</a></span><span class="op">(</span><span class="va">eff</span><span class="op">)</span>   <span class="op">&lt;-</span> <span class="va">Kin</span> <span class="op">-</span> <span class="va">Kout</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">C2</span><span class="op">/</span><span class="op">(</span><span class="va">EC50</span><span class="op">+</span><span class="va">C2</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="va">eff</span></span>
<span>    <span class="fu">eff</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="simulating">Simulating<a class="anchor" aria-label="anchor" href="#simulating"></a>
</h4>
<p>The next step to simulate is to create the dosing regimen for overall
simulation:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ev</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>amountUnits<span class="op">=</span><span class="st">"mg"</span>, timeUnits<span class="op">=</span><span class="st">"hours"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>amt<span class="op">=</span><span class="fl">10000</span>, cmt<span class="op">=</span><span class="st">"centr"</span><span class="op">)</span></span></code></pre></div>
<p>If you wish, you can also add sampling times (though rxode2 can fill
these in for you):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ev</span> <span class="op">&lt;-</span> <span class="va">ev</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">48</span>, length.out<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<p>Note the <code>et</code> takes similar arguments as <code>seq</code>
when adding sampling times. There are more methods to adding sampling
times and events to make complex dosing regimens (See <a href="rxode2-events.html">the event vignette</a>). This includes ways to
add variability to the <a href="rxode2-events.html#add-doses-and-samples-within-a-sampling-window">both
the sampling and dosing times</a>).</p>
<p>Once this is complete you can simulate using the <code>rxSolve</code>
routine:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rxSolve.html">rxSolve</a></span><span class="op">(</span><span class="va">mod</span>, <span class="va">ev</span>, nSub<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> parameter labels from comments are typically ignored in non-interactive mode</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Need to run with the source intact to parse comments</span></span>
<span><span class="co">#&gt; C model:</span></span>
<span><span class="co">#&gt; // Define translation state order for 4 states</span></span>
<span><span class="co">#&gt; #define __DDT0__ 0 // depot</span></span>
<span><span class="co">#&gt; #define _DEPOT_ 0 // depot</span></span>
<span><span class="co">#&gt; #define __DDT1__ 1 // centr</span></span>
<span><span class="co">#&gt; #define __DDT2__ 2 // peri</span></span>
<span><span class="co">#&gt; #define __DDT3__ 3 // eff</span></span>
<span><span class="co">#&gt; // Define 3 LHS values</span></span>
<span><span class="co">#&gt; #define _LHS_0_ 0 // C2</span></span>
<span><span class="co">#&gt; #define _LHS_1_ 1 // C3</span></span>
<span><span class="co">#&gt; #define _LHS_2_ 2 // CL</span></span>
<span><span class="co">#&gt; #define _getRxSolve_ _rx2dbd896ec90e82992ec062b48d4778e10__getRxSolve__Vaoj</span></span>
<span><span class="co">#&gt; #define _evalUdf _rx2dbd896ec90e82992ec062b48d4778e11__evalUdf_9xkq</span></span>
<span><span class="co">#&gt; #define _solveData _rx2dbd896ec90e82992ec062b48d4778e12__solveData_fOeJ</span></span>
<span><span class="co">#&gt; #define _assign_ptr _rx2dbd896ec90e82992ec062b48d4778e13__assign_ptr_blGk</span></span>
<span><span class="co">#&gt; #define _rxRmModelLib _rx2dbd896ec90e82992ec062b48d4778e14__rxRmModelLib_nQcu</span></span>
<span><span class="co">#&gt; #define _rxGetModelLib _rx2dbd896ec90e82992ec062b48d4778e15__rxGetModelLib_gtS8</span></span>
<span><span class="co">#&gt; #define _old_c _rx2dbd896ec90e82992ec062b48d4778e16__old_c_ZySW</span></span>
<span><span class="co">#&gt; #define _ptrid _rx2dbd896ec90e82992ec062b48d4778e17__ptrid_XbOp</span></span>
<span><span class="co">#&gt; #define _rxIsCurrentC _rx2dbd896ec90e82992ec062b48d4778e18__rxIsCurrentC_upRl</span></span>
<span><span class="co">#&gt; #define _sumPS _rx2dbd896ec90e82992ec062b48d4778e19__sumPS_W9nz</span></span>
<span><span class="co">#&gt; #define _prodPS _rx2dbd896ec90e82992ec062b48d4778e110__prodPS_Nl8X</span></span>
<span><span class="co">#&gt; #define _prodType _rx2dbd896ec90e82992ec062b48d4778e111__prodType_pDdx</span></span>
<span><span class="co">#&gt; #define _sumType _rx2dbd896ec90e82992ec062b48d4778e112__sumType_l3ox</span></span>
<span><span class="co">#&gt; #define _update_par_ptr _rx2dbd896ec90e82992ec062b48d4778e113__update_par_ptr_hL10</span></span>
<span><span class="co">#&gt; #define _getParCov _rx2dbd896ec90e82992ec062b48d4778e114__getParCov_prgx</span></span>
<span><span class="co">#&gt; #define _rxode2_rxAssignPtr _rx2dbd896ec90e82992ec062b48d4778e115__rxode2_rxAssignPtr_n8iB</span></span>
<span><span class="co">#&gt; #define _rxQr _rx2dbd896ec90e82992ec062b48d4778e116__rxQr_Czq6</span></span>
<span><span class="co">#&gt; #define _compareFactorVal _rx2dbd896ec90e82992ec062b48d4778e117__compareFactorVal_wPpF</span></span>
<span><span class="co">#&gt; #define _sum _rx2dbd896ec90e82992ec062b48d4778e118__sum_S16D</span></span>
<span><span class="co">#&gt; #define _udf _rx2dbd896ec90e82992ec062b48d4778e119__udf_k7NN</span></span>
<span><span class="co">#&gt; #define _sign _rx2dbd896ec90e82992ec062b48d4778e120__sign_WXX0</span></span>
<span><span class="co">#&gt; #define _prod _rx2dbd896ec90e82992ec062b48d4778e121__prod_AXSr</span></span>
<span><span class="co">#&gt; #define _max _rx2dbd896ec90e82992ec062b48d4778e122__max_Br3J</span></span>
<span><span class="co">#&gt; #define _min _rx2dbd896ec90e82992ec062b48d4778e123__min_7KG3</span></span>
<span><span class="co">#&gt; #define _transit4P _rx2dbd896ec90e82992ec062b48d4778e124__transit4P_GO65</span></span>
<span><span class="co">#&gt; #define _transit3P _rx2dbd896ec90e82992ec062b48d4778e125__transit3P_eqQ1</span></span>
<span><span class="co">#&gt; #define _assignFuns0 _rx2dbd896ec90e82992ec062b48d4778e126__assignFuns0_JnTj</span></span>
<span><span class="co">#&gt; #define _assignFuns _rx2dbd896ec90e82992ec062b48d4778e127__assignFuns_3jE8</span></span>
<span><span class="co">#&gt; #define _rxord _rx2dbd896ec90e82992ec062b48d4778e128__rxord_m9Qw</span></span>
<span><span class="co">#&gt; #define __assignFuns2 _rx2dbd896ec90e82992ec062b48d4778e129___assignFuns2_oDHN</span></span>
<span><span class="co">#&gt; #define _llikCauchyDscale _rx2dbd896ec90e82992ec062b48d4778e130__llikCauchyDscale_9v1a</span></span>
<span><span class="co">#&gt; #define _llikCauchyDlocation _rx2dbd896ec90e82992ec062b48d4778e131__llikCauchyDlocation_NCaN</span></span>
<span><span class="co">#&gt; #define _llikCauchy _rx2dbd896ec90e82992ec062b48d4778e132__llikCauchy_Y5AY</span></span>
<span><span class="co">#&gt; #define _llikGammaDrate _rx2dbd896ec90e82992ec062b48d4778e133__llikGammaDrate_DVeb</span></span>
<span><span class="co">#&gt; #define _llikGammaDshape _rx2dbd896ec90e82992ec062b48d4778e134__llikGammaDshape_eTU6</span></span>
<span><span class="co">#&gt; #define _llikGamma _rx2dbd896ec90e82992ec062b48d4778e135__llikGamma_83cw</span></span>
<span><span class="co">#&gt; #define _llikWeibullDscale _rx2dbd896ec90e82992ec062b48d4778e136__llikWeibullDscale_dxIU</span></span>
<span><span class="co">#&gt; #define _llikWeibullDshape _rx2dbd896ec90e82992ec062b48d4778e137__llikWeibullDshape_B7M8</span></span>
<span><span class="co">#&gt; #define _llikWeibull _rx2dbd896ec90e82992ec062b48d4778e138__llikWeibull_uE0z</span></span>
<span><span class="co">#&gt; #define _llikUnifDbeta _rx2dbd896ec90e82992ec062b48d4778e139__llikUnifDbeta_dHL1</span></span>
<span><span class="co">#&gt; #define _llikUnifDalpha _rx2dbd896ec90e82992ec062b48d4778e140__llikUnifDalpha_uh7y</span></span>
<span><span class="co">#&gt; #define _llikUnif _rx2dbd896ec90e82992ec062b48d4778e141__llikUnif_7i1b</span></span>
<span><span class="co">#&gt; #define _llikGeomDp _rx2dbd896ec90e82992ec062b48d4778e142__llikGeomDp_bYr8</span></span>
<span><span class="co">#&gt; #define _llikGeom _rx2dbd896ec90e82992ec062b48d4778e143__llikGeom_p4ZQ</span></span>
<span><span class="co">#&gt; #define _llikFDdf2 _rx2dbd896ec90e82992ec062b48d4778e144__llikFDdf2_nbD8</span></span>
<span><span class="co">#&gt; #define _llikFDdf1 _rx2dbd896ec90e82992ec062b48d4778e145__llikFDdf1_I1X2</span></span>
<span><span class="co">#&gt; #define _llikF _rx2dbd896ec90e82992ec062b48d4778e146__llikF_u8uJ</span></span>
<span><span class="co">#&gt; #define _llikExpDrate _rx2dbd896ec90e82992ec062b48d4778e147__llikExpDrate_iaaT</span></span>
<span><span class="co">#&gt; #define _llikExp _rx2dbd896ec90e82992ec062b48d4778e148__llikExp_DAI8</span></span>
<span><span class="co">#&gt; #define _llikChisqDdf _rx2dbd896ec90e82992ec062b48d4778e149__llikChisqDdf_F3U0</span></span>
<span><span class="co">#&gt; #define _llikChisq _rx2dbd896ec90e82992ec062b48d4778e150__llikChisq_HSfC</span></span>
<span><span class="co">#&gt; #define _llikTDsd _rx2dbd896ec90e82992ec062b48d4778e151__llikTDsd_Q5OV</span></span>
<span><span class="co">#&gt; #define _llikTDmean _rx2dbd896ec90e82992ec062b48d4778e152__llikTDmean_X4IS</span></span>
<span><span class="co">#&gt; #define _llikTDdf _rx2dbd896ec90e82992ec062b48d4778e153__llikTDdf_WheJ</span></span>
<span><span class="co">#&gt; #define _llikT _rx2dbd896ec90e82992ec062b48d4778e154__llikT_WWae</span></span>
<span><span class="co">#&gt; #define _llikBetaDshape2 _rx2dbd896ec90e82992ec062b48d4778e155__llikBetaDshape2_FZ8j</span></span>
<span><span class="co">#&gt; #define _llikBetaDshape1 _rx2dbd896ec90e82992ec062b48d4778e156__llikBetaDshape1_xI80</span></span>
<span><span class="co">#&gt; #define _llikBeta _rx2dbd896ec90e82992ec062b48d4778e157__llikBeta_U112</span></span>
<span><span class="co">#&gt; #define _llikNbinomMuDmu _rx2dbd896ec90e82992ec062b48d4778e158__llikNbinomMuDmu_w2La</span></span>
<span><span class="co">#&gt; #define _llikNbinomMu _rx2dbd896ec90e82992ec062b48d4778e159__llikNbinomMu_9bV7</span></span>
<span><span class="co">#&gt; #define _llikNbinomDprob _rx2dbd896ec90e82992ec062b48d4778e160__llikNbinomDprob_N6xI</span></span>
<span><span class="co">#&gt; #define _llikNbinom _rx2dbd896ec90e82992ec062b48d4778e161__llikNbinom_MJk0</span></span>
<span><span class="co">#&gt; #define _llikBinomDprob _rx2dbd896ec90e82992ec062b48d4778e162__llikBinomDprob_jHvl</span></span>
<span><span class="co">#&gt; #define _llikBinom _rx2dbd896ec90e82992ec062b48d4778e163__llikBinom_xTGE</span></span>
<span><span class="co">#&gt; #define _llikPoisDlambda _rx2dbd896ec90e82992ec062b48d4778e164__llikPoisDlambda_rsm8</span></span>
<span><span class="co">#&gt; #define _llikPois _rx2dbd896ec90e82992ec062b48d4778e165__llikPois_eoul</span></span>
<span><span class="co">#&gt; #define _llikNormDsd _rx2dbd896ec90e82992ec062b48d4778e166__llikNormDsd_HI69</span></span>
<span><span class="co">#&gt; #define _llikNormDmean _rx2dbd896ec90e82992ec062b48d4778e167__llikNormDmean_BpBR</span></span>
<span><span class="co">#&gt; #define _llikNorm _rx2dbd896ec90e82992ec062b48d4778e168__llikNorm_YoQF</span></span>
<span><span class="co">#&gt; #define simeps _rx2dbd896ec90e82992ec062b48d4778e169_simeps_Gl8i</span></span>
<span><span class="co">#&gt; #define simeta _rx2dbd896ec90e82992ec062b48d4778e170_simeta_fPX7</span></span>
<span><span class="co">#&gt; #define expit _rx2dbd896ec90e82992ec062b48d4778e171_expit_kbOk</span></span>
<span><span class="co">#&gt; #define logit _rx2dbd896ec90e82992ec062b48d4778e172_logit_UR3R</span></span>
<span><span class="co">#&gt; #define gammapDer _rx2dbd896ec90e82992ec062b48d4778e173_gammapDer_0cxY</span></span>
<span><span class="co">#&gt; #define lowergamma _rx2dbd896ec90e82992ec062b48d4778e174_lowergamma_CG1i</span></span>
<span><span class="co">#&gt; #define uppergamma _rx2dbd896ec90e82992ec062b48d4778e175_uppergamma_PGJk</span></span>
<span><span class="co">#&gt; #define gammaqInva _rx2dbd896ec90e82992ec062b48d4778e176_gammaqInva_jzI2</span></span>
<span><span class="co">#&gt; #define gammaqInv _rx2dbd896ec90e82992ec062b48d4778e177_gammaqInv_kItb</span></span>
<span><span class="co">#&gt; #define gammapInva _rx2dbd896ec90e82992ec062b48d4778e178_gammapInva_aBdx</span></span>
<span><span class="co">#&gt; #define gammapInv _rx2dbd896ec90e82992ec062b48d4778e179_gammapInv_vufd</span></span>
<span><span class="co">#&gt; #define gammaq _rx2dbd896ec90e82992ec062b48d4778e180_gammaq_Isq6</span></span>
<span><span class="co">#&gt; #define gammap _rx2dbd896ec90e82992ec062b48d4778e181_gammap_9enN</span></span>
<span><span class="co">#&gt; #define phi _rx2dbd896ec90e82992ec062b48d4778e182_phi_xL3f</span></span>
<span><span class="co">#&gt; #define d2ELUa _rx2dbd896ec90e82992ec062b48d4778e183_d2ELUa_Ypol</span></span>
<span><span class="co">#&gt; #define dELUa _rx2dbd896ec90e82992ec062b48d4778e184_dELUa_0xIK</span></span>
<span><span class="co">#&gt; #define d2aELU _rx2dbd896ec90e82992ec062b48d4778e185_d2aELU_JCgF</span></span>
<span><span class="co">#&gt; #define d2ELU _rx2dbd896ec90e82992ec062b48d4778e186_d2ELU_NmXy</span></span>
<span><span class="co">#&gt; #define dELU _rx2dbd896ec90e82992ec062b48d4778e187_dELU_kPca</span></span>
<span><span class="co">#&gt; #define ELU _rx2dbd896ec90e82992ec062b48d4778e188_ELU_SQGe</span></span>
<span><span class="co">#&gt; #define dPReLUa1 _rx2dbd896ec90e82992ec062b48d4778e189_dPReLUa1_bE5B</span></span>
<span><span class="co">#&gt; #define dPReLUa _rx2dbd896ec90e82992ec062b48d4778e190_dPReLUa_1yeg</span></span>
<span><span class="co">#&gt; #define dPReLU _rx2dbd896ec90e82992ec062b48d4778e191_dPReLU_FeCE</span></span>
<span><span class="co">#&gt; #define PReLU _rx2dbd896ec90e82992ec062b48d4778e192_PReLU_Vukc</span></span>
<span><span class="co">#&gt; #define dSwish _rx2dbd896ec90e82992ec062b48d4778e193_dSwish_GHuo</span></span>
<span><span class="co">#&gt; #define Swish _rx2dbd896ec90e82992ec062b48d4778e194_Swish_ARTH</span></span>
<span><span class="co">#&gt; #define dlReLU _rx2dbd896ec90e82992ec062b48d4778e195_dlReLU_xSmZ</span></span>
<span><span class="co">#&gt; #define lReLU _rx2dbd896ec90e82992ec062b48d4778e196_lReLU_rAF2</span></span>
<span><span class="co">#&gt; #define dSELU _rx2dbd896ec90e82992ec062b48d4778e197_dSELU_ZZsK</span></span>
<span><span class="co">#&gt; #define SELU _rx2dbd896ec90e82992ec062b48d4778e198_SELU_G2LP</span></span>
<span><span class="co">#&gt; #define d4softplus _rx2dbd896ec90e82992ec062b48d4778e199_d4softplus_1qBg</span></span>
<span><span class="co">#&gt; #define d3softplus _rx2dbd896ec90e82992ec062b48d4778e1100_d3softplus_0fWO</span></span>
<span><span class="co">#&gt; #define d2softplus _rx2dbd896ec90e82992ec062b48d4778e1101_d2softplus_VS5I</span></span>
<span><span class="co">#&gt; #define dsoftplus _rx2dbd896ec90e82992ec062b48d4778e1102_dsoftplus_1hpY</span></span>
<span><span class="co">#&gt; #define softplus _rx2dbd896ec90e82992ec062b48d4778e1103_softplus_yEzw</span></span>
<span><span class="co">#&gt; #define d4GELU _rx2dbd896ec90e82992ec062b48d4778e1104_d4GELU_Nzgn</span></span>
<span><span class="co">#&gt; #define d3GELU _rx2dbd896ec90e82992ec062b48d4778e1105_d3GELU_epKf</span></span>
<span><span class="co">#&gt; #define d2GELU _rx2dbd896ec90e82992ec062b48d4778e1106_d2GELU_egrF</span></span>
<span><span class="co">#&gt; #define dGELU _rx2dbd896ec90e82992ec062b48d4778e1107_dGELU_8t09</span></span>
<span><span class="co">#&gt; #define GELU _rx2dbd896ec90e82992ec062b48d4778e1108_GELU_Y5xW</span></span>
<span><span class="co">#&gt; #define dReLU _rx2dbd896ec90e82992ec062b48d4778e1109_dReLU_Pym9</span></span>
<span><span class="co">#&gt; #define ReLU _rx2dbd896ec90e82992ec062b48d4778e1110_ReLU_UDEX</span></span>
<span><span class="co">#&gt; #define riweibull _rx2dbd896ec90e82992ec062b48d4778e1111_riweibull_MOf4</span></span>
<span><span class="co">#&gt; #define riunif _rx2dbd896ec90e82992ec062b48d4778e1112_riunif_mRid</span></span>
<span><span class="co">#&gt; #define rit_ _rx2dbd896ec90e82992ec062b48d4778e1113_rit__m39x</span></span>
<span><span class="co">#&gt; #define ripois _rx2dbd896ec90e82992ec062b48d4778e1114_ripois_jiFE</span></span>
<span><span class="co">#&gt; #define ribeta _rx2dbd896ec90e82992ec062b48d4778e1115_ribeta_pjmW</span></span>
<span><span class="co">#&gt; #define rigamma _rx2dbd896ec90e82992ec062b48d4778e1116_rigamma_EuSr</span></span>
<span><span class="co">#&gt; #define rigeom _rx2dbd896ec90e82992ec062b48d4778e1117_rigeom_X2fg</span></span>
<span><span class="co">#&gt; #define rif _rx2dbd896ec90e82992ec062b48d4778e1118_rif_ccvo</span></span>
<span><span class="co">#&gt; #define riexp _rx2dbd896ec90e82992ec062b48d4778e1119_riexp_gQjd</span></span>
<span><span class="co">#&gt; #define richisq _rx2dbd896ec90e82992ec062b48d4778e1120_richisq_SxjK</span></span>
<span><span class="co">#&gt; #define ricauchy _rx2dbd896ec90e82992ec062b48d4778e1121_ricauchy_YDx2</span></span>
<span><span class="co">#&gt; #define rinbinomMu _rx2dbd896ec90e82992ec062b48d4778e1122_rinbinomMu_EoAo</span></span>
<span><span class="co">#&gt; #define rinbinom _rx2dbd896ec90e82992ec062b48d4778e1123_rinbinom_YFjR</span></span>
<span><span class="co">#&gt; #define ribinom _rx2dbd896ec90e82992ec062b48d4778e1124_ribinom_HKKt</span></span>
<span><span class="co">#&gt; #define rinorm _rx2dbd896ec90e82992ec062b48d4778e1125_rinorm_kaKz</span></span>
<span><span class="co">#&gt; #define rxweibull _rx2dbd896ec90e82992ec062b48d4778e1126_rxweibull_7SFM</span></span>
<span><span class="co">#&gt; #define rxunif _rx2dbd896ec90e82992ec062b48d4778e1127_rxunif_H4zk</span></span>
<span><span class="co">#&gt; #define rxt_ _rx2dbd896ec90e82992ec062b48d4778e1128_rxt__6zQQ</span></span>
<span><span class="co">#&gt; #define rxpois _rx2dbd896ec90e82992ec062b48d4778e1129_rxpois_bQJb</span></span>
<span><span class="co">#&gt; #define rxbeta _rx2dbd896ec90e82992ec062b48d4778e1130_rxbeta_vvZh</span></span>
<span><span class="co">#&gt; #define rxgamma _rx2dbd896ec90e82992ec062b48d4778e1131_rxgamma_xRbw</span></span>
<span><span class="co">#&gt; #define rxgeom _rx2dbd896ec90e82992ec062b48d4778e1132_rxgeom_oyS6</span></span>
<span><span class="co">#&gt; #define rxf _rx2dbd896ec90e82992ec062b48d4778e1133_rxf_AagP</span></span>
<span><span class="co">#&gt; #define rxexp _rx2dbd896ec90e82992ec062b48d4778e1134_rxexp_RNyr</span></span>
<span><span class="co">#&gt; #define rxchisq _rx2dbd896ec90e82992ec062b48d4778e1135_rxchisq_gWz3</span></span>
<span><span class="co">#&gt; #define rxcauchy _rx2dbd896ec90e82992ec062b48d4778e1136_rxcauchy_ZsGr</span></span>
<span><span class="co">#&gt; #define rxnbinomMu _rx2dbd896ec90e82992ec062b48d4778e1137_rxnbinomMu_k6bc</span></span>
<span><span class="co">#&gt; #define rxnbinom _rx2dbd896ec90e82992ec062b48d4778e1138_rxnbinom_B8sn</span></span>
<span><span class="co">#&gt; #define rxbinom _rx2dbd896ec90e82992ec062b48d4778e1139_rxbinom_zwc8</span></span>
<span><span class="co">#&gt; #define rxnorm _rx2dbd896ec90e82992ec062b48d4778e1140_rxnorm_6J2u</span></span>
<span><span class="co">#&gt; #define linCmtB _rx2dbd896ec90e82992ec062b48d4778e1141_linCmtB_b58Z</span></span>
<span><span class="co">#&gt; #define linCmtA _rx2dbd896ec90e82992ec062b48d4778e1142_linCmtA_JhNT</span></span>
<span><span class="co">#&gt; #include &lt;rxode2_model_shared.h&gt;</span></span>
<span><span class="co">#&gt; #define __MAX_PROD__ 0</span></span>
<span><span class="co">#&gt; #define _CMT CMT</span></span>
<span><span class="co">#&gt; #define _SYNC_simeps_ for (int _svari=_solveData-&gt;neps; _svari--;){  if (_solveData-&gt;svar[_svari] == 0) {KA = _PP[0];};   if (_solveData-&gt;svar[_svari] == 1) {TCl = _PP[1];};   if (_solveData-&gt;svar[_svari] == 2) {V2 = _PP[2];};   if (_solveData-&gt;svar[_svari] == 3) {Q = _PP[3];};   if (_solveData-&gt;svar[_svari] == 4) {V3 = _PP[4];};   if (_solveData-&gt;svar[_svari] == 5) {Kin = _PP[5];};   if (_solveData-&gt;svar[_svari] == 6) {Kout = _PP[6];};   if (_solveData-&gt;svar[_svari] == 7) {EC50 = _PP[7];};   if (_solveData-&gt;svar[_svari] == 8) {eta_DoT_Cl = _PP[8];}; }</span></span>
<span><span class="co">#&gt; #define _SYNC_simeta_ for (int _ovari=_solveData-&gt;neta; _ovari--;){  if (_solveData-&gt;ovar[_ovari] == 0) {KA = _PP[0];};   if (_solveData-&gt;ovar[_ovari] == 1) {TCl = _PP[1];};   if (_solveData-&gt;ovar[_ovari] == 2) {V2 = _PP[2];};   if (_solveData-&gt;ovar[_ovari] == 3) {Q = _PP[3];};   if (_solveData-&gt;ovar[_ovari] == 4) {V3 = _PP[4];};   if (_solveData-&gt;ovar[_ovari] == 5) {Kin = _PP[5];};   if (_solveData-&gt;ovar[_ovari] == 6) {Kout = _PP[6];};   if (_solveData-&gt;ovar[_ovari] == 7) {EC50 = _PP[7];};   if (_solveData-&gt;ovar[_ovari] == 8) {eta_DoT_Cl = _PP[8];}; }</span></span>
<span><span class="co">#&gt; _getRxSolve_t _getRxSolve_;</span></span>
<span><span class="co">#&gt; _simfun simeps;</span></span>
<span><span class="co">#&gt; _simfun simeta;</span></span>
<span><span class="co">#&gt; _udf_type _evalUdf=NULL;</span></span>
<span><span class="co">#&gt; rx_solve *_solveData=NULL;</span></span>
<span><span class="co">#&gt; rxode2_assign_ptr _assign_ptr=NULL;</span></span>
<span><span class="co">#&gt; _rxRmModelLibType _rxRmModelLib=NULL;</span></span>
<span><span class="co">#&gt; _rxGetModelLibType _rxGetModelLib=NULL;</span></span>
<span><span class="co">#&gt; rxode2_ode_solver_old_c _old_c=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _ptrid=NULL;</span></span>
<span><span class="co">#&gt; _rxIsCurrentC_type _rxIsCurrentC=NULL;</span></span>
<span><span class="co">#&gt; _rxSumType _sumPS=NULL;</span></span>
<span><span class="co">#&gt; _rxProdType _prodPS=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _prodType=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _sumType=NULL;</span></span>
<span><span class="co">#&gt; _update_par_ptr_p _update_par_ptr=NULL;</span></span>
<span><span class="co">#&gt; _getParCov_p _getParCov=NULL;</span></span>
<span><span class="co">#&gt; linCmtA_p linCmtA;</span></span>
<span><span class="co">#&gt; linCmtB_p linCmtB;</span></span>
<span><span class="co">#&gt; _rx_asgn _rxode2_rxAssignPtr=NULL;</span></span>
<span><span class="co">#&gt; _rx_asgn _rxQr=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn phi;</span></span>
<span><span class="co">#&gt; rxode2_fn ReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn dReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn dGELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d2GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d3GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d4GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn dsoftplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d2softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d3softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d4softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn SELU;</span></span>
<span><span class="co">#&gt; rxode2_fn dSELU;</span></span>
<span><span class="co">#&gt; rxode2_fn lReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn dlReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn Swish;</span></span>
<span><span class="co">#&gt; rxode2_fn dSwish;</span></span>
<span><span class="co">#&gt; rxode2_fn2 PReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLUa;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLUa1;</span></span>
<span><span class="co">#&gt; rxode2_fn2 ELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2ELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2aELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dELUa;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2ELUa;</span></span>
<span><span class="co">#&gt; rxode2_fn3 logit;</span></span>
<span><span class="co">#&gt; rxode2_fn3 expit;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammap;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaq;</span></span>
<span><span class="co">#&gt; rxode2_fn2 lowergamma;</span></span>
<span><span class="co">#&gt; rxode2_fn2 uppergamma;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapInv;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapDer;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapInva;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaqInv;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaqInva;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxnorm;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxbinom;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxnbinom;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxnbinomMu;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxcauchy;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxchisq;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxexp;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxf;</span></span>
<span><span class="co">#&gt; rxode2i_ifn rxgeom;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxgamma;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxbeta;</span></span>
<span><span class="co">#&gt; rxode2i_ifn rxpois;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxt_;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxunif;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxweibull;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rinorm;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom ribinom;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom rinbinom;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom rinbinomMu;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 ricauchy;</span></span>
<span><span class="co">#&gt; rxode2i2_fn richisq;</span></span>
<span><span class="co">#&gt; rxode2i2_fn riexp;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rif;</span></span>
<span><span class="co">#&gt; rxode2i2_ifn rigeom;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rigamma;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 ribeta;</span></span>
<span><span class="co">#&gt; rxode2i2_ifn ripois;</span></span>
<span><span class="co">#&gt; rxode2i2_fn rit_;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 riunif;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 riweibull;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNorm;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNormDmean;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNormDsd;</span></span>
<span><span class="co">#&gt; rxode2_llikPoisFun _llikPois;</span></span>
<span><span class="co">#&gt; rxode2_llikPoisFun _llikPoisDlambda;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikBinom;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikBinomDprob;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinom;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomDprob;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomMu;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomMuDmu;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBeta;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBetaDshape1;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBetaDshape2;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikT;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDdf;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDmean;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDsd;</span></span>
<span><span class="co">#&gt; rxode2_llikChisqFun _llikChisq;</span></span>
<span><span class="co">#&gt; rxode2_llikChisqFun _llikChisqDdf;</span></span>
<span><span class="co">#&gt; rxode2_llikExpFun _llikExp;</span></span>
<span><span class="co">#&gt; rxode2_llikExpFun _llikExpDrate;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikF;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikFDdf1;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikFDdf2;</span></span>
<span><span class="co">#&gt; rxode2_llikGeomFun _llikGeom;</span></span>
<span><span class="co">#&gt; rxode2_llikGeomFun _llikGeomDp;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnif;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnifDalpha;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnifDbeta;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibull;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibullDshape;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibullDscale;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGamma;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGammaDshape;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGammaDrate;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchy;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchyDlocation;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchyDscale;</span></span>
<span><span class="co">#&gt; rxode2_compareFactorVal_fn _compareFactorVal;</span></span>
<span><span class="co">#&gt; #include "extraC.h"</span></span>
<span><span class="co">#&gt; double _prod(double *input, double *p, int type, int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return _prodPS(input, p, n, type);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _udf(const char *funName, double *input, int n, ...) {</span></span>
<span><span class="co">#&gt;   if (n == -42) Rf_error("%s", "this has a ui user function that cannot be called directly");</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return _evalUdf(funName, n, input);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _sum(double *input, double *pld, int m, int type, int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   double ret = _sumPS(input, n, pld, m, type);</span></span>
<span><span class="co">#&gt;   if (type == 2 &amp;&amp; m &lt; 0){</span></span>
<span><span class="co">#&gt;     for (int i = -m; i--;){</span></span>
<span><span class="co">#&gt;       pld[i] = 0.0;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return ret;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _sign(unsigned int n, ...) {</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double s = 1;</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;     s = sign(va_arg(valist, double))*s;</span></span>
<span><span class="co">#&gt;     if (s == 0){</span></span>
<span><span class="co">#&gt;       break;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return s;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _rxord(int _cSub, unsigned int n,  ...) {</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind* ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   if (!ind-&gt;inLhs) {</span></span>
<span><span class="co">#&gt;     return 1.0;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double ret = 1.0;</span></span>
<span><span class="co">#&gt;   double p = 0.0;</span></span>
<span><span class="co">#&gt;   double u = rxunif(ind, 0.0, 1.0);</span></span>
<span><span class="co">#&gt;   int found = 0;</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;     p += va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     if (!found) {</span></span>
<span><span class="co">#&gt;       if (u &lt; p) {</span></span>
<span><span class="co">#&gt;         ret = (double)(i+1);</span></span>
<span><span class="co">#&gt;         found = 1;</span></span>
<span><span class="co">#&gt;       }</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   if (!found) ret =(double)(n+1);</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return ret;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _max(unsigned int n, ...) {</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double mx = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tmp = 0;</span></span>
<span><span class="co">#&gt;   if (n &gt;= 1){</span></span>
<span><span class="co">#&gt;     mx = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     for (unsigned int i = 1; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;       tmp = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;       if (tmp&gt;mx) mx=tmp;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     va_end(valist);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return mx;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _min(unsigned int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double mn = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tmp = 0;</span></span>
<span><span class="co">#&gt;   if (n &gt;= 1){</span></span>
<span><span class="co">#&gt;     mn = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     for (unsigned int i = 1; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;       tmp = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;       if (tmp&lt;mn) mn=tmp;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     va_end(valist);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return mn;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _transit4P(int cmt, double t, unsigned int id, double n, double mtt, double bio){</span></span>
<span><span class="co">#&gt;   double nd = (double) n;</span></span>
<span><span class="co">#&gt;   double ktr = (nd+1)/mtt;</span></span>
<span><span class="co">#&gt;   double lktr = _safe_log(nd+1)-_safe_log(mtt);</span></span>
<span><span class="co">#&gt;   double tlast = _solveData-&gt;subjects[id].tlastS[cmt];</span></span>
<span><span class="co">#&gt;   double dose = _solveData-&gt;subjects[id].curDoseS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(dose)) dose = 0.0;</span></span>
<span><span class="co">#&gt;   if (ISNA(tlast)) tlast = 0.0;</span></span>
<span><span class="co">#&gt;   double tad = (t-tlast);</span></span>
<span><span class="co">#&gt;   return exp(_safe_log(bio*dose)+lktr+n*(lktr+_safe_log(tad))-ktr*(tad)-lgamma1p(nd));</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _transit3P(int cmt, double t, unsigned int id, double n, double mtt){</span></span>
<span><span class="co">#&gt;   double nd = (double) n;</span></span>
<span><span class="co">#&gt;   double ktr = (nd+1)/mtt;</span></span>
<span><span class="co">#&gt;   double lktr = _safe_log(nd+1)-_safe_log(mtt);</span></span>
<span><span class="co">#&gt;   double tlast = _solveData-&gt;subjects[id].tlastS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(tlast)) tlast = 0.0;</span></span>
<span><span class="co">#&gt;   double tad = t-tlast;</span></span>
<span><span class="co">#&gt;   double podo = _solveData-&gt;subjects[id].curDoseS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(podo)) podo = 0.0;</span></span>
<span><span class="co">#&gt;   return exp(_safe_log(podo)+lktr+n*(lktr+_safe_log(tad))-ktr*(tad)-lgamma1p(nd));</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void _assignFuns0(void) {</span></span>
<span><span class="co">#&gt;   _evalUdf = (_udf_type) R_GetCCallable("rxode2", "_rxode2_evalUdf");</span></span>
<span><span class="co">#&gt;   _getRxSolve_ = (_getRxSolve_t) R_GetCCallable("rxode2","getRxSolve_");</span></span>
<span><span class="co">#&gt;   _assign_ptr=(rxode2_assign_ptr) R_GetCCallable("rxode2","rxode2_assign_fn_pointers");</span></span>
<span><span class="co">#&gt;   _rxRmModelLib=(_rxRmModelLibType) R_GetCCallable("rxode2","rxRmModelLib");</span></span>
<span><span class="co">#&gt;   _rxGetModelLib=(_rxGetModelLibType) R_GetCCallable("rxode2","rxGetModelLib");</span></span>
<span><span class="co">#&gt;   _rxode2_rxAssignPtr=(_rx_asgn)R_GetCCallable("rxode2","_rxode2_rxAssignPtr");</span></span>
<span><span class="co">#&gt;   _rxQr=(_rx_asgn)R_GetCCallable("rxode2","_rxode2_rxQr");</span></span>
<span><span class="co">#&gt;   _rxIsCurrentC = (_rxIsCurrentC_type)R_GetCCallable("rxode2","rxIsCurrentC");</span></span>
<span><span class="co">#&gt;   _sumPS  = (_rxSumType) R_GetCCallable("PreciseSums","PreciseSums_sum_r");</span></span>
<span><span class="co">#&gt;   _prodPS = (_rxProdType) R_GetCCallable("PreciseSums","PreciseSums_prod_r");</span></span>
<span><span class="co">#&gt;   _prodType=(rxode2_fn0i)R_GetCCallable("PreciseSums", "PreciseSums_prod_get");</span></span>
<span><span class="co">#&gt;   _sumType=(rxode2_fn0i)R_GetCCallable("PreciseSums", "PreciseSums_sum_get");</span></span>
<span><span class="co">#&gt;   _ptrid=(rxode2_fn0i)R_GetCCallable("rxode2", "rxode2_current_fn_pointer_id");</span></span>
<span><span class="co">#&gt;   _compareFactorVal=(rxode2_compareFactorVal_fn) R_GetCCallable("rxode2", "compareFactorVal");</span></span>
<span><span class="co">#&gt;   _update_par_ptr = (_update_par_ptr_p) R_GetCCallable("rxode2","_update_par_ptr");</span></span>
<span><span class="co">#&gt;   _getParCov = (_getParCov_p) R_GetCCallable("rxode2","_getParCov");</span></span>
<span><span class="co">#&gt;   // dynamic start</span></span>
<span><span class="co">#&gt;   _llikCauchyDscale = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchyDscale");</span></span>
<span><span class="co">#&gt;   _llikCauchyDlocation = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchyDlocation");</span></span>
<span><span class="co">#&gt;   _llikCauchy = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchy");</span></span>
<span><span class="co">#&gt;   _llikGammaDrate = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGammaDrate");</span></span>
<span><span class="co">#&gt;   _llikGammaDshape = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGammaDshape");</span></span>
<span><span class="co">#&gt;   _llikGamma = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGamma");</span></span>
<span><span class="co">#&gt;   _llikWeibullDscale = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibullDscale");</span></span>
<span><span class="co">#&gt;   _llikWeibullDshape = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibullDshape");</span></span>
<span><span class="co">#&gt;   _llikWeibull = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibull");</span></span>
<span><span class="co">#&gt;   _llikUnifDbeta = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnifDbeta");</span></span>
<span><span class="co">#&gt;   _llikUnifDalpha = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnifDalpha");</span></span>
<span><span class="co">#&gt;   _llikUnif = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnif");</span></span>
<span><span class="co">#&gt;   _llikGeomDp = (rxode2_llikGeomFun) R_GetCCallable("rxode2ll", "rxLlikGeomDp");</span></span>
<span><span class="co">#&gt;   _llikGeom = (rxode2_llikGeomFun) R_GetCCallable("rxode2ll", "rxLlikGeom");</span></span>
<span><span class="co">#&gt;   _llikFDdf2 = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikFDdf2");</span></span>
<span><span class="co">#&gt;   _llikFDdf1 = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikFDdf1");</span></span>
<span><span class="co">#&gt;   _llikF = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikF");</span></span>
<span><span class="co">#&gt;   _llikExpDrate = (rxode2_llikExpFun) R_GetCCallable("rxode2ll", "rxLlikExpDrate");</span></span>
<span><span class="co">#&gt;   _llikExp = (rxode2_llikExpFun) R_GetCCallable("rxode2ll", "rxLlikExp");</span></span>
<span><span class="co">#&gt;   _llikChisqDdf = (rxode2_llikChisqFun) R_GetCCallable("rxode2ll", "rxLlikChisqDdf");</span></span>
<span><span class="co">#&gt;   _llikChisq = (rxode2_llikChisqFun) R_GetCCallable("rxode2ll", "rxLlikChisq");</span></span>
<span><span class="co">#&gt;   _llikTDsd = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDsd");</span></span>
<span><span class="co">#&gt;   _llikTDmean = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDmean");</span></span>
<span><span class="co">#&gt;   _llikTDdf = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDdf");</span></span>
<span><span class="co">#&gt;   _llikT = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikT");</span></span>
<span><span class="co">#&gt;   _llikBetaDshape2 = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBetaDshape2");</span></span>
<span><span class="co">#&gt;   _llikBetaDshape1 = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBetaDshape1");</span></span>
<span><span class="co">#&gt;   _llikBeta = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBeta");</span></span>
<span><span class="co">#&gt;   _llikNbinomMuDmu = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomMuDmu");</span></span>
<span><span class="co">#&gt;   _llikNbinomMu = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomMu");</span></span>
<span><span class="co">#&gt;   _llikNbinomDprob = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomDprob");</span></span>
<span><span class="co">#&gt;   _llikNbinom = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinom");</span></span>
<span><span class="co">#&gt;   _llikBinomDprob = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikBinomDprob");</span></span>
<span><span class="co">#&gt;   _llikBinom = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikBinom");</span></span>
<span><span class="co">#&gt;   _llikPoisDlambda = (rxode2_llikPoisFun) R_GetCCallable("rxode2ll", "rxLlikPoisDlambda");</span></span>
<span><span class="co">#&gt;   _llikPois = (rxode2_llikPoisFun) R_GetCCallable("rxode2ll", "rxLlikPois");</span></span>
<span><span class="co">#&gt;   _llikNormDsd = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNormDsd");</span></span>
<span><span class="co">#&gt;   _llikNormDmean = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNormDmean");</span></span>
<span><span class="co">#&gt;   _llikNorm = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNorm");</span></span>
<span><span class="co">#&gt;   simeps = (_simfun) R_GetCCallable("rxode2", "simeps");</span></span>
<span><span class="co">#&gt;   simeta = (_simfun) R_GetCCallable("rxode2", "simeta");</span></span>
<span><span class="co">#&gt;   expit = (rxode2_fn3) R_GetCCallable("rxode2", "expit");</span></span>
<span><span class="co">#&gt;   logit = (rxode2_fn3) R_GetCCallable("rxode2", "logit");</span></span>
<span><span class="co">#&gt;   gammapDer = (rxode2_fn2) R_GetCCallable("rxode2", "gammapDer");</span></span>
<span><span class="co">#&gt;   lowergamma = (rxode2_fn2) R_GetCCallable("rxode2", "lowergamma");</span></span>
<span><span class="co">#&gt;   uppergamma = (rxode2_fn2) R_GetCCallable("rxode2", "uppergamma");</span></span>
<span><span class="co">#&gt;   gammaqInva = (rxode2_fn2) R_GetCCallable("rxode2", "gammaqInva");</span></span>
<span><span class="co">#&gt;   gammaqInv = (rxode2_fn2) R_GetCCallable("rxode2", "gammaqInv");</span></span>
<span><span class="co">#&gt;   gammapInva = (rxode2_fn2) R_GetCCallable("rxode2", "gammapInva");</span></span>
<span><span class="co">#&gt;   gammapInv = (rxode2_fn2) R_GetCCallable("rxode2", "gammapInv");</span></span>
<span><span class="co">#&gt;   gammaq = (rxode2_fn2) R_GetCCallable("rxode2", "gammaq");</span></span>
<span><span class="co">#&gt;   gammap = (rxode2_fn2) R_GetCCallable("rxode2", "gammap");</span></span>
<span><span class="co">#&gt;   phi = (rxode2_fn) R_GetCCallable("rxode2", "phi");</span></span>
<span><span class="co">#&gt;   d2ELUa = (rxode2_fn2) R_GetCCallable("rxode2", "d2ELUa");</span></span>
<span><span class="co">#&gt;   dELUa = (rxode2_fn2) R_GetCCallable("rxode2", "dELUa");</span></span>
<span><span class="co">#&gt;   d2aELU = (rxode2_fn2) R_GetCCallable("rxode2", "d2aELU");</span></span>
<span><span class="co">#&gt;   d2ELU = (rxode2_fn2) R_GetCCallable("rxode2", "d2ELU");</span></span>
<span><span class="co">#&gt;   dELU = (rxode2_fn2) R_GetCCallable("rxode2", "dELU");</span></span>
<span><span class="co">#&gt;   ELU = (rxode2_fn2) R_GetCCallable("rxode2", "ELU");</span></span>
<span><span class="co">#&gt;   dPReLUa1 = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLUa1");</span></span>
<span><span class="co">#&gt;   dPReLUa = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLUa");</span></span>
<span><span class="co">#&gt;   dPReLU = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLU");</span></span>
<span><span class="co">#&gt;   PReLU = (rxode2_fn2) R_GetCCallable("rxode2", "PReLU");</span></span>
<span><span class="co">#&gt;   dSwish = (rxode2_fn) R_GetCCallable("rxode2", "dSwish");</span></span>
<span><span class="co">#&gt;   Swish = (rxode2_fn) R_GetCCallable("rxode2", "Swish");</span></span>
<span><span class="co">#&gt;   dlReLU = (rxode2_fn) R_GetCCallable("rxode2", "dlReLU");</span></span>
<span><span class="co">#&gt;   lReLU = (rxode2_fn) R_GetCCallable("rxode2", "lReLU");</span></span>
<span><span class="co">#&gt;   dSELU = (rxode2_fn) R_GetCCallable("rxode2", "dSELU");</span></span>
<span><span class="co">#&gt;   SELU = (rxode2_fn) R_GetCCallable("rxode2", "SELU");</span></span>
<span><span class="co">#&gt;   d4softplus = (rxode2_fn) R_GetCCallable("rxode2", "d4softplus");</span></span>
<span><span class="co">#&gt;   d3softplus = (rxode2_fn) R_GetCCallable("rxode2", "d3softplus");</span></span>
<span><span class="co">#&gt;   d2softplus = (rxode2_fn) R_GetCCallable("rxode2", "d2softplus");</span></span>
<span><span class="co">#&gt;   dsoftplus = (rxode2_fn) R_GetCCallable("rxode2", "dsoftplus");</span></span>
<span><span class="co">#&gt;   softplus = (rxode2_fn) R_GetCCallable("rxode2", "softplus");</span></span>
<span><span class="co">#&gt;   d4GELU = (rxode2_fn) R_GetCCallable("rxode2", "d4GELU");</span></span>
<span><span class="co">#&gt;   d3GELU = (rxode2_fn) R_GetCCallable("rxode2", "d3GELU");</span></span>
<span><span class="co">#&gt;   d2GELU = (rxode2_fn) R_GetCCallable("rxode2", "d2GELU");</span></span>
<span><span class="co">#&gt;   dGELU = (rxode2_fn) R_GetCCallable("rxode2", "dGELU");</span></span>
<span><span class="co">#&gt;   GELU = (rxode2_fn) R_GetCCallable("rxode2", "GELU");</span></span>
<span><span class="co">#&gt;   dReLU = (rxode2_fn) R_GetCCallable("rxode2", "dReLU");</span></span>
<span><span class="co">#&gt;   ReLU = (rxode2_fn) R_GetCCallable("rxode2", "ReLU");</span></span>
<span><span class="co">#&gt;   riweibull = (rxode2i2_fn2) R_GetCCallable("rxode2", "riweibull");</span></span>
<span><span class="co">#&gt;   riunif = (rxode2i2_fn2) R_GetCCallable("rxode2", "riunif");</span></span>
<span><span class="co">#&gt;   rit_ = (rxode2i2_fn) R_GetCCallable("rxode2", "rit_");</span></span>
<span><span class="co">#&gt;   ripois = (rxode2i2_ifn) R_GetCCallable("rxode2", "ripois");</span></span>
<span><span class="co">#&gt;   ribeta = (rxode2i2_fn2) R_GetCCallable("rxode2", "ribeta");</span></span>
<span><span class="co">#&gt;   rigamma = (rxode2i2_fn2) R_GetCCallable("rxode2", "rigamma");</span></span>
<span><span class="co">#&gt;   rigeom = (rxode2i2_ifn) R_GetCCallable("rxode2", "rigeom");</span></span>
<span><span class="co">#&gt;   rif = (rxode2i2_fn2) R_GetCCallable("rxode2", "rif");</span></span>
<span><span class="co">#&gt;   riexp = (rxode2i2_fn) R_GetCCallable("rxode2", "riexp");</span></span>
<span><span class="co">#&gt;   richisq = (rxode2i2_fn) R_GetCCallable("rxode2", "richisq");</span></span>
<span><span class="co">#&gt;   ricauchy = (rxode2i2_fn2) R_GetCCallable("rxode2", "ricauchy");</span></span>
<span><span class="co">#&gt;   rinbinomMu = (rxode2i2_ribinom) R_GetCCallable("rxode2", "rinbinomMu");</span></span>
<span><span class="co">#&gt;   rinbinom = (rxode2i2_ribinom) R_GetCCallable("rxode2", "rinbinom");</span></span>
<span><span class="co">#&gt;   ribinom = (rxode2i2_ribinom) R_GetCCallable("rxode2", "ribinom");</span></span>
<span><span class="co">#&gt;   rinorm = (rxode2i2_fn2) R_GetCCallable("rxode2", "rinorm");</span></span>
<span><span class="co">#&gt;   rxweibull = (rxode2i_fn2) R_GetCCallable("rxode2", "rxweibull");</span></span>
<span><span class="co">#&gt;   rxunif = (rxode2i_fn2) R_GetCCallable("rxode2", "rxunif");</span></span>
<span><span class="co">#&gt;   rxt_ = (rxode2i_fn) R_GetCCallable("rxode2", "rxt_");</span></span>
<span><span class="co">#&gt;   rxpois = (rxode2i_ifn) R_GetCCallable("rxode2", "rxpois");</span></span>
<span><span class="co">#&gt;   rxbeta = (rxode2i_fn2) R_GetCCallable("rxode2", "rxbeta");</span></span>
<span><span class="co">#&gt;   rxgamma = (rxode2i_fn2) R_GetCCallable("rxode2", "rxgamma");</span></span>
<span><span class="co">#&gt;   rxgeom = (rxode2i_ifn) R_GetCCallable("rxode2", "rxgeom");</span></span>
<span><span class="co">#&gt;   rxf = (rxode2i_fn2) R_GetCCallable("rxode2", "rxf");</span></span>
<span><span class="co">#&gt;   rxexp = (rxode2i_fn) R_GetCCallable("rxode2", "rxexp");</span></span>
<span><span class="co">#&gt;   rxchisq = (rxode2i_fn) R_GetCCallable("rxode2", "rxchisq");</span></span>
<span><span class="co">#&gt;   rxcauchy = (rxode2i_fn2) R_GetCCallable("rxode2", "rxcauchy");</span></span>
<span><span class="co">#&gt;   rxnbinomMu = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxnbinomMu");</span></span>
<span><span class="co">#&gt;   rxnbinom = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxnbinom");</span></span>
<span><span class="co">#&gt;   rxbinom = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxbinom");</span></span>
<span><span class="co">#&gt;   rxnorm = (rxode2i_fn2) R_GetCCallable("rxode2", "rxnorm");</span></span>
<span><span class="co">#&gt;   linCmtB = (linCmtB_p) R_GetCCallable("rxode2", "linCmtB");</span></span>
<span><span class="co">#&gt;   linCmtA = (linCmtA_p) R_GetCCallable("rxode2", "linCmtA");</span></span>
<span><span class="co">#&gt;   // dynamic stop</span></span>
<span><span class="co">#&gt;   _solveData = _getRxSolve_();</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void _assignFuns(void) {</span></span>
<span><span class="co">#&gt;   if (_assign_ptr == NULL){</span></span>
<span><span class="co">#&gt;     _assignFuns0();</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void __assignFuns2(rx_solve rx,</span></span>
<span><span class="co">#&gt;                    rx_solving_options op,</span></span>
<span><span class="co">#&gt;                    t_F f,</span></span>
<span><span class="co">#&gt;                    t_LAG lag,</span></span>
<span><span class="co">#&gt;                    t_RATE rate,</span></span>
<span><span class="co">#&gt;                    t_DUR dur,</span></span>
<span><span class="co">#&gt;                    t_calc_mtime mtime,</span></span>
<span><span class="co">#&gt;                    t_ME me,</span></span>
<span><span class="co">#&gt;                    t_IndF indf,</span></span>
<span><span class="co">#&gt;                    t_getTime gettime,</span></span>
<span><span class="co">#&gt;                    t_locateTimeIndex timeindex,</span></span>
<span><span class="co">#&gt;                    t_handle_evidL handleEvid,</span></span>
<span><span class="co">#&gt;                    t_getDur getdur) {</span></span>
<span><span class="co">#&gt;   // assign start</span></span>
<span><span class="co">#&gt;     static rxode2_assignFuns2_t rxode2_assignFuns2 = NULL;</span></span>
<span><span class="co">#&gt;     if (rxode2_assignFuns2 == NULL) rxode2_assignFuns2 = (rxode2_assignFuns2_t)(R_GetCCallable("rxode2", "_rxode2_assignFuns2"));</span></span>
<span><span class="co">#&gt;     rxode2_assignFuns2(rx, op, f, lag, rate, dur, mtime, me, indf, gettime, timeindex, handleEvid, getdur);</span></span>
<span><span class="co">#&gt;   // assign stop</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void  rx_2715850a394bd98d2ab139c4ab6c00cb__ode_solver_solvedata (rx_solve *solve){</span></span>
<span><span class="co">#&gt;   _solveData = solve;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern rx_solve *rx_2715850a394bd98d2ab139c4ab6c00cb__ode_solver_get_solvedata(void){</span></span>
<span><span class="co">#&gt;   return _solveData;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; SEXP rx_2715850a394bd98d2ab139c4ab6c00cb__model_vars(void);</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; // prj-specific differential eqns</span></span>
<span><span class="co">#&gt; void rx_2715850a394bd98d2ab139c4ab6c00cb__dydt(int *_neq, double __t, double *__zzStateVar__, double *__DDtStateVar__)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   int _cSub = _neq[1];</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_neq[1]].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=1;</span></span>
<span><span class="co">#&gt;   double KA = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TCl = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Q = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kin = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kout = NA_REAL;</span></span>
<span><span class="co">#&gt;   double EC50 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_Cl = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double centr = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double peri = NA_REAL;</span></span>
<span><span class="co">#&gt;   double CL = NA_REAL;</span></span>
<span><span class="co">#&gt;   double depot = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eff = NA_REAL;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   (void)KA;</span></span>
<span><span class="co">#&gt;   (void)TCl;</span></span>
<span><span class="co">#&gt;   (void)V2;</span></span>
<span><span class="co">#&gt;   (void)Q;</span></span>
<span><span class="co">#&gt;   (void)V3;</span></span>
<span><span class="co">#&gt;   (void)Kin;</span></span>
<span><span class="co">#&gt;   (void)Kout;</span></span>
<span><span class="co">#&gt;   (void)EC50;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_Cl;</span></span>
<span><span class="co">#&gt;   (void)C2;</span></span>
<span><span class="co">#&gt;   (void)centr;</span></span>
<span><span class="co">#&gt;   (void)C3;</span></span>
<span><span class="co">#&gt;   (void)peri;</span></span>
<span><span class="co">#&gt;   (void)CL;</span></span>
<span><span class="co">#&gt;   (void)depot;</span></span>
<span><span class="co">#&gt;   (void)eff;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   C2 = _PL[0];</span></span>
<span><span class="co">#&gt;   C3 = _PL[1];</span></span>
<span><span class="co">#&gt;   CL = _PL[2];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _update_par_ptr(__t, _cSub, _solveData, _idx);</span></span>
<span><span class="co">#&gt;   KA = _PP[0];</span></span>
<span><span class="co">#&gt;   TCl = _PP[1];</span></span>
<span><span class="co">#&gt;   V2 = _PP[2];</span></span>
<span><span class="co">#&gt;   Q = _PP[3];</span></span>
<span><span class="co">#&gt;   V3 = _PP[4];</span></span>
<span><span class="co">#&gt;   Kin = _PP[5];</span></span>
<span><span class="co">#&gt;   Kout = _PP[6];</span></span>
<span><span class="co">#&gt;   EC50 = _PP[7];</span></span>
<span><span class="co">#&gt;   eta_DoT_Cl = _PP[8];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   depot = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">#&gt;   centr = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">#&gt;   peri = __zzStateVar__[__DDT2__]*((double)(_ON[__DDT2__]));</span></span>
<span><span class="co">#&gt;   eff = __zzStateVar__[__DDT3__]*((double)(_ON[__DDT3__]));</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   C2 =centr/_div0(V2);</span></span>
<span><span class="co">#&gt;   C3 =peri/_div0(V3);</span></span>
<span><span class="co">#&gt;   CL =TCl*exp(eta_DoT_Cl);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT0__] = ((double)(_ON[__DDT0__]))*(_IR[__DDT0__] -KA*depot);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT1__] = ((double)(_ON[__DDT1__]))*(_IR[__DDT1__] + KA*depot-CL*C2-Q*C2+Q*C3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT2__] = ((double)(_ON[__DDT2__]))*(_IR[__DDT2__] + Q*C2-Q*C3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT3__] = ((double)(_ON[__DDT3__]))*(_IR[__DDT3__] + Kin-Kout*(1-C2/_div0((EC50+C2)))*eff);</span></span>
<span><span class="co">#&gt;   (&amp;_solveData-&gt;subjects[_cSub])-&gt;dadt_counter[0]++;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; // Jacobian derived vars</span></span>
<span><span class="co">#&gt; void rx_2715850a394bd98d2ab139c4ab6c00cb__calc_jac(int *_neq, double __t, double *__zzStateVar__, double *__PDStateVar__, unsigned int __NROWPD__) {</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;     int _cSub=_neq[1];</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_neq[1]].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=2;</span></span>
<span><span class="co">#&gt;   (&amp;_solveData-&gt;subjects[_cSub])-&gt;jac_counter[0]++;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Functional based initial conditions.</span></span>
<span><span class="co">#&gt; void rx_2715850a394bd98d2ab139c4ab6c00cb__inis(int _cSub, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;  _ind-&gt;_rxFlag=3;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // prj-specific derived vars</span></span>
<span><span class="co">#&gt; void rx_2715850a394bd98d2ab139c4ab6c00cb__calc_lhs(int _cSub, double __t, double *__zzStateVar__, double *_lhs) {</span></span>
<span><span class="co">#&gt;     int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=11;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_0__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_1__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_2__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_3__;</span></span>
<span><span class="co">#&gt;   double KA = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TCl = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Q = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kin = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kout = NA_REAL;</span></span>
<span><span class="co">#&gt;   double EC50 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_Cl = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double centr = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double peri = NA_REAL;</span></span>
<span><span class="co">#&gt;   double CL = NA_REAL;</span></span>
<span><span class="co">#&gt;   double depot = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eff = NA_REAL;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_0__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_1__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_2__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_3__;</span></span>
<span><span class="co">#&gt;   (void)KA;</span></span>
<span><span class="co">#&gt;   (void)TCl;</span></span>
<span><span class="co">#&gt;   (void)V2;</span></span>
<span><span class="co">#&gt;   (void)Q;</span></span>
<span><span class="co">#&gt;   (void)V3;</span></span>
<span><span class="co">#&gt;   (void)Kin;</span></span>
<span><span class="co">#&gt;   (void)Kout;</span></span>
<span><span class="co">#&gt;   (void)EC50;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_Cl;</span></span>
<span><span class="co">#&gt;   (void)C2;</span></span>
<span><span class="co">#&gt;   (void)centr;</span></span>
<span><span class="co">#&gt;   (void)C3;</span></span>
<span><span class="co">#&gt;   (void)peri;</span></span>
<span><span class="co">#&gt;   (void)CL;</span></span>
<span><span class="co">#&gt;   (void)depot;</span></span>
<span><span class="co">#&gt;   (void)eff;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   C2 = _PL[0];</span></span>
<span><span class="co">#&gt;   C3 = _PL[1];</span></span>
<span><span class="co">#&gt;   CL = _PL[2];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _update_par_ptr(__t, _cSub, _solveData, _idx);</span></span>
<span><span class="co">#&gt;   KA = _PP[0];</span></span>
<span><span class="co">#&gt;   TCl = _PP[1];</span></span>
<span><span class="co">#&gt;   V2 = _PP[2];</span></span>
<span><span class="co">#&gt;   Q = _PP[3];</span></span>
<span><span class="co">#&gt;   V3 = _PP[4];</span></span>
<span><span class="co">#&gt;   Kin = _PP[5];</span></span>
<span><span class="co">#&gt;   Kout = _PP[6];</span></span>
<span><span class="co">#&gt;   EC50 = _PP[7];</span></span>
<span><span class="co">#&gt;   eta_DoT_Cl = _PP[8];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   depot = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">#&gt;   centr = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">#&gt;   peri = __zzStateVar__[__DDT2__]*((double)(_ON[__DDT2__]));</span></span>
<span><span class="co">#&gt;   eff = __zzStateVar__[__DDT3__]*((double)(_ON[__DDT3__]));</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   C2 =centr/_div0(V2);</span></span>
<span><span class="co">#&gt;   C3 =peri/_div0(V3);</span></span>
<span><span class="co">#&gt;   CL =TCl*exp(eta_DoT_Cl);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_0__ = ((double)(_ON[__DDT0__]))*(_IR[__DDT0__] -KA*depot);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_1__ = ((double)(_ON[__DDT1__]))*(_IR[__DDT1__] + KA*depot-CL*C2-Q*C2+Q*C3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_2__ = ((double)(_ON[__DDT2__]))*(_IR[__DDT2__] + Q*C2-Q*C3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_3__ = ((double)(_ON[__DDT3__]))*(_IR[__DDT3__] + Kin-Kout*(1-C2/_div0((EC50+C2)))*eff);</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _lhs[_LHS_0_]=C2;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_1_]=C3;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_2_]=CL;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Functional based bioavailability</span></span>
<span><span class="co">#&gt; double rx_2715850a394bd98d2ab139c4ab6c00cb__F(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return _amt;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; // Functional based absorption lag</span></span>
<span><span class="co">#&gt; double rx_2715850a394bd98d2ab139c4ab6c00cb__Lag(int _cSub,  int _cmt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return __t;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Modeled zero-order rate</span></span>
<span><span class="co">#&gt; double rx_2715850a394bd98d2ab139c4ab6c00cb__Rate(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return 0.0;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Modeled zero-order duration</span></span>
<span><span class="co">#&gt; double rx_2715850a394bd98d2ab139c4ab6c00cb__Dur(int _cSub,  int _cmt, double _amt, double __t){</span></span>
<span><span class="co">#&gt;  return 0.0;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Model Times</span></span>
<span><span class="co">#&gt; void rx_2715850a394bd98d2ab139c4ab6c00cb__mtime(int _cSub, double *_mtime){</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Matrix Exponential (0)</span></span>
<span><span class="co">#&gt; void rx_2715850a394bd98d2ab139c4ab6c00cb__ME(int _cSub, double _t, double __t, double *_mat, const double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=9;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Inductive linearization Matf</span></span>
<span><span class="co">#&gt; void rx_2715850a394bd98d2ab139c4ab6c00cb__IndF(int _cSub, double _t, double __t, double *_matf){</span></span>
<span><span class="co">#&gt;  int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=10;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern SEXP rx_2715850a394bd98d2ab139c4ab6c00cb__model_vars(void){</span></span>
<span><span class="co">#&gt;   int pro=0;</span></span>
<span><span class="co">#&gt;   SEXP _mv = PROTECT(_rxGetModelLib("rx_2715850a394bd98d2ab139c4ab6c00cb__model_vars"));pro++;</span></span>
<span><span class="co">#&gt;   if (!_rxIsCurrentC(_mv)){</span></span>
<span><span class="co">#&gt;     SEXP hash    = PROTECT(Rf_allocVector(STRSXP, 1));pro++;</span></span>
<span><span class="co">#&gt; #define __doBuf__  snprintf(buf, __doBufN__, "un]\"BAAA@QRtHACAAAAAAA5F&amp;AAAv7#aT)OyVhQA!qvgj\"{$6t1k\?pIaH+)E90~uop=2KB@6pR20p%%ozgO`&lt;~M$2Qm$vsczEXwNY3`_SP(m*Kk6)kTA&amp;Ru9_ggAPSB1Dbf6ywWuv3t3!{&lt;X46~*Xq_s9XLN+r=h*c,,C;Ge=0`b@0:{r*$~w=Dw&gt;6Pk{Q|s!b3ZM$=_BEh9#5aRE{4!bbw{#b]o|kHt!,&amp;Opm|t5&gt;R~D%%3&amp;=eid%%D;Y8[R1SleIb`Q[yPw_6cEQpiha.&amp;nQ&gt;Ecnmb\?Idh/M322x+|+l=~w;s%%8TdV:}CYkC$5ZjVlqbXUSs3\"yG)S*&lt;C#X:+:+e28c7+EM!WkZnRC$&gt;dMgF@VC%%Q_vlB{Q7g*8\?=*\"i9KjnQ{Z7]GU\"(s)~(J3e9\?==!b63i24D3hVJzOfC#a.wP[2JT(8Ur)#ywa&lt;&amp;B76iDVE$3KT7N_QtVVm*N_Q6c$4AgUOjVmqMM`4(bccG)f{U#5:WOe5WJ+1d5*XdL\?\"uK2JZ7,z{BTYT:v9]ZF=*o.wiI!!L#\"H7[0[::&lt;OxvqUEGl6RHv3P~&amp;XC_&lt;N}WO(l~Z,fTHqRM%%lh6@M`0WX3Rj9E9bH\";UF|dV48^i4\"^K;DW1y=,KVO/{*S~3ibg/s\?&lt;Te1|q,8h%%~tHA${zH)c}c*jQR`fGgLGa^xAGQGnYDOVE[qMCapTx2i2k7x5Xt&lt;X%%LOHQ963eQd=\?*P_+aj@rB5]eN5Rx\?H1sq|rF##EEa=u4bQb4&amp;^_bucqU)Vxj7d$:xBpXUUS9Z~g^ze3+T}z1&lt;Jxe2lmGksB0Iq{N,y&lt;pA8yZ\"5\"l=2o&amp;|qdKP;YC;c5yofh3\".VRf;ywis)7al7U(ibw;*o&amp;G~ZnPaF&amp;\"opE+98VaeJ}+`X$2HBw]l[n^a2NqbWM\"r3m*:X#{`j!adPeJwXD1qxnyK6G;vec;CC\"lJ[Tgu/Y&amp;&lt;AIHfbW}J@v`q8EObGJAS=1=ZdH%%ZIBTt.ImH#CJAsHU@`J5L)ASt=h9FRD,nvZ,dft3W{hUEDx5FQvV+.1!}A7zL*9lE\"*@_.|x\"D*;aJ%%*CFI23&gt;=di8L!}}AEr[\?*U:*G&lt;OGL5VAOWlEWr%%im/Q(boM%%H}jft@uVosU(,v}Gk25wDU%%in#)S&gt;O9PZQbtey$/LK`PbL=([II@jd5eJZA,=%%&gt;o+=GaeiqyPFW;_XI2Ij,N&lt;i[8{j4GEc*E\?_H,zI&gt;]wv&lt;`(5YK$7Kb#8pHir`Wm\?*T&lt;/wF^5*n39S=gjJQ_p:;&lt;Wb4E@&gt;u2:0fH[O1&gt;EL}z5ZLA!AM.moY*LY&lt;N+Oz&gt;P2:|}&lt;NrByR:t(1NMU(Hz)gg5O#By+6D3SdMD`V]_tH!y+xA");</span></span>
<span><span class="co">#&gt;     char buf[1348];</span></span>
<span><span class="co">#&gt; #define __doBufN__ 1348</span></span>
<span><span class="co">#&gt;     __doBuf__</span></span>
<span><span class="co">#&gt; #undef __doBuf__</span></span>
<span><span class="co">#&gt; #undef __doBufN__</span></span>
<span><span class="co">#&gt;     SET_STRING_ELT(hash, 0, Rf_mkChar(buf));</span></span>
<span><span class="co">#&gt;     SEXP lst      = PROTECT(_rxQr(hash));pro++;</span></span>
<span><span class="co">#&gt;     _assign_ptr(lst);</span></span>
<span><span class="co">#&gt;     UNPROTECT(pro);</span></span>
<span><span class="co">#&gt;     return lst;</span></span>
<span><span class="co">#&gt;   } else {</span></span>
<span><span class="co">#&gt;     UNPROTECT(pro);</span></span>
<span><span class="co">#&gt;     return _mv;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void rx_2715850a394bd98d2ab139c4ab6c00cb__dydt_lsoda(int *neq, double *t, double *A, double *DADT)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   rx_2715850a394bd98d2ab139c4ab6c00cb__dydt(neq, *t, A, DADT);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern int rx_2715850a394bd98d2ab139c4ab6c00cb__dydt_liblsoda(double __t, double *y, double *ydot, void *data)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   int *neq = (int*)(data);</span></span>
<span><span class="co">#&gt;   rx_2715850a394bd98d2ab139c4ab6c00cb__dydt(neq, __t, y, ydot);</span></span>
<span><span class="co">#&gt;   return(0);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void rx_2715850a394bd98d2ab139c4ab6c00cb__calc_jac_lsoda(int *neq, double *t, double *A,int *ml, int *mu, double *JAC, int *nrowpd){</span></span>
<span><span class="co">#&gt;   // Update all covariate parameters</span></span>
<span><span class="co">#&gt;   rx_2715850a394bd98d2ab139c4ab6c00cb__calc_jac(neq, *t, A, JAC, *nrowpd);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; //Create function to call from R's main thread that assigns the required functions. Sometimes they don't get assigned.</span></span>
<span><span class="co">#&gt; extern void rx_2715850a394bd98d2ab139c4ab6c00cb__assignFuns(void){</span></span>
<span><span class="co">#&gt;   _assignFuns();</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; //Initialize the dll to match rxode2's calls</span></span>
<span><span class="co">#&gt; void R_init0_rx_2715850a394bd98d2ab139c4ab6c00cb_(void){</span></span>
<span><span class="co">#&gt;   // Get C callables on load; Otherwise it isn't thread safe</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_2715850a394bd98d2ab139c4ab6c00cb_","rx_2715850a394bd98d2ab139c4ab6c00cb__assignFuns2", (DL_FUNC) __assignFuns2);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_2715850a394bd98d2ab139c4ab6c00cb_","rx_2715850a394bd98d2ab139c4ab6c00cb__assignFuns", (DL_FUNC) rx_2715850a394bd98d2ab139c4ab6c00cb__assignFuns);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_2715850a394bd98d2ab139c4ab6c00cb_","rx_2715850a394bd98d2ab139c4ab6c00cb__inis",(DL_FUNC) rx_2715850a394bd98d2ab139c4ab6c00cb__inis);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_2715850a394bd98d2ab139c4ab6c00cb_","rx_2715850a394bd98d2ab139c4ab6c00cb__dydt",(DL_FUNC) rx_2715850a394bd98d2ab139c4ab6c00cb__dydt);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_2715850a394bd98d2ab139c4ab6c00cb_","rx_2715850a394bd98d2ab139c4ab6c00cb__calc_lhs",(DL_FUNC) rx_2715850a394bd98d2ab139c4ab6c00cb__calc_lhs);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_2715850a394bd98d2ab139c4ab6c00cb_","rx_2715850a394bd98d2ab139c4ab6c00cb__calc_jac",(DL_FUNC) rx_2715850a394bd98d2ab139c4ab6c00cb__calc_jac);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_2715850a394bd98d2ab139c4ab6c00cb_","rx_2715850a394bd98d2ab139c4ab6c00cb__dydt_lsoda", (DL_FUNC) rx_2715850a394bd98d2ab139c4ab6c00cb__dydt_lsoda);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_2715850a394bd98d2ab139c4ab6c00cb_","rx_2715850a394bd98d2ab139c4ab6c00cb__calc_jac_lsoda", (DL_FUNC) rx_2715850a394bd98d2ab139c4ab6c00cb__calc_jac_lsoda);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_2715850a394bd98d2ab139c4ab6c00cb_","rx_2715850a394bd98d2ab139c4ab6c00cb__ode_solver_solvedata", (DL_FUNC) rx_2715850a394bd98d2ab139c4ab6c00cb__ode_solver_solvedata);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_2715850a394bd98d2ab139c4ab6c00cb_","rx_2715850a394bd98d2ab139c4ab6c00cb__ode_solver_get_solvedata", (DL_FUNC) rx_2715850a394bd98d2ab139c4ab6c00cb__ode_solver_get_solvedata);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_2715850a394bd98d2ab139c4ab6c00cb_","rx_2715850a394bd98d2ab139c4ab6c00cb__F", (DL_FUNC) rx_2715850a394bd98d2ab139c4ab6c00cb__F);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_2715850a394bd98d2ab139c4ab6c00cb_","rx_2715850a394bd98d2ab139c4ab6c00cb__Lag", (DL_FUNC) rx_2715850a394bd98d2ab139c4ab6c00cb__Lag);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_2715850a394bd98d2ab139c4ab6c00cb_","rx_2715850a394bd98d2ab139c4ab6c00cb__Rate", (DL_FUNC) rx_2715850a394bd98d2ab139c4ab6c00cb__Rate);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_2715850a394bd98d2ab139c4ab6c00cb_","rx_2715850a394bd98d2ab139c4ab6c00cb__Dur", (DL_FUNC) rx_2715850a394bd98d2ab139c4ab6c00cb__Dur);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_2715850a394bd98d2ab139c4ab6c00cb_","rx_2715850a394bd98d2ab139c4ab6c00cb__mtime", (DL_FUNC) rx_2715850a394bd98d2ab139c4ab6c00cb__mtime);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_2715850a394bd98d2ab139c4ab6c00cb_","rx_2715850a394bd98d2ab139c4ab6c00cb__ME", (DL_FUNC) rx_2715850a394bd98d2ab139c4ab6c00cb__ME);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_2715850a394bd98d2ab139c4ab6c00cb_","rx_2715850a394bd98d2ab139c4ab6c00cb__IndF", (DL_FUNC) rx_2715850a394bd98d2ab139c4ab6c00cb__IndF);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_2715850a394bd98d2ab139c4ab6c00cb_","rx_2715850a394bd98d2ab139c4ab6c00cb__dydt_liblsoda", (DL_FUNC) rx_2715850a394bd98d2ab139c4ab6c00cb__dydt_liblsoda);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; //Initialize the dll to match rxode2's calls</span></span>
<span><span class="co">#&gt; void R_init_rx_2715850a394bd98d2ab139c4ab6c00cb_(DllInfo *info){</span></span>
<span><span class="co">#&gt;   // Get C callables on load; Otherwise it isn't thread safe</span></span>
<span><span class="co">#&gt;   R_init0_rx_2715850a394bd98d2ab139c4ab6c00cb_();</span></span>
<span><span class="co">#&gt;   static const R_CallMethodDef callMethods[]  = {</span></span>
<span><span class="co">#&gt;     {"rx_2715850a394bd98d2ab139c4ab6c00cb__model_vars", (DL_FUNC) &amp;rx_2715850a394bd98d2ab139c4ab6c00cb__model_vars, 0},</span></span>
<span><span class="co">#&gt;     {NULL, NULL, 0}</span></span>
<span><span class="co">#&gt;   };</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   R_registerRoutines(info, NULL, callMethods, NULL, NULL);</span></span>
<span><span class="co">#&gt;   R_useDynamicSymbols(info,FALSE);</span></span>
<span><span class="co">#&gt;   _assignFuns0();</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; void R_unload_rx_2715850a394bd98d2ab139c4ab6c00cb_ (DllInfo *info){</span></span>
<span><span class="co">#&gt;   // Free resources required for single subject solve.</span></span>
<span><span class="co">#&gt;   SEXP _mv = PROTECT(_rxGetModelLib("rx_2715850a394bd98d2ab139c4ab6c00cb__model_vars"));</span></span>
<span><span class="co">#&gt;   if (!Rf_isNull(_mv)){</span></span>
<span><span class="co">#&gt;     _rxRmModelLib("rx_2715850a394bd98d2ab139c4ab6c00cb__model_vars");</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   UNPROTECT(1);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’</span></span></code></pre></div>
<p>To quickly look and customize your simulation you use the default
<code>plot</code> routine. Since this is an rxode2 object, it will
create a <code>ggplot2</code> object that you can modify as you wish.
The extra parameter to the <code>plot</code> tells
<code>rxode2</code>/<code>R</code> what piece of information you are
interested in plotting. In this case, we are interested in looking at
the derived parameter <code>C2</code>:</p>
</div>
<div class="section level4">
<h4 id="checking-the-simulation-with-plot">Checking the simulation with <code>plot</code><a class="anchor" aria-label="anchor" href="#checking-the-simulation-with-plot"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="co">## The plots from rxode2 are ggplots so they can be modified with</span></span>
<span><span class="co">## standard ggplot commands.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim</span>, <span class="va">C2</span>, log<span class="op">=</span><span class="st">"y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Central Compartment"</span><span class="op">)</span></span></code></pre></div>
<p><img src="rxode2-sim-var_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>Of course this additional parameter could also be a state value, like
<code>eff</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## They also takes many of the standard plot arguments; See ?plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim</span>, <span class="va">eff</span>, ylab<span class="op">=</span><span class="st">"Effect"</span><span class="op">)</span></span></code></pre></div>
<p><img src="rxode2-sim-var_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>Or you could even look at the two side-by-side:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim</span>, <span class="va">C2</span>, <span class="va">eff</span><span class="op">)</span></span></code></pre></div>
<p><img src="rxode2-sim-var_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>Or stack them with <code>patchwork</code></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim</span>, <span class="va">C2</span>, log<span class="op">=</span><span class="st">"y"</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sim</span>, <span class="va">eff</span><span class="op">)</span></span></code></pre></div>
<p><img src="rxode2-sim-var_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="processing-the-data-to-create-summary-plots">Processing the data to create summary plots<a class="anchor" aria-label="anchor" href="#processing-the-data-to-create-summary-plots"></a>
</h4>
<p>Usually in pharmacometric simulations it is not enough to simply
simulate the system. We have to do something easier to digest, like look
at the central and extreme tendencies of the simulation.</p>
<p>Since the <code>rxode2</code> solve object is a type of <a href="rxode2-data-frame.html">data frame</a></p>
<p>It is now straightforward to perform calculations and generate plots
with the simulated data. You can</p>
<p>Below, the 5th, 50th, and 95th percentiles of the simulated data are
plotted.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">sim</span>, <span class="st">"C2"</span>, level<span class="op">=</span><span class="fl">0.95</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>ylab<span class="op">=</span><span class="st">"Central Concentration"</span>, log<span class="op">=</span><span class="st">"y"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> in order to put confidence bands around the intervals, you need at least 2500 simulations</span></span>
<span><span class="co">#&gt; summarizing data...done</span></span></code></pre></div>
<p><img src="rxode2-sim-var_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">sim</span>, <span class="st">"eff"</span>, level<span class="op">=</span><span class="fl">0.95</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>ylab<span class="op">=</span><span class="st">"Effect"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> in order to put confidence bands around the intervals, you need at least 2500 simulations</span></span>
<span><span class="co">#&gt; summarizing data...done</span></span></code></pre></div>
<p><img src="rxode2-sim-var_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>Note that you can see the parameters that were simulated for the
example</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">param</span><span class="op">)</span></span>
<span><span class="co">#&gt;   sim.id    KA  TCl   V2    Q  V3 Kin Kout EC50     eta.Cl</span></span>
<span><span class="co">#&gt; 1      1 0.294 18.6 40.2 10.5 297   1    1  200  0.8067570</span></span>
<span><span class="co">#&gt; 2      2 0.294 18.6 40.2 10.5 297   1    1  200  0.0236961</span></span>
<span><span class="co">#&gt; 3      3 0.294 18.6 40.2 10.5 297   1    1  200 -0.3340697</span></span>
<span><span class="co">#&gt; 4      4 0.294 18.6 40.2 10.5 297   1    1  200 -0.1098197</span></span>
<span><span class="co">#&gt; 5      5 0.294 18.6 40.2 10.5 297   1    1  200 -0.2803752</span></span>
<span><span class="co">#&gt; 6      6 0.294 18.6 40.2 10.5 297   1    1  200 -0.2114090</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="simulation-of-unexplained-variability-sigma">Simulation of unexplained variability (sigma)<a class="anchor" aria-label="anchor" href="#simulation-of-unexplained-variability-sigma"></a>
</h4>
<p>In addition to conveniently simulating between subject variability,
you can also easily simulate unexplained variability.</p>
<p>One way to do that is to create a rxode2 model with the endpoints
defined. Model piping can do this while keeping the model intact:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="va">mod</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/model.html">model</a></span><span class="op">(</span><span class="va">eff</span> <span class="op">~</span> <span class="fu">add</span><span class="op">(</span><span class="va">eff.sd</span><span class="op">)</span>, append<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/model.html">model</a></span><span class="op">(</span><span class="va">C2</span> <span class="op">~</span> <span class="fu">prop</span><span class="op">(</span><span class="va">prop.sd</span><span class="op">)</span>, append<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/ini.html">ini</a></span><span class="op">(</span>eff.sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span>, prop.sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> parameter labels from comments are typically ignored in non-interactive mode</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Need to run with the source intact to parse comments</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> add residual parameter `eff.sd` and set estimate to 1</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> add residual parameter `prop.sd` and set estimate to 1</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `eff.sd` to `0.316227766016838`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> change initial estimate of `prop.sd` to `0.316227766016838`</span></span></code></pre></div>
<p>You can see how the dataset should be defined with
<code>$multipleEndpoint</code>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod2</span><span class="op">$</span><span class="va">multipleEndpoint</span></span>
<span><span class="co">#&gt;   variable                cmt                dvid*</span></span>
<span><span class="co">#&gt; 1  eff ~ … cmt='eff' or cmt=4 dvid='eff' or dvid=1</span></span>
<span><span class="co">#&gt; 2   C2 ~ …  cmt='C2' or cmt=5  dvid='C2' or dvid=2</span></span></code></pre></div>
<p>Here you see the endpoints should be defined for <code>eff</code> and
<code>C2</code>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ev</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>amountUnits<span class="op">=</span><span class="st">"mg"</span>, timeUnits<span class="op">=</span><span class="st">"hours"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>amt<span class="op">=</span><span class="fl">10000</span>, cmt<span class="op">=</span><span class="st">"centr"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">48</span>, length.out<span class="op">=</span><span class="fl">100</span><span class="op">)</span>, cmt<span class="op">=</span><span class="st">"eff"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">48</span>, length.out<span class="op">=</span><span class="fl">100</span><span class="op">)</span>, cmt<span class="op">=</span><span class="st">"C2"</span><span class="op">)</span></span></code></pre></div>
<p>Which allows you to solve the system:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rxSolve.html">rxSolve</a></span><span class="op">(</span><span class="va">mod2</span>, <span class="va">ev</span>, nSub<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="co">#&gt; C model:</span></span>
<span><span class="co">#&gt; // Define translation state order for 5 states</span></span>
<span><span class="co">#&gt; #define __DDT0__ 0 // depot</span></span>
<span><span class="co">#&gt; #define _DEPOT_ 0 // depot</span></span>
<span><span class="co">#&gt; #define __DDT1__ 1 // centr</span></span>
<span><span class="co">#&gt; #define __DDT2__ 2 // peri</span></span>
<span><span class="co">#&gt; #define __DDT3__ 3 // eff</span></span>
<span><span class="co">#&gt; #define __DDT4__ 4 // NA</span></span>
<span><span class="co">#&gt; // Define 5 LHS values</span></span>
<span><span class="co">#&gt; #define _LHS_0_ 0 // C2</span></span>
<span><span class="co">#&gt; #define _LHS_1_ 1 // C3</span></span>
<span><span class="co">#&gt; #define _LHS_2_ 2 // CL</span></span>
<span><span class="co">#&gt; #define _LHS_3_ 3 // ipredSim</span></span>
<span><span class="co">#&gt; #define _LHS_4_ 4 // sim</span></span>
<span><span class="co">#&gt; #define _getRxSolve_ _rxb33b901694f470e435a3fead7d18dcfb143__getRxSolve__Vaoj</span></span>
<span><span class="co">#&gt; #define _evalUdf _rxb33b901694f470e435a3fead7d18dcfb144__evalUdf_9xkq</span></span>
<span><span class="co">#&gt; #define _solveData _rxb33b901694f470e435a3fead7d18dcfb145__solveData_fOeJ</span></span>
<span><span class="co">#&gt; #define _assign_ptr _rxb33b901694f470e435a3fead7d18dcfb146__assign_ptr_blGk</span></span>
<span><span class="co">#&gt; #define _rxRmModelLib _rxb33b901694f470e435a3fead7d18dcfb147__rxRmModelLib_nQcu</span></span>
<span><span class="co">#&gt; #define _rxGetModelLib _rxb33b901694f470e435a3fead7d18dcfb148__rxGetModelLib_gtS8</span></span>
<span><span class="co">#&gt; #define _old_c _rxb33b901694f470e435a3fead7d18dcfb149__old_c_ZySW</span></span>
<span><span class="co">#&gt; #define _ptrid _rxb33b901694f470e435a3fead7d18dcfb150__ptrid_XbOp</span></span>
<span><span class="co">#&gt; #define _rxIsCurrentC _rxb33b901694f470e435a3fead7d18dcfb151__rxIsCurrentC_upRl</span></span>
<span><span class="co">#&gt; #define _sumPS _rxb33b901694f470e435a3fead7d18dcfb152__sumPS_W9nz</span></span>
<span><span class="co">#&gt; #define _prodPS _rxb33b901694f470e435a3fead7d18dcfb153__prodPS_Nl8X</span></span>
<span><span class="co">#&gt; #define _prodType _rxb33b901694f470e435a3fead7d18dcfb154__prodType_pDdx</span></span>
<span><span class="co">#&gt; #define _sumType _rxb33b901694f470e435a3fead7d18dcfb155__sumType_l3ox</span></span>
<span><span class="co">#&gt; #define _update_par_ptr _rxb33b901694f470e435a3fead7d18dcfb156__update_par_ptr_hL10</span></span>
<span><span class="co">#&gt; #define _getParCov _rxb33b901694f470e435a3fead7d18dcfb157__getParCov_prgx</span></span>
<span><span class="co">#&gt; #define _rxode2_rxAssignPtr _rxb33b901694f470e435a3fead7d18dcfb158__rxode2_rxAssignPtr_n8iB</span></span>
<span><span class="co">#&gt; #define _rxQr _rxb33b901694f470e435a3fead7d18dcfb159__rxQr_Czq6</span></span>
<span><span class="co">#&gt; #define _compareFactorVal _rxb33b901694f470e435a3fead7d18dcfb160__compareFactorVal_wPpF</span></span>
<span><span class="co">#&gt; #define _sum _rxb33b901694f470e435a3fead7d18dcfb161__sum_S16D</span></span>
<span><span class="co">#&gt; #define _udf _rxb33b901694f470e435a3fead7d18dcfb162__udf_k7NN</span></span>
<span><span class="co">#&gt; #define _sign _rxb33b901694f470e435a3fead7d18dcfb163__sign_WXX0</span></span>
<span><span class="co">#&gt; #define _prod _rxb33b901694f470e435a3fead7d18dcfb164__prod_AXSr</span></span>
<span><span class="co">#&gt; #define _max _rxb33b901694f470e435a3fead7d18dcfb165__max_Br3J</span></span>
<span><span class="co">#&gt; #define _min _rxb33b901694f470e435a3fead7d18dcfb166__min_7KG3</span></span>
<span><span class="co">#&gt; #define _transit4P _rxb33b901694f470e435a3fead7d18dcfb167__transit4P_GO65</span></span>
<span><span class="co">#&gt; #define _transit3P _rxb33b901694f470e435a3fead7d18dcfb168__transit3P_eqQ1</span></span>
<span><span class="co">#&gt; #define _assignFuns0 _rxb33b901694f470e435a3fead7d18dcfb169__assignFuns0_JnTj</span></span>
<span><span class="co">#&gt; #define _assignFuns _rxb33b901694f470e435a3fead7d18dcfb170__assignFuns_3jE8</span></span>
<span><span class="co">#&gt; #define _rxord _rxb33b901694f470e435a3fead7d18dcfb171__rxord_m9Qw</span></span>
<span><span class="co">#&gt; #define __assignFuns2 _rxb33b901694f470e435a3fead7d18dcfb172___assignFuns2_oDHN</span></span>
<span><span class="co">#&gt; #define _llikCauchyDscale _rxb33b901694f470e435a3fead7d18dcfb173__llikCauchyDscale_9v1a</span></span>
<span><span class="co">#&gt; #define _llikCauchyDlocation _rxb33b901694f470e435a3fead7d18dcfb174__llikCauchyDlocation_NCaN</span></span>
<span><span class="co">#&gt; #define _llikCauchy _rxb33b901694f470e435a3fead7d18dcfb175__llikCauchy_Y5AY</span></span>
<span><span class="co">#&gt; #define _llikGammaDrate _rxb33b901694f470e435a3fead7d18dcfb176__llikGammaDrate_DVeb</span></span>
<span><span class="co">#&gt; #define _llikGammaDshape _rxb33b901694f470e435a3fead7d18dcfb177__llikGammaDshape_eTU6</span></span>
<span><span class="co">#&gt; #define _llikGamma _rxb33b901694f470e435a3fead7d18dcfb178__llikGamma_83cw</span></span>
<span><span class="co">#&gt; #define _llikWeibullDscale _rxb33b901694f470e435a3fead7d18dcfb179__llikWeibullDscale_dxIU</span></span>
<span><span class="co">#&gt; #define _llikWeibullDshape _rxb33b901694f470e435a3fead7d18dcfb180__llikWeibullDshape_B7M8</span></span>
<span><span class="co">#&gt; #define _llikWeibull _rxb33b901694f470e435a3fead7d18dcfb181__llikWeibull_uE0z</span></span>
<span><span class="co">#&gt; #define _llikUnifDbeta _rxb33b901694f470e435a3fead7d18dcfb182__llikUnifDbeta_dHL1</span></span>
<span><span class="co">#&gt; #define _llikUnifDalpha _rxb33b901694f470e435a3fead7d18dcfb183__llikUnifDalpha_uh7y</span></span>
<span><span class="co">#&gt; #define _llikUnif _rxb33b901694f470e435a3fead7d18dcfb184__llikUnif_7i1b</span></span>
<span><span class="co">#&gt; #define _llikGeomDp _rxb33b901694f470e435a3fead7d18dcfb185__llikGeomDp_bYr8</span></span>
<span><span class="co">#&gt; #define _llikGeom _rxb33b901694f470e435a3fead7d18dcfb186__llikGeom_p4ZQ</span></span>
<span><span class="co">#&gt; #define _llikFDdf2 _rxb33b901694f470e435a3fead7d18dcfb187__llikFDdf2_nbD8</span></span>
<span><span class="co">#&gt; #define _llikFDdf1 _rxb33b901694f470e435a3fead7d18dcfb188__llikFDdf1_I1X2</span></span>
<span><span class="co">#&gt; #define _llikF _rxb33b901694f470e435a3fead7d18dcfb189__llikF_u8uJ</span></span>
<span><span class="co">#&gt; #define _llikExpDrate _rxb33b901694f470e435a3fead7d18dcfb190__llikExpDrate_iaaT</span></span>
<span><span class="co">#&gt; #define _llikExp _rxb33b901694f470e435a3fead7d18dcfb191__llikExp_DAI8</span></span>
<span><span class="co">#&gt; #define _llikChisqDdf _rxb33b901694f470e435a3fead7d18dcfb192__llikChisqDdf_F3U0</span></span>
<span><span class="co">#&gt; #define _llikChisq _rxb33b901694f470e435a3fead7d18dcfb193__llikChisq_HSfC</span></span>
<span><span class="co">#&gt; #define _llikTDsd _rxb33b901694f470e435a3fead7d18dcfb194__llikTDsd_Q5OV</span></span>
<span><span class="co">#&gt; #define _llikTDmean _rxb33b901694f470e435a3fead7d18dcfb195__llikTDmean_X4IS</span></span>
<span><span class="co">#&gt; #define _llikTDdf _rxb33b901694f470e435a3fead7d18dcfb196__llikTDdf_WheJ</span></span>
<span><span class="co">#&gt; #define _llikT _rxb33b901694f470e435a3fead7d18dcfb197__llikT_WWae</span></span>
<span><span class="co">#&gt; #define _llikBetaDshape2 _rxb33b901694f470e435a3fead7d18dcfb198__llikBetaDshape2_FZ8j</span></span>
<span><span class="co">#&gt; #define _llikBetaDshape1 _rxb33b901694f470e435a3fead7d18dcfb199__llikBetaDshape1_xI80</span></span>
<span><span class="co">#&gt; #define _llikBeta _rxb33b901694f470e435a3fead7d18dcfb200__llikBeta_U112</span></span>
<span><span class="co">#&gt; #define _llikNbinomMuDmu _rxb33b901694f470e435a3fead7d18dcfb201__llikNbinomMuDmu_w2La</span></span>
<span><span class="co">#&gt; #define _llikNbinomMu _rxb33b901694f470e435a3fead7d18dcfb202__llikNbinomMu_9bV7</span></span>
<span><span class="co">#&gt; #define _llikNbinomDprob _rxb33b901694f470e435a3fead7d18dcfb203__llikNbinomDprob_N6xI</span></span>
<span><span class="co">#&gt; #define _llikNbinom _rxb33b901694f470e435a3fead7d18dcfb204__llikNbinom_MJk0</span></span>
<span><span class="co">#&gt; #define _llikBinomDprob _rxb33b901694f470e435a3fead7d18dcfb205__llikBinomDprob_jHvl</span></span>
<span><span class="co">#&gt; #define _llikBinom _rxb33b901694f470e435a3fead7d18dcfb206__llikBinom_xTGE</span></span>
<span><span class="co">#&gt; #define _llikPoisDlambda _rxb33b901694f470e435a3fead7d18dcfb207__llikPoisDlambda_rsm8</span></span>
<span><span class="co">#&gt; #define _llikPois _rxb33b901694f470e435a3fead7d18dcfb208__llikPois_eoul</span></span>
<span><span class="co">#&gt; #define _llikNormDsd _rxb33b901694f470e435a3fead7d18dcfb209__llikNormDsd_HI69</span></span>
<span><span class="co">#&gt; #define _llikNormDmean _rxb33b901694f470e435a3fead7d18dcfb210__llikNormDmean_BpBR</span></span>
<span><span class="co">#&gt; #define _llikNorm _rxb33b901694f470e435a3fead7d18dcfb211__llikNorm_YoQF</span></span>
<span><span class="co">#&gt; #define simeps _rxb33b901694f470e435a3fead7d18dcfb212_simeps_Gl8i</span></span>
<span><span class="co">#&gt; #define simeta _rxb33b901694f470e435a3fead7d18dcfb213_simeta_fPX7</span></span>
<span><span class="co">#&gt; #define expit _rxb33b901694f470e435a3fead7d18dcfb214_expit_kbOk</span></span>
<span><span class="co">#&gt; #define logit _rxb33b901694f470e435a3fead7d18dcfb215_logit_UR3R</span></span>
<span><span class="co">#&gt; #define gammapDer _rxb33b901694f470e435a3fead7d18dcfb216_gammapDer_0cxY</span></span>
<span><span class="co">#&gt; #define lowergamma _rxb33b901694f470e435a3fead7d18dcfb217_lowergamma_CG1i</span></span>
<span><span class="co">#&gt; #define uppergamma _rxb33b901694f470e435a3fead7d18dcfb218_uppergamma_PGJk</span></span>
<span><span class="co">#&gt; #define gammaqInva _rxb33b901694f470e435a3fead7d18dcfb219_gammaqInva_jzI2</span></span>
<span><span class="co">#&gt; #define gammaqInv _rxb33b901694f470e435a3fead7d18dcfb220_gammaqInv_kItb</span></span>
<span><span class="co">#&gt; #define gammapInva _rxb33b901694f470e435a3fead7d18dcfb221_gammapInva_aBdx</span></span>
<span><span class="co">#&gt; #define gammapInv _rxb33b901694f470e435a3fead7d18dcfb222_gammapInv_vufd</span></span>
<span><span class="co">#&gt; #define gammaq _rxb33b901694f470e435a3fead7d18dcfb223_gammaq_Isq6</span></span>
<span><span class="co">#&gt; #define gammap _rxb33b901694f470e435a3fead7d18dcfb224_gammap_9enN</span></span>
<span><span class="co">#&gt; #define phi _rxb33b901694f470e435a3fead7d18dcfb225_phi_xL3f</span></span>
<span><span class="co">#&gt; #define d2ELUa _rxb33b901694f470e435a3fead7d18dcfb226_d2ELUa_Ypol</span></span>
<span><span class="co">#&gt; #define dELUa _rxb33b901694f470e435a3fead7d18dcfb227_dELUa_0xIK</span></span>
<span><span class="co">#&gt; #define d2aELU _rxb33b901694f470e435a3fead7d18dcfb228_d2aELU_JCgF</span></span>
<span><span class="co">#&gt; #define d2ELU _rxb33b901694f470e435a3fead7d18dcfb229_d2ELU_NmXy</span></span>
<span><span class="co">#&gt; #define dELU _rxb33b901694f470e435a3fead7d18dcfb230_dELU_kPca</span></span>
<span><span class="co">#&gt; #define ELU _rxb33b901694f470e435a3fead7d18dcfb231_ELU_SQGe</span></span>
<span><span class="co">#&gt; #define dPReLUa1 _rxb33b901694f470e435a3fead7d18dcfb232_dPReLUa1_bE5B</span></span>
<span><span class="co">#&gt; #define dPReLUa _rxb33b901694f470e435a3fead7d18dcfb233_dPReLUa_1yeg</span></span>
<span><span class="co">#&gt; #define dPReLU _rxb33b901694f470e435a3fead7d18dcfb234_dPReLU_FeCE</span></span>
<span><span class="co">#&gt; #define PReLU _rxb33b901694f470e435a3fead7d18dcfb235_PReLU_Vukc</span></span>
<span><span class="co">#&gt; #define dSwish _rxb33b901694f470e435a3fead7d18dcfb236_dSwish_GHuo</span></span>
<span><span class="co">#&gt; #define Swish _rxb33b901694f470e435a3fead7d18dcfb237_Swish_ARTH</span></span>
<span><span class="co">#&gt; #define dlReLU _rxb33b901694f470e435a3fead7d18dcfb238_dlReLU_xSmZ</span></span>
<span><span class="co">#&gt; #define lReLU _rxb33b901694f470e435a3fead7d18dcfb239_lReLU_rAF2</span></span>
<span><span class="co">#&gt; #define dSELU _rxb33b901694f470e435a3fead7d18dcfb240_dSELU_ZZsK</span></span>
<span><span class="co">#&gt; #define SELU _rxb33b901694f470e435a3fead7d18dcfb241_SELU_G2LP</span></span>
<span><span class="co">#&gt; #define d4softplus _rxb33b901694f470e435a3fead7d18dcfb242_d4softplus_1qBg</span></span>
<span><span class="co">#&gt; #define d3softplus _rxb33b901694f470e435a3fead7d18dcfb243_d3softplus_0fWO</span></span>
<span><span class="co">#&gt; #define d2softplus _rxb33b901694f470e435a3fead7d18dcfb244_d2softplus_VS5I</span></span>
<span><span class="co">#&gt; #define dsoftplus _rxb33b901694f470e435a3fead7d18dcfb245_dsoftplus_1hpY</span></span>
<span><span class="co">#&gt; #define softplus _rxb33b901694f470e435a3fead7d18dcfb246_softplus_yEzw</span></span>
<span><span class="co">#&gt; #define d4GELU _rxb33b901694f470e435a3fead7d18dcfb247_d4GELU_Nzgn</span></span>
<span><span class="co">#&gt; #define d3GELU _rxb33b901694f470e435a3fead7d18dcfb248_d3GELU_epKf</span></span>
<span><span class="co">#&gt; #define d2GELU _rxb33b901694f470e435a3fead7d18dcfb249_d2GELU_egrF</span></span>
<span><span class="co">#&gt; #define dGELU _rxb33b901694f470e435a3fead7d18dcfb250_dGELU_8t09</span></span>
<span><span class="co">#&gt; #define GELU _rxb33b901694f470e435a3fead7d18dcfb251_GELU_Y5xW</span></span>
<span><span class="co">#&gt; #define dReLU _rxb33b901694f470e435a3fead7d18dcfb252_dReLU_Pym9</span></span>
<span><span class="co">#&gt; #define ReLU _rxb33b901694f470e435a3fead7d18dcfb253_ReLU_UDEX</span></span>
<span><span class="co">#&gt; #define riweibull _rxb33b901694f470e435a3fead7d18dcfb254_riweibull_MOf4</span></span>
<span><span class="co">#&gt; #define riunif _rxb33b901694f470e435a3fead7d18dcfb255_riunif_mRid</span></span>
<span><span class="co">#&gt; #define rit_ _rxb33b901694f470e435a3fead7d18dcfb256_rit__m39x</span></span>
<span><span class="co">#&gt; #define ripois _rxb33b901694f470e435a3fead7d18dcfb257_ripois_jiFE</span></span>
<span><span class="co">#&gt; #define ribeta _rxb33b901694f470e435a3fead7d18dcfb258_ribeta_pjmW</span></span>
<span><span class="co">#&gt; #define rigamma _rxb33b901694f470e435a3fead7d18dcfb259_rigamma_EuSr</span></span>
<span><span class="co">#&gt; #define rigeom _rxb33b901694f470e435a3fead7d18dcfb260_rigeom_X2fg</span></span>
<span><span class="co">#&gt; #define rif _rxb33b901694f470e435a3fead7d18dcfb261_rif_ccvo</span></span>
<span><span class="co">#&gt; #define riexp _rxb33b901694f470e435a3fead7d18dcfb262_riexp_gQjd</span></span>
<span><span class="co">#&gt; #define richisq _rxb33b901694f470e435a3fead7d18dcfb263_richisq_SxjK</span></span>
<span><span class="co">#&gt; #define ricauchy _rxb33b901694f470e435a3fead7d18dcfb264_ricauchy_YDx2</span></span>
<span><span class="co">#&gt; #define rinbinomMu _rxb33b901694f470e435a3fead7d18dcfb265_rinbinomMu_EoAo</span></span>
<span><span class="co">#&gt; #define rinbinom _rxb33b901694f470e435a3fead7d18dcfb266_rinbinom_YFjR</span></span>
<span><span class="co">#&gt; #define ribinom _rxb33b901694f470e435a3fead7d18dcfb267_ribinom_HKKt</span></span>
<span><span class="co">#&gt; #define rinorm _rxb33b901694f470e435a3fead7d18dcfb268_rinorm_kaKz</span></span>
<span><span class="co">#&gt; #define rxweibull _rxb33b901694f470e435a3fead7d18dcfb269_rxweibull_7SFM</span></span>
<span><span class="co">#&gt; #define rxunif _rxb33b901694f470e435a3fead7d18dcfb270_rxunif_H4zk</span></span>
<span><span class="co">#&gt; #define rxt_ _rxb33b901694f470e435a3fead7d18dcfb271_rxt__6zQQ</span></span>
<span><span class="co">#&gt; #define rxpois _rxb33b901694f470e435a3fead7d18dcfb272_rxpois_bQJb</span></span>
<span><span class="co">#&gt; #define rxbeta _rxb33b901694f470e435a3fead7d18dcfb273_rxbeta_vvZh</span></span>
<span><span class="co">#&gt; #define rxgamma _rxb33b901694f470e435a3fead7d18dcfb274_rxgamma_xRbw</span></span>
<span><span class="co">#&gt; #define rxgeom _rxb33b901694f470e435a3fead7d18dcfb275_rxgeom_oyS6</span></span>
<span><span class="co">#&gt; #define rxf _rxb33b901694f470e435a3fead7d18dcfb276_rxf_AagP</span></span>
<span><span class="co">#&gt; #define rxexp _rxb33b901694f470e435a3fead7d18dcfb277_rxexp_RNyr</span></span>
<span><span class="co">#&gt; #define rxchisq _rxb33b901694f470e435a3fead7d18dcfb278_rxchisq_gWz3</span></span>
<span><span class="co">#&gt; #define rxcauchy _rxb33b901694f470e435a3fead7d18dcfb279_rxcauchy_ZsGr</span></span>
<span><span class="co">#&gt; #define rxnbinomMu _rxb33b901694f470e435a3fead7d18dcfb280_rxnbinomMu_k6bc</span></span>
<span><span class="co">#&gt; #define rxnbinom _rxb33b901694f470e435a3fead7d18dcfb281_rxnbinom_B8sn</span></span>
<span><span class="co">#&gt; #define rxbinom _rxb33b901694f470e435a3fead7d18dcfb282_rxbinom_zwc8</span></span>
<span><span class="co">#&gt; #define rxnorm _rxb33b901694f470e435a3fead7d18dcfb283_rxnorm_6J2u</span></span>
<span><span class="co">#&gt; #define linCmtB _rxb33b901694f470e435a3fead7d18dcfb284_linCmtB_b58Z</span></span>
<span><span class="co">#&gt; #define linCmtA _rxb33b901694f470e435a3fead7d18dcfb285_linCmtA_JhNT</span></span>
<span><span class="co">#&gt; #include &lt;rxode2_model_shared.h&gt;</span></span>
<span><span class="co">#&gt; #define __MAX_PROD__ 0</span></span>
<span><span class="co">#&gt; #define _CMT CMT</span></span>
<span><span class="co">#&gt; #define _SYNC_simeps_ for (int _svari=_solveData-&gt;neps; _svari--;){  if (_solveData-&gt;svar[_svari] == 0) {KA = _PP[0];};   if (_solveData-&gt;svar[_svari] == 1) {TCl = _PP[1];};   if (_solveData-&gt;svar[_svari] == 2) {V2 = _PP[2];};   if (_solveData-&gt;svar[_svari] == 3) {Q = _PP[3];};   if (_solveData-&gt;svar[_svari] == 4) {V3 = _PP[4];};   if (_solveData-&gt;svar[_svari] == 5) {Kin = _PP[5];};   if (_solveData-&gt;svar[_svari] == 6) {Kout = _PP[6];};   if (_solveData-&gt;svar[_svari] == 7) {EC50 = _PP[7];};   if (_solveData-&gt;svar[_svari] == 8) {eff_DoT_sd = _PP[8];};   if (_solveData-&gt;svar[_svari] == 9) {prop_DoT_sd = _PP[9];};   if (_solveData-&gt;svar[_svari] == 10) {eta_DoT_Cl = _PP[10];};   if (_solveData-&gt;svar[_svari] == 11) {CMT = _PP[11];};   if (_solveData-&gt;svar[_svari] == 12) {rxerr_DoT_eff = _PP[12];};   if (_solveData-&gt;svar[_svari] == 13) {rxerr_DoT_C2 = _PP[13];}; }</span></span>
<span><span class="co">#&gt; #define _SYNC_simeta_ for (int _ovari=_solveData-&gt;neta; _ovari--;){  if (_solveData-&gt;ovar[_ovari] == 0) {KA = _PP[0];};   if (_solveData-&gt;ovar[_ovari] == 1) {TCl = _PP[1];};   if (_solveData-&gt;ovar[_ovari] == 2) {V2 = _PP[2];};   if (_solveData-&gt;ovar[_ovari] == 3) {Q = _PP[3];};   if (_solveData-&gt;ovar[_ovari] == 4) {V3 = _PP[4];};   if (_solveData-&gt;ovar[_ovari] == 5) {Kin = _PP[5];};   if (_solveData-&gt;ovar[_ovari] == 6) {Kout = _PP[6];};   if (_solveData-&gt;ovar[_ovari] == 7) {EC50 = _PP[7];};   if (_solveData-&gt;ovar[_ovari] == 8) {eff_DoT_sd = _PP[8];};   if (_solveData-&gt;ovar[_ovari] == 9) {prop_DoT_sd = _PP[9];};   if (_solveData-&gt;ovar[_ovari] == 10) {eta_DoT_Cl = _PP[10];};   if (_solveData-&gt;ovar[_ovari] == 11) {CMT = _PP[11];};   if (_solveData-&gt;ovar[_ovari] == 12) {rxerr_DoT_eff = _PP[12];};   if (_solveData-&gt;ovar[_ovari] == 13) {rxerr_DoT_C2 = _PP[13];}; }</span></span>
<span><span class="co">#&gt; _getRxSolve_t _getRxSolve_;</span></span>
<span><span class="co">#&gt; _simfun simeps;</span></span>
<span><span class="co">#&gt; _simfun simeta;</span></span>
<span><span class="co">#&gt; _udf_type _evalUdf=NULL;</span></span>
<span><span class="co">#&gt; rx_solve *_solveData=NULL;</span></span>
<span><span class="co">#&gt; rxode2_assign_ptr _assign_ptr=NULL;</span></span>
<span><span class="co">#&gt; _rxRmModelLibType _rxRmModelLib=NULL;</span></span>
<span><span class="co">#&gt; _rxGetModelLibType _rxGetModelLib=NULL;</span></span>
<span><span class="co">#&gt; rxode2_ode_solver_old_c _old_c=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _ptrid=NULL;</span></span>
<span><span class="co">#&gt; _rxIsCurrentC_type _rxIsCurrentC=NULL;</span></span>
<span><span class="co">#&gt; _rxSumType _sumPS=NULL;</span></span>
<span><span class="co">#&gt; _rxProdType _prodPS=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _prodType=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _sumType=NULL;</span></span>
<span><span class="co">#&gt; _update_par_ptr_p _update_par_ptr=NULL;</span></span>
<span><span class="co">#&gt; _getParCov_p _getParCov=NULL;</span></span>
<span><span class="co">#&gt; linCmtA_p linCmtA;</span></span>
<span><span class="co">#&gt; linCmtB_p linCmtB;</span></span>
<span><span class="co">#&gt; _rx_asgn _rxode2_rxAssignPtr=NULL;</span></span>
<span><span class="co">#&gt; _rx_asgn _rxQr=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn phi;</span></span>
<span><span class="co">#&gt; rxode2_fn ReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn dReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn dGELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d2GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d3GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d4GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn dsoftplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d2softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d3softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d4softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn SELU;</span></span>
<span><span class="co">#&gt; rxode2_fn dSELU;</span></span>
<span><span class="co">#&gt; rxode2_fn lReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn dlReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn Swish;</span></span>
<span><span class="co">#&gt; rxode2_fn dSwish;</span></span>
<span><span class="co">#&gt; rxode2_fn2 PReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLUa;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLUa1;</span></span>
<span><span class="co">#&gt; rxode2_fn2 ELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2ELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2aELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dELUa;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2ELUa;</span></span>
<span><span class="co">#&gt; rxode2_fn3 logit;</span></span>
<span><span class="co">#&gt; rxode2_fn3 expit;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammap;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaq;</span></span>
<span><span class="co">#&gt; rxode2_fn2 lowergamma;</span></span>
<span><span class="co">#&gt; rxode2_fn2 uppergamma;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapInv;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapDer;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapInva;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaqInv;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaqInva;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxnorm;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxbinom;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxnbinom;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxnbinomMu;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxcauchy;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxchisq;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxexp;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxf;</span></span>
<span><span class="co">#&gt; rxode2i_ifn rxgeom;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxgamma;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxbeta;</span></span>
<span><span class="co">#&gt; rxode2i_ifn rxpois;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxt_;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxunif;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxweibull;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rinorm;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom ribinom;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom rinbinom;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom rinbinomMu;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 ricauchy;</span></span>
<span><span class="co">#&gt; rxode2i2_fn richisq;</span></span>
<span><span class="co">#&gt; rxode2i2_fn riexp;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rif;</span></span>
<span><span class="co">#&gt; rxode2i2_ifn rigeom;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rigamma;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 ribeta;</span></span>
<span><span class="co">#&gt; rxode2i2_ifn ripois;</span></span>
<span><span class="co">#&gt; rxode2i2_fn rit_;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 riunif;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 riweibull;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNorm;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNormDmean;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNormDsd;</span></span>
<span><span class="co">#&gt; rxode2_llikPoisFun _llikPois;</span></span>
<span><span class="co">#&gt; rxode2_llikPoisFun _llikPoisDlambda;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikBinom;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikBinomDprob;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinom;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomDprob;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomMu;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomMuDmu;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBeta;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBetaDshape1;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBetaDshape2;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikT;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDdf;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDmean;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDsd;</span></span>
<span><span class="co">#&gt; rxode2_llikChisqFun _llikChisq;</span></span>
<span><span class="co">#&gt; rxode2_llikChisqFun _llikChisqDdf;</span></span>
<span><span class="co">#&gt; rxode2_llikExpFun _llikExp;</span></span>
<span><span class="co">#&gt; rxode2_llikExpFun _llikExpDrate;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikF;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikFDdf1;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikFDdf2;</span></span>
<span><span class="co">#&gt; rxode2_llikGeomFun _llikGeom;</span></span>
<span><span class="co">#&gt; rxode2_llikGeomFun _llikGeomDp;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnif;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnifDalpha;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnifDbeta;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibull;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibullDshape;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibullDscale;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGamma;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGammaDshape;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGammaDrate;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchy;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchyDlocation;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchyDscale;</span></span>
<span><span class="co">#&gt; rxode2_compareFactorVal_fn _compareFactorVal;</span></span>
<span><span class="co">#&gt; #include "extraC.h"</span></span>
<span><span class="co">#&gt; double _prod(double *input, double *p, int type, int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return _prodPS(input, p, n, type);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _udf(const char *funName, double *input, int n, ...) {</span></span>
<span><span class="co">#&gt;   if (n == -42) Rf_error("%s", "this has a ui user function that cannot be called directly");</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return _evalUdf(funName, n, input);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _sum(double *input, double *pld, int m, int type, int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   double ret = _sumPS(input, n, pld, m, type);</span></span>
<span><span class="co">#&gt;   if (type == 2 &amp;&amp; m &lt; 0){</span></span>
<span><span class="co">#&gt;     for (int i = -m; i--;){</span></span>
<span><span class="co">#&gt;       pld[i] = 0.0;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return ret;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _sign(unsigned int n, ...) {</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double s = 1;</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;     s = sign(va_arg(valist, double))*s;</span></span>
<span><span class="co">#&gt;     if (s == 0){</span></span>
<span><span class="co">#&gt;       break;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return s;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _rxord(int _cSub, unsigned int n,  ...) {</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind* ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   if (!ind-&gt;inLhs) {</span></span>
<span><span class="co">#&gt;     return 1.0;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double ret = 1.0;</span></span>
<span><span class="co">#&gt;   double p = 0.0;</span></span>
<span><span class="co">#&gt;   double u = rxunif(ind, 0.0, 1.0);</span></span>
<span><span class="co">#&gt;   int found = 0;</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;     p += va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     if (!found) {</span></span>
<span><span class="co">#&gt;       if (u &lt; p) {</span></span>
<span><span class="co">#&gt;         ret = (double)(i+1);</span></span>
<span><span class="co">#&gt;         found = 1;</span></span>
<span><span class="co">#&gt;       }</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   if (!found) ret =(double)(n+1);</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return ret;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _max(unsigned int n, ...) {</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double mx = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tmp = 0;</span></span>
<span><span class="co">#&gt;   if (n &gt;= 1){</span></span>
<span><span class="co">#&gt;     mx = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     for (unsigned int i = 1; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;       tmp = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;       if (tmp&gt;mx) mx=tmp;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     va_end(valist);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return mx;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _min(unsigned int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double mn = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tmp = 0;</span></span>
<span><span class="co">#&gt;   if (n &gt;= 1){</span></span>
<span><span class="co">#&gt;     mn = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     for (unsigned int i = 1; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;       tmp = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;       if (tmp&lt;mn) mn=tmp;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     va_end(valist);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return mn;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _transit4P(int cmt, double t, unsigned int id, double n, double mtt, double bio){</span></span>
<span><span class="co">#&gt;   double nd = (double) n;</span></span>
<span><span class="co">#&gt;   double ktr = (nd+1)/mtt;</span></span>
<span><span class="co">#&gt;   double lktr = _safe_log(nd+1)-_safe_log(mtt);</span></span>
<span><span class="co">#&gt;   double tlast = _solveData-&gt;subjects[id].tlastS[cmt];</span></span>
<span><span class="co">#&gt;   double dose = _solveData-&gt;subjects[id].curDoseS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(dose)) dose = 0.0;</span></span>
<span><span class="co">#&gt;   if (ISNA(tlast)) tlast = 0.0;</span></span>
<span><span class="co">#&gt;   double tad = (t-tlast);</span></span>
<span><span class="co">#&gt;   return exp(_safe_log(bio*dose)+lktr+n*(lktr+_safe_log(tad))-ktr*(tad)-lgamma1p(nd));</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _transit3P(int cmt, double t, unsigned int id, double n, double mtt){</span></span>
<span><span class="co">#&gt;   double nd = (double) n;</span></span>
<span><span class="co">#&gt;   double ktr = (nd+1)/mtt;</span></span>
<span><span class="co">#&gt;   double lktr = _safe_log(nd+1)-_safe_log(mtt);</span></span>
<span><span class="co">#&gt;   double tlast = _solveData-&gt;subjects[id].tlastS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(tlast)) tlast = 0.0;</span></span>
<span><span class="co">#&gt;   double tad = t-tlast;</span></span>
<span><span class="co">#&gt;   double podo = _solveData-&gt;subjects[id].curDoseS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(podo)) podo = 0.0;</span></span>
<span><span class="co">#&gt;   return exp(_safe_log(podo)+lktr+n*(lktr+_safe_log(tad))-ktr*(tad)-lgamma1p(nd));</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void _assignFuns0(void) {</span></span>
<span><span class="co">#&gt;   _evalUdf = (_udf_type) R_GetCCallable("rxode2", "_rxode2_evalUdf");</span></span>
<span><span class="co">#&gt;   _getRxSolve_ = (_getRxSolve_t) R_GetCCallable("rxode2","getRxSolve_");</span></span>
<span><span class="co">#&gt;   _assign_ptr=(rxode2_assign_ptr) R_GetCCallable("rxode2","rxode2_assign_fn_pointers");</span></span>
<span><span class="co">#&gt;   _rxRmModelLib=(_rxRmModelLibType) R_GetCCallable("rxode2","rxRmModelLib");</span></span>
<span><span class="co">#&gt;   _rxGetModelLib=(_rxGetModelLibType) R_GetCCallable("rxode2","rxGetModelLib");</span></span>
<span><span class="co">#&gt;   _rxode2_rxAssignPtr=(_rx_asgn)R_GetCCallable("rxode2","_rxode2_rxAssignPtr");</span></span>
<span><span class="co">#&gt;   _rxQr=(_rx_asgn)R_GetCCallable("rxode2","_rxode2_rxQr");</span></span>
<span><span class="co">#&gt;   _rxIsCurrentC = (_rxIsCurrentC_type)R_GetCCallable("rxode2","rxIsCurrentC");</span></span>
<span><span class="co">#&gt;   _sumPS  = (_rxSumType) R_GetCCallable("PreciseSums","PreciseSums_sum_r");</span></span>
<span><span class="co">#&gt;   _prodPS = (_rxProdType) R_GetCCallable("PreciseSums","PreciseSums_prod_r");</span></span>
<span><span class="co">#&gt;   _prodType=(rxode2_fn0i)R_GetCCallable("PreciseSums", "PreciseSums_prod_get");</span></span>
<span><span class="co">#&gt;   _sumType=(rxode2_fn0i)R_GetCCallable("PreciseSums", "PreciseSums_sum_get");</span></span>
<span><span class="co">#&gt;   _ptrid=(rxode2_fn0i)R_GetCCallable("rxode2", "rxode2_current_fn_pointer_id");</span></span>
<span><span class="co">#&gt;   _compareFactorVal=(rxode2_compareFactorVal_fn) R_GetCCallable("rxode2", "compareFactorVal");</span></span>
<span><span class="co">#&gt;   _update_par_ptr = (_update_par_ptr_p) R_GetCCallable("rxode2","_update_par_ptr");</span></span>
<span><span class="co">#&gt;   _getParCov = (_getParCov_p) R_GetCCallable("rxode2","_getParCov");</span></span>
<span><span class="co">#&gt;   // dynamic start</span></span>
<span><span class="co">#&gt;   _llikCauchyDscale = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchyDscale");</span></span>
<span><span class="co">#&gt;   _llikCauchyDlocation = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchyDlocation");</span></span>
<span><span class="co">#&gt;   _llikCauchy = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchy");</span></span>
<span><span class="co">#&gt;   _llikGammaDrate = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGammaDrate");</span></span>
<span><span class="co">#&gt;   _llikGammaDshape = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGammaDshape");</span></span>
<span><span class="co">#&gt;   _llikGamma = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGamma");</span></span>
<span><span class="co">#&gt;   _llikWeibullDscale = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibullDscale");</span></span>
<span><span class="co">#&gt;   _llikWeibullDshape = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibullDshape");</span></span>
<span><span class="co">#&gt;   _llikWeibull = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibull");</span></span>
<span><span class="co">#&gt;   _llikUnifDbeta = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnifDbeta");</span></span>
<span><span class="co">#&gt;   _llikUnifDalpha = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnifDalpha");</span></span>
<span><span class="co">#&gt;   _llikUnif = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnif");</span></span>
<span><span class="co">#&gt;   _llikGeomDp = (rxode2_llikGeomFun) R_GetCCallable("rxode2ll", "rxLlikGeomDp");</span></span>
<span><span class="co">#&gt;   _llikGeom = (rxode2_llikGeomFun) R_GetCCallable("rxode2ll", "rxLlikGeom");</span></span>
<span><span class="co">#&gt;   _llikFDdf2 = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikFDdf2");</span></span>
<span><span class="co">#&gt;   _llikFDdf1 = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikFDdf1");</span></span>
<span><span class="co">#&gt;   _llikF = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikF");</span></span>
<span><span class="co">#&gt;   _llikExpDrate = (rxode2_llikExpFun) R_GetCCallable("rxode2ll", "rxLlikExpDrate");</span></span>
<span><span class="co">#&gt;   _llikExp = (rxode2_llikExpFun) R_GetCCallable("rxode2ll", "rxLlikExp");</span></span>
<span><span class="co">#&gt;   _llikChisqDdf = (rxode2_llikChisqFun) R_GetCCallable("rxode2ll", "rxLlikChisqDdf");</span></span>
<span><span class="co">#&gt;   _llikChisq = (rxode2_llikChisqFun) R_GetCCallable("rxode2ll", "rxLlikChisq");</span></span>
<span><span class="co">#&gt;   _llikTDsd = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDsd");</span></span>
<span><span class="co">#&gt;   _llikTDmean = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDmean");</span></span>
<span><span class="co">#&gt;   _llikTDdf = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDdf");</span></span>
<span><span class="co">#&gt;   _llikT = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikT");</span></span>
<span><span class="co">#&gt;   _llikBetaDshape2 = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBetaDshape2");</span></span>
<span><span class="co">#&gt;   _llikBetaDshape1 = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBetaDshape1");</span></span>
<span><span class="co">#&gt;   _llikBeta = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBeta");</span></span>
<span><span class="co">#&gt;   _llikNbinomMuDmu = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomMuDmu");</span></span>
<span><span class="co">#&gt;   _llikNbinomMu = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomMu");</span></span>
<span><span class="co">#&gt;   _llikNbinomDprob = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomDprob");</span></span>
<span><span class="co">#&gt;   _llikNbinom = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinom");</span></span>
<span><span class="co">#&gt;   _llikBinomDprob = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikBinomDprob");</span></span>
<span><span class="co">#&gt;   _llikBinom = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikBinom");</span></span>
<span><span class="co">#&gt;   _llikPoisDlambda = (rxode2_llikPoisFun) R_GetCCallable("rxode2ll", "rxLlikPoisDlambda");</span></span>
<span><span class="co">#&gt;   _llikPois = (rxode2_llikPoisFun) R_GetCCallable("rxode2ll", "rxLlikPois");</span></span>
<span><span class="co">#&gt;   _llikNormDsd = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNormDsd");</span></span>
<span><span class="co">#&gt;   _llikNormDmean = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNormDmean");</span></span>
<span><span class="co">#&gt;   _llikNorm = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNorm");</span></span>
<span><span class="co">#&gt;   simeps = (_simfun) R_GetCCallable("rxode2", "simeps");</span></span>
<span><span class="co">#&gt;   simeta = (_simfun) R_GetCCallable("rxode2", "simeta");</span></span>
<span><span class="co">#&gt;   expit = (rxode2_fn3) R_GetCCallable("rxode2", "expit");</span></span>
<span><span class="co">#&gt;   logit = (rxode2_fn3) R_GetCCallable("rxode2", "logit");</span></span>
<span><span class="co">#&gt;   gammapDer = (rxode2_fn2) R_GetCCallable("rxode2", "gammapDer");</span></span>
<span><span class="co">#&gt;   lowergamma = (rxode2_fn2) R_GetCCallable("rxode2", "lowergamma");</span></span>
<span><span class="co">#&gt;   uppergamma = (rxode2_fn2) R_GetCCallable("rxode2", "uppergamma");</span></span>
<span><span class="co">#&gt;   gammaqInva = (rxode2_fn2) R_GetCCallable("rxode2", "gammaqInva");</span></span>
<span><span class="co">#&gt;   gammaqInv = (rxode2_fn2) R_GetCCallable("rxode2", "gammaqInv");</span></span>
<span><span class="co">#&gt;   gammapInva = (rxode2_fn2) R_GetCCallable("rxode2", "gammapInva");</span></span>
<span><span class="co">#&gt;   gammapInv = (rxode2_fn2) R_GetCCallable("rxode2", "gammapInv");</span></span>
<span><span class="co">#&gt;   gammaq = (rxode2_fn2) R_GetCCallable("rxode2", "gammaq");</span></span>
<span><span class="co">#&gt;   gammap = (rxode2_fn2) R_GetCCallable("rxode2", "gammap");</span></span>
<span><span class="co">#&gt;   phi = (rxode2_fn) R_GetCCallable("rxode2", "phi");</span></span>
<span><span class="co">#&gt;   d2ELUa = (rxode2_fn2) R_GetCCallable("rxode2", "d2ELUa");</span></span>
<span><span class="co">#&gt;   dELUa = (rxode2_fn2) R_GetCCallable("rxode2", "dELUa");</span></span>
<span><span class="co">#&gt;   d2aELU = (rxode2_fn2) R_GetCCallable("rxode2", "d2aELU");</span></span>
<span><span class="co">#&gt;   d2ELU = (rxode2_fn2) R_GetCCallable("rxode2", "d2ELU");</span></span>
<span><span class="co">#&gt;   dELU = (rxode2_fn2) R_GetCCallable("rxode2", "dELU");</span></span>
<span><span class="co">#&gt;   ELU = (rxode2_fn2) R_GetCCallable("rxode2", "ELU");</span></span>
<span><span class="co">#&gt;   dPReLUa1 = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLUa1");</span></span>
<span><span class="co">#&gt;   dPReLUa = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLUa");</span></span>
<span><span class="co">#&gt;   dPReLU = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLU");</span></span>
<span><span class="co">#&gt;   PReLU = (rxode2_fn2) R_GetCCallable("rxode2", "PReLU");</span></span>
<span><span class="co">#&gt;   dSwish = (rxode2_fn) R_GetCCallable("rxode2", "dSwish");</span></span>
<span><span class="co">#&gt;   Swish = (rxode2_fn) R_GetCCallable("rxode2", "Swish");</span></span>
<span><span class="co">#&gt;   dlReLU = (rxode2_fn) R_GetCCallable("rxode2", "dlReLU");</span></span>
<span><span class="co">#&gt;   lReLU = (rxode2_fn) R_GetCCallable("rxode2", "lReLU");</span></span>
<span><span class="co">#&gt;   dSELU = (rxode2_fn) R_GetCCallable("rxode2", "dSELU");</span></span>
<span><span class="co">#&gt;   SELU = (rxode2_fn) R_GetCCallable("rxode2", "SELU");</span></span>
<span><span class="co">#&gt;   d4softplus = (rxode2_fn) R_GetCCallable("rxode2", "d4softplus");</span></span>
<span><span class="co">#&gt;   d3softplus = (rxode2_fn) R_GetCCallable("rxode2", "d3softplus");</span></span>
<span><span class="co">#&gt;   d2softplus = (rxode2_fn) R_GetCCallable("rxode2", "d2softplus");</span></span>
<span><span class="co">#&gt;   dsoftplus = (rxode2_fn) R_GetCCallable("rxode2", "dsoftplus");</span></span>
<span><span class="co">#&gt;   softplus = (rxode2_fn) R_GetCCallable("rxode2", "softplus");</span></span>
<span><span class="co">#&gt;   d4GELU = (rxode2_fn) R_GetCCallable("rxode2", "d4GELU");</span></span>
<span><span class="co">#&gt;   d3GELU = (rxode2_fn) R_GetCCallable("rxode2", "d3GELU");</span></span>
<span><span class="co">#&gt;   d2GELU = (rxode2_fn) R_GetCCallable("rxode2", "d2GELU");</span></span>
<span><span class="co">#&gt;   dGELU = (rxode2_fn) R_GetCCallable("rxode2", "dGELU");</span></span>
<span><span class="co">#&gt;   GELU = (rxode2_fn) R_GetCCallable("rxode2", "GELU");</span></span>
<span><span class="co">#&gt;   dReLU = (rxode2_fn) R_GetCCallable("rxode2", "dReLU");</span></span>
<span><span class="co">#&gt;   ReLU = (rxode2_fn) R_GetCCallable("rxode2", "ReLU");</span></span>
<span><span class="co">#&gt;   riweibull = (rxode2i2_fn2) R_GetCCallable("rxode2", "riweibull");</span></span>
<span><span class="co">#&gt;   riunif = (rxode2i2_fn2) R_GetCCallable("rxode2", "riunif");</span></span>
<span><span class="co">#&gt;   rit_ = (rxode2i2_fn) R_GetCCallable("rxode2", "rit_");</span></span>
<span><span class="co">#&gt;   ripois = (rxode2i2_ifn) R_GetCCallable("rxode2", "ripois");</span></span>
<span><span class="co">#&gt;   ribeta = (rxode2i2_fn2) R_GetCCallable("rxode2", "ribeta");</span></span>
<span><span class="co">#&gt;   rigamma = (rxode2i2_fn2) R_GetCCallable("rxode2", "rigamma");</span></span>
<span><span class="co">#&gt;   rigeom = (rxode2i2_ifn) R_GetCCallable("rxode2", "rigeom");</span></span>
<span><span class="co">#&gt;   rif = (rxode2i2_fn2) R_GetCCallable("rxode2", "rif");</span></span>
<span><span class="co">#&gt;   riexp = (rxode2i2_fn) R_GetCCallable("rxode2", "riexp");</span></span>
<span><span class="co">#&gt;   richisq = (rxode2i2_fn) R_GetCCallable("rxode2", "richisq");</span></span>
<span><span class="co">#&gt;   ricauchy = (rxode2i2_fn2) R_GetCCallable("rxode2", "ricauchy");</span></span>
<span><span class="co">#&gt;   rinbinomMu = (rxode2i2_ribinom) R_GetCCallable("rxode2", "rinbinomMu");</span></span>
<span><span class="co">#&gt;   rinbinom = (rxode2i2_ribinom) R_GetCCallable("rxode2", "rinbinom");</span></span>
<span><span class="co">#&gt;   ribinom = (rxode2i2_ribinom) R_GetCCallable("rxode2", "ribinom");</span></span>
<span><span class="co">#&gt;   rinorm = (rxode2i2_fn2) R_GetCCallable("rxode2", "rinorm");</span></span>
<span><span class="co">#&gt;   rxweibull = (rxode2i_fn2) R_GetCCallable("rxode2", "rxweibull");</span></span>
<span><span class="co">#&gt;   rxunif = (rxode2i_fn2) R_GetCCallable("rxode2", "rxunif");</span></span>
<span><span class="co">#&gt;   rxt_ = (rxode2i_fn) R_GetCCallable("rxode2", "rxt_");</span></span>
<span><span class="co">#&gt;   rxpois = (rxode2i_ifn) R_GetCCallable("rxode2", "rxpois");</span></span>
<span><span class="co">#&gt;   rxbeta = (rxode2i_fn2) R_GetCCallable("rxode2", "rxbeta");</span></span>
<span><span class="co">#&gt;   rxgamma = (rxode2i_fn2) R_GetCCallable("rxode2", "rxgamma");</span></span>
<span><span class="co">#&gt;   rxgeom = (rxode2i_ifn) R_GetCCallable("rxode2", "rxgeom");</span></span>
<span><span class="co">#&gt;   rxf = (rxode2i_fn2) R_GetCCallable("rxode2", "rxf");</span></span>
<span><span class="co">#&gt;   rxexp = (rxode2i_fn) R_GetCCallable("rxode2", "rxexp");</span></span>
<span><span class="co">#&gt;   rxchisq = (rxode2i_fn) R_GetCCallable("rxode2", "rxchisq");</span></span>
<span><span class="co">#&gt;   rxcauchy = (rxode2i_fn2) R_GetCCallable("rxode2", "rxcauchy");</span></span>
<span><span class="co">#&gt;   rxnbinomMu = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxnbinomMu");</span></span>
<span><span class="co">#&gt;   rxnbinom = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxnbinom");</span></span>
<span><span class="co">#&gt;   rxbinom = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxbinom");</span></span>
<span><span class="co">#&gt;   rxnorm = (rxode2i_fn2) R_GetCCallable("rxode2", "rxnorm");</span></span>
<span><span class="co">#&gt;   linCmtB = (linCmtB_p) R_GetCCallable("rxode2", "linCmtB");</span></span>
<span><span class="co">#&gt;   linCmtA = (linCmtA_p) R_GetCCallable("rxode2", "linCmtA");</span></span>
<span><span class="co">#&gt;   // dynamic stop</span></span>
<span><span class="co">#&gt;   _solveData = _getRxSolve_();</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void _assignFuns(void) {</span></span>
<span><span class="co">#&gt;   if (_assign_ptr == NULL){</span></span>
<span><span class="co">#&gt;     _assignFuns0();</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void __assignFuns2(rx_solve rx,</span></span>
<span><span class="co">#&gt;                    rx_solving_options op,</span></span>
<span><span class="co">#&gt;                    t_F f,</span></span>
<span><span class="co">#&gt;                    t_LAG lag,</span></span>
<span><span class="co">#&gt;                    t_RATE rate,</span></span>
<span><span class="co">#&gt;                    t_DUR dur,</span></span>
<span><span class="co">#&gt;                    t_calc_mtime mtime,</span></span>
<span><span class="co">#&gt;                    t_ME me,</span></span>
<span><span class="co">#&gt;                    t_IndF indf,</span></span>
<span><span class="co">#&gt;                    t_getTime gettime,</span></span>
<span><span class="co">#&gt;                    t_locateTimeIndex timeindex,</span></span>
<span><span class="co">#&gt;                    t_handle_evidL handleEvid,</span></span>
<span><span class="co">#&gt;                    t_getDur getdur) {</span></span>
<span><span class="co">#&gt;   // assign start</span></span>
<span><span class="co">#&gt;     static rxode2_assignFuns2_t rxode2_assignFuns2 = NULL;</span></span>
<span><span class="co">#&gt;     if (rxode2_assignFuns2 == NULL) rxode2_assignFuns2 = (rxode2_assignFuns2_t)(R_GetCCallable("rxode2", "_rxode2_assignFuns2"));</span></span>
<span><span class="co">#&gt;     rxode2_assignFuns2(rx, op, f, lag, rate, dur, mtime, me, indf, gettime, timeindex, handleEvid, getdur);</span></span>
<span><span class="co">#&gt;   // assign stop</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void  rx_27a3b98533d0bc5bf2af030c2f0b9532__ode_solver_solvedata (rx_solve *solve){</span></span>
<span><span class="co">#&gt;   _solveData = solve;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern rx_solve *rx_27a3b98533d0bc5bf2af030c2f0b9532__ode_solver_get_solvedata(void){</span></span>
<span><span class="co">#&gt;   return _solveData;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; SEXP rx_27a3b98533d0bc5bf2af030c2f0b9532__model_vars(void);</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; // prj-specific differential eqns</span></span>
<span><span class="co">#&gt; void rx_27a3b98533d0bc5bf2af030c2f0b9532__dydt(int *_neq, double __t, double *__zzStateVar__, double *__DDtStateVar__)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   int _cSub = _neq[1];</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_neq[1]].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=1;</span></span>
<span><span class="co">#&gt;   double KA = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TCl = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Q = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kin = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kout = NA_REAL;</span></span>
<span><span class="co">#&gt;   double EC50 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eff_DoT_sd = NA_REAL;</span></span>
<span><span class="co">#&gt;   double prop_DoT_sd = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_Cl = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double centr = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double peri = NA_REAL;</span></span>
<span><span class="co">#&gt;   double CL = NA_REAL;</span></span>
<span><span class="co">#&gt;   double depot = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eff = NA_REAL;</span></span>
<span><span class="co">#&gt;   double CMT = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_yj___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_lambda___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_low___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_hi___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_f_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_r_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double ipredSim = NA_REAL;</span></span>
<span><span class="co">#&gt;   double sim = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rxerr_DoT_eff = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rxerr_DoT_C2 = NA_REAL;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   (void)KA;</span></span>
<span><span class="co">#&gt;   (void)TCl;</span></span>
<span><span class="co">#&gt;   (void)V2;</span></span>
<span><span class="co">#&gt;   (void)Q;</span></span>
<span><span class="co">#&gt;   (void)V3;</span></span>
<span><span class="co">#&gt;   (void)Kin;</span></span>
<span><span class="co">#&gt;   (void)Kout;</span></span>
<span><span class="co">#&gt;   (void)EC50;</span></span>
<span><span class="co">#&gt;   (void)eff_DoT_sd;</span></span>
<span><span class="co">#&gt;   (void)prop_DoT_sd;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_Cl;</span></span>
<span><span class="co">#&gt;   (void)C2;</span></span>
<span><span class="co">#&gt;   (void)centr;</span></span>
<span><span class="co">#&gt;   (void)C3;</span></span>
<span><span class="co">#&gt;   (void)peri;</span></span>
<span><span class="co">#&gt;   (void)CL;</span></span>
<span><span class="co">#&gt;   (void)depot;</span></span>
<span><span class="co">#&gt;   (void)eff;</span></span>
<span><span class="co">#&gt;   (void)CMT;</span></span>
<span><span class="co">#&gt;   (void)rx_yj___;</span></span>
<span><span class="co">#&gt;   (void)rx_lambda___;</span></span>
<span><span class="co">#&gt;   (void)rx_low___;</span></span>
<span><span class="co">#&gt;   (void)rx_hi___;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_f_;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_;</span></span>
<span><span class="co">#&gt;   (void)rx_r_;</span></span>
<span><span class="co">#&gt;   (void)ipredSim;</span></span>
<span><span class="co">#&gt;   (void)sim;</span></span>
<span><span class="co">#&gt;   (void)rxerr_DoT_eff;</span></span>
<span><span class="co">#&gt;   (void)rxerr_DoT_C2;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   C2 = _PL[0];</span></span>
<span><span class="co">#&gt;   C3 = _PL[1];</span></span>
<span><span class="co">#&gt;   CL = _PL[2];</span></span>
<span><span class="co">#&gt;   ipredSim = _PL[3];</span></span>
<span><span class="co">#&gt;   sim = _PL[4];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _update_par_ptr(__t, _cSub, _solveData, _idx);</span></span>
<span><span class="co">#&gt;   KA = _PP[0];</span></span>
<span><span class="co">#&gt;   TCl = _PP[1];</span></span>
<span><span class="co">#&gt;   V2 = _PP[2];</span></span>
<span><span class="co">#&gt;   Q = _PP[3];</span></span>
<span><span class="co">#&gt;   V3 = _PP[4];</span></span>
<span><span class="co">#&gt;   Kin = _PP[5];</span></span>
<span><span class="co">#&gt;   Kout = _PP[6];</span></span>
<span><span class="co">#&gt;   EC50 = _PP[7];</span></span>
<span><span class="co">#&gt;   eff_DoT_sd = _PP[8];</span></span>
<span><span class="co">#&gt;   prop_DoT_sd = _PP[9];</span></span>
<span><span class="co">#&gt;   eta_DoT_Cl = _PP[10];</span></span>
<span><span class="co">#&gt;   CMT = _PP[11];</span></span>
<span><span class="co">#&gt;   rxerr_DoT_eff = _PP[12];</span></span>
<span><span class="co">#&gt;   rxerr_DoT_C2 = _PP[13];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   depot = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">#&gt;   centr = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">#&gt;   peri = __zzStateVar__[__DDT2__]*((double)(_ON[__DDT2__]));</span></span>
<span><span class="co">#&gt;   eff = __zzStateVar__[__DDT3__]*((double)(_ON[__DDT3__]));</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   C2 =centr/_div0(V2);</span></span>
<span><span class="co">#&gt;   C3 =peri/_div0(V3);</span></span>
<span><span class="co">#&gt;   CL =TCl*exp(eta_DoT_Cl);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT0__] = ((double)(_ON[__DDT0__]))*(_IR[__DDT0__] -KA*depot);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT1__] = ((double)(_ON[__DDT1__]))*(_IR[__DDT1__] + KA*depot-CL*C2-Q*C2+Q*C3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT2__] = ((double)(_ON[__DDT2__]))*(_IR[__DDT2__] + Q*C2-Q*C3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT3__] = ((double)(_ON[__DDT3__]))*(_IR[__DDT3__] + Kin-Kout*(1-C2/_div0((EC50+C2)))*eff);</span></span>
<span><span class="co">#&gt;   if (_CMT==4){</span></span>
<span><span class="co">#&gt;   rx_yj_ =2;</span></span>
<span><span class="co">#&gt;   rx_lambda_ =1;</span></span>
<span><span class="co">#&gt;   rx_low_ =0;</span></span>
<span><span class="co">#&gt;   rx_hi_ =1;</span></span>
<span><span class="co">#&gt;   rx_pred_f_ =eff;</span></span>
<span><span class="co">#&gt;   rx_pred_ =rx_pred_f_;</span></span>
<span><span class="co">#&gt;   rx_r_ =Rx_pow((eff_DoT_sd),2);</span></span>
<span><span class="co">#&gt;   ipredSim =rxTBSi(rx_pred_,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   sim =rxTBSi(rx_pred_+sqrt(rx_r_)*rxerr_DoT_eff,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   if (_CMT==5){</span></span>
<span><span class="co">#&gt;   rx_yj_ =2;</span></span>
<span><span class="co">#&gt;   rx_lambda_ =1;</span></span>
<span><span class="co">#&gt;   rx_low_ =0;</span></span>
<span><span class="co">#&gt;   rx_hi_ =1;</span></span>
<span><span class="co">#&gt;   rx_pred_f_ =C2;</span></span>
<span><span class="co">#&gt;   rx_pred_ =rx_pred_f_;</span></span>
<span><span class="co">#&gt;   rx_r_ =Rx_pow((rx_pred_f_*prop_DoT_sd),2);</span></span>
<span><span class="co">#&gt;   ipredSim =rxTBSi(rx_pred_,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   sim =rxTBSi(rx_pred_+sqrt(rx_r_)*rxerr_DoT_C2,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   (&amp;_solveData-&gt;subjects[_cSub])-&gt;dadt_counter[0]++;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; // Jacobian derived vars</span></span>
<span><span class="co">#&gt; void rx_27a3b98533d0bc5bf2af030c2f0b9532__calc_jac(int *_neq, double __t, double *__zzStateVar__, double *__PDStateVar__, unsigned int __NROWPD__) {</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;     int _cSub=_neq[1];</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_neq[1]].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=2;</span></span>
<span><span class="co">#&gt;   (&amp;_solveData-&gt;subjects[_cSub])-&gt;jac_counter[0]++;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Functional based initial conditions.</span></span>
<span><span class="co">#&gt; void rx_27a3b98533d0bc5bf2af030c2f0b9532__inis(int _cSub, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;  _ind-&gt;_rxFlag=3;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // prj-specific derived vars</span></span>
<span><span class="co">#&gt; void rx_27a3b98533d0bc5bf2af030c2f0b9532__calc_lhs(int _cSub, double __t, double *__zzStateVar__, double *_lhs) {</span></span>
<span><span class="co">#&gt;     int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=11;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_0__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_1__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_2__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_3__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_4__;</span></span>
<span><span class="co">#&gt;   double KA = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TCl = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Q = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kin = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kout = NA_REAL;</span></span>
<span><span class="co">#&gt;   double EC50 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eff_DoT_sd = NA_REAL;</span></span>
<span><span class="co">#&gt;   double prop_DoT_sd = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_Cl = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double centr = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double peri = NA_REAL;</span></span>
<span><span class="co">#&gt;   double CL = NA_REAL;</span></span>
<span><span class="co">#&gt;   double depot = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eff = NA_REAL;</span></span>
<span><span class="co">#&gt;   double CMT = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_yj___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_lambda___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_low___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_hi___ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_f_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_pred_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rx_r_ = NA_REAL;</span></span>
<span><span class="co">#&gt;   double ipredSim = NA_REAL;</span></span>
<span><span class="co">#&gt;   double sim = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rxerr_DoT_eff = NA_REAL;</span></span>
<span><span class="co">#&gt;   double rxerr_DoT_C2 = NA_REAL;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_0__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_1__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_2__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_3__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_4__;</span></span>
<span><span class="co">#&gt;   (void)KA;</span></span>
<span><span class="co">#&gt;   (void)TCl;</span></span>
<span><span class="co">#&gt;   (void)V2;</span></span>
<span><span class="co">#&gt;   (void)Q;</span></span>
<span><span class="co">#&gt;   (void)V3;</span></span>
<span><span class="co">#&gt;   (void)Kin;</span></span>
<span><span class="co">#&gt;   (void)Kout;</span></span>
<span><span class="co">#&gt;   (void)EC50;</span></span>
<span><span class="co">#&gt;   (void)eff_DoT_sd;</span></span>
<span><span class="co">#&gt;   (void)prop_DoT_sd;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_Cl;</span></span>
<span><span class="co">#&gt;   (void)C2;</span></span>
<span><span class="co">#&gt;   (void)centr;</span></span>
<span><span class="co">#&gt;   (void)C3;</span></span>
<span><span class="co">#&gt;   (void)peri;</span></span>
<span><span class="co">#&gt;   (void)CL;</span></span>
<span><span class="co">#&gt;   (void)depot;</span></span>
<span><span class="co">#&gt;   (void)eff;</span></span>
<span><span class="co">#&gt;   (void)CMT;</span></span>
<span><span class="co">#&gt;   (void)rx_yj___;</span></span>
<span><span class="co">#&gt;   (void)rx_lambda___;</span></span>
<span><span class="co">#&gt;   (void)rx_low___;</span></span>
<span><span class="co">#&gt;   (void)rx_hi___;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_f_;</span></span>
<span><span class="co">#&gt;   (void)rx_pred_;</span></span>
<span><span class="co">#&gt;   (void)rx_r_;</span></span>
<span><span class="co">#&gt;   (void)ipredSim;</span></span>
<span><span class="co">#&gt;   (void)sim;</span></span>
<span><span class="co">#&gt;   (void)rxerr_DoT_eff;</span></span>
<span><span class="co">#&gt;   (void)rxerr_DoT_C2;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   C2 = _PL[0];</span></span>
<span><span class="co">#&gt;   C3 = _PL[1];</span></span>
<span><span class="co">#&gt;   CL = _PL[2];</span></span>
<span><span class="co">#&gt;   ipredSim = _PL[3];</span></span>
<span><span class="co">#&gt;   sim = _PL[4];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _update_par_ptr(__t, _cSub, _solveData, _idx);</span></span>
<span><span class="co">#&gt;   KA = _PP[0];</span></span>
<span><span class="co">#&gt;   TCl = _PP[1];</span></span>
<span><span class="co">#&gt;   V2 = _PP[2];</span></span>
<span><span class="co">#&gt;   Q = _PP[3];</span></span>
<span><span class="co">#&gt;   V3 = _PP[4];</span></span>
<span><span class="co">#&gt;   Kin = _PP[5];</span></span>
<span><span class="co">#&gt;   Kout = _PP[6];</span></span>
<span><span class="co">#&gt;   EC50 = _PP[7];</span></span>
<span><span class="co">#&gt;   eff_DoT_sd = _PP[8];</span></span>
<span><span class="co">#&gt;   prop_DoT_sd = _PP[9];</span></span>
<span><span class="co">#&gt;   eta_DoT_Cl = _PP[10];</span></span>
<span><span class="co">#&gt;   CMT = _PP[11];</span></span>
<span><span class="co">#&gt;   rxerr_DoT_eff = _PP[12];</span></span>
<span><span class="co">#&gt;   rxerr_DoT_C2 = _PP[13];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   depot = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">#&gt;   centr = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">#&gt;   peri = __zzStateVar__[__DDT2__]*((double)(_ON[__DDT2__]));</span></span>
<span><span class="co">#&gt;   eff = __zzStateVar__[__DDT3__]*((double)(_ON[__DDT3__]));</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   C2 =centr/_div0(V2);</span></span>
<span><span class="co">#&gt;   C3 =peri/_div0(V3);</span></span>
<span><span class="co">#&gt;   CL =TCl*exp(eta_DoT_Cl);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_0__ = ((double)(_ON[__DDT0__]))*(_IR[__DDT0__] -KA*depot);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_1__ = ((double)(_ON[__DDT1__]))*(_IR[__DDT1__] + KA*depot-CL*C2-Q*C2+Q*C3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_2__ = ((double)(_ON[__DDT2__]))*(_IR[__DDT2__] + Q*C2-Q*C3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_3__ = ((double)(_ON[__DDT3__]))*(_IR[__DDT3__] + Kin-Kout*(1-C2/_div0((EC50+C2)))*eff);</span></span>
<span><span class="co">#&gt;   if (_CMT==4){</span></span>
<span><span class="co">#&gt;   rx_yj_ =2;</span></span>
<span><span class="co">#&gt;   rx_lambda_ =1;</span></span>
<span><span class="co">#&gt;   rx_low_ =0;</span></span>
<span><span class="co">#&gt;   rx_hi_ =1;</span></span>
<span><span class="co">#&gt;   rx_pred_f_ =eff;</span></span>
<span><span class="co">#&gt;   rx_pred_ =rx_pred_f_;</span></span>
<span><span class="co">#&gt;   rx_r_ =Rx_pow((eff_DoT_sd),2);</span></span>
<span><span class="co">#&gt;   ipredSim =rxTBSi(rx_pred_,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   sim =rxTBSi(rx_pred_+sqrt(rx_r_)*rxerr_DoT_eff,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   if (_CMT==5){</span></span>
<span><span class="co">#&gt;   rx_yj_ =2;</span></span>
<span><span class="co">#&gt;   rx_lambda_ =1;</span></span>
<span><span class="co">#&gt;   rx_low_ =0;</span></span>
<span><span class="co">#&gt;   rx_hi_ =1;</span></span>
<span><span class="co">#&gt;   rx_pred_f_ =C2;</span></span>
<span><span class="co">#&gt;   rx_pred_ =rx_pred_f_;</span></span>
<span><span class="co">#&gt;   rx_r_ =Rx_pow((rx_pred_f_*prop_DoT_sd),2);</span></span>
<span><span class="co">#&gt;   ipredSim =rxTBSi(rx_pred_,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   sim =rxTBSi(rx_pred_+sqrt(rx_r_)*rxerr_DoT_C2,rx_lambda_,rx_yj_,rx_low_,rx_hi_);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _lhs[_LHS_0_]=C2;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_1_]=C3;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_2_]=CL;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_3_]=ipredSim;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_4_]=sim;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Functional based bioavailability</span></span>
<span><span class="co">#&gt; double rx_27a3b98533d0bc5bf2af030c2f0b9532__F(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return _amt;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; // Functional based absorption lag</span></span>
<span><span class="co">#&gt; double rx_27a3b98533d0bc5bf2af030c2f0b9532__Lag(int _cSub,  int _cmt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return __t;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Modeled zero-order rate</span></span>
<span><span class="co">#&gt; double rx_27a3b98533d0bc5bf2af030c2f0b9532__Rate(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return 0.0;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Modeled zero-order duration</span></span>
<span><span class="co">#&gt; double rx_27a3b98533d0bc5bf2af030c2f0b9532__Dur(int _cSub,  int _cmt, double _amt, double __t){</span></span>
<span><span class="co">#&gt;  return 0.0;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Model Times</span></span>
<span><span class="co">#&gt; void rx_27a3b98533d0bc5bf2af030c2f0b9532__mtime(int _cSub, double *_mtime){</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Matrix Exponential (0)</span></span>
<span><span class="co">#&gt; void rx_27a3b98533d0bc5bf2af030c2f0b9532__ME(int _cSub, double _t, double __t, double *_mat, const double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=9;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Inductive linearization Matf</span></span>
<span><span class="co">#&gt; void rx_27a3b98533d0bc5bf2af030c2f0b9532__IndF(int _cSub, double _t, double __t, double *_matf){</span></span>
<span><span class="co">#&gt;  int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=10;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern SEXP rx_27a3b98533d0bc5bf2af030c2f0b9532__model_vars(void){</span></span>
<span><span class="co">#&gt;   int pro=0;</span></span>
<span><span class="co">#&gt;   SEXP _mv = PROTECT(_rxGetModelLib("rx_27a3b98533d0bc5bf2af030c2f0b9532__model_vars"));pro++;</span></span>
<span><span class="co">#&gt;   if (!_rxIsCurrentC(_mv)){</span></span>
<span><span class="co">#&gt;     SEXP hash    = PROTECT(Rf_allocVector(STRSXP, 1));pro++;</span></span>
<span><span class="co">#&gt; #define __doBuf__  snprintf(buf, __doBufN__, "un]\"BAAA@QRtHACAAAAAAA6y@AAAv7#aT)T(t~TAtFE$@C@jM^Io3Df!)Y*t\"l=M&gt;.`tcNM7{RUWHdMY)&lt;so64Ra1J[sWX2/%%}BHP6SSK)OO9JE4[*t#T=;3ZxcUV&gt;7\?Z\"KB.IG&gt;L1p(=NhAfguI1s!c,(dl0y/\"T^%%&amp;Z&lt;E=tF&amp;9x.K,s2HVJ[.{&amp;z&lt;Jr&gt;2V$m`lP*Z`]{J=0nc$zQx~b+=YP&amp;Es4&amp;_ZC1~`mvw/t6t&amp;UhY6)\?j5M_2}97}Ywk|W,0KQ3JR,~$[^\"6y~C`]]kVV_JE$#FeNn,\?vdf}qeV;!k8jf#p,~$P_a6~PQc.#\?U1y[gD_w&lt;:fKsK3mR92OED4W:^wirGs^dSG,O5jivlfpdbC4[!W\"\?TXSp\?z&amp;k3kG(5OrTcHxv|5Yd]CAS&lt;u&lt;eFlAV26iKODl]LYy6;CrBS.++~z(R6S&gt;zWoM&gt;NlKe:Ih#9zJ$x)!V7#xxx\"J(hbhGhp&lt;*g#m}ZhZl+Ph%%y:P~&gt;,6p8u2^^FEc\"5\"bYE/9A:kHGBp;tU~TAKByirUs*nF\?gY/p}v~uifK=`.5FAAE3&lt;gxd+p_zo4&lt;SP~o)B*oHHp,852M%%uf\"[t=5ihm&gt;7L5+.K)M1&gt;}7*=.CC;H935u:V${nuZ&lt;aELoF(l14[2Fsp@n6|+x!oo^`_vn(Y(I2sc,0T7hNrpG/+~,aW&lt;+P*PtOni;,O\?@+m4X5dBNJYEab`H,:CtZWPX!8=20|GXg!6a_:KRf=[:JCJe\?T#7INoEo%%L.iY2O~`(D6]6j6N5\?;z72X9a:@E+uS0p#ZT(ND*aU|@~oxYY=q3S&amp;PJp%%A_v4rJ*(NL~/@&amp;I3j`+lw*RGZmv0NS;24x&lt;TUp;apSD2#N~lWZ1I4x53:7LX^&amp;Cq|ZPx72\?[\?hP1pZ^j4]~fq#JrYS|&amp;.+}^S=r@78!y;^N%%&amp;TW^=i1Kxc(,#s(]2`)O~2oLIs`==+@`%%]V[^:qN^JsR[ta=]T1n$\"~f~8&gt;o`[pfy*)z{;{c$JQu\?g3#cYwJ@lYP15;X[8p\"bC^kX#8Vk:IBK3&gt;GzEa*N@GSAYe5rjt2BAA.,b]zDotK{_#&amp;`T1S*yN70V2xew*|Mwx\"P,_X&lt;Vq9](~22|uvr)V9z7\?=({xAA/w9ng0VXgSRz{/rLaJaL;C/71c}zk_nzpL3kdx\"F;FVXhx8YfZHX16/*U)F[l\"juuAU0Q&amp;:V^tlIAF95WiW:p.~q6IfxVYGQk4Lk#~VF1f}EsFB7d9`:Cpej0Ym=CD^@.el;m_U}Umu]E@_c&gt;Sa=*zFcYzQxM~b,~1$mu1&gt;7G0Bj+8Ju`Qxw=HOK6&amp;XD.Mxg/SR`,.hi[&lt;S$#!FS/TH^7obWIRRbBl~LTgM8)4bS_E(T=J3LVjPT^BH,p~FsDQ5{W\"Uzu:3E=I(N5pYO[=yu@wQ}$dlI^3lu4XX!S]AyFN_gqv/wfu%%bZf(HGbx\?Xh,PYK}*Uk2zj&gt;DB$5lGI%%4.j(IT9HY#NHo@zw|B&lt;H]VIMP{|QqRS$1t;!:8&gt;^+S(R&amp;Oy:Z!k@y7..,coFK,WS]K#ZD*^g&amp;zgjg$7^@i;Wibd)T\".$1qc)*isZb]|3`v+D6DJ,I;jd1T/,d8V/8B36xThS4A0{E5C&lt;gcDh&amp;ijm)W~+up}/bynk@IqI{otHel*D(pd!u");</span></span>
<span><span class="co">#&gt;     char buf[1628];</span></span>
<span><span class="co">#&gt; #define __doBufN__ 1628</span></span>
<span><span class="co">#&gt;     __doBuf__</span></span>
<span><span class="co">#&gt; #undef __doBuf__</span></span>
<span><span class="co">#&gt; #undef __doBufN__</span></span>
<span><span class="co">#&gt;     SET_STRING_ELT(hash, 0, Rf_mkChar(buf));</span></span>
<span><span class="co">#&gt;     SEXP lst      = PROTECT(_rxQr(hash));pro++;</span></span>
<span><span class="co">#&gt;     _assign_ptr(lst);</span></span>
<span><span class="co">#&gt;     UNPROTECT(pro);</span></span>
<span><span class="co">#&gt;     return lst;</span></span>
<span><span class="co">#&gt;   } else {</span></span>
<span><span class="co">#&gt;     UNPROTECT(pro);</span></span>
<span><span class="co">#&gt;     return _mv;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void rx_27a3b98533d0bc5bf2af030c2f0b9532__dydt_lsoda(int *neq, double *t, double *A, double *DADT)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   rx_27a3b98533d0bc5bf2af030c2f0b9532__dydt(neq, *t, A, DADT);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern int rx_27a3b98533d0bc5bf2af030c2f0b9532__dydt_liblsoda(double __t, double *y, double *ydot, void *data)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   int *neq = (int*)(data);</span></span>
<span><span class="co">#&gt;   rx_27a3b98533d0bc5bf2af030c2f0b9532__dydt(neq, __t, y, ydot);</span></span>
<span><span class="co">#&gt;   return(0);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void rx_27a3b98533d0bc5bf2af030c2f0b9532__calc_jac_lsoda(int *neq, double *t, double *A,int *ml, int *mu, double *JAC, int *nrowpd){</span></span>
<span><span class="co">#&gt;   // Update all covariate parameters</span></span>
<span><span class="co">#&gt;   rx_27a3b98533d0bc5bf2af030c2f0b9532__calc_jac(neq, *t, A, JAC, *nrowpd);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; //Create function to call from R's main thread that assigns the required functions. Sometimes they don't get assigned.</span></span>
<span><span class="co">#&gt; extern void rx_27a3b98533d0bc5bf2af030c2f0b9532__assignFuns(void){</span></span>
<span><span class="co">#&gt;   _assignFuns();</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; //Initialize the dll to match rxode2's calls</span></span>
<span><span class="co">#&gt; void R_init0_rx_27a3b98533d0bc5bf2af030c2f0b9532_(void){</span></span>
<span><span class="co">#&gt;   // Get C callables on load; Otherwise it isn't thread safe</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_27a3b98533d0bc5bf2af030c2f0b9532_","rx_27a3b98533d0bc5bf2af030c2f0b9532__assignFuns2", (DL_FUNC) __assignFuns2);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_27a3b98533d0bc5bf2af030c2f0b9532_","rx_27a3b98533d0bc5bf2af030c2f0b9532__assignFuns", (DL_FUNC) rx_27a3b98533d0bc5bf2af030c2f0b9532__assignFuns);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_27a3b98533d0bc5bf2af030c2f0b9532_","rx_27a3b98533d0bc5bf2af030c2f0b9532__inis",(DL_FUNC) rx_27a3b98533d0bc5bf2af030c2f0b9532__inis);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_27a3b98533d0bc5bf2af030c2f0b9532_","rx_27a3b98533d0bc5bf2af030c2f0b9532__dydt",(DL_FUNC) rx_27a3b98533d0bc5bf2af030c2f0b9532__dydt);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_27a3b98533d0bc5bf2af030c2f0b9532_","rx_27a3b98533d0bc5bf2af030c2f0b9532__calc_lhs",(DL_FUNC) rx_27a3b98533d0bc5bf2af030c2f0b9532__calc_lhs);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_27a3b98533d0bc5bf2af030c2f0b9532_","rx_27a3b98533d0bc5bf2af030c2f0b9532__calc_jac",(DL_FUNC) rx_27a3b98533d0bc5bf2af030c2f0b9532__calc_jac);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_27a3b98533d0bc5bf2af030c2f0b9532_","rx_27a3b98533d0bc5bf2af030c2f0b9532__dydt_lsoda", (DL_FUNC) rx_27a3b98533d0bc5bf2af030c2f0b9532__dydt_lsoda);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_27a3b98533d0bc5bf2af030c2f0b9532_","rx_27a3b98533d0bc5bf2af030c2f0b9532__calc_jac_lsoda", (DL_FUNC) rx_27a3b98533d0bc5bf2af030c2f0b9532__calc_jac_lsoda);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_27a3b98533d0bc5bf2af030c2f0b9532_","rx_27a3b98533d0bc5bf2af030c2f0b9532__ode_solver_solvedata", (DL_FUNC) rx_27a3b98533d0bc5bf2af030c2f0b9532__ode_solver_solvedata);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_27a3b98533d0bc5bf2af030c2f0b9532_","rx_27a3b98533d0bc5bf2af030c2f0b9532__ode_solver_get_solvedata", (DL_FUNC) rx_27a3b98533d0bc5bf2af030c2f0b9532__ode_solver_get_solvedata);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_27a3b98533d0bc5bf2af030c2f0b9532_","rx_27a3b98533d0bc5bf2af030c2f0b9532__F", (DL_FUNC) rx_27a3b98533d0bc5bf2af030c2f0b9532__F);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_27a3b98533d0bc5bf2af030c2f0b9532_","rx_27a3b98533d0bc5bf2af030c2f0b9532__Lag", (DL_FUNC) rx_27a3b98533d0bc5bf2af030c2f0b9532__Lag);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_27a3b98533d0bc5bf2af030c2f0b9532_","rx_27a3b98533d0bc5bf2af030c2f0b9532__Rate", (DL_FUNC) rx_27a3b98533d0bc5bf2af030c2f0b9532__Rate);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_27a3b98533d0bc5bf2af030c2f0b9532_","rx_27a3b98533d0bc5bf2af030c2f0b9532__Dur", (DL_FUNC) rx_27a3b98533d0bc5bf2af030c2f0b9532__Dur);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_27a3b98533d0bc5bf2af030c2f0b9532_","rx_27a3b98533d0bc5bf2af030c2f0b9532__mtime", (DL_FUNC) rx_27a3b98533d0bc5bf2af030c2f0b9532__mtime);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_27a3b98533d0bc5bf2af030c2f0b9532_","rx_27a3b98533d0bc5bf2af030c2f0b9532__ME", (DL_FUNC) rx_27a3b98533d0bc5bf2af030c2f0b9532__ME);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_27a3b98533d0bc5bf2af030c2f0b9532_","rx_27a3b98533d0bc5bf2af030c2f0b9532__IndF", (DL_FUNC) rx_27a3b98533d0bc5bf2af030c2f0b9532__IndF);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_27a3b98533d0bc5bf2af030c2f0b9532_","rx_27a3b98533d0bc5bf2af030c2f0b9532__dydt_liblsoda", (DL_FUNC) rx_27a3b98533d0bc5bf2af030c2f0b9532__dydt_liblsoda);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; //Initialize the dll to match rxode2's calls</span></span>
<span><span class="co">#&gt; void R_init_rx_27a3b98533d0bc5bf2af030c2f0b9532_(DllInfo *info){</span></span>
<span><span class="co">#&gt;   // Get C callables on load; Otherwise it isn't thread safe</span></span>
<span><span class="co">#&gt;   R_init0_rx_27a3b98533d0bc5bf2af030c2f0b9532_();</span></span>
<span><span class="co">#&gt;   static const R_CallMethodDef callMethods[]  = {</span></span>
<span><span class="co">#&gt;     {"rx_27a3b98533d0bc5bf2af030c2f0b9532__model_vars", (DL_FUNC) &amp;rx_27a3b98533d0bc5bf2af030c2f0b9532__model_vars, 0},</span></span>
<span><span class="co">#&gt;     {NULL, NULL, 0}</span></span>
<span><span class="co">#&gt;   };</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   R_registerRoutines(info, NULL, callMethods, NULL, NULL);</span></span>
<span><span class="co">#&gt;   R_useDynamicSymbols(info,FALSE);</span></span>
<span><span class="co">#&gt;   _assignFuns0();</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; void R_unload_rx_27a3b98533d0bc5bf2af030c2f0b9532_ (DllInfo *info){</span></span>
<span><span class="co">#&gt;   // Free resources required for single subject solve.</span></span>
<span><span class="co">#&gt;   SEXP _mv = PROTECT(_rxGetModelLib("rx_27a3b98533d0bc5bf2af030c2f0b9532__model_vars"));</span></span>
<span><span class="co">#&gt;   if (!Rf_isNull(_mv)){</span></span>
<span><span class="co">#&gt;     _rxRmModelLib("rx_27a3b98533d0bc5bf2af030c2f0b9532__model_vars");</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   UNPROTECT(1);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’</span></span></code></pre></div>
<p>Since this is simulated from a model with the residual specification
included and a multiple endpoint model, you can summarize for each
endpoint by simply taking a confidence interval of
<code>"sim"</code>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">sim</span>, <span class="st">"sim"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> in order to put confidence bands around the intervals, you need at least 2500 simulations</span></span>
<span><span class="co">#&gt; summarizing data...done</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span></code></pre></div>
<p><img src="rxode2-sim-var_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<p>If you want to subset to a specific endpoint, like <code>eff</code>
you can create the confidence interval for only that endpoint by using
the specification <code>sim.eff</code>, where the endpoint name is
separated from <code>sim</code> by a dot:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">sim</span>, <span class="st">"sim.eff"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> in order to put confidence bands around the intervals, you need at least 2500 simulations</span></span>
<span><span class="co">#&gt; summarizing data...done</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">seff</span><span class="op">)</span></span></code></pre></div>
<p><img src="rxode2-sim-var_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="simulation-of-individuals">Simulation of Individuals<a class="anchor" aria-label="anchor" href="#simulation-of-individuals"></a>
</h4>
<p>Sometimes you may want to match the dosing and observations of
individuals in a clinical trial. To do this you will have to create a
data.frame using the <code>rxode2</code> event specification as well as
an <code>ID</code> column to indicate an individual. The rxode2 event
vignette talks more about how these datasets should be created.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="va">ev1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>amountUnits<span class="op">=</span><span class="st">"mg"</span>, timeUnits<span class="op">=</span><span class="st">"hours"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>amt<span class="op">=</span><span class="fl">10000</span>, cmt<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">48</span>,length.out<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ev2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>amountUnits<span class="op">=</span><span class="st">"mg"</span>, timeUnits<span class="op">=</span><span class="st">"hours"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>amt<span class="op">=</span><span class="fl">5000</span>, cmt<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">48</span>,length.out<span class="op">=</span><span class="fl">8</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>ID<span class="op">=</span><span class="fl">1</span>, <span class="va">ev1</span><span class="op">$</span><span class="fu">get.EventTable</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>ID<span class="op">=</span><span class="fl">2</span>, <span class="va">ev2</span><span class="op">$</span><span class="fu">get.EventTable</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## Note the number of subject is not needed since it is determined by the data</span></span>
<span><span class="va">sim</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rxSolve.html">rxSolve</a></span><span class="op">(</span><span class="va">mod</span>, <span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> parameter labels from comments are typically ignored in non-interactive mode</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Need to run with the source intact to parse comments</span></span>
<span><span class="co">#&gt; C model:</span></span>
<span><span class="co">#&gt; // Define translation state order for 4 states</span></span>
<span><span class="co">#&gt; #define __DDT0__ 0 // depot</span></span>
<span><span class="co">#&gt; #define _DEPOT_ 0 // depot</span></span>
<span><span class="co">#&gt; #define __DDT1__ 1 // centr</span></span>
<span><span class="co">#&gt; #define __DDT2__ 2 // peri</span></span>
<span><span class="co">#&gt; #define __DDT3__ 3 // eff</span></span>
<span><span class="co">#&gt; // Define 3 LHS values</span></span>
<span><span class="co">#&gt; #define _LHS_0_ 0 // C2</span></span>
<span><span class="co">#&gt; #define _LHS_1_ 1 // C3</span></span>
<span><span class="co">#&gt; #define _LHS_2_ 2 // CL</span></span>
<span><span class="co">#&gt; #define _getRxSolve_ _rxc2db6456dc1d107ac1d0565f2be219a2286__getRxSolve__Vaoj</span></span>
<span><span class="co">#&gt; #define _evalUdf _rxc2db6456dc1d107ac1d0565f2be219a2287__evalUdf_9xkq</span></span>
<span><span class="co">#&gt; #define _solveData _rxc2db6456dc1d107ac1d0565f2be219a2288__solveData_fOeJ</span></span>
<span><span class="co">#&gt; #define _assign_ptr _rxc2db6456dc1d107ac1d0565f2be219a2289__assign_ptr_blGk</span></span>
<span><span class="co">#&gt; #define _rxRmModelLib _rxc2db6456dc1d107ac1d0565f2be219a2290__rxRmModelLib_nQcu</span></span>
<span><span class="co">#&gt; #define _rxGetModelLib _rxc2db6456dc1d107ac1d0565f2be219a2291__rxGetModelLib_gtS8</span></span>
<span><span class="co">#&gt; #define _old_c _rxc2db6456dc1d107ac1d0565f2be219a2292__old_c_ZySW</span></span>
<span><span class="co">#&gt; #define _ptrid _rxc2db6456dc1d107ac1d0565f2be219a2293__ptrid_XbOp</span></span>
<span><span class="co">#&gt; #define _rxIsCurrentC _rxc2db6456dc1d107ac1d0565f2be219a2294__rxIsCurrentC_upRl</span></span>
<span><span class="co">#&gt; #define _sumPS _rxc2db6456dc1d107ac1d0565f2be219a2295__sumPS_W9nz</span></span>
<span><span class="co">#&gt; #define _prodPS _rxc2db6456dc1d107ac1d0565f2be219a2296__prodPS_Nl8X</span></span>
<span><span class="co">#&gt; #define _prodType _rxc2db6456dc1d107ac1d0565f2be219a2297__prodType_pDdx</span></span>
<span><span class="co">#&gt; #define _sumType _rxc2db6456dc1d107ac1d0565f2be219a2298__sumType_l3ox</span></span>
<span><span class="co">#&gt; #define _update_par_ptr _rxc2db6456dc1d107ac1d0565f2be219a2299__update_par_ptr_hL10</span></span>
<span><span class="co">#&gt; #define _getParCov _rxc2db6456dc1d107ac1d0565f2be219a2300__getParCov_prgx</span></span>
<span><span class="co">#&gt; #define _rxode2_rxAssignPtr _rxc2db6456dc1d107ac1d0565f2be219a2301__rxode2_rxAssignPtr_n8iB</span></span>
<span><span class="co">#&gt; #define _rxQr _rxc2db6456dc1d107ac1d0565f2be219a2302__rxQr_Czq6</span></span>
<span><span class="co">#&gt; #define _compareFactorVal _rxc2db6456dc1d107ac1d0565f2be219a2303__compareFactorVal_wPpF</span></span>
<span><span class="co">#&gt; #define _sum _rxc2db6456dc1d107ac1d0565f2be219a2304__sum_S16D</span></span>
<span><span class="co">#&gt; #define _udf _rxc2db6456dc1d107ac1d0565f2be219a2305__udf_k7NN</span></span>
<span><span class="co">#&gt; #define _sign _rxc2db6456dc1d107ac1d0565f2be219a2306__sign_WXX0</span></span>
<span><span class="co">#&gt; #define _prod _rxc2db6456dc1d107ac1d0565f2be219a2307__prod_AXSr</span></span>
<span><span class="co">#&gt; #define _max _rxc2db6456dc1d107ac1d0565f2be219a2308__max_Br3J</span></span>
<span><span class="co">#&gt; #define _min _rxc2db6456dc1d107ac1d0565f2be219a2309__min_7KG3</span></span>
<span><span class="co">#&gt; #define _transit4P _rxc2db6456dc1d107ac1d0565f2be219a2310__transit4P_GO65</span></span>
<span><span class="co">#&gt; #define _transit3P _rxc2db6456dc1d107ac1d0565f2be219a2311__transit3P_eqQ1</span></span>
<span><span class="co">#&gt; #define _assignFuns0 _rxc2db6456dc1d107ac1d0565f2be219a2312__assignFuns0_JnTj</span></span>
<span><span class="co">#&gt; #define _assignFuns _rxc2db6456dc1d107ac1d0565f2be219a2313__assignFuns_3jE8</span></span>
<span><span class="co">#&gt; #define _rxord _rxc2db6456dc1d107ac1d0565f2be219a2314__rxord_m9Qw</span></span>
<span><span class="co">#&gt; #define __assignFuns2 _rxc2db6456dc1d107ac1d0565f2be219a2315___assignFuns2_oDHN</span></span>
<span><span class="co">#&gt; #define _llikCauchyDscale _rxc2db6456dc1d107ac1d0565f2be219a2316__llikCauchyDscale_9v1a</span></span>
<span><span class="co">#&gt; #define _llikCauchyDlocation _rxc2db6456dc1d107ac1d0565f2be219a2317__llikCauchyDlocation_NCaN</span></span>
<span><span class="co">#&gt; #define _llikCauchy _rxc2db6456dc1d107ac1d0565f2be219a2318__llikCauchy_Y5AY</span></span>
<span><span class="co">#&gt; #define _llikGammaDrate _rxc2db6456dc1d107ac1d0565f2be219a2319__llikGammaDrate_DVeb</span></span>
<span><span class="co">#&gt; #define _llikGammaDshape _rxc2db6456dc1d107ac1d0565f2be219a2320__llikGammaDshape_eTU6</span></span>
<span><span class="co">#&gt; #define _llikGamma _rxc2db6456dc1d107ac1d0565f2be219a2321__llikGamma_83cw</span></span>
<span><span class="co">#&gt; #define _llikWeibullDscale _rxc2db6456dc1d107ac1d0565f2be219a2322__llikWeibullDscale_dxIU</span></span>
<span><span class="co">#&gt; #define _llikWeibullDshape _rxc2db6456dc1d107ac1d0565f2be219a2323__llikWeibullDshape_B7M8</span></span>
<span><span class="co">#&gt; #define _llikWeibull _rxc2db6456dc1d107ac1d0565f2be219a2324__llikWeibull_uE0z</span></span>
<span><span class="co">#&gt; #define _llikUnifDbeta _rxc2db6456dc1d107ac1d0565f2be219a2325__llikUnifDbeta_dHL1</span></span>
<span><span class="co">#&gt; #define _llikUnifDalpha _rxc2db6456dc1d107ac1d0565f2be219a2326__llikUnifDalpha_uh7y</span></span>
<span><span class="co">#&gt; #define _llikUnif _rxc2db6456dc1d107ac1d0565f2be219a2327__llikUnif_7i1b</span></span>
<span><span class="co">#&gt; #define _llikGeomDp _rxc2db6456dc1d107ac1d0565f2be219a2328__llikGeomDp_bYr8</span></span>
<span><span class="co">#&gt; #define _llikGeom _rxc2db6456dc1d107ac1d0565f2be219a2329__llikGeom_p4ZQ</span></span>
<span><span class="co">#&gt; #define _llikFDdf2 _rxc2db6456dc1d107ac1d0565f2be219a2330__llikFDdf2_nbD8</span></span>
<span><span class="co">#&gt; #define _llikFDdf1 _rxc2db6456dc1d107ac1d0565f2be219a2331__llikFDdf1_I1X2</span></span>
<span><span class="co">#&gt; #define _llikF _rxc2db6456dc1d107ac1d0565f2be219a2332__llikF_u8uJ</span></span>
<span><span class="co">#&gt; #define _llikExpDrate _rxc2db6456dc1d107ac1d0565f2be219a2333__llikExpDrate_iaaT</span></span>
<span><span class="co">#&gt; #define _llikExp _rxc2db6456dc1d107ac1d0565f2be219a2334__llikExp_DAI8</span></span>
<span><span class="co">#&gt; #define _llikChisqDdf _rxc2db6456dc1d107ac1d0565f2be219a2335__llikChisqDdf_F3U0</span></span>
<span><span class="co">#&gt; #define _llikChisq _rxc2db6456dc1d107ac1d0565f2be219a2336__llikChisq_HSfC</span></span>
<span><span class="co">#&gt; #define _llikTDsd _rxc2db6456dc1d107ac1d0565f2be219a2337__llikTDsd_Q5OV</span></span>
<span><span class="co">#&gt; #define _llikTDmean _rxc2db6456dc1d107ac1d0565f2be219a2338__llikTDmean_X4IS</span></span>
<span><span class="co">#&gt; #define _llikTDdf _rxc2db6456dc1d107ac1d0565f2be219a2339__llikTDdf_WheJ</span></span>
<span><span class="co">#&gt; #define _llikT _rxc2db6456dc1d107ac1d0565f2be219a2340__llikT_WWae</span></span>
<span><span class="co">#&gt; #define _llikBetaDshape2 _rxc2db6456dc1d107ac1d0565f2be219a2341__llikBetaDshape2_FZ8j</span></span>
<span><span class="co">#&gt; #define _llikBetaDshape1 _rxc2db6456dc1d107ac1d0565f2be219a2342__llikBetaDshape1_xI80</span></span>
<span><span class="co">#&gt; #define _llikBeta _rxc2db6456dc1d107ac1d0565f2be219a2343__llikBeta_U112</span></span>
<span><span class="co">#&gt; #define _llikNbinomMuDmu _rxc2db6456dc1d107ac1d0565f2be219a2344__llikNbinomMuDmu_w2La</span></span>
<span><span class="co">#&gt; #define _llikNbinomMu _rxc2db6456dc1d107ac1d0565f2be219a2345__llikNbinomMu_9bV7</span></span>
<span><span class="co">#&gt; #define _llikNbinomDprob _rxc2db6456dc1d107ac1d0565f2be219a2346__llikNbinomDprob_N6xI</span></span>
<span><span class="co">#&gt; #define _llikNbinom _rxc2db6456dc1d107ac1d0565f2be219a2347__llikNbinom_MJk0</span></span>
<span><span class="co">#&gt; #define _llikBinomDprob _rxc2db6456dc1d107ac1d0565f2be219a2348__llikBinomDprob_jHvl</span></span>
<span><span class="co">#&gt; #define _llikBinom _rxc2db6456dc1d107ac1d0565f2be219a2349__llikBinom_xTGE</span></span>
<span><span class="co">#&gt; #define _llikPoisDlambda _rxc2db6456dc1d107ac1d0565f2be219a2350__llikPoisDlambda_rsm8</span></span>
<span><span class="co">#&gt; #define _llikPois _rxc2db6456dc1d107ac1d0565f2be219a2351__llikPois_eoul</span></span>
<span><span class="co">#&gt; #define _llikNormDsd _rxc2db6456dc1d107ac1d0565f2be219a2352__llikNormDsd_HI69</span></span>
<span><span class="co">#&gt; #define _llikNormDmean _rxc2db6456dc1d107ac1d0565f2be219a2353__llikNormDmean_BpBR</span></span>
<span><span class="co">#&gt; #define _llikNorm _rxc2db6456dc1d107ac1d0565f2be219a2354__llikNorm_YoQF</span></span>
<span><span class="co">#&gt; #define simeps _rxc2db6456dc1d107ac1d0565f2be219a2355_simeps_Gl8i</span></span>
<span><span class="co">#&gt; #define simeta _rxc2db6456dc1d107ac1d0565f2be219a2356_simeta_fPX7</span></span>
<span><span class="co">#&gt; #define expit _rxc2db6456dc1d107ac1d0565f2be219a2357_expit_kbOk</span></span>
<span><span class="co">#&gt; #define logit _rxc2db6456dc1d107ac1d0565f2be219a2358_logit_UR3R</span></span>
<span><span class="co">#&gt; #define gammapDer _rxc2db6456dc1d107ac1d0565f2be219a2359_gammapDer_0cxY</span></span>
<span><span class="co">#&gt; #define lowergamma _rxc2db6456dc1d107ac1d0565f2be219a2360_lowergamma_CG1i</span></span>
<span><span class="co">#&gt; #define uppergamma _rxc2db6456dc1d107ac1d0565f2be219a2361_uppergamma_PGJk</span></span>
<span><span class="co">#&gt; #define gammaqInva _rxc2db6456dc1d107ac1d0565f2be219a2362_gammaqInva_jzI2</span></span>
<span><span class="co">#&gt; #define gammaqInv _rxc2db6456dc1d107ac1d0565f2be219a2363_gammaqInv_kItb</span></span>
<span><span class="co">#&gt; #define gammapInva _rxc2db6456dc1d107ac1d0565f2be219a2364_gammapInva_aBdx</span></span>
<span><span class="co">#&gt; #define gammapInv _rxc2db6456dc1d107ac1d0565f2be219a2365_gammapInv_vufd</span></span>
<span><span class="co">#&gt; #define gammaq _rxc2db6456dc1d107ac1d0565f2be219a2366_gammaq_Isq6</span></span>
<span><span class="co">#&gt; #define gammap _rxc2db6456dc1d107ac1d0565f2be219a2367_gammap_9enN</span></span>
<span><span class="co">#&gt; #define phi _rxc2db6456dc1d107ac1d0565f2be219a2368_phi_xL3f</span></span>
<span><span class="co">#&gt; #define d2ELUa _rxc2db6456dc1d107ac1d0565f2be219a2369_d2ELUa_Ypol</span></span>
<span><span class="co">#&gt; #define dELUa _rxc2db6456dc1d107ac1d0565f2be219a2370_dELUa_0xIK</span></span>
<span><span class="co">#&gt; #define d2aELU _rxc2db6456dc1d107ac1d0565f2be219a2371_d2aELU_JCgF</span></span>
<span><span class="co">#&gt; #define d2ELU _rxc2db6456dc1d107ac1d0565f2be219a2372_d2ELU_NmXy</span></span>
<span><span class="co">#&gt; #define dELU _rxc2db6456dc1d107ac1d0565f2be219a2373_dELU_kPca</span></span>
<span><span class="co">#&gt; #define ELU _rxc2db6456dc1d107ac1d0565f2be219a2374_ELU_SQGe</span></span>
<span><span class="co">#&gt; #define dPReLUa1 _rxc2db6456dc1d107ac1d0565f2be219a2375_dPReLUa1_bE5B</span></span>
<span><span class="co">#&gt; #define dPReLUa _rxc2db6456dc1d107ac1d0565f2be219a2376_dPReLUa_1yeg</span></span>
<span><span class="co">#&gt; #define dPReLU _rxc2db6456dc1d107ac1d0565f2be219a2377_dPReLU_FeCE</span></span>
<span><span class="co">#&gt; #define PReLU _rxc2db6456dc1d107ac1d0565f2be219a2378_PReLU_Vukc</span></span>
<span><span class="co">#&gt; #define dSwish _rxc2db6456dc1d107ac1d0565f2be219a2379_dSwish_GHuo</span></span>
<span><span class="co">#&gt; #define Swish _rxc2db6456dc1d107ac1d0565f2be219a2380_Swish_ARTH</span></span>
<span><span class="co">#&gt; #define dlReLU _rxc2db6456dc1d107ac1d0565f2be219a2381_dlReLU_xSmZ</span></span>
<span><span class="co">#&gt; #define lReLU _rxc2db6456dc1d107ac1d0565f2be219a2382_lReLU_rAF2</span></span>
<span><span class="co">#&gt; #define dSELU _rxc2db6456dc1d107ac1d0565f2be219a2383_dSELU_ZZsK</span></span>
<span><span class="co">#&gt; #define SELU _rxc2db6456dc1d107ac1d0565f2be219a2384_SELU_G2LP</span></span>
<span><span class="co">#&gt; #define d4softplus _rxc2db6456dc1d107ac1d0565f2be219a2385_d4softplus_1qBg</span></span>
<span><span class="co">#&gt; #define d3softplus _rxc2db6456dc1d107ac1d0565f2be219a2386_d3softplus_0fWO</span></span>
<span><span class="co">#&gt; #define d2softplus _rxc2db6456dc1d107ac1d0565f2be219a2387_d2softplus_VS5I</span></span>
<span><span class="co">#&gt; #define dsoftplus _rxc2db6456dc1d107ac1d0565f2be219a2388_dsoftplus_1hpY</span></span>
<span><span class="co">#&gt; #define softplus _rxc2db6456dc1d107ac1d0565f2be219a2389_softplus_yEzw</span></span>
<span><span class="co">#&gt; #define d4GELU _rxc2db6456dc1d107ac1d0565f2be219a2390_d4GELU_Nzgn</span></span>
<span><span class="co">#&gt; #define d3GELU _rxc2db6456dc1d107ac1d0565f2be219a2391_d3GELU_epKf</span></span>
<span><span class="co">#&gt; #define d2GELU _rxc2db6456dc1d107ac1d0565f2be219a2392_d2GELU_egrF</span></span>
<span><span class="co">#&gt; #define dGELU _rxc2db6456dc1d107ac1d0565f2be219a2393_dGELU_8t09</span></span>
<span><span class="co">#&gt; #define GELU _rxc2db6456dc1d107ac1d0565f2be219a2394_GELU_Y5xW</span></span>
<span><span class="co">#&gt; #define dReLU _rxc2db6456dc1d107ac1d0565f2be219a2395_dReLU_Pym9</span></span>
<span><span class="co">#&gt; #define ReLU _rxc2db6456dc1d107ac1d0565f2be219a2396_ReLU_UDEX</span></span>
<span><span class="co">#&gt; #define riweibull _rxc2db6456dc1d107ac1d0565f2be219a2397_riweibull_MOf4</span></span>
<span><span class="co">#&gt; #define riunif _rxc2db6456dc1d107ac1d0565f2be219a2398_riunif_mRid</span></span>
<span><span class="co">#&gt; #define rit_ _rxc2db6456dc1d107ac1d0565f2be219a2399_rit__m39x</span></span>
<span><span class="co">#&gt; #define ripois _rxc2db6456dc1d107ac1d0565f2be219a2400_ripois_jiFE</span></span>
<span><span class="co">#&gt; #define ribeta _rxc2db6456dc1d107ac1d0565f2be219a2401_ribeta_pjmW</span></span>
<span><span class="co">#&gt; #define rigamma _rxc2db6456dc1d107ac1d0565f2be219a2402_rigamma_EuSr</span></span>
<span><span class="co">#&gt; #define rigeom _rxc2db6456dc1d107ac1d0565f2be219a2403_rigeom_X2fg</span></span>
<span><span class="co">#&gt; #define rif _rxc2db6456dc1d107ac1d0565f2be219a2404_rif_ccvo</span></span>
<span><span class="co">#&gt; #define riexp _rxc2db6456dc1d107ac1d0565f2be219a2405_riexp_gQjd</span></span>
<span><span class="co">#&gt; #define richisq _rxc2db6456dc1d107ac1d0565f2be219a2406_richisq_SxjK</span></span>
<span><span class="co">#&gt; #define ricauchy _rxc2db6456dc1d107ac1d0565f2be219a2407_ricauchy_YDx2</span></span>
<span><span class="co">#&gt; #define rinbinomMu _rxc2db6456dc1d107ac1d0565f2be219a2408_rinbinomMu_EoAo</span></span>
<span><span class="co">#&gt; #define rinbinom _rxc2db6456dc1d107ac1d0565f2be219a2409_rinbinom_YFjR</span></span>
<span><span class="co">#&gt; #define ribinom _rxc2db6456dc1d107ac1d0565f2be219a2410_ribinom_HKKt</span></span>
<span><span class="co">#&gt; #define rinorm _rxc2db6456dc1d107ac1d0565f2be219a2411_rinorm_kaKz</span></span>
<span><span class="co">#&gt; #define rxweibull _rxc2db6456dc1d107ac1d0565f2be219a2412_rxweibull_7SFM</span></span>
<span><span class="co">#&gt; #define rxunif _rxc2db6456dc1d107ac1d0565f2be219a2413_rxunif_H4zk</span></span>
<span><span class="co">#&gt; #define rxt_ _rxc2db6456dc1d107ac1d0565f2be219a2414_rxt__6zQQ</span></span>
<span><span class="co">#&gt; #define rxpois _rxc2db6456dc1d107ac1d0565f2be219a2415_rxpois_bQJb</span></span>
<span><span class="co">#&gt; #define rxbeta _rxc2db6456dc1d107ac1d0565f2be219a2416_rxbeta_vvZh</span></span>
<span><span class="co">#&gt; #define rxgamma _rxc2db6456dc1d107ac1d0565f2be219a2417_rxgamma_xRbw</span></span>
<span><span class="co">#&gt; #define rxgeom _rxc2db6456dc1d107ac1d0565f2be219a2418_rxgeom_oyS6</span></span>
<span><span class="co">#&gt; #define rxf _rxc2db6456dc1d107ac1d0565f2be219a2419_rxf_AagP</span></span>
<span><span class="co">#&gt; #define rxexp _rxc2db6456dc1d107ac1d0565f2be219a2420_rxexp_RNyr</span></span>
<span><span class="co">#&gt; #define rxchisq _rxc2db6456dc1d107ac1d0565f2be219a2421_rxchisq_gWz3</span></span>
<span><span class="co">#&gt; #define rxcauchy _rxc2db6456dc1d107ac1d0565f2be219a2422_rxcauchy_ZsGr</span></span>
<span><span class="co">#&gt; #define rxnbinomMu _rxc2db6456dc1d107ac1d0565f2be219a2423_rxnbinomMu_k6bc</span></span>
<span><span class="co">#&gt; #define rxnbinom _rxc2db6456dc1d107ac1d0565f2be219a2424_rxnbinom_B8sn</span></span>
<span><span class="co">#&gt; #define rxbinom _rxc2db6456dc1d107ac1d0565f2be219a2425_rxbinom_zwc8</span></span>
<span><span class="co">#&gt; #define rxnorm _rxc2db6456dc1d107ac1d0565f2be219a2426_rxnorm_6J2u</span></span>
<span><span class="co">#&gt; #define linCmtB _rxc2db6456dc1d107ac1d0565f2be219a2427_linCmtB_b58Z</span></span>
<span><span class="co">#&gt; #define linCmtA _rxc2db6456dc1d107ac1d0565f2be219a2428_linCmtA_JhNT</span></span>
<span><span class="co">#&gt; #include &lt;rxode2_model_shared.h&gt;</span></span>
<span><span class="co">#&gt; #define __MAX_PROD__ 0</span></span>
<span><span class="co">#&gt; #define _CMT CMT</span></span>
<span><span class="co">#&gt; #define _SYNC_simeps_ for (int _svari=_solveData-&gt;neps; _svari--;){  if (_solveData-&gt;svar[_svari] == 0) {KA = _PP[0];};   if (_solveData-&gt;svar[_svari] == 1) {TCl = _PP[1];};   if (_solveData-&gt;svar[_svari] == 2) {V2 = _PP[2];};   if (_solveData-&gt;svar[_svari] == 3) {Q = _PP[3];};   if (_solveData-&gt;svar[_svari] == 4) {V3 = _PP[4];};   if (_solveData-&gt;svar[_svari] == 5) {Kin = _PP[5];};   if (_solveData-&gt;svar[_svari] == 6) {Kout = _PP[6];};   if (_solveData-&gt;svar[_svari] == 7) {EC50 = _PP[7];};   if (_solveData-&gt;svar[_svari] == 8) {eta_DoT_Cl = _PP[8];}; }</span></span>
<span><span class="co">#&gt; #define _SYNC_simeta_ for (int _ovari=_solveData-&gt;neta; _ovari--;){  if (_solveData-&gt;ovar[_ovari] == 0) {KA = _PP[0];};   if (_solveData-&gt;ovar[_ovari] == 1) {TCl = _PP[1];};   if (_solveData-&gt;ovar[_ovari] == 2) {V2 = _PP[2];};   if (_solveData-&gt;ovar[_ovari] == 3) {Q = _PP[3];};   if (_solveData-&gt;ovar[_ovari] == 4) {V3 = _PP[4];};   if (_solveData-&gt;ovar[_ovari] == 5) {Kin = _PP[5];};   if (_solveData-&gt;ovar[_ovari] == 6) {Kout = _PP[6];};   if (_solveData-&gt;ovar[_ovari] == 7) {EC50 = _PP[7];};   if (_solveData-&gt;ovar[_ovari] == 8) {eta_DoT_Cl = _PP[8];}; }</span></span>
<span><span class="co">#&gt; _getRxSolve_t _getRxSolve_;</span></span>
<span><span class="co">#&gt; _simfun simeps;</span></span>
<span><span class="co">#&gt; _simfun simeta;</span></span>
<span><span class="co">#&gt; _udf_type _evalUdf=NULL;</span></span>
<span><span class="co">#&gt; rx_solve *_solveData=NULL;</span></span>
<span><span class="co">#&gt; rxode2_assign_ptr _assign_ptr=NULL;</span></span>
<span><span class="co">#&gt; _rxRmModelLibType _rxRmModelLib=NULL;</span></span>
<span><span class="co">#&gt; _rxGetModelLibType _rxGetModelLib=NULL;</span></span>
<span><span class="co">#&gt; rxode2_ode_solver_old_c _old_c=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _ptrid=NULL;</span></span>
<span><span class="co">#&gt; _rxIsCurrentC_type _rxIsCurrentC=NULL;</span></span>
<span><span class="co">#&gt; _rxSumType _sumPS=NULL;</span></span>
<span><span class="co">#&gt; _rxProdType _prodPS=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _prodType=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _sumType=NULL;</span></span>
<span><span class="co">#&gt; _update_par_ptr_p _update_par_ptr=NULL;</span></span>
<span><span class="co">#&gt; _getParCov_p _getParCov=NULL;</span></span>
<span><span class="co">#&gt; linCmtA_p linCmtA;</span></span>
<span><span class="co">#&gt; linCmtB_p linCmtB;</span></span>
<span><span class="co">#&gt; _rx_asgn _rxode2_rxAssignPtr=NULL;</span></span>
<span><span class="co">#&gt; _rx_asgn _rxQr=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn phi;</span></span>
<span><span class="co">#&gt; rxode2_fn ReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn dReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn dGELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d2GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d3GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d4GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn dsoftplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d2softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d3softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d4softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn SELU;</span></span>
<span><span class="co">#&gt; rxode2_fn dSELU;</span></span>
<span><span class="co">#&gt; rxode2_fn lReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn dlReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn Swish;</span></span>
<span><span class="co">#&gt; rxode2_fn dSwish;</span></span>
<span><span class="co">#&gt; rxode2_fn2 PReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLUa;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLUa1;</span></span>
<span><span class="co">#&gt; rxode2_fn2 ELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2ELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2aELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dELUa;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2ELUa;</span></span>
<span><span class="co">#&gt; rxode2_fn3 logit;</span></span>
<span><span class="co">#&gt; rxode2_fn3 expit;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammap;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaq;</span></span>
<span><span class="co">#&gt; rxode2_fn2 lowergamma;</span></span>
<span><span class="co">#&gt; rxode2_fn2 uppergamma;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapInv;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapDer;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapInva;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaqInv;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaqInva;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxnorm;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxbinom;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxnbinom;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxnbinomMu;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxcauchy;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxchisq;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxexp;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxf;</span></span>
<span><span class="co">#&gt; rxode2i_ifn rxgeom;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxgamma;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxbeta;</span></span>
<span><span class="co">#&gt; rxode2i_ifn rxpois;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxt_;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxunif;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxweibull;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rinorm;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom ribinom;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom rinbinom;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom rinbinomMu;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 ricauchy;</span></span>
<span><span class="co">#&gt; rxode2i2_fn richisq;</span></span>
<span><span class="co">#&gt; rxode2i2_fn riexp;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rif;</span></span>
<span><span class="co">#&gt; rxode2i2_ifn rigeom;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rigamma;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 ribeta;</span></span>
<span><span class="co">#&gt; rxode2i2_ifn ripois;</span></span>
<span><span class="co">#&gt; rxode2i2_fn rit_;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 riunif;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 riweibull;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNorm;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNormDmean;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNormDsd;</span></span>
<span><span class="co">#&gt; rxode2_llikPoisFun _llikPois;</span></span>
<span><span class="co">#&gt; rxode2_llikPoisFun _llikPoisDlambda;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikBinom;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikBinomDprob;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinom;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomDprob;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomMu;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomMuDmu;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBeta;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBetaDshape1;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBetaDshape2;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikT;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDdf;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDmean;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDsd;</span></span>
<span><span class="co">#&gt; rxode2_llikChisqFun _llikChisq;</span></span>
<span><span class="co">#&gt; rxode2_llikChisqFun _llikChisqDdf;</span></span>
<span><span class="co">#&gt; rxode2_llikExpFun _llikExp;</span></span>
<span><span class="co">#&gt; rxode2_llikExpFun _llikExpDrate;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikF;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikFDdf1;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikFDdf2;</span></span>
<span><span class="co">#&gt; rxode2_llikGeomFun _llikGeom;</span></span>
<span><span class="co">#&gt; rxode2_llikGeomFun _llikGeomDp;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnif;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnifDalpha;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnifDbeta;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibull;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibullDshape;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibullDscale;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGamma;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGammaDshape;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGammaDrate;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchy;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchyDlocation;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchyDscale;</span></span>
<span><span class="co">#&gt; rxode2_compareFactorVal_fn _compareFactorVal;</span></span>
<span><span class="co">#&gt; #include "extraC.h"</span></span>
<span><span class="co">#&gt; double _prod(double *input, double *p, int type, int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return _prodPS(input, p, n, type);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _udf(const char *funName, double *input, int n, ...) {</span></span>
<span><span class="co">#&gt;   if (n == -42) Rf_error("%s", "this has a ui user function that cannot be called directly");</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return _evalUdf(funName, n, input);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _sum(double *input, double *pld, int m, int type, int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   double ret = _sumPS(input, n, pld, m, type);</span></span>
<span><span class="co">#&gt;   if (type == 2 &amp;&amp; m &lt; 0){</span></span>
<span><span class="co">#&gt;     for (int i = -m; i--;){</span></span>
<span><span class="co">#&gt;       pld[i] = 0.0;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return ret;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _sign(unsigned int n, ...) {</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double s = 1;</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;     s = sign(va_arg(valist, double))*s;</span></span>
<span><span class="co">#&gt;     if (s == 0){</span></span>
<span><span class="co">#&gt;       break;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return s;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _rxord(int _cSub, unsigned int n,  ...) {</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind* ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   if (!ind-&gt;inLhs) {</span></span>
<span><span class="co">#&gt;     return 1.0;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double ret = 1.0;</span></span>
<span><span class="co">#&gt;   double p = 0.0;</span></span>
<span><span class="co">#&gt;   double u = rxunif(ind, 0.0, 1.0);</span></span>
<span><span class="co">#&gt;   int found = 0;</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;     p += va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     if (!found) {</span></span>
<span><span class="co">#&gt;       if (u &lt; p) {</span></span>
<span><span class="co">#&gt;         ret = (double)(i+1);</span></span>
<span><span class="co">#&gt;         found = 1;</span></span>
<span><span class="co">#&gt;       }</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   if (!found) ret =(double)(n+1);</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return ret;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _max(unsigned int n, ...) {</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double mx = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tmp = 0;</span></span>
<span><span class="co">#&gt;   if (n &gt;= 1){</span></span>
<span><span class="co">#&gt;     mx = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     for (unsigned int i = 1; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;       tmp = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;       if (tmp&gt;mx) mx=tmp;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     va_end(valist);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return mx;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _min(unsigned int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double mn = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tmp = 0;</span></span>
<span><span class="co">#&gt;   if (n &gt;= 1){</span></span>
<span><span class="co">#&gt;     mn = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     for (unsigned int i = 1; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;       tmp = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;       if (tmp&lt;mn) mn=tmp;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     va_end(valist);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return mn;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _transit4P(int cmt, double t, unsigned int id, double n, double mtt, double bio){</span></span>
<span><span class="co">#&gt;   double nd = (double) n;</span></span>
<span><span class="co">#&gt;   double ktr = (nd+1)/mtt;</span></span>
<span><span class="co">#&gt;   double lktr = _safe_log(nd+1)-_safe_log(mtt);</span></span>
<span><span class="co">#&gt;   double tlast = _solveData-&gt;subjects[id].tlastS[cmt];</span></span>
<span><span class="co">#&gt;   double dose = _solveData-&gt;subjects[id].curDoseS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(dose)) dose = 0.0;</span></span>
<span><span class="co">#&gt;   if (ISNA(tlast)) tlast = 0.0;</span></span>
<span><span class="co">#&gt;   double tad = (t-tlast);</span></span>
<span><span class="co">#&gt;   return exp(_safe_log(bio*dose)+lktr+n*(lktr+_safe_log(tad))-ktr*(tad)-lgamma1p(nd));</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _transit3P(int cmt, double t, unsigned int id, double n, double mtt){</span></span>
<span><span class="co">#&gt;   double nd = (double) n;</span></span>
<span><span class="co">#&gt;   double ktr = (nd+1)/mtt;</span></span>
<span><span class="co">#&gt;   double lktr = _safe_log(nd+1)-_safe_log(mtt);</span></span>
<span><span class="co">#&gt;   double tlast = _solveData-&gt;subjects[id].tlastS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(tlast)) tlast = 0.0;</span></span>
<span><span class="co">#&gt;   double tad = t-tlast;</span></span>
<span><span class="co">#&gt;   double podo = _solveData-&gt;subjects[id].curDoseS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(podo)) podo = 0.0;</span></span>
<span><span class="co">#&gt;   return exp(_safe_log(podo)+lktr+n*(lktr+_safe_log(tad))-ktr*(tad)-lgamma1p(nd));</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void _assignFuns0(void) {</span></span>
<span><span class="co">#&gt;   _evalUdf = (_udf_type) R_GetCCallable("rxode2", "_rxode2_evalUdf");</span></span>
<span><span class="co">#&gt;   _getRxSolve_ = (_getRxSolve_t) R_GetCCallable("rxode2","getRxSolve_");</span></span>
<span><span class="co">#&gt;   _assign_ptr=(rxode2_assign_ptr) R_GetCCallable("rxode2","rxode2_assign_fn_pointers");</span></span>
<span><span class="co">#&gt;   _rxRmModelLib=(_rxRmModelLibType) R_GetCCallable("rxode2","rxRmModelLib");</span></span>
<span><span class="co">#&gt;   _rxGetModelLib=(_rxGetModelLibType) R_GetCCallable("rxode2","rxGetModelLib");</span></span>
<span><span class="co">#&gt;   _rxode2_rxAssignPtr=(_rx_asgn)R_GetCCallable("rxode2","_rxode2_rxAssignPtr");</span></span>
<span><span class="co">#&gt;   _rxQr=(_rx_asgn)R_GetCCallable("rxode2","_rxode2_rxQr");</span></span>
<span><span class="co">#&gt;   _rxIsCurrentC = (_rxIsCurrentC_type)R_GetCCallable("rxode2","rxIsCurrentC");</span></span>
<span><span class="co">#&gt;   _sumPS  = (_rxSumType) R_GetCCallable("PreciseSums","PreciseSums_sum_r");</span></span>
<span><span class="co">#&gt;   _prodPS = (_rxProdType) R_GetCCallable("PreciseSums","PreciseSums_prod_r");</span></span>
<span><span class="co">#&gt;   _prodType=(rxode2_fn0i)R_GetCCallable("PreciseSums", "PreciseSums_prod_get");</span></span>
<span><span class="co">#&gt;   _sumType=(rxode2_fn0i)R_GetCCallable("PreciseSums", "PreciseSums_sum_get");</span></span>
<span><span class="co">#&gt;   _ptrid=(rxode2_fn0i)R_GetCCallable("rxode2", "rxode2_current_fn_pointer_id");</span></span>
<span><span class="co">#&gt;   _compareFactorVal=(rxode2_compareFactorVal_fn) R_GetCCallable("rxode2", "compareFactorVal");</span></span>
<span><span class="co">#&gt;   _update_par_ptr = (_update_par_ptr_p) R_GetCCallable("rxode2","_update_par_ptr");</span></span>
<span><span class="co">#&gt;   _getParCov = (_getParCov_p) R_GetCCallable("rxode2","_getParCov");</span></span>
<span><span class="co">#&gt;   // dynamic start</span></span>
<span><span class="co">#&gt;   _llikCauchyDscale = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchyDscale");</span></span>
<span><span class="co">#&gt;   _llikCauchyDlocation = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchyDlocation");</span></span>
<span><span class="co">#&gt;   _llikCauchy = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchy");</span></span>
<span><span class="co">#&gt;   _llikGammaDrate = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGammaDrate");</span></span>
<span><span class="co">#&gt;   _llikGammaDshape = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGammaDshape");</span></span>
<span><span class="co">#&gt;   _llikGamma = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGamma");</span></span>
<span><span class="co">#&gt;   _llikWeibullDscale = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibullDscale");</span></span>
<span><span class="co">#&gt;   _llikWeibullDshape = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibullDshape");</span></span>
<span><span class="co">#&gt;   _llikWeibull = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibull");</span></span>
<span><span class="co">#&gt;   _llikUnifDbeta = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnifDbeta");</span></span>
<span><span class="co">#&gt;   _llikUnifDalpha = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnifDalpha");</span></span>
<span><span class="co">#&gt;   _llikUnif = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnif");</span></span>
<span><span class="co">#&gt;   _llikGeomDp = (rxode2_llikGeomFun) R_GetCCallable("rxode2ll", "rxLlikGeomDp");</span></span>
<span><span class="co">#&gt;   _llikGeom = (rxode2_llikGeomFun) R_GetCCallable("rxode2ll", "rxLlikGeom");</span></span>
<span><span class="co">#&gt;   _llikFDdf2 = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikFDdf2");</span></span>
<span><span class="co">#&gt;   _llikFDdf1 = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikFDdf1");</span></span>
<span><span class="co">#&gt;   _llikF = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikF");</span></span>
<span><span class="co">#&gt;   _llikExpDrate = (rxode2_llikExpFun) R_GetCCallable("rxode2ll", "rxLlikExpDrate");</span></span>
<span><span class="co">#&gt;   _llikExp = (rxode2_llikExpFun) R_GetCCallable("rxode2ll", "rxLlikExp");</span></span>
<span><span class="co">#&gt;   _llikChisqDdf = (rxode2_llikChisqFun) R_GetCCallable("rxode2ll", "rxLlikChisqDdf");</span></span>
<span><span class="co">#&gt;   _llikChisq = (rxode2_llikChisqFun) R_GetCCallable("rxode2ll", "rxLlikChisq");</span></span>
<span><span class="co">#&gt;   _llikTDsd = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDsd");</span></span>
<span><span class="co">#&gt;   _llikTDmean = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDmean");</span></span>
<span><span class="co">#&gt;   _llikTDdf = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDdf");</span></span>
<span><span class="co">#&gt;   _llikT = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikT");</span></span>
<span><span class="co">#&gt;   _llikBetaDshape2 = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBetaDshape2");</span></span>
<span><span class="co">#&gt;   _llikBetaDshape1 = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBetaDshape1");</span></span>
<span><span class="co">#&gt;   _llikBeta = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBeta");</span></span>
<span><span class="co">#&gt;   _llikNbinomMuDmu = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomMuDmu");</span></span>
<span><span class="co">#&gt;   _llikNbinomMu = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomMu");</span></span>
<span><span class="co">#&gt;   _llikNbinomDprob = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomDprob");</span></span>
<span><span class="co">#&gt;   _llikNbinom = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinom");</span></span>
<span><span class="co">#&gt;   _llikBinomDprob = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikBinomDprob");</span></span>
<span><span class="co">#&gt;   _llikBinom = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikBinom");</span></span>
<span><span class="co">#&gt;   _llikPoisDlambda = (rxode2_llikPoisFun) R_GetCCallable("rxode2ll", "rxLlikPoisDlambda");</span></span>
<span><span class="co">#&gt;   _llikPois = (rxode2_llikPoisFun) R_GetCCallable("rxode2ll", "rxLlikPois");</span></span>
<span><span class="co">#&gt;   _llikNormDsd = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNormDsd");</span></span>
<span><span class="co">#&gt;   _llikNormDmean = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNormDmean");</span></span>
<span><span class="co">#&gt;   _llikNorm = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNorm");</span></span>
<span><span class="co">#&gt;   simeps = (_simfun) R_GetCCallable("rxode2", "simeps");</span></span>
<span><span class="co">#&gt;   simeta = (_simfun) R_GetCCallable("rxode2", "simeta");</span></span>
<span><span class="co">#&gt;   expit = (rxode2_fn3) R_GetCCallable("rxode2", "expit");</span></span>
<span><span class="co">#&gt;   logit = (rxode2_fn3) R_GetCCallable("rxode2", "logit");</span></span>
<span><span class="co">#&gt;   gammapDer = (rxode2_fn2) R_GetCCallable("rxode2", "gammapDer");</span></span>
<span><span class="co">#&gt;   lowergamma = (rxode2_fn2) R_GetCCallable("rxode2", "lowergamma");</span></span>
<span><span class="co">#&gt;   uppergamma = (rxode2_fn2) R_GetCCallable("rxode2", "uppergamma");</span></span>
<span><span class="co">#&gt;   gammaqInva = (rxode2_fn2) R_GetCCallable("rxode2", "gammaqInva");</span></span>
<span><span class="co">#&gt;   gammaqInv = (rxode2_fn2) R_GetCCallable("rxode2", "gammaqInv");</span></span>
<span><span class="co">#&gt;   gammapInva = (rxode2_fn2) R_GetCCallable("rxode2", "gammapInva");</span></span>
<span><span class="co">#&gt;   gammapInv = (rxode2_fn2) R_GetCCallable("rxode2", "gammapInv");</span></span>
<span><span class="co">#&gt;   gammaq = (rxode2_fn2) R_GetCCallable("rxode2", "gammaq");</span></span>
<span><span class="co">#&gt;   gammap = (rxode2_fn2) R_GetCCallable("rxode2", "gammap");</span></span>
<span><span class="co">#&gt;   phi = (rxode2_fn) R_GetCCallable("rxode2", "phi");</span></span>
<span><span class="co">#&gt;   d2ELUa = (rxode2_fn2) R_GetCCallable("rxode2", "d2ELUa");</span></span>
<span><span class="co">#&gt;   dELUa = (rxode2_fn2) R_GetCCallable("rxode2", "dELUa");</span></span>
<span><span class="co">#&gt;   d2aELU = (rxode2_fn2) R_GetCCallable("rxode2", "d2aELU");</span></span>
<span><span class="co">#&gt;   d2ELU = (rxode2_fn2) R_GetCCallable("rxode2", "d2ELU");</span></span>
<span><span class="co">#&gt;   dELU = (rxode2_fn2) R_GetCCallable("rxode2", "dELU");</span></span>
<span><span class="co">#&gt;   ELU = (rxode2_fn2) R_GetCCallable("rxode2", "ELU");</span></span>
<span><span class="co">#&gt;   dPReLUa1 = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLUa1");</span></span>
<span><span class="co">#&gt;   dPReLUa = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLUa");</span></span>
<span><span class="co">#&gt;   dPReLU = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLU");</span></span>
<span><span class="co">#&gt;   PReLU = (rxode2_fn2) R_GetCCallable("rxode2", "PReLU");</span></span>
<span><span class="co">#&gt;   dSwish = (rxode2_fn) R_GetCCallable("rxode2", "dSwish");</span></span>
<span><span class="co">#&gt;   Swish = (rxode2_fn) R_GetCCallable("rxode2", "Swish");</span></span>
<span><span class="co">#&gt;   dlReLU = (rxode2_fn) R_GetCCallable("rxode2", "dlReLU");</span></span>
<span><span class="co">#&gt;   lReLU = (rxode2_fn) R_GetCCallable("rxode2", "lReLU");</span></span>
<span><span class="co">#&gt;   dSELU = (rxode2_fn) R_GetCCallable("rxode2", "dSELU");</span></span>
<span><span class="co">#&gt;   SELU = (rxode2_fn) R_GetCCallable("rxode2", "SELU");</span></span>
<span><span class="co">#&gt;   d4softplus = (rxode2_fn) R_GetCCallable("rxode2", "d4softplus");</span></span>
<span><span class="co">#&gt;   d3softplus = (rxode2_fn) R_GetCCallable("rxode2", "d3softplus");</span></span>
<span><span class="co">#&gt;   d2softplus = (rxode2_fn) R_GetCCallable("rxode2", "d2softplus");</span></span>
<span><span class="co">#&gt;   dsoftplus = (rxode2_fn) R_GetCCallable("rxode2", "dsoftplus");</span></span>
<span><span class="co">#&gt;   softplus = (rxode2_fn) R_GetCCallable("rxode2", "softplus");</span></span>
<span><span class="co">#&gt;   d4GELU = (rxode2_fn) R_GetCCallable("rxode2", "d4GELU");</span></span>
<span><span class="co">#&gt;   d3GELU = (rxode2_fn) R_GetCCallable("rxode2", "d3GELU");</span></span>
<span><span class="co">#&gt;   d2GELU = (rxode2_fn) R_GetCCallable("rxode2", "d2GELU");</span></span>
<span><span class="co">#&gt;   dGELU = (rxode2_fn) R_GetCCallable("rxode2", "dGELU");</span></span>
<span><span class="co">#&gt;   GELU = (rxode2_fn) R_GetCCallable("rxode2", "GELU");</span></span>
<span><span class="co">#&gt;   dReLU = (rxode2_fn) R_GetCCallable("rxode2", "dReLU");</span></span>
<span><span class="co">#&gt;   ReLU = (rxode2_fn) R_GetCCallable("rxode2", "ReLU");</span></span>
<span><span class="co">#&gt;   riweibull = (rxode2i2_fn2) R_GetCCallable("rxode2", "riweibull");</span></span>
<span><span class="co">#&gt;   riunif = (rxode2i2_fn2) R_GetCCallable("rxode2", "riunif");</span></span>
<span><span class="co">#&gt;   rit_ = (rxode2i2_fn) R_GetCCallable("rxode2", "rit_");</span></span>
<span><span class="co">#&gt;   ripois = (rxode2i2_ifn) R_GetCCallable("rxode2", "ripois");</span></span>
<span><span class="co">#&gt;   ribeta = (rxode2i2_fn2) R_GetCCallable("rxode2", "ribeta");</span></span>
<span><span class="co">#&gt;   rigamma = (rxode2i2_fn2) R_GetCCallable("rxode2", "rigamma");</span></span>
<span><span class="co">#&gt;   rigeom = (rxode2i2_ifn) R_GetCCallable("rxode2", "rigeom");</span></span>
<span><span class="co">#&gt;   rif = (rxode2i2_fn2) R_GetCCallable("rxode2", "rif");</span></span>
<span><span class="co">#&gt;   riexp = (rxode2i2_fn) R_GetCCallable("rxode2", "riexp");</span></span>
<span><span class="co">#&gt;   richisq = (rxode2i2_fn) R_GetCCallable("rxode2", "richisq");</span></span>
<span><span class="co">#&gt;   ricauchy = (rxode2i2_fn2) R_GetCCallable("rxode2", "ricauchy");</span></span>
<span><span class="co">#&gt;   rinbinomMu = (rxode2i2_ribinom) R_GetCCallable("rxode2", "rinbinomMu");</span></span>
<span><span class="co">#&gt;   rinbinom = (rxode2i2_ribinom) R_GetCCallable("rxode2", "rinbinom");</span></span>
<span><span class="co">#&gt;   ribinom = (rxode2i2_ribinom) R_GetCCallable("rxode2", "ribinom");</span></span>
<span><span class="co">#&gt;   rinorm = (rxode2i2_fn2) R_GetCCallable("rxode2", "rinorm");</span></span>
<span><span class="co">#&gt;   rxweibull = (rxode2i_fn2) R_GetCCallable("rxode2", "rxweibull");</span></span>
<span><span class="co">#&gt;   rxunif = (rxode2i_fn2) R_GetCCallable("rxode2", "rxunif");</span></span>
<span><span class="co">#&gt;   rxt_ = (rxode2i_fn) R_GetCCallable("rxode2", "rxt_");</span></span>
<span><span class="co">#&gt;   rxpois = (rxode2i_ifn) R_GetCCallable("rxode2", "rxpois");</span></span>
<span><span class="co">#&gt;   rxbeta = (rxode2i_fn2) R_GetCCallable("rxode2", "rxbeta");</span></span>
<span><span class="co">#&gt;   rxgamma = (rxode2i_fn2) R_GetCCallable("rxode2", "rxgamma");</span></span>
<span><span class="co">#&gt;   rxgeom = (rxode2i_ifn) R_GetCCallable("rxode2", "rxgeom");</span></span>
<span><span class="co">#&gt;   rxf = (rxode2i_fn2) R_GetCCallable("rxode2", "rxf");</span></span>
<span><span class="co">#&gt;   rxexp = (rxode2i_fn) R_GetCCallable("rxode2", "rxexp");</span></span>
<span><span class="co">#&gt;   rxchisq = (rxode2i_fn) R_GetCCallable("rxode2", "rxchisq");</span></span>
<span><span class="co">#&gt;   rxcauchy = (rxode2i_fn2) R_GetCCallable("rxode2", "rxcauchy");</span></span>
<span><span class="co">#&gt;   rxnbinomMu = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxnbinomMu");</span></span>
<span><span class="co">#&gt;   rxnbinom = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxnbinom");</span></span>
<span><span class="co">#&gt;   rxbinom = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxbinom");</span></span>
<span><span class="co">#&gt;   rxnorm = (rxode2i_fn2) R_GetCCallable("rxode2", "rxnorm");</span></span>
<span><span class="co">#&gt;   linCmtB = (linCmtB_p) R_GetCCallable("rxode2", "linCmtB");</span></span>
<span><span class="co">#&gt;   linCmtA = (linCmtA_p) R_GetCCallable("rxode2", "linCmtA");</span></span>
<span><span class="co">#&gt;   // dynamic stop</span></span>
<span><span class="co">#&gt;   _solveData = _getRxSolve_();</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void _assignFuns(void) {</span></span>
<span><span class="co">#&gt;   if (_assign_ptr == NULL){</span></span>
<span><span class="co">#&gt;     _assignFuns0();</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void __assignFuns2(rx_solve rx,</span></span>
<span><span class="co">#&gt;                    rx_solving_options op,</span></span>
<span><span class="co">#&gt;                    t_F f,</span></span>
<span><span class="co">#&gt;                    t_LAG lag,</span></span>
<span><span class="co">#&gt;                    t_RATE rate,</span></span>
<span><span class="co">#&gt;                    t_DUR dur,</span></span>
<span><span class="co">#&gt;                    t_calc_mtime mtime,</span></span>
<span><span class="co">#&gt;                    t_ME me,</span></span>
<span><span class="co">#&gt;                    t_IndF indf,</span></span>
<span><span class="co">#&gt;                    t_getTime gettime,</span></span>
<span><span class="co">#&gt;                    t_locateTimeIndex timeindex,</span></span>
<span><span class="co">#&gt;                    t_handle_evidL handleEvid,</span></span>
<span><span class="co">#&gt;                    t_getDur getdur) {</span></span>
<span><span class="co">#&gt;   // assign start</span></span>
<span><span class="co">#&gt;     static rxode2_assignFuns2_t rxode2_assignFuns2 = NULL;</span></span>
<span><span class="co">#&gt;     if (rxode2_assignFuns2 == NULL) rxode2_assignFuns2 = (rxode2_assignFuns2_t)(R_GetCCallable("rxode2", "_rxode2_assignFuns2"));</span></span>
<span><span class="co">#&gt;     rxode2_assignFuns2(rx, op, f, lag, rate, dur, mtime, me, indf, gettime, timeindex, handleEvid, getdur);</span></span>
<span><span class="co">#&gt;   // assign stop</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void  rx_d1057c6ed551ef594f444c72b1e0314f__ode_solver_solvedata (rx_solve *solve){</span></span>
<span><span class="co">#&gt;   _solveData = solve;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern rx_solve *rx_d1057c6ed551ef594f444c72b1e0314f__ode_solver_get_solvedata(void){</span></span>
<span><span class="co">#&gt;   return _solveData;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; SEXP rx_d1057c6ed551ef594f444c72b1e0314f__model_vars(void);</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; // prj-specific differential eqns</span></span>
<span><span class="co">#&gt; void rx_d1057c6ed551ef594f444c72b1e0314f__dydt(int *_neq, double __t, double *__zzStateVar__, double *__DDtStateVar__)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   int _cSub = _neq[1];</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_neq[1]].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=1;</span></span>
<span><span class="co">#&gt;   double KA = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TCl = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Q = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kin = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kout = NA_REAL;</span></span>
<span><span class="co">#&gt;   double EC50 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_Cl = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double centr = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double peri = NA_REAL;</span></span>
<span><span class="co">#&gt;   double CL = NA_REAL;</span></span>
<span><span class="co">#&gt;   double depot = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eff = NA_REAL;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   (void)KA;</span></span>
<span><span class="co">#&gt;   (void)TCl;</span></span>
<span><span class="co">#&gt;   (void)V2;</span></span>
<span><span class="co">#&gt;   (void)Q;</span></span>
<span><span class="co">#&gt;   (void)V3;</span></span>
<span><span class="co">#&gt;   (void)Kin;</span></span>
<span><span class="co">#&gt;   (void)Kout;</span></span>
<span><span class="co">#&gt;   (void)EC50;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_Cl;</span></span>
<span><span class="co">#&gt;   (void)C2;</span></span>
<span><span class="co">#&gt;   (void)centr;</span></span>
<span><span class="co">#&gt;   (void)C3;</span></span>
<span><span class="co">#&gt;   (void)peri;</span></span>
<span><span class="co">#&gt;   (void)CL;</span></span>
<span><span class="co">#&gt;   (void)depot;</span></span>
<span><span class="co">#&gt;   (void)eff;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   C2 = _PL[0];</span></span>
<span><span class="co">#&gt;   C3 = _PL[1];</span></span>
<span><span class="co">#&gt;   CL = _PL[2];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _update_par_ptr(__t, _cSub, _solveData, _idx);</span></span>
<span><span class="co">#&gt;   KA = _PP[0];</span></span>
<span><span class="co">#&gt;   TCl = _PP[1];</span></span>
<span><span class="co">#&gt;   V2 = _PP[2];</span></span>
<span><span class="co">#&gt;   Q = _PP[3];</span></span>
<span><span class="co">#&gt;   V3 = _PP[4];</span></span>
<span><span class="co">#&gt;   Kin = _PP[5];</span></span>
<span><span class="co">#&gt;   Kout = _PP[6];</span></span>
<span><span class="co">#&gt;   EC50 = _PP[7];</span></span>
<span><span class="co">#&gt;   eta_DoT_Cl = _PP[8];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   depot = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">#&gt;   centr = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">#&gt;   peri = __zzStateVar__[__DDT2__]*((double)(_ON[__DDT2__]));</span></span>
<span><span class="co">#&gt;   eff = __zzStateVar__[__DDT3__]*((double)(_ON[__DDT3__]));</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   C2 =centr/_div0(V2);</span></span>
<span><span class="co">#&gt;   C3 =peri/_div0(V3);</span></span>
<span><span class="co">#&gt;   CL =TCl*exp(eta_DoT_Cl);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT0__] = ((double)(_ON[__DDT0__]))*(_IR[__DDT0__] -KA*depot);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT1__] = ((double)(_ON[__DDT1__]))*(_IR[__DDT1__] + KA*depot-CL*C2-Q*C2+Q*C3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT2__] = ((double)(_ON[__DDT2__]))*(_IR[__DDT2__] + Q*C2-Q*C3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar__[__DDT3__] = ((double)(_ON[__DDT3__]))*(_IR[__DDT3__] + Kin-Kout*(1-C2/_div0((EC50+C2)))*eff);</span></span>
<span><span class="co">#&gt;   (&amp;_solveData-&gt;subjects[_cSub])-&gt;dadt_counter[0]++;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; // Jacobian derived vars</span></span>
<span><span class="co">#&gt; void rx_d1057c6ed551ef594f444c72b1e0314f__calc_jac(int *_neq, double __t, double *__zzStateVar__, double *__PDStateVar__, unsigned int __NROWPD__) {</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;     int _cSub=_neq[1];</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_neq[1]].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=2;</span></span>
<span><span class="co">#&gt;   (&amp;_solveData-&gt;subjects[_cSub])-&gt;jac_counter[0]++;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Functional based initial conditions.</span></span>
<span><span class="co">#&gt; void rx_d1057c6ed551ef594f444c72b1e0314f__inis(int _cSub, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;  _ind-&gt;_rxFlag=3;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // prj-specific derived vars</span></span>
<span><span class="co">#&gt; void rx_d1057c6ed551ef594f444c72b1e0314f__calc_lhs(int _cSub, double __t, double *__zzStateVar__, double *_lhs) {</span></span>
<span><span class="co">#&gt;     int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=11;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_0__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_1__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_2__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_3__;</span></span>
<span><span class="co">#&gt;   double KA = NA_REAL;</span></span>
<span><span class="co">#&gt;   double TCl = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Q = NA_REAL;</span></span>
<span><span class="co">#&gt;   double V3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kin = NA_REAL;</span></span>
<span><span class="co">#&gt;   double Kout = NA_REAL;</span></span>
<span><span class="co">#&gt;   double EC50 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_Cl = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C2 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double centr = NA_REAL;</span></span>
<span><span class="co">#&gt;   double C3 = NA_REAL;</span></span>
<span><span class="co">#&gt;   double peri = NA_REAL;</span></span>
<span><span class="co">#&gt;   double CL = NA_REAL;</span></span>
<span><span class="co">#&gt;   double depot = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eff = NA_REAL;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_0__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_1__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_2__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_3__;</span></span>
<span><span class="co">#&gt;   (void)KA;</span></span>
<span><span class="co">#&gt;   (void)TCl;</span></span>
<span><span class="co">#&gt;   (void)V2;</span></span>
<span><span class="co">#&gt;   (void)Q;</span></span>
<span><span class="co">#&gt;   (void)V3;</span></span>
<span><span class="co">#&gt;   (void)Kin;</span></span>
<span><span class="co">#&gt;   (void)Kout;</span></span>
<span><span class="co">#&gt;   (void)EC50;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_Cl;</span></span>
<span><span class="co">#&gt;   (void)C2;</span></span>
<span><span class="co">#&gt;   (void)centr;</span></span>
<span><span class="co">#&gt;   (void)C3;</span></span>
<span><span class="co">#&gt;   (void)peri;</span></span>
<span><span class="co">#&gt;   (void)CL;</span></span>
<span><span class="co">#&gt;   (void)depot;</span></span>
<span><span class="co">#&gt;   (void)eff;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   C2 = _PL[0];</span></span>
<span><span class="co">#&gt;   C3 = _PL[1];</span></span>
<span><span class="co">#&gt;   CL = _PL[2];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _update_par_ptr(__t, _cSub, _solveData, _idx);</span></span>
<span><span class="co">#&gt;   KA = _PP[0];</span></span>
<span><span class="co">#&gt;   TCl = _PP[1];</span></span>
<span><span class="co">#&gt;   V2 = _PP[2];</span></span>
<span><span class="co">#&gt;   Q = _PP[3];</span></span>
<span><span class="co">#&gt;   V3 = _PP[4];</span></span>
<span><span class="co">#&gt;   Kin = _PP[5];</span></span>
<span><span class="co">#&gt;   Kout = _PP[6];</span></span>
<span><span class="co">#&gt;   EC50 = _PP[7];</span></span>
<span><span class="co">#&gt;   eta_DoT_Cl = _PP[8];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   depot = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">#&gt;   centr = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">#&gt;   peri = __zzStateVar__[__DDT2__]*((double)(_ON[__DDT2__]));</span></span>
<span><span class="co">#&gt;   eff = __zzStateVar__[__DDT3__]*((double)(_ON[__DDT3__]));</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   C2 =centr/_div0(V2);</span></span>
<span><span class="co">#&gt;   C3 =peri/_div0(V3);</span></span>
<span><span class="co">#&gt;   CL =TCl*exp(eta_DoT_Cl);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_0__ = ((double)(_ON[__DDT0__]))*(_IR[__DDT0__] -KA*depot);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_1__ = ((double)(_ON[__DDT1__]))*(_IR[__DDT1__] + KA*depot-CL*C2-Q*C2+Q*C3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_2__ = ((double)(_ON[__DDT2__]))*(_IR[__DDT2__] + Q*C2-Q*C3);</span></span>
<span><span class="co">#&gt;   __DDtStateVar_3__ = ((double)(_ON[__DDT3__]))*(_IR[__DDT3__] + Kin-Kout*(1-C2/_div0((EC50+C2)))*eff);</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _lhs[_LHS_0_]=C2;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_1_]=C3;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_2_]=CL;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Functional based bioavailability</span></span>
<span><span class="co">#&gt; double rx_d1057c6ed551ef594f444c72b1e0314f__F(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return _amt;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; // Functional based absorption lag</span></span>
<span><span class="co">#&gt; double rx_d1057c6ed551ef594f444c72b1e0314f__Lag(int _cSub,  int _cmt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return __t;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Modeled zero-order rate</span></span>
<span><span class="co">#&gt; double rx_d1057c6ed551ef594f444c72b1e0314f__Rate(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return 0.0;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Modeled zero-order duration</span></span>
<span><span class="co">#&gt; double rx_d1057c6ed551ef594f444c72b1e0314f__Dur(int _cSub,  int _cmt, double _amt, double __t){</span></span>
<span><span class="co">#&gt;  return 0.0;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Model Times</span></span>
<span><span class="co">#&gt; void rx_d1057c6ed551ef594f444c72b1e0314f__mtime(int _cSub, double *_mtime){</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Matrix Exponential (0)</span></span>
<span><span class="co">#&gt; void rx_d1057c6ed551ef594f444c72b1e0314f__ME(int _cSub, double _t, double __t, double *_mat, const double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=9;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Inductive linearization Matf</span></span>
<span><span class="co">#&gt; void rx_d1057c6ed551ef594f444c72b1e0314f__IndF(int _cSub, double _t, double __t, double *_matf){</span></span>
<span><span class="co">#&gt;  int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=10;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern SEXP rx_d1057c6ed551ef594f444c72b1e0314f__model_vars(void){</span></span>
<span><span class="co">#&gt;   int pro=0;</span></span>
<span><span class="co">#&gt;   SEXP _mv = PROTECT(_rxGetModelLib("rx_d1057c6ed551ef594f444c72b1e0314f__model_vars"));pro++;</span></span>
<span><span class="co">#&gt;   if (!_rxIsCurrentC(_mv)){</span></span>
<span><span class="co">#&gt;     SEXP hash    = PROTECT(Rf_allocVector(STRSXP, 1));pro++;</span></span>
<span><span class="co">#&gt; #define __doBuf__  snprintf(buf, __doBufN__, "un]\"BAAA@QRtHACAAAAAAAAAhAAA+:g6JiHZ^PIAg&amp;W9!WGwlCjtF\"{W$A]CS\"4LQ\?hnI\"mu\?/{y.{(%%m=b6=M1G.;7TQ|%%\"w:&amp;iavreD.z,&lt;KK6W0|5tA,h]&gt;a`eLzWsA/B/*|k@w,#]s&lt;%%;@KF8$wt,^DCfiUj[{E*:`\?6QL&lt;]Pu@:lC4[,3IC(ix&gt;=mNu2&lt;(ALW&lt;;CBa%%V]MASh;8!m0C8IL7j=+{Yy;N,7Xm&lt;kPQ.k\"1qNh2[YL}1Sn/o*\"u&amp;&lt;1DoO_tkc{8C,(~=O\"\?;8$&amp;{b3cNZ\?tE3H,qNea&amp;rPQaJtEhr19yD.pQiM2,X+_[+=}!u5.,H\?h(AlS$R2NMYBMRDS/fGQ0B9KH{f[[7VKmCG@$[*j6J8uFGxS}OR4c9\?bNge{gEPY$|E[f&amp;HDRbjPFCY*8n0[11MW\?j,9/\?uC^86k/CLB4g,ynbz@$@@HEvI_vE*fQUY_v@hgc|(oK\"QrcNX%%}YoTW|(d[f[2~OB5Z6d*T)+6@KFJ5MowNqZ/R.I$RAeO.ihxZk{hWd:DiTNbrZit~IyEl7\?cj\"i]Q5UChm&lt;Rq19zU$DN|M`te2$x&amp;5z&lt;8Pq1z7fQ\"^X##LdI8A^#CU5L/c$y/s^,#9.guFn,b@o2t\"pO&lt;~fu3%%p[HP&gt;m`DOCVVCv^1@CR}^bRJE/rIYBDvzQ6JtB*=4!N1&gt;Yd;39.~y;a::~1B.6JSh~I]YPkTXLLiTp6w2|D{10B(rky;r&lt;,g&lt;WIR:,28ux\?H9R1`C)s/24B48Q~\?c;BnC0b:]c1X\"In(k*;6Y1;H(&amp;&gt;v;M6Kb1|md7=36sYeg3c_F@Of&lt;\?N\?qB{{TB9c^fuVL`!$U}3ni98IH*}e0Q/Ma(i&amp;7;*o&amp;I~Znfa}%%u#pE*9Q~t6g^^|LgnY4YTk(}6i36PJ`oIp#k@[^Z(4r65L~Tl\"pOorlBJ\?SACa;BEAXL\?CbDEaoO|iP_!#u9y6`2qcqbbo/,pZQisSiZ;*8M&gt;W!Yf]fG95(FuM~v/F&lt;v^XcM/FgL@z!!d`&amp;awwFBvnwBWOQ&amp;k~ySJ/3@44)x{C{j&amp;9`sI7{2QY|%%c/iR4&lt;(VZesiyyd4[.VV=NVfuJa)k#CACOd\?P_1PnUOq/^]{ALR8d&amp;#v:9l1rcj)ES=_Y[fxnefChYTNxY9yEoqU+XAv_)&amp;TKBvgnl&lt;wk7\?I);h9&amp;2YwaE;/l\?7UtZBS],UY48i{\"a=\"iHR!/be&amp;DXch=TLnhlZz3U0Sylg!Iqd#%%m5`\"rJi\?OWkrJpK=0jotTu^bSCaBynZb3UNSh17QRYn=O}4iaB5mCb@W)O~+}GUtXF~o(4iV/&amp;zL7~I[cTx#Z_SqUer5Z9DGJ}:$(M@z9sax.)T");</span></span>
<span><span class="co">#&gt;     char buf[1340];</span></span>
<span><span class="co">#&gt; #define __doBufN__ 1340</span></span>
<span><span class="co">#&gt;     __doBuf__</span></span>
<span><span class="co">#&gt; #undef __doBuf__</span></span>
<span><span class="co">#&gt; #undef __doBufN__</span></span>
<span><span class="co">#&gt;     SET_STRING_ELT(hash, 0, Rf_mkChar(buf));</span></span>
<span><span class="co">#&gt;     SEXP lst      = PROTECT(_rxQr(hash));pro++;</span></span>
<span><span class="co">#&gt;     _assign_ptr(lst);</span></span>
<span><span class="co">#&gt;     UNPROTECT(pro);</span></span>
<span><span class="co">#&gt;     return lst;</span></span>
<span><span class="co">#&gt;   } else {</span></span>
<span><span class="co">#&gt;     UNPROTECT(pro);</span></span>
<span><span class="co">#&gt;     return _mv;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void rx_d1057c6ed551ef594f444c72b1e0314f__dydt_lsoda(int *neq, double *t, double *A, double *DADT)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   rx_d1057c6ed551ef594f444c72b1e0314f__dydt(neq, *t, A, DADT);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern int rx_d1057c6ed551ef594f444c72b1e0314f__dydt_liblsoda(double __t, double *y, double *ydot, void *data)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   int *neq = (int*)(data);</span></span>
<span><span class="co">#&gt;   rx_d1057c6ed551ef594f444c72b1e0314f__dydt(neq, __t, y, ydot);</span></span>
<span><span class="co">#&gt;   return(0);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void rx_d1057c6ed551ef594f444c72b1e0314f__calc_jac_lsoda(int *neq, double *t, double *A,int *ml, int *mu, double *JAC, int *nrowpd){</span></span>
<span><span class="co">#&gt;   // Update all covariate parameters</span></span>
<span><span class="co">#&gt;   rx_d1057c6ed551ef594f444c72b1e0314f__calc_jac(neq, *t, A, JAC, *nrowpd);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; //Create function to call from R's main thread that assigns the required functions. Sometimes they don't get assigned.</span></span>
<span><span class="co">#&gt; extern void rx_d1057c6ed551ef594f444c72b1e0314f__assignFuns(void){</span></span>
<span><span class="co">#&gt;   _assignFuns();</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; //Initialize the dll to match rxode2's calls</span></span>
<span><span class="co">#&gt; void R_init0_rx_d1057c6ed551ef594f444c72b1e0314f_(void){</span></span>
<span><span class="co">#&gt;   // Get C callables on load; Otherwise it isn't thread safe</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_d1057c6ed551ef594f444c72b1e0314f_","rx_d1057c6ed551ef594f444c72b1e0314f__assignFuns2", (DL_FUNC) __assignFuns2);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_d1057c6ed551ef594f444c72b1e0314f_","rx_d1057c6ed551ef594f444c72b1e0314f__assignFuns", (DL_FUNC) rx_d1057c6ed551ef594f444c72b1e0314f__assignFuns);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_d1057c6ed551ef594f444c72b1e0314f_","rx_d1057c6ed551ef594f444c72b1e0314f__inis",(DL_FUNC) rx_d1057c6ed551ef594f444c72b1e0314f__inis);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_d1057c6ed551ef594f444c72b1e0314f_","rx_d1057c6ed551ef594f444c72b1e0314f__dydt",(DL_FUNC) rx_d1057c6ed551ef594f444c72b1e0314f__dydt);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_d1057c6ed551ef594f444c72b1e0314f_","rx_d1057c6ed551ef594f444c72b1e0314f__calc_lhs",(DL_FUNC) rx_d1057c6ed551ef594f444c72b1e0314f__calc_lhs);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_d1057c6ed551ef594f444c72b1e0314f_","rx_d1057c6ed551ef594f444c72b1e0314f__calc_jac",(DL_FUNC) rx_d1057c6ed551ef594f444c72b1e0314f__calc_jac);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_d1057c6ed551ef594f444c72b1e0314f_","rx_d1057c6ed551ef594f444c72b1e0314f__dydt_lsoda", (DL_FUNC) rx_d1057c6ed551ef594f444c72b1e0314f__dydt_lsoda);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_d1057c6ed551ef594f444c72b1e0314f_","rx_d1057c6ed551ef594f444c72b1e0314f__calc_jac_lsoda", (DL_FUNC) rx_d1057c6ed551ef594f444c72b1e0314f__calc_jac_lsoda);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_d1057c6ed551ef594f444c72b1e0314f_","rx_d1057c6ed551ef594f444c72b1e0314f__ode_solver_solvedata", (DL_FUNC) rx_d1057c6ed551ef594f444c72b1e0314f__ode_solver_solvedata);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_d1057c6ed551ef594f444c72b1e0314f_","rx_d1057c6ed551ef594f444c72b1e0314f__ode_solver_get_solvedata", (DL_FUNC) rx_d1057c6ed551ef594f444c72b1e0314f__ode_solver_get_solvedata);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_d1057c6ed551ef594f444c72b1e0314f_","rx_d1057c6ed551ef594f444c72b1e0314f__F", (DL_FUNC) rx_d1057c6ed551ef594f444c72b1e0314f__F);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_d1057c6ed551ef594f444c72b1e0314f_","rx_d1057c6ed551ef594f444c72b1e0314f__Lag", (DL_FUNC) rx_d1057c6ed551ef594f444c72b1e0314f__Lag);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_d1057c6ed551ef594f444c72b1e0314f_","rx_d1057c6ed551ef594f444c72b1e0314f__Rate", (DL_FUNC) rx_d1057c6ed551ef594f444c72b1e0314f__Rate);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_d1057c6ed551ef594f444c72b1e0314f_","rx_d1057c6ed551ef594f444c72b1e0314f__Dur", (DL_FUNC) rx_d1057c6ed551ef594f444c72b1e0314f__Dur);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_d1057c6ed551ef594f444c72b1e0314f_","rx_d1057c6ed551ef594f444c72b1e0314f__mtime", (DL_FUNC) rx_d1057c6ed551ef594f444c72b1e0314f__mtime);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_d1057c6ed551ef594f444c72b1e0314f_","rx_d1057c6ed551ef594f444c72b1e0314f__ME", (DL_FUNC) rx_d1057c6ed551ef594f444c72b1e0314f__ME);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_d1057c6ed551ef594f444c72b1e0314f_","rx_d1057c6ed551ef594f444c72b1e0314f__IndF", (DL_FUNC) rx_d1057c6ed551ef594f444c72b1e0314f__IndF);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_d1057c6ed551ef594f444c72b1e0314f_","rx_d1057c6ed551ef594f444c72b1e0314f__dydt_liblsoda", (DL_FUNC) rx_d1057c6ed551ef594f444c72b1e0314f__dydt_liblsoda);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; //Initialize the dll to match rxode2's calls</span></span>
<span><span class="co">#&gt; void R_init_rx_d1057c6ed551ef594f444c72b1e0314f_(DllInfo *info){</span></span>
<span><span class="co">#&gt;   // Get C callables on load; Otherwise it isn't thread safe</span></span>
<span><span class="co">#&gt;   R_init0_rx_d1057c6ed551ef594f444c72b1e0314f_();</span></span>
<span><span class="co">#&gt;   static const R_CallMethodDef callMethods[]  = {</span></span>
<span><span class="co">#&gt;     {"rx_d1057c6ed551ef594f444c72b1e0314f__model_vars", (DL_FUNC) &amp;rx_d1057c6ed551ef594f444c72b1e0314f__model_vars, 0},</span></span>
<span><span class="co">#&gt;     {NULL, NULL, 0}</span></span>
<span><span class="co">#&gt;   };</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   R_registerRoutines(info, NULL, callMethods, NULL, NULL);</span></span>
<span><span class="co">#&gt;   R_useDynamicSymbols(info,FALSE);</span></span>
<span><span class="co">#&gt;   _assignFuns0();</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; void R_unload_rx_d1057c6ed551ef594f444c72b1e0314f_ (DllInfo *info){</span></span>
<span><span class="co">#&gt;   // Free resources required for single subject solve.</span></span>
<span><span class="co">#&gt;   SEXP _mv = PROTECT(_rxGetModelLib("rx_d1057c6ed551ef594f444c72b1e0314f__model_vars"));</span></span>
<span><span class="co">#&gt;   if (!Rf_isNull(_mv)){</span></span>
<span><span class="co">#&gt;     _rxRmModelLib("rx_d1057c6ed551ef594f444c72b1e0314f__model_vars");</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   UNPROTECT(1);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’</span></span>
<span></span>
<span><span class="va">sim</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">time</span>, <span class="va">eff</span>, <span class="va">C2</span><span class="op">)</span></span>
<span><span class="co">#&gt;    id          time      eff          C2</span></span>
<span><span class="co">#&gt; 1   1  0.000000 [h] 1.000000 248.7562189</span></span>
<span><span class="co">#&gt; 2   1  5.333333 [h] 1.062982   5.3970840</span></span>
<span><span class="co">#&gt; 3   1 10.666667 [h] 1.013881   2.5901710</span></span>
<span><span class="co">#&gt; 4   1 16.000000 [h] 1.011565   2.2550581</span></span>
<span><span class="co">#&gt; 5   1 21.333333 [h] 1.010158   1.9820213</span></span>
<span><span class="co">#&gt; 6   1 26.666667 [h] 1.008929   1.7422286</span></span>
<span><span class="co">#&gt; 7   1 32.000000 [h] 1.007849   1.5314615</span></span>
<span><span class="co">#&gt; 8   1 37.333333 [h] 1.006899   1.3461870</span></span>
<span><span class="co">#&gt; 9   1 42.666667 [h] 1.006064   1.1833253</span></span>
<span><span class="co">#&gt; 10  1 48.000000 [h] 1.005330   1.0401683</span></span>
<span><span class="co">#&gt; 11  2  0.000000 [h] 1.000000 124.3781095</span></span>
<span><span class="co">#&gt; 12  2  6.857143 [h] 1.005764   0.7047232</span></span>
<span><span class="co">#&gt; 13  2 13.714286 [h] 1.002879   0.5592808</span></span>
<span><span class="co">#&gt; 14  2 20.571429 [h] 1.002381   0.4630160</span></span>
<span><span class="co">#&gt; 15  2 27.428571 [h] 1.001971   0.3833262</span></span>
<span><span class="co">#&gt; 16  2 34.285714 [h] 1.001632   0.3173516</span></span>
<span><span class="co">#&gt; 17  2 41.142857 [h] 1.001351   0.2627315</span></span>
<span><span class="co">#&gt; 18  2 48.000000 [h] 1.001118   0.2175123</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="simulation-of-clinical-trials">Simulation of Clinical Trials<a class="anchor" aria-label="anchor" href="#simulation-of-clinical-trials"></a>
</h2>
<p>By either using a simple single event table, or data from a clinical
trial as described above, a complete clinical trial simulation can be
performed.</p>
<p>Typically in clinical trial simulations you want to account for the
uncertainty in the fixed parameter estimates, and even the uncertainty
in both your between subject variability as well as the unexplained
variability.</p>
<p><code>rxode2</code> allows you to account for these uncertainties by
simulating multiple virtual “studies,” specified by the parameter
<code>nStud</code>. Each of these studies samples a realization of fixed
effect parameters and covariance matrices for the between subject
variability(<code>omega</code>) and unexplained variabilities
(<code>sigma</code>). Depending on the information you have from the
models, there are a few strategies for simulating a realization of the
<code>omega</code> and <code>sigma</code> matrices.</p>
<p>The first strategy occurs when either there is not any standard
errors for standard deviations (or related parameters), or there is a
modeled correlation in the model you are simulating from. In that case
the suggested strategy is to use the inverse Wishart (parameterized to
scale to the conjugate prior)/<a href="https://en.wikipedia.org/wiki/Scaled_inverse_chi-squared_distribution" class="external-link">scaled
inverse chi distribution</a>. this approach uses a single parameter to
inform the variability of the covariance matrix sampled (the degrees of
freedom).</p>
<p>The second strategy occurs if you have standard errors on the
variance/standard deviation with no modeled correlations in the
covariance matrix. In this approach you perform separate simulations for
the standard deviations and the correlation matrix. First you simulate
the variance/standard deviation components in the <code>thetaMat</code>
multivariate normal simulation. After simulation and transformation to
standard deviations, a correlation matrix is simulated using the degrees
of freedom of your covariance matrix. Combining the simulated standard
deviation with the simulated correlation matrix will give a simulated
covariance matrix. For smaller dimension covariance matrices (dimension
&lt; 10x10) it is recommended you use the <code>lkj</code> distribution
to simulate the correlation matrix. For higher dimension covariance
matrices it is suggested you use the inverse wishart distribution
(transformed to a correlation matrix) for the simulations.</p>
<p>The covariance/variance prior is simulated from <code>rxode2</code>s
<code><a href="../reference/cvPost.html">cvPost()</a></code> function.</p>
<div class="section level3">
<h3 id="simulation-from-inverse-wishart-correlations">Simulation from inverse Wishart correlations<a class="anchor" aria-label="anchor" href="#simulation-from-inverse-wishart-correlations"></a>
</h3>
<p>An example of this simulation is below:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## Creating covariance matrix</span></span>
<span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">8</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, <span class="fl">8</span>, <span class="fl">8</span><span class="op">)</span></span>
<span><span class="va">tMat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">tcrossprod</a></span><span class="op">(</span><span class="va">tmp</span>, <span class="va">tmp</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">8</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">tMat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">$</span><span class="va">theta</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rxSolve.html">rxSolve</a></span><span class="op">(</span><span class="va">mod2</span>, <span class="va">ev</span>, nSub<span class="op">=</span><span class="fl">100</span>, thetaMat<span class="op">=</span><span class="va">tMat</span>, nStud<span class="op">=</span><span class="fl">10</span>,</span>
<span>                dfSub<span class="op">=</span><span class="fl">10</span>, dfObs<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span><span class="va">sim</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="st">"sim"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> in order to put confidence bands around the intervals, you need at least 2500 simulations</span></span>
<span><span class="co">#&gt; summarizing data...done</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span></code></pre></div>
<p><img src="rxode2-sim-var_files/figure-html/unnamed-chunk-23-1.png" width="700"></p>
<p>If you wish you can see what <code>omega</code> and
<code>sigma</code> was used for each virtual study by accessing them in
the solved data object with <code>$omega.list</code> and
<code>$sigma.list</code>:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">omegaList</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt;           eta.Cl</span></span>
<span><span class="co">#&gt; eta.Cl 0.1676778</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt;           eta.Cl</span></span>
<span><span class="co">#&gt; eta.Cl 0.2917085</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt;           eta.Cl</span></span>
<span><span class="co">#&gt; eta.Cl 0.1776813</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]]</span></span>
<span><span class="co">#&gt;           eta.Cl</span></span>
<span><span class="co">#&gt; eta.Cl 0.1578682</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[5]]</span></span>
<span><span class="co">#&gt;           eta.Cl</span></span>
<span><span class="co">#&gt; eta.Cl 0.1845614</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[6]]</span></span>
<span><span class="co">#&gt;           eta.Cl</span></span>
<span><span class="co">#&gt; eta.Cl 0.3282268</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">sigmaList</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt;            rxerr.eff   rxerr.C2</span></span>
<span><span class="co">#&gt; rxerr.eff 1.12416983 0.04197039</span></span>
<span><span class="co">#&gt; rxerr.C2  0.04197039 0.97293971</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt;             rxerr.eff    rxerr.C2</span></span>
<span><span class="co">#&gt; rxerr.eff  0.84311199 -0.06277998</span></span>
<span><span class="co">#&gt; rxerr.C2  -0.06277998  1.22140938</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt;           rxerr.eff  rxerr.C2</span></span>
<span><span class="co">#&gt; rxerr.eff 0.9834771 0.1060251</span></span>
<span><span class="co">#&gt; rxerr.C2  0.1060251 1.0024751</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]]</span></span>
<span><span class="co">#&gt;            rxerr.eff   rxerr.C2</span></span>
<span><span class="co">#&gt; rxerr.eff 1.25556975 0.07690868</span></span>
<span><span class="co">#&gt; rxerr.C2  0.07690868 0.90991261</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[5]]</span></span>
<span><span class="co">#&gt;           rxerr.eff  rxerr.C2</span></span>
<span><span class="co">#&gt; rxerr.eff  1.116261 -0.184748</span></span>
<span><span class="co">#&gt; rxerr.C2  -0.184748  1.320288</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[6]]</span></span>
<span><span class="co">#&gt;            rxerr.eff   rxerr.C2</span></span>
<span><span class="co">#&gt; rxerr.eff 0.93539238 0.07270049</span></span>
<span><span class="co">#&gt; rxerr.C2  0.07270049 0.98648424</span></span></code></pre></div>
<p>You can also see the parameter realizations from the
<code>$params</code> data frame.</p>
</div>
<div class="section level3">
<h3 id="simulate-using-covariance-inputs">Simulate using covariance inputs<a class="anchor" aria-label="anchor" href="#simulate-using-covariance-inputs"></a>
</h3>
<p>Lets assume we wish to simulate from <a href="https://github.com/UUPharmacometrics/xpose/blob/master/inst/extdata/run001.lst" class="external-link">the
nonmem run included in xpose</a></p>
<p>First we setup the model; Since we are taking this from nonmem and
would like to use the more free-form style from the classic
<code>rxode2</code> model we start from the classic model:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rx1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rxode2.html">rxode2</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">cl</span> <span class="op">&lt;-</span> <span class="va">tcl</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">crcl.cl</span><span class="op">*</span><span class="op">(</span><span class="va">CLCR</span><span class="op">-</span><span class="fl">65</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">eta.cl</span><span class="op">)</span></span>
<span>  <span class="va">v</span> <span class="op">&lt;-</span> <span class="va">tv</span> <span class="op">*</span> <span class="va">WT</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">eta.v</span><span class="op">)</span></span>
<span>  <span class="va">ka</span> <span class="op">&lt;-</span> <span class="va">tka</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">eta.ka</span><span class="op">)</span></span>
<span>  <span class="va">ipred</span> <span class="op">&lt;-</span> <span class="fu">linCmt</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">obs</span> <span class="op">&lt;-</span> <span class="va">ipred</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">prop.sd</span><span class="op">)</span> <span class="op">+</span> <span class="va">add.sd</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; C model:</span></span>
<span><span class="co">#&gt; // Define translation state order for 2 states</span></span>
<span><span class="co">#&gt; #define __DDT0__ 0 // depot</span></span>
<span><span class="co">#&gt; #define _DEPOT_ 0 // depot</span></span>
<span><span class="co">#&gt; #define __DDT1__ 1 // central</span></span>
<span><span class="co">#&gt; #define _CENTRAL_ 1 // central</span></span>
<span><span class="co">#&gt; // Define 5 LHS values</span></span>
<span><span class="co">#&gt; #define _LHS_0_ 0 // cl</span></span>
<span><span class="co">#&gt; #define _LHS_1_ 1 // v</span></span>
<span><span class="co">#&gt; #define _LHS_2_ 2 // ka</span></span>
<span><span class="co">#&gt; #define _LHS_3_ 3 // ipred</span></span>
<span><span class="co">#&gt; #define _LHS_4_ 4 // obs</span></span>
<span><span class="co">#&gt; #define _getRxSolve_ _rx65102c88c8e7a44adb7d781f48f2e860429__getRxSolve__I80U</span></span>
<span><span class="co">#&gt; #define _evalUdf _rx65102c88c8e7a44adb7d781f48f2e860430__evalUdf_112w</span></span>
<span><span class="co">#&gt; #define _solveData _rx65102c88c8e7a44adb7d781f48f2e860431__solveData_2La9</span></span>
<span><span class="co">#&gt; #define _assign_ptr _rx65102c88c8e7a44adb7d781f48f2e860432__assign_ptr_bV7N</span></span>
<span><span class="co">#&gt; #define _rxRmModelLib _rx65102c88c8e7a44adb7d781f48f2e860433__rxRmModelLib_6xIM</span></span>
<span><span class="co">#&gt; #define _rxGetModelLib _rx65102c88c8e7a44adb7d781f48f2e860434__rxGetModelLib_Jk0j</span></span>
<span><span class="co">#&gt; #define _old_c _rx65102c88c8e7a44adb7d781f48f2e860435__old_c_Hvlx</span></span>
<span><span class="co">#&gt; #define _ptrid _rx65102c88c8e7a44adb7d781f48f2e860436__ptrid_TGEr</span></span>
<span><span class="co">#&gt; #define _rxIsCurrentC _rx65102c88c8e7a44adb7d781f48f2e860437__rxIsCurrentC_sm8e</span></span>
<span><span class="co">#&gt; #define _sumPS _rx65102c88c8e7a44adb7d781f48f2e860438__sumPS_oulH</span></span>
<span><span class="co">#&gt; #define _prodPS _rx65102c88c8e7a44adb7d781f48f2e860439__prodPS_I69B</span></span>
<span><span class="co">#&gt; #define _prodType _rx65102c88c8e7a44adb7d781f48f2e860440__prodType_pBRY</span></span>
<span><span class="co">#&gt; #define _sumType _rx65102c88c8e7a44adb7d781f48f2e860441__sumType_oQFG</span></span>
<span><span class="co">#&gt; #define _update_par_ptr _rx65102c88c8e7a44adb7d781f48f2e860442__update_par_ptr_l8if</span></span>
<span><span class="co">#&gt; #define _getParCov _rx65102c88c8e7a44adb7d781f48f2e860443__getParCov_PX7k</span></span>
<span><span class="co">#&gt; #define _rxode2_rxAssignPtr _rx65102c88c8e7a44adb7d781f48f2e860444__rxode2_rxAssignPtr_bOkU</span></span>
<span><span class="co">#&gt; #define _rxQr _rx65102c88c8e7a44adb7d781f48f2e860445__rxQr_R3R0</span></span>
<span><span class="co">#&gt; #define _compareFactorVal _rx65102c88c8e7a44adb7d781f48f2e860446__compareFactorVal_cxYC</span></span>
<span><span class="co">#&gt; #define _sum _rx65102c88c8e7a44adb7d781f48f2e860447__sum_G1iP</span></span>
<span><span class="co">#&gt; #define _udf _rx65102c88c8e7a44adb7d781f48f2e860448__udf_GJkj</span></span>
<span><span class="co">#&gt; #define _sign _rx65102c88c8e7a44adb7d781f48f2e860449__sign_zI2k</span></span>
<span><span class="co">#&gt; #define _prod _rx65102c88c8e7a44adb7d781f48f2e860450__prod_Itba</span></span>
<span><span class="co">#&gt; #define _max _rx65102c88c8e7a44adb7d781f48f2e860451__max_Bdxv</span></span>
<span><span class="co">#&gt; #define _min _rx65102c88c8e7a44adb7d781f48f2e860452__min_ufdI</span></span>
<span><span class="co">#&gt; #define _transit4P _rx65102c88c8e7a44adb7d781f48f2e860453__transit4P_sq69</span></span>
<span><span class="co">#&gt; #define _transit3P _rx65102c88c8e7a44adb7d781f48f2e860454__transit3P_enNx</span></span>
<span><span class="co">#&gt; #define _assignFuns0 _rx65102c88c8e7a44adb7d781f48f2e860455__assignFuns0_L3fY</span></span>
<span><span class="co">#&gt; #define _assignFuns _rx65102c88c8e7a44adb7d781f48f2e860456__assignFuns_pol0</span></span>
<span><span class="co">#&gt; #define _rxord _rx65102c88c8e7a44adb7d781f48f2e860457__rxord_xIKJ</span></span>
<span><span class="co">#&gt; #define __assignFuns2 _rx65102c88c8e7a44adb7d781f48f2e860458___assignFuns2_CgFN</span></span>
<span><span class="co">#&gt; #define _llikCauchyDscale _rx65102c88c8e7a44adb7d781f48f2e860459__llikCauchyDscale_mXyk</span></span>
<span><span class="co">#&gt; #define _llikCauchyDlocation _rx65102c88c8e7a44adb7d781f48f2e860460__llikCauchyDlocation_PcaS</span></span>
<span><span class="co">#&gt; #define _llikCauchy _rx65102c88c8e7a44adb7d781f48f2e860461__llikCauchy_QGeb</span></span>
<span><span class="co">#&gt; #define _llikGammaDrate _rx65102c88c8e7a44adb7d781f48f2e860462__llikGammaDrate_E5B1</span></span>
<span><span class="co">#&gt; #define _llikGammaDshape _rx65102c88c8e7a44adb7d781f48f2e860463__llikGammaDshape_yegF</span></span>
<span><span class="co">#&gt; #define _llikGamma _rx65102c88c8e7a44adb7d781f48f2e860464__llikGamma_eCEV</span></span>
<span><span class="co">#&gt; #define _llikWeibullDscale _rx65102c88c8e7a44adb7d781f48f2e860465__llikWeibullDscale_ukcG</span></span>
<span><span class="co">#&gt; #define _llikWeibullDshape _rx65102c88c8e7a44adb7d781f48f2e860466__llikWeibullDshape_HuoA</span></span>
<span><span class="co">#&gt; #define _llikWeibull _rx65102c88c8e7a44adb7d781f48f2e860467__llikWeibull_RTHx</span></span>
<span><span class="co">#&gt; #define _llikUnifDbeta _rx65102c88c8e7a44adb7d781f48f2e860468__llikUnifDbeta_SmZr</span></span>
<span><span class="co">#&gt; #define _llikUnifDalpha _rx65102c88c8e7a44adb7d781f48f2e860469__llikUnifDalpha_AF2Z</span></span>
<span><span class="co">#&gt; #define _llikUnif _rx65102c88c8e7a44adb7d781f48f2e860470__llikUnif_ZsKG</span></span>
<span><span class="co">#&gt; #define _llikGeomDp _rx65102c88c8e7a44adb7d781f48f2e860471__llikGeomDp_2LP1</span></span>
<span><span class="co">#&gt; #define _llikGeom _rx65102c88c8e7a44adb7d781f48f2e860472__llikGeom_qBg0</span></span>
<span><span class="co">#&gt; #define _llikFDdf2 _rx65102c88c8e7a44adb7d781f48f2e860473__llikFDdf2_fWOV</span></span>
<span><span class="co">#&gt; #define _llikFDdf1 _rx65102c88c8e7a44adb7d781f48f2e860474__llikFDdf1_S5I1</span></span>
<span><span class="co">#&gt; #define _llikF _rx65102c88c8e7a44adb7d781f48f2e860475__llikF_hpYy</span></span>
<span><span class="co">#&gt; #define _llikExpDrate _rx65102c88c8e7a44adb7d781f48f2e860476__llikExpDrate_EzwN</span></span>
<span><span class="co">#&gt; #define _llikExp _rx65102c88c8e7a44adb7d781f48f2e860477__llikExp_zgne</span></span>
<span><span class="co">#&gt; #define _llikChisqDdf _rx65102c88c8e7a44adb7d781f48f2e860478__llikChisqDdf_pKfe</span></span>
<span><span class="co">#&gt; #define _llikChisq _rx65102c88c8e7a44adb7d781f48f2e860479__llikChisq_grF8</span></span>
<span><span class="co">#&gt; #define _llikTDsd _rx65102c88c8e7a44adb7d781f48f2e860480__llikTDsd_t09Y</span></span>
<span><span class="co">#&gt; #define _llikTDmean _rx65102c88c8e7a44adb7d781f48f2e860481__llikTDmean_5xWP</span></span>
<span><span class="co">#&gt; #define _llikTDdf _rx65102c88c8e7a44adb7d781f48f2e860482__llikTDdf_ym9U</span></span>
<span><span class="co">#&gt; #define _llikT _rx65102c88c8e7a44adb7d781f48f2e860483__llikT_DEXM</span></span>
<span><span class="co">#&gt; #define _llikBetaDshape2 _rx65102c88c8e7a44adb7d781f48f2e860484__llikBetaDshape2_Of4m</span></span>
<span><span class="co">#&gt; #define _llikBetaDshape1 _rx65102c88c8e7a44adb7d781f48f2e860485__llikBetaDshape1_Ridm</span></span>
<span><span class="co">#&gt; #define _llikBeta _rx65102c88c8e7a44adb7d781f48f2e860486__llikBeta_39xj</span></span>
<span><span class="co">#&gt; #define _llikNbinomMuDmu _rx65102c88c8e7a44adb7d781f48f2e860487__llikNbinomMuDmu_iFEp</span></span>
<span><span class="co">#&gt; #define _llikNbinomMu _rx65102c88c8e7a44adb7d781f48f2e860488__llikNbinomMu_jmWE</span></span>
<span><span class="co">#&gt; #define _llikNbinomDprob _rx65102c88c8e7a44adb7d781f48f2e860489__llikNbinomDprob_uSrX</span></span>
<span><span class="co">#&gt; #define _llikNbinom _rx65102c88c8e7a44adb7d781f48f2e860490__llikNbinom_2fgc</span></span>
<span><span class="co">#&gt; #define _llikBinomDprob _rx65102c88c8e7a44adb7d781f48f2e860491__llikBinomDprob_cvog</span></span>
<span><span class="co">#&gt; #define _llikBinom _rx65102c88c8e7a44adb7d781f48f2e860492__llikBinom_QjdS</span></span>
<span><span class="co">#&gt; #define _llikPoisDlambda _rx65102c88c8e7a44adb7d781f48f2e860493__llikPoisDlambda_xjKY</span></span>
<span><span class="co">#&gt; #define _llikPois _rx65102c88c8e7a44adb7d781f48f2e860494__llikPois_Dx2E</span></span>
<span><span class="co">#&gt; #define _llikNormDsd _rx65102c88c8e7a44adb7d781f48f2e860495__llikNormDsd_oAoY</span></span>
<span><span class="co">#&gt; #define _llikNormDmean _rx65102c88c8e7a44adb7d781f48f2e860496__llikNormDmean_FjRH</span></span>
<span><span class="co">#&gt; #define _llikNorm _rx65102c88c8e7a44adb7d781f48f2e860497__llikNorm_KKtk</span></span>
<span><span class="co">#&gt; #define simeps _rx65102c88c8e7a44adb7d781f48f2e860498_simeps_aKz7</span></span>
<span><span class="co">#&gt; #define simeta _rx65102c88c8e7a44adb7d781f48f2e860499_simeta_SFMH</span></span>
<span><span class="co">#&gt; #define expit _rx65102c88c8e7a44adb7d781f48f2e860500_expit_4zk6</span></span>
<span><span class="co">#&gt; #define logit _rx65102c88c8e7a44adb7d781f48f2e860501_logit_zQQb</span></span>
<span><span class="co">#&gt; #define gammapDer _rx65102c88c8e7a44adb7d781f48f2e860502_gammapDer_QJbv</span></span>
<span><span class="co">#&gt; #define lowergamma _rx65102c88c8e7a44adb7d781f48f2e860503_lowergamma_vZhx</span></span>
<span><span class="co">#&gt; #define uppergamma _rx65102c88c8e7a44adb7d781f48f2e860504_uppergamma_Rbwo</span></span>
<span><span class="co">#&gt; #define gammaqInva _rx65102c88c8e7a44adb7d781f48f2e860505_gammaqInva_yS6A</span></span>
<span><span class="co">#&gt; #define gammaqInv _rx65102c88c8e7a44adb7d781f48f2e860506_gammaqInv_agPR</span></span>
<span><span class="co">#&gt; #define gammapInva _rx65102c88c8e7a44adb7d781f48f2e860507_gammapInva_Nyrg</span></span>
<span><span class="co">#&gt; #define gammapInv _rx65102c88c8e7a44adb7d781f48f2e860508_gammapInv_Wz3Z</span></span>
<span><span class="co">#&gt; #define gammaq _rx65102c88c8e7a44adb7d781f48f2e860509_gammaq_sGrk</span></span>
<span><span class="co">#&gt; #define gammap _rx65102c88c8e7a44adb7d781f48f2e860510_gammap_6bcB</span></span>
<span><span class="co">#&gt; #define phi _rx65102c88c8e7a44adb7d781f48f2e860511_phi_8snz</span></span>
<span><span class="co">#&gt; #define d2ELUa _rx65102c88c8e7a44adb7d781f48f2e860512_d2ELUa_wc86</span></span>
<span><span class="co">#&gt; #define dELUa _rx65102c88c8e7a44adb7d781f48f2e860513_dELUa_J2ub</span></span>
<span><span class="co">#&gt; #define d2aELU _rx65102c88c8e7a44adb7d781f48f2e860514_d2aELU_58ZJ</span></span>
<span><span class="co">#&gt; #define d2ELU _rx65102c88c8e7a44adb7d781f48f2e860515_d2ELU_hNT6</span></span>
<span><span class="co">#&gt; #define dELU _rx65102c88c8e7a44adb7d781f48f2e860516_dELU_VO8d</span></span>
<span><span class="co">#&gt; #define ELU _rx65102c88c8e7a44adb7d781f48f2e860517_ELU_EYZk</span></span>
<span><span class="co">#&gt; #define dPReLUa1 _rx65102c88c8e7a44adb7d781f48f2e860518_dPReLUa1_lVtF</span></span>
<span><span class="co">#&gt; #define dPReLUa _rx65102c88c8e7a44adb7d781f48f2e860519_dPReLUa_GPt6</span></span>
<span><span class="co">#&gt; #define dPReLU _rx65102c88c8e7a44adb7d781f48f2e860520_dPReLU_fTwd</span></span>
<span><span class="co">#&gt; #define PReLU _rx65102c88c8e7a44adb7d781f48f2e860521_PReLU_OUau</span></span>
<span><span class="co">#&gt; #define dSwish _rx65102c88c8e7a44adb7d781f48f2e860522_dSwish_dsA8</span></span>
<span><span class="co">#&gt; #define Swish _rx65102c88c8e7a44adb7d781f48f2e860523_Swish_00dL</span></span>
<span><span class="co">#&gt; #define dlReLU _rx65102c88c8e7a44adb7d781f48f2e860524_dlReLU_KeWG</span></span>
<span><span class="co">#&gt; #define lReLU _rx65102c88c8e7a44adb7d781f48f2e860525_lReLU_5x1j</span></span>
<span><span class="co">#&gt; #define dSELU _rx65102c88c8e7a44adb7d781f48f2e860526_dSELU_oSuQ</span></span>
<span><span class="co">#&gt; #define SELU _rx65102c88c8e7a44adb7d781f48f2e860527_SELU_g8Z4</span></span>
<span><span class="co">#&gt; #define d4softplus _rx65102c88c8e7a44adb7d781f48f2e860528_d4softplus_KNxR</span></span>
<span><span class="co">#&gt; #define d3softplus _rx65102c88c8e7a44adb7d781f48f2e860529_d3softplus_AIzq</span></span>
<span><span class="co">#&gt; #define d2softplus _rx65102c88c8e7a44adb7d781f48f2e860530_d2softplus_FNei</span></span>
<span><span class="co">#&gt; #define dsoftplus _rx65102c88c8e7a44adb7d781f48f2e860531_dsoftplus_oZ8B</span></span>
<span><span class="co">#&gt; #define softplus _rx65102c88c8e7a44adb7d781f48f2e860532_softplus_1VQa</span></span>
<span><span class="co">#&gt; #define d4GELU _rx65102c88c8e7a44adb7d781f48f2e860533_d4GELU_YUrO</span></span>
<span><span class="co">#&gt; #define d3GELU _rx65102c88c8e7a44adb7d781f48f2e860534_d3GELU_KsTU</span></span>
<span><span class="co">#&gt; #define d2GELU _rx65102c88c8e7a44adb7d781f48f2e860535_d2GELU_PPtC</span></span>
<span><span class="co">#&gt; #define dGELU _rx65102c88c8e7a44adb7d781f48f2e860536_dGELU_3L5b</span></span>
<span><span class="co">#&gt; #define GELU _rx65102c88c8e7a44adb7d781f48f2e860537_GELU_OS1n</span></span>
<span><span class="co">#&gt; #define dReLU _rx65102c88c8e7a44adb7d781f48f2e860538_dReLU_0cfg</span></span>
<span><span class="co">#&gt; #define ReLU _rx65102c88c8e7a44adb7d781f48f2e860539_ReLU_VkCp</span></span>
<span><span class="co">#&gt; #define riweibull _rx65102c88c8e7a44adb7d781f48f2e860540_riweibull_1xOD</span></span>
<span><span class="co">#&gt; #define riunif _rx65102c88c8e7a44adb7d781f48f2e860541_riunif_FOG6</span></span>
<span><span class="co">#&gt; #define rit_ _rx65102c88c8e7a44adb7d781f48f2e860542_rit__I4RH</span></span>
<span><span class="co">#&gt; #define ripois _rx65102c88c8e7a44adb7d781f48f2e860543_ripois_D4R8</span></span>
<span><span class="co">#&gt; #define ribeta _rx65102c88c8e7a44adb7d781f48f2e860544_ribeta_UM0O</span></span>
<span><span class="co">#&gt; #define rigamma _rx65102c88c8e7a44adb7d781f48f2e860545_rigamma_LKxk</span></span>
<span><span class="co">#&gt; #define rigeom _rx65102c88c8e7a44adb7d781f48f2e860546_rigeom_em1l</span></span>
<span><span class="co">#&gt; #define rif _rx65102c88c8e7a44adb7d781f48f2e860547_rif_6uhL</span></span>
<span><span class="co">#&gt; #define riexp _rx65102c88c8e7a44adb7d781f48f2e860548_riexp_MvNA</span></span>
<span><span class="co">#&gt; #define richisq _rx65102c88c8e7a44adb7d781f48f2e860549_richisq_JtWf</span></span>
<span><span class="co">#&gt; #define ricauchy _rx65102c88c8e7a44adb7d781f48f2e860550_ricauchy_1S6a</span></span>
<span><span class="co">#&gt; #define rinbinomMu _rx65102c88c8e7a44adb7d781f48f2e860551_rinbinomMu_LzjI</span></span>
<span><span class="co">#&gt; #define rinbinom _rx65102c88c8e7a44adb7d781f48f2e860552_rinbinom_REBf</span></span>
<span><span class="co">#&gt; #define ribinom _rx65102c88c8e7a44adb7d781f48f2e860553_ribinom_880h</span></span>
<span><span class="co">#&gt; #define rinorm _rx65102c88c8e7a44adb7d781f48f2e860554_rinorm_Sf0e</span></span>
<span><span class="co">#&gt; #define rxweibull _rx65102c88c8e7a44adb7d781f48f2e860555_rxweibull_E06V</span></span>
<span><span class="co">#&gt; #define rxunif _rx65102c88c8e7a44adb7d781f48f2e860556_rxunif_PMkJ</span></span>
<span><span class="co">#&gt; #define rxt_ _rx65102c88c8e7a44adb7d781f48f2e860557_rxt__tbt4</span></span>
<span><span class="co">#&gt; #define rxpois _rx65102c88c8e7a44adb7d781f48f2e860558_rxpois_Q2UJ</span></span>
<span><span class="co">#&gt; #define rxbeta _rx65102c88c8e7a44adb7d781f48f2e860559_rxbeta_UT0x</span></span>
<span><span class="co">#&gt; #define rxgamma _rx65102c88c8e7a44adb7d781f48f2e860560_rxgamma_i2n9</span></span>
<span><span class="co">#&gt; #define rxgeom _rx65102c88c8e7a44adb7d781f48f2e860561_rxgeom_RtEy</span></span>
<span><span class="co">#&gt; #define rxf _rx65102c88c8e7a44adb7d781f48f2e860562_rxf_Udvp</span></span>
<span><span class="co">#&gt; #define rxexp _rx65102c88c8e7a44adb7d781f48f2e860563_rxexp_EYRT</span></span>
<span><span class="co">#&gt; #define rxchisq _rx65102c88c8e7a44adb7d781f48f2e860564_rxchisq_vncr</span></span>
<span><span class="co">#&gt; #define rxcauchy _rx65102c88c8e7a44adb7d781f48f2e860565_rxcauchy_qSGC</span></span>
<span><span class="co">#&gt; #define rxnbinomMu _rx65102c88c8e7a44adb7d781f48f2e860566_rxnbinomMu_pgst</span></span>
<span><span class="co">#&gt; #define rxnbinom _rx65102c88c8e7a44adb7d781f48f2e860567_rxnbinom_JKND</span></span>
<span><span class="co">#&gt; #define rxbinom _rx65102c88c8e7a44adb7d781f48f2e860568_rxbinom_JuHv</span></span>
<span><span class="co">#&gt; #define rxnorm _rx65102c88c8e7a44adb7d781f48f2e860569_rxnorm_zKXa</span></span>
<span><span class="co">#&gt; #define linCmtB _rx65102c88c8e7a44adb7d781f48f2e860570_linCmtB_1DaC</span></span>
<span><span class="co">#&gt; #define linCmtA _rx65102c88c8e7a44adb7d781f48f2e860571_linCmtA_5rN3</span></span>
<span><span class="co">#&gt; #include &lt;rxode2_model_shared.h&gt;</span></span>
<span><span class="co">#&gt; #define __MAX_PROD__ 0</span></span>
<span><span class="co">#&gt; #define _CMT CMT</span></span>
<span><span class="co">#&gt; #define _SYNC_simeps_ for (int _svari=_solveData-&gt;neps; _svari--;){  if (_solveData-&gt;svar[_svari] == 0) {tcl = _PP[0];};   if (_solveData-&gt;svar[_svari] == 1) {crcl_DoT_cl = _PP[1];};   if (_solveData-&gt;svar[_svari] == 2) {CLCR = _PP[2];};   if (_solveData-&gt;svar[_svari] == 3) {eta_DoT_cl = _PP[3];};   if (_solveData-&gt;svar[_svari] == 4) {tv = _PP[4];};   if (_solveData-&gt;svar[_svari] == 5) {WT = _PP[5];};   if (_solveData-&gt;svar[_svari] == 6) {eta_DoT_v = _PP[6];};   if (_solveData-&gt;svar[_svari] == 7) {tka = _PP[7];};   if (_solveData-&gt;svar[_svari] == 8) {eta_DoT_ka = _PP[8];};   if (_solveData-&gt;svar[_svari] == 9) {prop_DoT_sd = _PP[9];};   if (_solveData-&gt;svar[_svari] == 10) {add_DoT_sd = _PP[10];}; }</span></span>
<span><span class="co">#&gt; #define _SYNC_simeta_ for (int _ovari=_solveData-&gt;neta; _ovari--;){  if (_solveData-&gt;ovar[_ovari] == 0) {tcl = _PP[0];};   if (_solveData-&gt;ovar[_ovari] == 1) {crcl_DoT_cl = _PP[1];};   if (_solveData-&gt;ovar[_ovari] == 2) {CLCR = _PP[2];};   if (_solveData-&gt;ovar[_ovari] == 3) {eta_DoT_cl = _PP[3];};   if (_solveData-&gt;ovar[_ovari] == 4) {tv = _PP[4];};   if (_solveData-&gt;ovar[_ovari] == 5) {WT = _PP[5];};   if (_solveData-&gt;ovar[_ovari] == 6) {eta_DoT_v = _PP[6];};   if (_solveData-&gt;ovar[_ovari] == 7) {tka = _PP[7];};   if (_solveData-&gt;ovar[_ovari] == 8) {eta_DoT_ka = _PP[8];};   if (_solveData-&gt;ovar[_ovari] == 9) {prop_DoT_sd = _PP[9];};   if (_solveData-&gt;ovar[_ovari] == 10) {add_DoT_sd = _PP[10];}; }</span></span>
<span><span class="co">#&gt; _getRxSolve_t _getRxSolve_;</span></span>
<span><span class="co">#&gt; _simfun simeps;</span></span>
<span><span class="co">#&gt; _simfun simeta;</span></span>
<span><span class="co">#&gt; _udf_type _evalUdf=NULL;</span></span>
<span><span class="co">#&gt; rx_solve *_solveData=NULL;</span></span>
<span><span class="co">#&gt; rxode2_assign_ptr _assign_ptr=NULL;</span></span>
<span><span class="co">#&gt; _rxRmModelLibType _rxRmModelLib=NULL;</span></span>
<span><span class="co">#&gt; _rxGetModelLibType _rxGetModelLib=NULL;</span></span>
<span><span class="co">#&gt; rxode2_ode_solver_old_c _old_c=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _ptrid=NULL;</span></span>
<span><span class="co">#&gt; _rxIsCurrentC_type _rxIsCurrentC=NULL;</span></span>
<span><span class="co">#&gt; _rxSumType _sumPS=NULL;</span></span>
<span><span class="co">#&gt; _rxProdType _prodPS=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _prodType=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn0i _sumType=NULL;</span></span>
<span><span class="co">#&gt; _update_par_ptr_p _update_par_ptr=NULL;</span></span>
<span><span class="co">#&gt; _getParCov_p _getParCov=NULL;</span></span>
<span><span class="co">#&gt; linCmtA_p linCmtA;</span></span>
<span><span class="co">#&gt; linCmtB_p linCmtB;</span></span>
<span><span class="co">#&gt; _rx_asgn _rxode2_rxAssignPtr=NULL;</span></span>
<span><span class="co">#&gt; _rx_asgn _rxQr=NULL;</span></span>
<span><span class="co">#&gt; rxode2_fn phi;</span></span>
<span><span class="co">#&gt; rxode2_fn ReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn dReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn dGELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d2GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d3GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn d4GELU;</span></span>
<span><span class="co">#&gt; rxode2_fn softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn dsoftplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d2softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d3softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn d4softplus;</span></span>
<span><span class="co">#&gt; rxode2_fn SELU;</span></span>
<span><span class="co">#&gt; rxode2_fn dSELU;</span></span>
<span><span class="co">#&gt; rxode2_fn lReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn dlReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn Swish;</span></span>
<span><span class="co">#&gt; rxode2_fn dSwish;</span></span>
<span><span class="co">#&gt; rxode2_fn2 PReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLUa;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dPReLUa1;</span></span>
<span><span class="co">#&gt; rxode2_fn2 ELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2ELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2aELU;</span></span>
<span><span class="co">#&gt; rxode2_fn2 dELUa;</span></span>
<span><span class="co">#&gt; rxode2_fn2 d2ELUa;</span></span>
<span><span class="co">#&gt; rxode2_fn3 logit;</span></span>
<span><span class="co">#&gt; rxode2_fn3 expit;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammap;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaq;</span></span>
<span><span class="co">#&gt; rxode2_fn2 lowergamma;</span></span>
<span><span class="co">#&gt; rxode2_fn2 uppergamma;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapInv;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapDer;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammapInva;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaqInv;</span></span>
<span><span class="co">#&gt; rxode2_fn2 gammaqInva;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxnorm;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxbinom;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxnbinom;</span></span>
<span><span class="co">#&gt; rxode2i_rxbinom rxnbinomMu;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxcauchy;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxchisq;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxexp;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxf;</span></span>
<span><span class="co">#&gt; rxode2i_ifn rxgeom;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxgamma;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxbeta;</span></span>
<span><span class="co">#&gt; rxode2i_ifn rxpois;</span></span>
<span><span class="co">#&gt; rxode2i_fn rxt_;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxunif;</span></span>
<span><span class="co">#&gt; rxode2i_fn2 rxweibull;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rinorm;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom ribinom;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom rinbinom;</span></span>
<span><span class="co">#&gt; rxode2i2_ribinom rinbinomMu;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 ricauchy;</span></span>
<span><span class="co">#&gt; rxode2i2_fn richisq;</span></span>
<span><span class="co">#&gt; rxode2i2_fn riexp;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rif;</span></span>
<span><span class="co">#&gt; rxode2i2_ifn rigeom;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 rigamma;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 ribeta;</span></span>
<span><span class="co">#&gt; rxode2i2_ifn ripois;</span></span>
<span><span class="co">#&gt; rxode2i2_fn rit_;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 riunif;</span></span>
<span><span class="co">#&gt; rxode2i2_fn2 riweibull;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNorm;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNormDmean;</span></span>
<span><span class="co">#&gt; rxode2_llikNormFun _llikNormDsd;</span></span>
<span><span class="co">#&gt; rxode2_llikPoisFun _llikPois;</span></span>
<span><span class="co">#&gt; rxode2_llikPoisFun _llikPoisDlambda;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikBinom;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikBinomDprob;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinom;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomDprob;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomMu;</span></span>
<span><span class="co">#&gt; rxode2_llikBinomFun _llikNbinomMuDmu;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBeta;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBetaDshape1;</span></span>
<span><span class="co">#&gt; rxode2_llikBetaFun _llikBetaDshape2;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikT;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDdf;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDmean;</span></span>
<span><span class="co">#&gt; rxode2_llikTFun _llikTDsd;</span></span>
<span><span class="co">#&gt; rxode2_llikChisqFun _llikChisq;</span></span>
<span><span class="co">#&gt; rxode2_llikChisqFun _llikChisqDdf;</span></span>
<span><span class="co">#&gt; rxode2_llikExpFun _llikExp;</span></span>
<span><span class="co">#&gt; rxode2_llikExpFun _llikExpDrate;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikF;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikFDdf1;</span></span>
<span><span class="co">#&gt; rxode2_llikFFun _llikFDdf2;</span></span>
<span><span class="co">#&gt; rxode2_llikGeomFun _llikGeom;</span></span>
<span><span class="co">#&gt; rxode2_llikGeomFun _llikGeomDp;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnif;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnifDalpha;</span></span>
<span><span class="co">#&gt; rxode2_llikUnifFun _llikUnifDbeta;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibull;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibullDshape;</span></span>
<span><span class="co">#&gt; rxode2_llikWeibullFun _llikWeibullDscale;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGamma;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGammaDshape;</span></span>
<span><span class="co">#&gt; rxode2_llikGammaFun _llikGammaDrate;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchy;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchyDlocation;</span></span>
<span><span class="co">#&gt; rxode2_llikCauchyFun _llikCauchyDscale;</span></span>
<span><span class="co">#&gt; rxode2_compareFactorVal_fn _compareFactorVal;</span></span>
<span><span class="co">#&gt; #include "extraC.h"</span></span>
<span><span class="co">#&gt; double _prod(double *input, double *p, int type, int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return _prodPS(input, p, n, type);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _udf(const char *funName, double *input, int n, ...) {</span></span>
<span><span class="co">#&gt;   if (n == -42) Rf_error("%s", "this has a ui user function that cannot be called directly");</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return _evalUdf(funName, n, input);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _sum(double *input, double *pld, int m, int type, int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;     input[i] = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   double ret = _sumPS(input, n, pld, m, type);</span></span>
<span><span class="co">#&gt;   if (type == 2 &amp;&amp; m &lt; 0){</span></span>
<span><span class="co">#&gt;     for (int i = -m; i--;){</span></span>
<span><span class="co">#&gt;       pld[i] = 0.0;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return ret;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _sign(unsigned int n, ...) {</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double s = 1;</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;     s = sign(va_arg(valist, double))*s;</span></span>
<span><span class="co">#&gt;     if (s == 0){</span></span>
<span><span class="co">#&gt;       break;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return s;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _rxord(int _cSub, unsigned int n,  ...) {</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind* ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   if (!ind-&gt;inLhs) {</span></span>
<span><span class="co">#&gt;     return 1.0;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double ret = 1.0;</span></span>
<span><span class="co">#&gt;   double p = 0.0;</span></span>
<span><span class="co">#&gt;   double u = rxunif(ind, 0.0, 1.0);</span></span>
<span><span class="co">#&gt;   int found = 0;</span></span>
<span><span class="co">#&gt;   for (unsigned int i = 0; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;     p += va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     if (!found) {</span></span>
<span><span class="co">#&gt;       if (u &lt; p) {</span></span>
<span><span class="co">#&gt;         ret = (double)(i+1);</span></span>
<span><span class="co">#&gt;         found = 1;</span></span>
<span><span class="co">#&gt;       }</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   if (!found) ret =(double)(n+1);</span></span>
<span><span class="co">#&gt;   va_end(valist);</span></span>
<span><span class="co">#&gt;   return ret;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _max(unsigned int n, ...) {</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double mx = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tmp = 0;</span></span>
<span><span class="co">#&gt;   if (n &gt;= 1){</span></span>
<span><span class="co">#&gt;     mx = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     for (unsigned int i = 1; i &lt; n; i++) {</span></span>
<span><span class="co">#&gt;       tmp = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;       if (tmp&gt;mx) mx=tmp;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     va_end(valist);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return mx;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _min(unsigned int n, ...){</span></span>
<span><span class="co">#&gt;   va_list valist;</span></span>
<span><span class="co">#&gt;   va_start(valist, n);</span></span>
<span><span class="co">#&gt;   double mn = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tmp = 0;</span></span>
<span><span class="co">#&gt;   if (n &gt;= 1){</span></span>
<span><span class="co">#&gt;     mn = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;     for (unsigned int i = 1; i &lt; n; i++){</span></span>
<span><span class="co">#&gt;       tmp = va_arg(valist, double);</span></span>
<span><span class="co">#&gt;       if (tmp&lt;mn) mn=tmp;</span></span>
<span><span class="co">#&gt;     }</span></span>
<span><span class="co">#&gt;     va_end(valist);</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   return mn;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _transit4P(int cmt, double t, unsigned int id, double n, double mtt, double bio){</span></span>
<span><span class="co">#&gt;   double nd = (double) n;</span></span>
<span><span class="co">#&gt;   double ktr = (nd+1)/mtt;</span></span>
<span><span class="co">#&gt;   double lktr = _safe_log(nd+1)-_safe_log(mtt);</span></span>
<span><span class="co">#&gt;   double tlast = _solveData-&gt;subjects[id].tlastS[cmt];</span></span>
<span><span class="co">#&gt;   double dose = _solveData-&gt;subjects[id].curDoseS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(dose)) dose = 0.0;</span></span>
<span><span class="co">#&gt;   if (ISNA(tlast)) tlast = 0.0;</span></span>
<span><span class="co">#&gt;   double tad = (t-tlast);</span></span>
<span><span class="co">#&gt;   return exp(_safe_log(bio*dose)+lktr+n*(lktr+_safe_log(tad))-ktr*(tad)-lgamma1p(nd));</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; double _transit3P(int cmt, double t, unsigned int id, double n, double mtt){</span></span>
<span><span class="co">#&gt;   double nd = (double) n;</span></span>
<span><span class="co">#&gt;   double ktr = (nd+1)/mtt;</span></span>
<span><span class="co">#&gt;   double lktr = _safe_log(nd+1)-_safe_log(mtt);</span></span>
<span><span class="co">#&gt;   double tlast = _solveData-&gt;subjects[id].tlastS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(tlast)) tlast = 0.0;</span></span>
<span><span class="co">#&gt;   double tad = t-tlast;</span></span>
<span><span class="co">#&gt;   double podo = _solveData-&gt;subjects[id].curDoseS[cmt];</span></span>
<span><span class="co">#&gt;   if (ISNA(podo)) podo = 0.0;</span></span>
<span><span class="co">#&gt;   return exp(_safe_log(podo)+lktr+n*(lktr+_safe_log(tad))-ktr*(tad)-lgamma1p(nd));</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void _assignFuns0(void) {</span></span>
<span><span class="co">#&gt;   _evalUdf = (_udf_type) R_GetCCallable("rxode2", "_rxode2_evalUdf");</span></span>
<span><span class="co">#&gt;   _getRxSolve_ = (_getRxSolve_t) R_GetCCallable("rxode2","getRxSolve_");</span></span>
<span><span class="co">#&gt;   _assign_ptr=(rxode2_assign_ptr) R_GetCCallable("rxode2","rxode2_assign_fn_pointers");</span></span>
<span><span class="co">#&gt;   _rxRmModelLib=(_rxRmModelLibType) R_GetCCallable("rxode2","rxRmModelLib");</span></span>
<span><span class="co">#&gt;   _rxGetModelLib=(_rxGetModelLibType) R_GetCCallable("rxode2","rxGetModelLib");</span></span>
<span><span class="co">#&gt;   _rxode2_rxAssignPtr=(_rx_asgn)R_GetCCallable("rxode2","_rxode2_rxAssignPtr");</span></span>
<span><span class="co">#&gt;   _rxQr=(_rx_asgn)R_GetCCallable("rxode2","_rxode2_rxQr");</span></span>
<span><span class="co">#&gt;   _rxIsCurrentC = (_rxIsCurrentC_type)R_GetCCallable("rxode2","rxIsCurrentC");</span></span>
<span><span class="co">#&gt;   _sumPS  = (_rxSumType) R_GetCCallable("PreciseSums","PreciseSums_sum_r");</span></span>
<span><span class="co">#&gt;   _prodPS = (_rxProdType) R_GetCCallable("PreciseSums","PreciseSums_prod_r");</span></span>
<span><span class="co">#&gt;   _prodType=(rxode2_fn0i)R_GetCCallable("PreciseSums", "PreciseSums_prod_get");</span></span>
<span><span class="co">#&gt;   _sumType=(rxode2_fn0i)R_GetCCallable("PreciseSums", "PreciseSums_sum_get");</span></span>
<span><span class="co">#&gt;   _ptrid=(rxode2_fn0i)R_GetCCallable("rxode2", "rxode2_current_fn_pointer_id");</span></span>
<span><span class="co">#&gt;   _compareFactorVal=(rxode2_compareFactorVal_fn) R_GetCCallable("rxode2", "compareFactorVal");</span></span>
<span><span class="co">#&gt;   _update_par_ptr = (_update_par_ptr_p) R_GetCCallable("rxode2","_update_par_ptr");</span></span>
<span><span class="co">#&gt;   _getParCov = (_getParCov_p) R_GetCCallable("rxode2","_getParCov");</span></span>
<span><span class="co">#&gt;   // dynamic start</span></span>
<span><span class="co">#&gt;   _llikCauchyDscale = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchyDscale");</span></span>
<span><span class="co">#&gt;   _llikCauchyDlocation = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchyDlocation");</span></span>
<span><span class="co">#&gt;   _llikCauchy = (rxode2_llikCauchyFun) R_GetCCallable("rxode2ll", "rxLlikCauchy");</span></span>
<span><span class="co">#&gt;   _llikGammaDrate = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGammaDrate");</span></span>
<span><span class="co">#&gt;   _llikGammaDshape = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGammaDshape");</span></span>
<span><span class="co">#&gt;   _llikGamma = (rxode2_llikGammaFun) R_GetCCallable("rxode2ll", "rxLlikGamma");</span></span>
<span><span class="co">#&gt;   _llikWeibullDscale = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibullDscale");</span></span>
<span><span class="co">#&gt;   _llikWeibullDshape = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibullDshape");</span></span>
<span><span class="co">#&gt;   _llikWeibull = (rxode2_llikWeibullFun) R_GetCCallable("rxode2ll", "rxLlikWeibull");</span></span>
<span><span class="co">#&gt;   _llikUnifDbeta = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnifDbeta");</span></span>
<span><span class="co">#&gt;   _llikUnifDalpha = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnifDalpha");</span></span>
<span><span class="co">#&gt;   _llikUnif = (rxode2_llikUnifFun) R_GetCCallable("rxode2ll", "rxLlikUnif");</span></span>
<span><span class="co">#&gt;   _llikGeomDp = (rxode2_llikGeomFun) R_GetCCallable("rxode2ll", "rxLlikGeomDp");</span></span>
<span><span class="co">#&gt;   _llikGeom = (rxode2_llikGeomFun) R_GetCCallable("rxode2ll", "rxLlikGeom");</span></span>
<span><span class="co">#&gt;   _llikFDdf2 = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikFDdf2");</span></span>
<span><span class="co">#&gt;   _llikFDdf1 = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikFDdf1");</span></span>
<span><span class="co">#&gt;   _llikF = (rxode2_llikFFun) R_GetCCallable("rxode2ll", "rxLlikF");</span></span>
<span><span class="co">#&gt;   _llikExpDrate = (rxode2_llikExpFun) R_GetCCallable("rxode2ll", "rxLlikExpDrate");</span></span>
<span><span class="co">#&gt;   _llikExp = (rxode2_llikExpFun) R_GetCCallable("rxode2ll", "rxLlikExp");</span></span>
<span><span class="co">#&gt;   _llikChisqDdf = (rxode2_llikChisqFun) R_GetCCallable("rxode2ll", "rxLlikChisqDdf");</span></span>
<span><span class="co">#&gt;   _llikChisq = (rxode2_llikChisqFun) R_GetCCallable("rxode2ll", "rxLlikChisq");</span></span>
<span><span class="co">#&gt;   _llikTDsd = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDsd");</span></span>
<span><span class="co">#&gt;   _llikTDmean = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDmean");</span></span>
<span><span class="co">#&gt;   _llikTDdf = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikTDdf");</span></span>
<span><span class="co">#&gt;   _llikT = (rxode2_llikTFun) R_GetCCallable("rxode2ll", "rxLlikT");</span></span>
<span><span class="co">#&gt;   _llikBetaDshape2 = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBetaDshape2");</span></span>
<span><span class="co">#&gt;   _llikBetaDshape1 = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBetaDshape1");</span></span>
<span><span class="co">#&gt;   _llikBeta = (rxode2_llikBetaFun) R_GetCCallable("rxode2ll", "rxLlikBeta");</span></span>
<span><span class="co">#&gt;   _llikNbinomMuDmu = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomMuDmu");</span></span>
<span><span class="co">#&gt;   _llikNbinomMu = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomMu");</span></span>
<span><span class="co">#&gt;   _llikNbinomDprob = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinomDprob");</span></span>
<span><span class="co">#&gt;   _llikNbinom = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikNbinom");</span></span>
<span><span class="co">#&gt;   _llikBinomDprob = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikBinomDprob");</span></span>
<span><span class="co">#&gt;   _llikBinom = (rxode2_llikBinomFun) R_GetCCallable("rxode2ll", "rxLlikBinom");</span></span>
<span><span class="co">#&gt;   _llikPoisDlambda = (rxode2_llikPoisFun) R_GetCCallable("rxode2ll", "rxLlikPoisDlambda");</span></span>
<span><span class="co">#&gt;   _llikPois = (rxode2_llikPoisFun) R_GetCCallable("rxode2ll", "rxLlikPois");</span></span>
<span><span class="co">#&gt;   _llikNormDsd = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNormDsd");</span></span>
<span><span class="co">#&gt;   _llikNormDmean = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNormDmean");</span></span>
<span><span class="co">#&gt;   _llikNorm = (rxode2_llikNormFun) R_GetCCallable("rxode2ll", "rxLlikNorm");</span></span>
<span><span class="co">#&gt;   simeps = (_simfun) R_GetCCallable("rxode2", "simeps");</span></span>
<span><span class="co">#&gt;   simeta = (_simfun) R_GetCCallable("rxode2", "simeta");</span></span>
<span><span class="co">#&gt;   expit = (rxode2_fn3) R_GetCCallable("rxode2", "expit");</span></span>
<span><span class="co">#&gt;   logit = (rxode2_fn3) R_GetCCallable("rxode2", "logit");</span></span>
<span><span class="co">#&gt;   gammapDer = (rxode2_fn2) R_GetCCallable("rxode2", "gammapDer");</span></span>
<span><span class="co">#&gt;   lowergamma = (rxode2_fn2) R_GetCCallable("rxode2", "lowergamma");</span></span>
<span><span class="co">#&gt;   uppergamma = (rxode2_fn2) R_GetCCallable("rxode2", "uppergamma");</span></span>
<span><span class="co">#&gt;   gammaqInva = (rxode2_fn2) R_GetCCallable("rxode2", "gammaqInva");</span></span>
<span><span class="co">#&gt;   gammaqInv = (rxode2_fn2) R_GetCCallable("rxode2", "gammaqInv");</span></span>
<span><span class="co">#&gt;   gammapInva = (rxode2_fn2) R_GetCCallable("rxode2", "gammapInva");</span></span>
<span><span class="co">#&gt;   gammapInv = (rxode2_fn2) R_GetCCallable("rxode2", "gammapInv");</span></span>
<span><span class="co">#&gt;   gammaq = (rxode2_fn2) R_GetCCallable("rxode2", "gammaq");</span></span>
<span><span class="co">#&gt;   gammap = (rxode2_fn2) R_GetCCallable("rxode2", "gammap");</span></span>
<span><span class="co">#&gt;   phi = (rxode2_fn) R_GetCCallable("rxode2", "phi");</span></span>
<span><span class="co">#&gt;   d2ELUa = (rxode2_fn2) R_GetCCallable("rxode2", "d2ELUa");</span></span>
<span><span class="co">#&gt;   dELUa = (rxode2_fn2) R_GetCCallable("rxode2", "dELUa");</span></span>
<span><span class="co">#&gt;   d2aELU = (rxode2_fn2) R_GetCCallable("rxode2", "d2aELU");</span></span>
<span><span class="co">#&gt;   d2ELU = (rxode2_fn2) R_GetCCallable("rxode2", "d2ELU");</span></span>
<span><span class="co">#&gt;   dELU = (rxode2_fn2) R_GetCCallable("rxode2", "dELU");</span></span>
<span><span class="co">#&gt;   ELU = (rxode2_fn2) R_GetCCallable("rxode2", "ELU");</span></span>
<span><span class="co">#&gt;   dPReLUa1 = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLUa1");</span></span>
<span><span class="co">#&gt;   dPReLUa = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLUa");</span></span>
<span><span class="co">#&gt;   dPReLU = (rxode2_fn2) R_GetCCallable("rxode2", "dPReLU");</span></span>
<span><span class="co">#&gt;   PReLU = (rxode2_fn2) R_GetCCallable("rxode2", "PReLU");</span></span>
<span><span class="co">#&gt;   dSwish = (rxode2_fn) R_GetCCallable("rxode2", "dSwish");</span></span>
<span><span class="co">#&gt;   Swish = (rxode2_fn) R_GetCCallable("rxode2", "Swish");</span></span>
<span><span class="co">#&gt;   dlReLU = (rxode2_fn) R_GetCCallable("rxode2", "dlReLU");</span></span>
<span><span class="co">#&gt;   lReLU = (rxode2_fn) R_GetCCallable("rxode2", "lReLU");</span></span>
<span><span class="co">#&gt;   dSELU = (rxode2_fn) R_GetCCallable("rxode2", "dSELU");</span></span>
<span><span class="co">#&gt;   SELU = (rxode2_fn) R_GetCCallable("rxode2", "SELU");</span></span>
<span><span class="co">#&gt;   d4softplus = (rxode2_fn) R_GetCCallable("rxode2", "d4softplus");</span></span>
<span><span class="co">#&gt;   d3softplus = (rxode2_fn) R_GetCCallable("rxode2", "d3softplus");</span></span>
<span><span class="co">#&gt;   d2softplus = (rxode2_fn) R_GetCCallable("rxode2", "d2softplus");</span></span>
<span><span class="co">#&gt;   dsoftplus = (rxode2_fn) R_GetCCallable("rxode2", "dsoftplus");</span></span>
<span><span class="co">#&gt;   softplus = (rxode2_fn) R_GetCCallable("rxode2", "softplus");</span></span>
<span><span class="co">#&gt;   d4GELU = (rxode2_fn) R_GetCCallable("rxode2", "d4GELU");</span></span>
<span><span class="co">#&gt;   d3GELU = (rxode2_fn) R_GetCCallable("rxode2", "d3GELU");</span></span>
<span><span class="co">#&gt;   d2GELU = (rxode2_fn) R_GetCCallable("rxode2", "d2GELU");</span></span>
<span><span class="co">#&gt;   dGELU = (rxode2_fn) R_GetCCallable("rxode2", "dGELU");</span></span>
<span><span class="co">#&gt;   GELU = (rxode2_fn) R_GetCCallable("rxode2", "GELU");</span></span>
<span><span class="co">#&gt;   dReLU = (rxode2_fn) R_GetCCallable("rxode2", "dReLU");</span></span>
<span><span class="co">#&gt;   ReLU = (rxode2_fn) R_GetCCallable("rxode2", "ReLU");</span></span>
<span><span class="co">#&gt;   riweibull = (rxode2i2_fn2) R_GetCCallable("rxode2", "riweibull");</span></span>
<span><span class="co">#&gt;   riunif = (rxode2i2_fn2) R_GetCCallable("rxode2", "riunif");</span></span>
<span><span class="co">#&gt;   rit_ = (rxode2i2_fn) R_GetCCallable("rxode2", "rit_");</span></span>
<span><span class="co">#&gt;   ripois = (rxode2i2_ifn) R_GetCCallable("rxode2", "ripois");</span></span>
<span><span class="co">#&gt;   ribeta = (rxode2i2_fn2) R_GetCCallable("rxode2", "ribeta");</span></span>
<span><span class="co">#&gt;   rigamma = (rxode2i2_fn2) R_GetCCallable("rxode2", "rigamma");</span></span>
<span><span class="co">#&gt;   rigeom = (rxode2i2_ifn) R_GetCCallable("rxode2", "rigeom");</span></span>
<span><span class="co">#&gt;   rif = (rxode2i2_fn2) R_GetCCallable("rxode2", "rif");</span></span>
<span><span class="co">#&gt;   riexp = (rxode2i2_fn) R_GetCCallable("rxode2", "riexp");</span></span>
<span><span class="co">#&gt;   richisq = (rxode2i2_fn) R_GetCCallable("rxode2", "richisq");</span></span>
<span><span class="co">#&gt;   ricauchy = (rxode2i2_fn2) R_GetCCallable("rxode2", "ricauchy");</span></span>
<span><span class="co">#&gt;   rinbinomMu = (rxode2i2_ribinom) R_GetCCallable("rxode2", "rinbinomMu");</span></span>
<span><span class="co">#&gt;   rinbinom = (rxode2i2_ribinom) R_GetCCallable("rxode2", "rinbinom");</span></span>
<span><span class="co">#&gt;   ribinom = (rxode2i2_ribinom) R_GetCCallable("rxode2", "ribinom");</span></span>
<span><span class="co">#&gt;   rinorm = (rxode2i2_fn2) R_GetCCallable("rxode2", "rinorm");</span></span>
<span><span class="co">#&gt;   rxweibull = (rxode2i_fn2) R_GetCCallable("rxode2", "rxweibull");</span></span>
<span><span class="co">#&gt;   rxunif = (rxode2i_fn2) R_GetCCallable("rxode2", "rxunif");</span></span>
<span><span class="co">#&gt;   rxt_ = (rxode2i_fn) R_GetCCallable("rxode2", "rxt_");</span></span>
<span><span class="co">#&gt;   rxpois = (rxode2i_ifn) R_GetCCallable("rxode2", "rxpois");</span></span>
<span><span class="co">#&gt;   rxbeta = (rxode2i_fn2) R_GetCCallable("rxode2", "rxbeta");</span></span>
<span><span class="co">#&gt;   rxgamma = (rxode2i_fn2) R_GetCCallable("rxode2", "rxgamma");</span></span>
<span><span class="co">#&gt;   rxgeom = (rxode2i_ifn) R_GetCCallable("rxode2", "rxgeom");</span></span>
<span><span class="co">#&gt;   rxf = (rxode2i_fn2) R_GetCCallable("rxode2", "rxf");</span></span>
<span><span class="co">#&gt;   rxexp = (rxode2i_fn) R_GetCCallable("rxode2", "rxexp");</span></span>
<span><span class="co">#&gt;   rxchisq = (rxode2i_fn) R_GetCCallable("rxode2", "rxchisq");</span></span>
<span><span class="co">#&gt;   rxcauchy = (rxode2i_fn2) R_GetCCallable("rxode2", "rxcauchy");</span></span>
<span><span class="co">#&gt;   rxnbinomMu = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxnbinomMu");</span></span>
<span><span class="co">#&gt;   rxnbinom = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxnbinom");</span></span>
<span><span class="co">#&gt;   rxbinom = (rxode2i_rxbinom) R_GetCCallable("rxode2", "rxbinom");</span></span>
<span><span class="co">#&gt;   rxnorm = (rxode2i_fn2) R_GetCCallable("rxode2", "rxnorm");</span></span>
<span><span class="co">#&gt;   linCmtB = (linCmtB_p) R_GetCCallable("rxode2", "linCmtB");</span></span>
<span><span class="co">#&gt;   linCmtA = (linCmtA_p) R_GetCCallable("rxode2", "linCmtA");</span></span>
<span><span class="co">#&gt;   // dynamic stop</span></span>
<span><span class="co">#&gt;   _solveData = _getRxSolve_();</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void _assignFuns(void) {</span></span>
<span><span class="co">#&gt;   if (_assign_ptr == NULL){</span></span>
<span><span class="co">#&gt;     _assignFuns0();</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; void __assignFuns2(rx_solve rx,</span></span>
<span><span class="co">#&gt;                    rx_solving_options op,</span></span>
<span><span class="co">#&gt;                    t_F f,</span></span>
<span><span class="co">#&gt;                    t_LAG lag,</span></span>
<span><span class="co">#&gt;                    t_RATE rate,</span></span>
<span><span class="co">#&gt;                    t_DUR dur,</span></span>
<span><span class="co">#&gt;                    t_calc_mtime mtime,</span></span>
<span><span class="co">#&gt;                    t_ME me,</span></span>
<span><span class="co">#&gt;                    t_IndF indf,</span></span>
<span><span class="co">#&gt;                    t_getTime gettime,</span></span>
<span><span class="co">#&gt;                    t_locateTimeIndex timeindex,</span></span>
<span><span class="co">#&gt;                    t_handle_evidL handleEvid,</span></span>
<span><span class="co">#&gt;                    t_getDur getdur) {</span></span>
<span><span class="co">#&gt;   // assign start</span></span>
<span><span class="co">#&gt;     static rxode2_assignFuns2_t rxode2_assignFuns2 = NULL;</span></span>
<span><span class="co">#&gt;     if (rxode2_assignFuns2 == NULL) rxode2_assignFuns2 = (rxode2_assignFuns2_t)(R_GetCCallable("rxode2", "_rxode2_assignFuns2"));</span></span>
<span><span class="co">#&gt;     rxode2_assignFuns2(rx, op, f, lag, rate, dur, mtime, me, indf, gettime, timeindex, handleEvid, getdur);</span></span>
<span><span class="co">#&gt;   // assign stop</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void  rx_91d591d68fc26fd14386b3d46f46cb48__ode_solver_solvedata (rx_solve *solve){</span></span>
<span><span class="co">#&gt;   _solveData = solve;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern rx_solve *rx_91d591d68fc26fd14386b3d46f46cb48__ode_solver_get_solvedata(void){</span></span>
<span><span class="co">#&gt;   return _solveData;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; SEXP rx_91d591d68fc26fd14386b3d46f46cb48__model_vars(void);</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; // prj-specific differential eqns</span></span>
<span><span class="co">#&gt; void rx_91d591d68fc26fd14386b3d46f46cb48__dydt(int *_neq, double __t, double *__zzStateVar__, double *__DDtStateVar__)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   int _cSub = _neq[1];</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_neq[1]].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=1;</span></span>
<span><span class="co">#&gt;   double cl = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tcl = NA_REAL;</span></span>
<span><span class="co">#&gt;   double crcl_DoT_cl = NA_REAL;</span></span>
<span><span class="co">#&gt;   double CLCR = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_cl = NA_REAL;</span></span>
<span><span class="co">#&gt;   double v = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tv = NA_REAL;</span></span>
<span><span class="co">#&gt;   double WT = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_v = NA_REAL;</span></span>
<span><span class="co">#&gt;   double ka = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tka = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_ka = NA_REAL;</span></span>
<span><span class="co">#&gt;   double ipred = NA_REAL;</span></span>
<span><span class="co">#&gt;   double obs = NA_REAL;</span></span>
<span><span class="co">#&gt;   double prop_DoT_sd = NA_REAL;</span></span>
<span><span class="co">#&gt;   double add_DoT_sd = NA_REAL;</span></span>
<span><span class="co">#&gt;   double depot = NA_REAL;</span></span>
<span><span class="co">#&gt;   double central = NA_REAL;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   (void)cl;</span></span>
<span><span class="co">#&gt;   (void)tcl;</span></span>
<span><span class="co">#&gt;   (void)crcl_DoT_cl;</span></span>
<span><span class="co">#&gt;   (void)CLCR;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_cl;</span></span>
<span><span class="co">#&gt;   (void)v;</span></span>
<span><span class="co">#&gt;   (void)tv;</span></span>
<span><span class="co">#&gt;   (void)WT;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_v;</span></span>
<span><span class="co">#&gt;   (void)ka;</span></span>
<span><span class="co">#&gt;   (void)tka;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_ka;</span></span>
<span><span class="co">#&gt;   (void)ipred;</span></span>
<span><span class="co">#&gt;   (void)obs;</span></span>
<span><span class="co">#&gt;   (void)prop_DoT_sd;</span></span>
<span><span class="co">#&gt;   (void)add_DoT_sd;</span></span>
<span><span class="co">#&gt;   (void)depot;</span></span>
<span><span class="co">#&gt;   (void)central;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   cl = _PL[0];</span></span>
<span><span class="co">#&gt;   v = _PL[1];</span></span>
<span><span class="co">#&gt;   ka = _PL[2];</span></span>
<span><span class="co">#&gt;   ipred = _PL[3];</span></span>
<span><span class="co">#&gt;   obs = _PL[4];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _update_par_ptr(__t, _cSub, _solveData, _idx);</span></span>
<span><span class="co">#&gt;   tcl = _PP[0];</span></span>
<span><span class="co">#&gt;   crcl_DoT_cl = _PP[1];</span></span>
<span><span class="co">#&gt;   CLCR = _PP[2];</span></span>
<span><span class="co">#&gt;   eta_DoT_cl = _PP[3];</span></span>
<span><span class="co">#&gt;   tv = _PP[4];</span></span>
<span><span class="co">#&gt;   WT = _PP[5];</span></span>
<span><span class="co">#&gt;   eta_DoT_v = _PP[6];</span></span>
<span><span class="co">#&gt;   tka = _PP[7];</span></span>
<span><span class="co">#&gt;   eta_DoT_ka = _PP[8];</span></span>
<span><span class="co">#&gt;   prop_DoT_sd = _PP[9];</span></span>
<span><span class="co">#&gt;   add_DoT_sd = _PP[10];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   depot = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">#&gt;   central = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   cl=tcl*(1+crcl_DoT_cl*(CLCR-65))*exp(eta_DoT_cl);</span></span>
<span><span class="co">#&gt;   v=tv*WT*exp(eta_DoT_v);</span></span>
<span><span class="co">#&gt;   ka=tka*exp(eta_DoT_ka);</span></span>
<span><span class="co">#&gt;   ipred=linCmtA(_solveData, _cSub,t,2,1,1,-1,1,cl,v,0.0,0.0,0.0,0.0,ka);</span></span>
<span><span class="co">#&gt;   obs=ipred*(1+prop_DoT_sd)+add_DoT_sd;</span></span>
<span><span class="co">#&gt;   (&amp;_solveData-&gt;subjects[_cSub])-&gt;dadt_counter[0]++;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; // Jacobian derived vars</span></span>
<span><span class="co">#&gt; void rx_91d591d68fc26fd14386b3d46f46cb48__calc_jac(int *_neq, double __t, double *__zzStateVar__, double *__PDStateVar__, unsigned int __NROWPD__) {</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;     int _cSub=_neq[1];</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_neq[1]].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=2;</span></span>
<span><span class="co">#&gt;   (&amp;_solveData-&gt;subjects[_cSub])-&gt;jac_counter[0]++;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Functional based initial conditions.</span></span>
<span><span class="co">#&gt; void rx_91d591d68fc26fd14386b3d46f46cb48__inis(int _cSub, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;  _ind-&gt;_rxFlag=3;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // prj-specific derived vars</span></span>
<span><span class="co">#&gt; void rx_91d591d68fc26fd14386b3d46f46cb48__calc_lhs(int _cSub, double __t, double *__zzStateVar__, double *_lhs) {</span></span>
<span><span class="co">#&gt;     int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=11;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_0__;</span></span>
<span><span class="co">#&gt;   double  __DDtStateVar_1__;</span></span>
<span><span class="co">#&gt;   double cl = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tcl = NA_REAL;</span></span>
<span><span class="co">#&gt;   double crcl_DoT_cl = NA_REAL;</span></span>
<span><span class="co">#&gt;   double CLCR = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_cl = NA_REAL;</span></span>
<span><span class="co">#&gt;   double v = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tv = NA_REAL;</span></span>
<span><span class="co">#&gt;   double WT = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_v = NA_REAL;</span></span>
<span><span class="co">#&gt;   double ka = NA_REAL;</span></span>
<span><span class="co">#&gt;   double tka = NA_REAL;</span></span>
<span><span class="co">#&gt;   double eta_DoT_ka = NA_REAL;</span></span>
<span><span class="co">#&gt;   double ipred = NA_REAL;</span></span>
<span><span class="co">#&gt;   double obs = NA_REAL;</span></span>
<span><span class="co">#&gt;   double prop_DoT_sd = NA_REAL;</span></span>
<span><span class="co">#&gt;   double add_DoT_sd = NA_REAL;</span></span>
<span><span class="co">#&gt;   double depot = NA_REAL;</span></span>
<span><span class="co">#&gt;   double central = NA_REAL;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_0__;</span></span>
<span><span class="co">#&gt;   (void)__DDtStateVar_1__;</span></span>
<span><span class="co">#&gt;   (void)cl;</span></span>
<span><span class="co">#&gt;   (void)tcl;</span></span>
<span><span class="co">#&gt;   (void)crcl_DoT_cl;</span></span>
<span><span class="co">#&gt;   (void)CLCR;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_cl;</span></span>
<span><span class="co">#&gt;   (void)v;</span></span>
<span><span class="co">#&gt;   (void)tv;</span></span>
<span><span class="co">#&gt;   (void)WT;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_v;</span></span>
<span><span class="co">#&gt;   (void)ka;</span></span>
<span><span class="co">#&gt;   (void)tka;</span></span>
<span><span class="co">#&gt;   (void)eta_DoT_ka;</span></span>
<span><span class="co">#&gt;   (void)ipred;</span></span>
<span><span class="co">#&gt;   (void)obs;</span></span>
<span><span class="co">#&gt;   (void)prop_DoT_sd;</span></span>
<span><span class="co">#&gt;   (void)add_DoT_sd;</span></span>
<span><span class="co">#&gt;   (void)depot;</span></span>
<span><span class="co">#&gt;   (void)central;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   cl = _PL[0];</span></span>
<span><span class="co">#&gt;   v = _PL[1];</span></span>
<span><span class="co">#&gt;   ka = _PL[2];</span></span>
<span><span class="co">#&gt;   ipred = _PL[3];</span></span>
<span><span class="co">#&gt;   obs = _PL[4];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _update_par_ptr(__t, _cSub, _solveData, _idx);</span></span>
<span><span class="co">#&gt;   tcl = _PP[0];</span></span>
<span><span class="co">#&gt;   crcl_DoT_cl = _PP[1];</span></span>
<span><span class="co">#&gt;   CLCR = _PP[2];</span></span>
<span><span class="co">#&gt;   eta_DoT_cl = _PP[3];</span></span>
<span><span class="co">#&gt;   tv = _PP[4];</span></span>
<span><span class="co">#&gt;   WT = _PP[5];</span></span>
<span><span class="co">#&gt;   eta_DoT_v = _PP[6];</span></span>
<span><span class="co">#&gt;   tka = _PP[7];</span></span>
<span><span class="co">#&gt;   eta_DoT_ka = _PP[8];</span></span>
<span><span class="co">#&gt;   prop_DoT_sd = _PP[9];</span></span>
<span><span class="co">#&gt;   add_DoT_sd = _PP[10];</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   depot = __zzStateVar__[__DDT0__]*((double)(_ON[__DDT0__]));</span></span>
<span><span class="co">#&gt;   central = __zzStateVar__[__DDT1__]*((double)(_ON[__DDT1__]));</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   cl=tcl*(1+crcl_DoT_cl*(CLCR-65))*exp(eta_DoT_cl);</span></span>
<span><span class="co">#&gt;   v=tv*WT*exp(eta_DoT_v);</span></span>
<span><span class="co">#&gt;   ka=tka*exp(eta_DoT_ka);</span></span>
<span><span class="co">#&gt;   ipred=linCmtA(_solveData, _cSub,t,2,1,1,-1,1,cl,v,0.0,0.0,0.0,0.0,ka);</span></span>
<span><span class="co">#&gt;   obs=ipred*(1+prop_DoT_sd)+add_DoT_sd;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   _lhs[_LHS_0_]=cl;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_1_]=v;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_2_]=ka;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_3_]=ipred;</span></span>
<span><span class="co">#&gt;   _lhs[_LHS_4_]=obs;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Functional based bioavailability</span></span>
<span><span class="co">#&gt; double rx_91d591d68fc26fd14386b3d46f46cb48__F(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return _amt;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; // Functional based absorption lag</span></span>
<span><span class="co">#&gt; double rx_91d591d68fc26fd14386b3d46f46cb48__Lag(int _cSub,  int _cmt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return __t;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Modeled zero-order rate</span></span>
<span><span class="co">#&gt; double rx_91d591d68fc26fd14386b3d46f46cb48__Rate(int _cSub,  int _cmt, double _amt, double __t, double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;  return 0.0;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Modeled zero-order duration</span></span>
<span><span class="co">#&gt; double rx_91d591d68fc26fd14386b3d46f46cb48__Dur(int _cSub,  int _cmt, double _amt, double __t){</span></span>
<span><span class="co">#&gt;  return 0.0;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Model Times</span></span>
<span><span class="co">#&gt; void rx_91d591d68fc26fd14386b3d46f46cb48__mtime(int _cSub, double *_mtime){</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Matrix Exponential (0)</span></span>
<span><span class="co">#&gt; void rx_91d591d68fc26fd14386b3d46f46cb48__ME(int _cSub, double _t, double __t, double *_mat, const double *__zzStateVar__){</span></span>
<span><span class="co">#&gt;   int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=9;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; // Inductive linearization Matf</span></span>
<span><span class="co">#&gt; void rx_91d591d68fc26fd14386b3d46f46cb48__IndF(int _cSub, double _t, double __t, double *_matf){</span></span>
<span><span class="co">#&gt;  int _itwhile = 0;</span></span>
<span><span class="co">#&gt;   (void)_itwhile;</span></span>
<span><span class="co">#&gt;   double t = __t + _solveData-&gt;subjects[_cSub].curShift;</span></span>
<span><span class="co">#&gt;   (void)t;</span></span>
<span><span class="co">#&gt;   rx_solving_options_ind *_ind = &amp;(_solveData-&gt;subjects[_cSub]);</span></span>
<span><span class="co">#&gt;   _ind-&gt;_rxFlag=10;</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern SEXP rx_91d591d68fc26fd14386b3d46f46cb48__model_vars(void){</span></span>
<span><span class="co">#&gt;   int pro=0;</span></span>
<span><span class="co">#&gt;   SEXP _mv = PROTECT(_rxGetModelLib("rx_91d591d68fc26fd14386b3d46f46cb48__model_vars"));pro++;</span></span>
<span><span class="co">#&gt;   if (!_rxIsCurrentC(_mv)){</span></span>
<span><span class="co">#&gt;     SEXP hash    = PROTECT(Rf_allocVector(STRSXP, 1));pro++;</span></span>
<span><span class="co">#&gt; #define __doBuf__  snprintf(buf, __doBufN__, "un]\"BAAA@QRtHACAAAAAAA@Q$AAAv7#aT)5xF[PAxhWfi\"W$Tu1)GS%%j8_7&gt;+;A#Az5)4/jJ8h+4=!`]O4&lt;!&amp;7FgkLRRpIK,u0OjhH{6&amp;#9U5/&amp;R.GojmxX\"hXykTA`ApDF%%P{yl%%0oxP|.=F@K[JP&gt;*UM@d4hOT3s(E;Q^&amp;85Xg(SeY9v$`&gt;(l&amp;jUd&lt;$L;fY&gt;g&lt;y^r{E0]]Ss0=$y^Y$|lpUmfOvb$BDoBJOIuEH_DQ}j9[Qqg9yz~PI:bKU4GYr$&lt;UGVmx[$Szi4)IBsO0%%G1$++$`L{^\?OC,FV&lt;I%%P&lt;=eXJEikM)b~p`b.^mytt\"S_QggQ_dM!SvHN=zDqV#t&amp;\"hLSmEXDQpEN9E98WscQD^IKc}t:R}Ts381y2y222Ac&gt;qEi`ByEDj(!l.}4Z;$`L{{&amp;&gt;vFf;IM)r!BS\"4Ye/_Kr\?!Z\?yc8zee&amp;%%8V|UEXyM&amp;+:IxgT$[C#ZlVD5JMz/%%);ZjQ&amp;_1z0!6]zZq~{XGWbgKBo*oV$X(QLzRw&lt;.cmWUJ3qP1^Z=oBS~J)Ij(DtZ@nYnek\?&gt;D(${ch%%KO6(dP(Ejf6jp{r&amp;:nnt(l:5!|EH\?:C4ky`Oy2*73X(5vgHPIE$fH|=I.1+1ntTd768!~&amp;:hyHsM~xRaB,{C}KMvqoa7_;XyKFN}C{Et~yw|kepO,D1+;vGz1Qfm$tEW,%%2UR\"hWsKe|0NQRRgOm&lt;%%L=f|:dml#3y\?&amp;cH1VNs)uG1yDn\";s6rXN4Qo$zdQ{DB@%%VuR&amp;oE~pwat95&lt;_\",3{2bsSV&lt;@[T(sob%%po0\?nEjps^sW8bjGsOnn;6g+%%Ba0;LKJm13Q%%&gt;CrLkjxmkw)~G4i}$`SV[xB`e(Ka3kr&gt;^_FvZr&lt;;u8\"y4nJ8|9lC$]{W=_u~1^1cj.\?=qe2prCQ^OOyu5[pFC\"l+h]T@xy6L^CEH].6UiK!)sX~vtEPO9Bad&lt;MhEcM&gt;WeY;!hG|LX/1XEY^XxBBYPD84]2!!rRJuItv0MBRRfzU$|wlOk|}NyLtD#&lt;*af~&gt;}!LY*!7:I/v)]@aTMy|/Boz7Cz3izwA3M5G)m.Ybiw_jqK9!TTl\?E%%3SUIoaLKJj)r_&gt;bFn=j*OzO#,:z5t,i%%)IYv&gt;5[2Z\"y*AXv9t=K@0b0&amp;\?YRTGG(Z1e[O8x&lt;_ZJI7&amp;!*EFTf!WO=fFXzmByXvpb2]QpvcE,Fz&lt;t/j@89lJ3&lt;sv=asWILcw[cs!T/,MHnvWi\?bB:14Ey\?Nit.`o@K@WL7=W\"h/v4jN%%$PcFCx2l/Jupy1*STEs=NZCihl7Xitz)yZyrQTf&gt;(M^qf,^:C0Bjd6]I+h9s~xxg^A");</span></span>
<span><span class="co">#&gt;     char buf[1314];</span></span>
<span><span class="co">#&gt; #define __doBufN__ 1314</span></span>
<span><span class="co">#&gt;     __doBuf__</span></span>
<span><span class="co">#&gt; #undef __doBuf__</span></span>
<span><span class="co">#&gt; #undef __doBufN__</span></span>
<span><span class="co">#&gt;     SET_STRING_ELT(hash, 0, Rf_mkChar(buf));</span></span>
<span><span class="co">#&gt;     SEXP lst      = PROTECT(_rxQr(hash));pro++;</span></span>
<span><span class="co">#&gt;     _assign_ptr(lst);</span></span>
<span><span class="co">#&gt;     UNPROTECT(pro);</span></span>
<span><span class="co">#&gt;     return lst;</span></span>
<span><span class="co">#&gt;   } else {</span></span>
<span><span class="co">#&gt;     UNPROTECT(pro);</span></span>
<span><span class="co">#&gt;     return _mv;</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void rx_91d591d68fc26fd14386b3d46f46cb48__dydt_lsoda(int *neq, double *t, double *A, double *DADT)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   rx_91d591d68fc26fd14386b3d46f46cb48__dydt(neq, *t, A, DADT);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern int rx_91d591d68fc26fd14386b3d46f46cb48__dydt_liblsoda(double __t, double *y, double *ydot, void *data)</span></span>
<span><span class="co">#&gt; {</span></span>
<span><span class="co">#&gt;   int *neq = (int*)(data);</span></span>
<span><span class="co">#&gt;   rx_91d591d68fc26fd14386b3d46f46cb48__dydt(neq, __t, y, ydot);</span></span>
<span><span class="co">#&gt;   return(0);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; extern void rx_91d591d68fc26fd14386b3d46f46cb48__calc_jac_lsoda(int *neq, double *t, double *A,int *ml, int *mu, double *JAC, int *nrowpd){</span></span>
<span><span class="co">#&gt;   // Update all covariate parameters</span></span>
<span><span class="co">#&gt;   rx_91d591d68fc26fd14386b3d46f46cb48__calc_jac(neq, *t, A, JAC, *nrowpd);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; //Create function to call from R's main thread that assigns the required functions. Sometimes they don't get assigned.</span></span>
<span><span class="co">#&gt; extern void rx_91d591d68fc26fd14386b3d46f46cb48__assignFuns(void){</span></span>
<span><span class="co">#&gt;   _assignFuns();</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; //Initialize the dll to match rxode2's calls</span></span>
<span><span class="co">#&gt; void R_init0_rx_91d591d68fc26fd14386b3d46f46cb48_(void){</span></span>
<span><span class="co">#&gt;   // Get C callables on load; Otherwise it isn't thread safe</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_91d591d68fc26fd14386b3d46f46cb48_","rx_91d591d68fc26fd14386b3d46f46cb48__assignFuns2", (DL_FUNC) __assignFuns2);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_91d591d68fc26fd14386b3d46f46cb48_","rx_91d591d68fc26fd14386b3d46f46cb48__assignFuns", (DL_FUNC) rx_91d591d68fc26fd14386b3d46f46cb48__assignFuns);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_91d591d68fc26fd14386b3d46f46cb48_","rx_91d591d68fc26fd14386b3d46f46cb48__inis",(DL_FUNC) rx_91d591d68fc26fd14386b3d46f46cb48__inis);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_91d591d68fc26fd14386b3d46f46cb48_","rx_91d591d68fc26fd14386b3d46f46cb48__dydt",(DL_FUNC) rx_91d591d68fc26fd14386b3d46f46cb48__dydt);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_91d591d68fc26fd14386b3d46f46cb48_","rx_91d591d68fc26fd14386b3d46f46cb48__calc_lhs",(DL_FUNC) rx_91d591d68fc26fd14386b3d46f46cb48__calc_lhs);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_91d591d68fc26fd14386b3d46f46cb48_","rx_91d591d68fc26fd14386b3d46f46cb48__calc_jac",(DL_FUNC) rx_91d591d68fc26fd14386b3d46f46cb48__calc_jac);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_91d591d68fc26fd14386b3d46f46cb48_","rx_91d591d68fc26fd14386b3d46f46cb48__dydt_lsoda", (DL_FUNC) rx_91d591d68fc26fd14386b3d46f46cb48__dydt_lsoda);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_91d591d68fc26fd14386b3d46f46cb48_","rx_91d591d68fc26fd14386b3d46f46cb48__calc_jac_lsoda", (DL_FUNC) rx_91d591d68fc26fd14386b3d46f46cb48__calc_jac_lsoda);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_91d591d68fc26fd14386b3d46f46cb48_","rx_91d591d68fc26fd14386b3d46f46cb48__ode_solver_solvedata", (DL_FUNC) rx_91d591d68fc26fd14386b3d46f46cb48__ode_solver_solvedata);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_91d591d68fc26fd14386b3d46f46cb48_","rx_91d591d68fc26fd14386b3d46f46cb48__ode_solver_get_solvedata", (DL_FUNC) rx_91d591d68fc26fd14386b3d46f46cb48__ode_solver_get_solvedata);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_91d591d68fc26fd14386b3d46f46cb48_","rx_91d591d68fc26fd14386b3d46f46cb48__F", (DL_FUNC) rx_91d591d68fc26fd14386b3d46f46cb48__F);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_91d591d68fc26fd14386b3d46f46cb48_","rx_91d591d68fc26fd14386b3d46f46cb48__Lag", (DL_FUNC) rx_91d591d68fc26fd14386b3d46f46cb48__Lag);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_91d591d68fc26fd14386b3d46f46cb48_","rx_91d591d68fc26fd14386b3d46f46cb48__Rate", (DL_FUNC) rx_91d591d68fc26fd14386b3d46f46cb48__Rate);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_91d591d68fc26fd14386b3d46f46cb48_","rx_91d591d68fc26fd14386b3d46f46cb48__Dur", (DL_FUNC) rx_91d591d68fc26fd14386b3d46f46cb48__Dur);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_91d591d68fc26fd14386b3d46f46cb48_","rx_91d591d68fc26fd14386b3d46f46cb48__mtime", (DL_FUNC) rx_91d591d68fc26fd14386b3d46f46cb48__mtime);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_91d591d68fc26fd14386b3d46f46cb48_","rx_91d591d68fc26fd14386b3d46f46cb48__ME", (DL_FUNC) rx_91d591d68fc26fd14386b3d46f46cb48__ME);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_91d591d68fc26fd14386b3d46f46cb48_","rx_91d591d68fc26fd14386b3d46f46cb48__IndF", (DL_FUNC) rx_91d591d68fc26fd14386b3d46f46cb48__IndF);</span></span>
<span><span class="co">#&gt;   R_RegisterCCallable("rx_91d591d68fc26fd14386b3d46f46cb48_","rx_91d591d68fc26fd14386b3d46f46cb48__dydt_liblsoda", (DL_FUNC) rx_91d591d68fc26fd14386b3d46f46cb48__dydt_liblsoda);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; //Initialize the dll to match rxode2's calls</span></span>
<span><span class="co">#&gt; void R_init_rx_91d591d68fc26fd14386b3d46f46cb48_(DllInfo *info){</span></span>
<span><span class="co">#&gt;   // Get C callables on load; Otherwise it isn't thread safe</span></span>
<span><span class="co">#&gt;   R_init0_rx_91d591d68fc26fd14386b3d46f46cb48_();</span></span>
<span><span class="co">#&gt;   static const R_CallMethodDef callMethods[]  = {</span></span>
<span><span class="co">#&gt;     {"rx_91d591d68fc26fd14386b3d46f46cb48__model_vars", (DL_FUNC) &amp;rx_91d591d68fc26fd14386b3d46f46cb48__model_vars, 0},</span></span>
<span><span class="co">#&gt;     {NULL, NULL, 0}</span></span>
<span><span class="co">#&gt;   };</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   R_registerRoutines(info, NULL, callMethods, NULL, NULL);</span></span>
<span><span class="co">#&gt;   R_useDynamicSymbols(info,FALSE);</span></span>
<span><span class="co">#&gt;   _assignFuns0();</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; void R_unload_rx_91d591d68fc26fd14386b3d46f46cb48_ (DllInfo *info){</span></span>
<span><span class="co">#&gt;   // Free resources required for single subject solve.</span></span>
<span><span class="co">#&gt;   SEXP _mv = PROTECT(_rxGetModelLib("rx_91d591d68fc26fd14386b3d46f46cb48__model_vars"));</span></span>
<span><span class="co">#&gt;   if (!Rf_isNull(_mv)){</span></span>
<span><span class="co">#&gt;     _rxRmModelLib("rx_91d591d68fc26fd14386b3d46f46cb48__model_vars");</span></span>
<span><span class="co">#&gt;   }</span></span>
<span><span class="co">#&gt;   UNPROTECT(1);</span></span>
<span><span class="co">#&gt; }</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’</span></span></code></pre></div>
<p>Next we input the estimated parameters:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>tcl<span class="op">=</span><span class="fl">2.63E+01</span>, tv<span class="op">=</span><span class="fl">1.35E+00</span>, tka<span class="op">=</span><span class="fl">4.20E+00</span>, tlag<span class="op">=</span><span class="fl">2.08E-01</span>,</span>
<span>           prop.sd<span class="op">=</span><span class="fl">2.05E-01</span>, add.sd<span class="op">=</span><span class="fl">1.06E-02</span>, crcl.cl<span class="op">=</span><span class="fl">7.17E-03</span>,</span>
<span>           <span class="co">## Note that since we are using the separation strategy the ETA variances are here too</span></span>
<span>           eta.cl<span class="op">=</span><span class="fl">7.30E-02</span>,  eta.v<span class="op">=</span><span class="fl">3.80E-02</span>, eta.ka<span class="op">=</span><span class="fl">1.91E+00</span><span class="op">)</span></span></code></pre></div>
<p>And also their covariances; To me, the easiest way to create a named
covariance matrix is to use <code><a href="https://nlmixr2.github.io/lotri/reference/lotri.html" class="external-link">lotri()</a></code>:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">thetaMat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://nlmixr2.github.io/lotri/reference/lotri.html" class="external-link">lotri</a></span><span class="op">(</span></span>
<span>    <span class="va">tcl</span> <span class="op">+</span> <span class="va">tv</span> <span class="op">+</span> <span class="va">tka</span> <span class="op">+</span> <span class="va">tlag</span> <span class="op">+</span> <span class="va">prop.sd</span> <span class="op">+</span> <span class="va">add.sd</span> <span class="op">+</span> <span class="va">crcl.cl</span> <span class="op">+</span> <span class="va">eta.cl</span> <span class="op">+</span> <span class="va">eta.v</span> <span class="op">+</span> <span class="va">eta.ka</span> <span class="op">~</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7.95E-01</span>,</span>
<span>          <span class="fl">2.05E-02</span>, <span class="fl">1.92E-03</span>,</span>
<span>          <span class="fl">7.22E-02</span>, <span class="op">-</span><span class="fl">8.30E-03</span>, <span class="fl">6.55E-01</span>,</span>
<span>          <span class="op">-</span><span class="fl">3.45E-03</span>, <span class="op">-</span><span class="fl">6.42E-05</span>, <span class="fl">3.22E-03</span>, <span class="fl">2.47E-04</span>,</span>
<span>          <span class="fl">8.71E-04</span>, <span class="fl">2.53E-04</span>, <span class="op">-</span><span class="fl">4.71E-03</span>, <span class="op">-</span><span class="fl">5.79E-05</span>, <span class="fl">5.04E-04</span>,</span>
<span>          <span class="fl">6.30E-04</span>, <span class="op">-</span><span class="fl">3.17E-06</span>, <span class="op">-</span><span class="fl">6.52E-04</span>, <span class="op">-</span><span class="fl">1.53E-05</span>, <span class="op">-</span><span class="fl">3.14E-05</span>, <span class="fl">1.34E-05</span>,</span>
<span>          <span class="op">-</span><span class="fl">3.30E-04</span>, <span class="fl">5.46E-06</span>, <span class="op">-</span><span class="fl">3.15E-04</span>, <span class="fl">2.46E-06</span>, <span class="fl">3.15E-06</span>, <span class="op">-</span><span class="fl">1.58E-06</span>, <span class="fl">2.88E-06</span>,</span>
<span>          <span class="op">-</span><span class="fl">1.29E-03</span>, <span class="op">-</span><span class="fl">7.97E-05</span>, <span class="fl">1.68E-03</span>, <span class="op">-</span><span class="fl">2.75E-05</span>, <span class="op">-</span><span class="fl">8.26E-05</span>, <span class="fl">1.13E-05</span>, <span class="op">-</span><span class="fl">1.66E-06</span>, <span class="fl">1.58E-04</span>,</span>
<span>          <span class="op">-</span><span class="fl">1.23E-03</span>, <span class="op">-</span><span class="fl">1.27E-05</span>, <span class="op">-</span><span class="fl">1.33E-03</span>, <span class="op">-</span><span class="fl">1.47E-05</span>, <span class="op">-</span><span class="fl">1.03E-04</span>, <span class="fl">1.02E-05</span>, <span class="fl">1.67E-06</span>, <span class="fl">6.68E-05</span>, <span class="fl">1.56E-04</span>,</span>
<span>          <span class="fl">7.69E-02</span>, <span class="op">-</span><span class="fl">7.23E-03</span>, <span class="fl">3.74E-01</span>, <span class="fl">1.79E-03</span>, <span class="op">-</span><span class="fl">2.85E-03</span>, <span class="fl">1.18E-05</span>, <span class="op">-</span><span class="fl">2.54E-04</span>, <span class="fl">1.61E-03</span>, <span class="op">-</span><span class="fl">9.03E-04</span>, <span class="fl">3.12E-01</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">evw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>amount.units<span class="op">=</span><span class="st">"mg"</span>, time.units<span class="op">=</span><span class="st">"hours"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>amt<span class="op">=</span><span class="fl">100</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="co">## For this problem we will simulate with sampling windows</span></span>
<span>    <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>id<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## From the run we know that:</span></span>
<span><span class="co">##   total number of observations is: 476</span></span>
<span><span class="co">##    Total number of individuals:     74</span></span>
<span><span class="va">sim</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rxSolve.html">rxSolve</a></span><span class="op">(</span><span class="va">rx1</span>, <span class="va">theta</span>, <span class="va">evw</span>,  nSub<span class="op">=</span><span class="fl">100</span>, nStud<span class="op">=</span><span class="fl">10</span>,</span>
<span>                thetaMat<span class="op">=</span><span class="va">thetaMat</span>,</span>
<span>                <span class="co">## Match boundaries of problem</span></span>
<span>                thetaLower<span class="op">=</span><span class="fl">0</span>,</span>
<span>                sigma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"prop.sd"</span>, <span class="st">"add.sd"</span><span class="op">)</span>, <span class="co">## Sigmas are standard deviations</span></span>
<span>                sigmaXform<span class="op">=</span><span class="st">"identity"</span>, <span class="co"># default sigma xform="identity"</span></span>
<span>                omega<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"eta.cl"</span>, <span class="st">"eta.v"</span>, <span class="st">"eta.ka"</span><span class="op">)</span>, <span class="co">## etas are variances</span></span>
<span>                omegaXform<span class="op">=</span><span class="st">"variance"</span>, <span class="co"># default omega xform="variance"</span></span>
<span>                iCov<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>WT<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">70</span>, <span class="fl">15</span><span class="op">)</span>, CLCR<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">65</span>, <span class="fl">25</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                dfSub<span class="op">=</span><span class="fl">74</span>, dfObs<span class="op">=</span><span class="fl">476</span><span class="op">)</span>;</span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> thetaMat has too many items, ignored: 'tlag'</span></span>
<span><span class="co">#&gt; [====|====|====|====|====|====|====|====|====|====] 0:00:00</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Solved rxode2 object ──</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Parameters (</span><span style="color: #0000BB; font-weight: bold;">$params</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10,000 × 9</span></span></span>
<span><span class="co">#&gt;    sim.id id      tcl crcl.cl  eta.cl    tv    eta.v   tka eta.ka</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>      1 1      27.0   0.995  0.489   1.45  0.975    4.51 -<span style="color: #BB0000;">0.186</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>      1 2      27.0   0.995 -<span style="color: #BB0000;">0.770</span>   1.45  0.029<span style="text-decoration: underline;">4</span>   4.51 -<span style="color: #BB0000;">0.116</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>      1 3      27.0   0.995 -<span style="color: #BB0000;">2.13</span>    1.45  0.187    4.51  0.941</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>      1 4      27.0   0.995  0.333   1.45 -<span style="color: #BB0000;">0.346</span>    4.51 -<span style="color: #BB0000;">0.686</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>      1 5      27.0   0.995  1.01    1.45  0.978    4.51  1.69 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>      1 6      27.0   0.995 -<span style="color: #BB0000;">0.474</span>   1.45  1.06     4.51 -<span style="color: #BB0000;">0.641</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>      1 7      27.0   0.995 -<span style="color: #BB0000;">0.048</span><span style="color: #BB0000; text-decoration: underline;">8</span>  1.45  1.18     4.51  0.395</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>      1 8      27.0   0.995  0.267   1.45  0.164    4.51  1.41 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>      1 9      27.0   0.995 -<span style="color: #BB0000;">1.19</span>    1.45  1.24     4.51 -<span style="color: #BB0000;">0.726</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>      1 10     27.0   0.995 -<span style="color: #BB0000;">0.163</span>   1.45 -<span style="color: #BB0000;">0.007</span><span style="color: #BB0000; text-decoration: underline;">41</span>  4.51 -<span style="color: #BB0000;">0.799</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 9,990 more rows</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── Initial Conditions (</span><span style="color: #0000BB; font-weight: bold;">$inits</span><span style="font-weight: bold;">): ──</span></span></span>
<span><span class="co">#&gt;   depot central </span></span>
<span><span class="co">#&gt;       0       0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulation <span style="font-weight: bold;">with uncertainty</span> in:</span></span>
<span><span class="co">#&gt; • parameters (<span style="color: #0000BB; font-weight: bold;">$thetaMat</span> for changes)</span></span>
<span><span class="co">#&gt; • omega matrix (<span style="color: #0000BB; font-weight: bold;">$omegaList</span>)</span></span>
<span><span class="co">#&gt; • sigma matrix (<span style="color: #0000BB; font-weight: bold;">$sigmaList</span>)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">── First part of data (object): ──</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 50,000 × 12</span></span></span>
<span><span class="co">#&gt;   sim.id    id   time    cl     v    ka   ipred    obs   depot central    WT</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494;">[h]</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>      1     1 0.151   230. 240.   3.74 0.167   1.21   5.68<span style="color: #949494;">e</span>+1  39.9    62.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>      1     1 0.568   230. 240.   3.74 0.258   0.700  1.19<span style="color: #949494;">e</span>+1  61.9    62.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>      1     1 1.02    230. 240.   3.74 0.198   0.044<span style="text-decoration: underline;">3</span> 2.18<span style="color: #949494;">e</span>+0  47.5    62.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>      1     1 4.49    230. 240.   3.74 0.007<span style="text-decoration: underline;">53</span> 0.261  5.01<span style="color: #949494;">e</span><span style="color: #BB0000;">-6</span>   1.80   62.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>      1     1 6.19    230. 240.   3.74 0.001<span style="text-decoration: underline;">48</span> 1.21   8.84<span style="color: #949494;">e</span><span style="color: #BB0000;">-9</span>   0.355  62.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>      1     2 0.083<span style="text-decoration: underline;">3</span>  515.  53.3  4.01 0.358   0.620  7.16<span style="color: #949494;">e</span>+1  19.1    35.7</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 49,994 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: CLCR &lt;dbl&gt;</span></span></span>
<span><span class="co">## Notice that the simulation time-points change for the individual</span></span>
<span></span>
<span><span class="co">## If you want the same sampling time-points you can do that as well:</span></span>
<span><span class="va">evw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>amount.units<span class="op">=</span><span class="st">"mg"</span>, time.units<span class="op">=</span><span class="st">"hours"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>amt<span class="op">=</span><span class="fl">100</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">24</span>, length.out<span class="op">=</span><span class="fl">50</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/et.html">et</a></span><span class="op">(</span>id<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rxSolve.html">rxSolve</a></span><span class="op">(</span><span class="va">rx1</span>, <span class="va">theta</span>, <span class="va">evw</span>,  nSub<span class="op">=</span><span class="fl">100</span>, nStud<span class="op">=</span><span class="fl">10</span>,</span>
<span>                thetaMat<span class="op">=</span><span class="va">thetaMat</span>,</span>
<span>                <span class="co">## Match boundaries of problem</span></span>
<span>                thetaLower<span class="op">=</span><span class="fl">0</span>,</span>
<span>                sigma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"prop.sd"</span>, <span class="st">"add.sd"</span><span class="op">)</span>, <span class="co">## Sigmas are standard deviations</span></span>
<span>                sigmaXform<span class="op">=</span><span class="st">"identity"</span>, <span class="co"># default sigma xform="identity"</span></span>
<span>                omega<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"eta.cl"</span>, <span class="st">"eta.v"</span>, <span class="st">"eta.ka"</span><span class="op">)</span>, <span class="co">## etas are variances</span></span>
<span>                omegaXform<span class="op">=</span><span class="st">"variance"</span>, <span class="co"># default omega xform="variance"</span></span>
<span>                iCov<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>WT<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">70</span>, <span class="fl">15</span><span class="op">)</span>, CLCR<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">65</span>, <span class="fl">25</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                dfSub<span class="op">=</span><span class="fl">74</span>, dfObs<span class="op">=</span><span class="fl">476</span>,</span>
<span>                resample<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> thetaMat has too many items, ignored: 'tlag'</span></span>
<span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span><span class="va">sim</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ipred"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; summarizing data...</span></span>
<span><span class="co">#&gt; done</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span></code></pre></div>
<p><img src="rxode2-sim-var_files/figure-html/unnamed-chunk-28-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="simulate-without-uncertainty-in-omega-or-sigma-parameters">Simulate without uncertainty in <code>omega</code> or
<code>sigma</code> parameters<a class="anchor" aria-label="anchor" href="#simulate-without-uncertainty-in-omega-or-sigma-parameters"></a>
</h3>
<p>If you do not wish to sample from the prior distributions of either
the <code>omega</code> or <code>sigma</code> matrices, you can turn off
this feature by specifying the <code>simVariability = FALSE</code>
option when solving:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">sim</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rxSolve.html">rxSolve</a></span><span class="op">(</span><span class="va">mod2</span>, <span class="va">ev</span>, nSub<span class="op">=</span><span class="fl">100</span>, thetaMat<span class="op">=</span><span class="va">tMat</span>, nStud<span class="op">=</span><span class="fl">10</span>,</span>
<span>                simVariability<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span><span class="va">sim</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"centr"</span>, <span class="st">"eff"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> in order to put confidence bands around the intervals, you need at least 2500 simulations</span></span>
<span><span class="co">#&gt; summarizing data...done</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span></code></pre></div>
<p><img src="rxode2-sim-var_files/figure-html/unnamed-chunk-29-1.png" width="700"></p>
<p>Note since realizations of <code>omega</code> and <code>sigma</code>
were not simulated, <code>$omegaList</code> and <code>$sigmaList</code>
both return <code>NULL</code>.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matthew L. Fidler, Wenping Wang, Melissa Hallow.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
